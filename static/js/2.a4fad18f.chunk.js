(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{2724:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(85),s=n(44),o=n(12),i=n(9);t.a=Object(o.b)(function(e,t){return{rolling:e.sequencer.trackRolling,quantized:e.sequencer.quantized}},function(e){return{setTrackRolling:function(t){return e(Object(i.oh)(t))},setQuantized:function(t){return e(Object(i.Ee)(t))}}})(function(e){var t=e.rolling,n=e.setTrackRolling,r=e.quantized,o=e.setQuantized;return a.a.createElement("div",{className:"live-buttons"},a.a.createElement(c.a,{onClick:function(){return n(!t)},className:t?"live-button selected":"live-button",element:s.xb},a.a.createElement("img",{className:"roll-icon",src:"/roll-light.png"})),a.a.createElement(c.a,{onClick:function(){return o(!r)},className:r?"live-button":"live-button selected",element:s.nb},a.a.createElement("img",{className:"quantize-btn",src:r?"/quantized.svg":"/unquantized.svg"})))})},2726:function(e,t,n){},2826:function(e,t,n){},2827:function(e,t,n){},2828:function(e,t,n){},2829:function(e,t,n){},2830:function(e,t,n){},2831:function(e,t,n){},2832:function(e,t,n){},2970:function(e,t,n){"use strict";n.r(t);var r=n(6),a=n(0),c=n.n(a),s=n(103),o=n(1417),i=n(2625),u=n(1512),l=n(1382),f=n(716),b=n(12),d=Object(b.b)(function(e,t){return{}},function(e){return{}})(function(e){Object(l.a)(e);var t=Object(a.useState)(0),n=Object(r.a)(t,2),s=n[0],o=n[1],i=Object(a.useCallback)(function(){window.fps&&o(window.fps)},[o]);return Object(f.a)(i,500),c.a.createElement("div",{className:"frames-per-second"},Math.round(s)," F.P.S.")}),m=n(43),g=n(2769),E=n(102),v=n(2685),j=n(975),p=n(2692),O=n(1500),h=n(1161),w=n(10),S=n(78),k=n(9),q=function(e,t){var n=[],r=e;for(r&&r.subSequence&&r.subSequence.zObject&&n.push(r);r&&r.subSequence&&r.subSequence.zObject;)r=r.subSequence.zObject,n.push(r);0===n.length&&(n=[e]);var a=n.map(function(e,n){return e.message?e._text:e.zObject&&"comment"===e.zObject.name?y(t,e.text):"subpatch"===e.name&&e.args[0]&&""!==e.args[0].trim()?e.args[0]:e.name});return{tree:n,list:a}},y=function(e,t){var n=t.indexOf(e);return"..."+t.slice(n,n+12)+"..."},C=(n(2826),Object(b.b)(function(e,t){return{recentSubPatches:e.zobject.recentSubPatches}},function(e){return{setViewableSubPatches:function(t){return e(Object(k.Nh)(t))}}})(function(e){var t=e.recentSubPatches,n=e.setViewableSubPatches,s=e.clear,o=Object(a.useState)(-1),i=Object(r.a)(o,2),u=i[0],l=i[1],f=Object(a.useCallback)(function(e){var t=e.sequencerEngine.state.zobject.viewableSubPatches;n([].concat(Object(w.a)(t),[e])),s()},[]);Object(a.useEffect)(function(){return window.addEventListener("keydown",b),function(){return window.removeEventListener("keydown",b)}},[l,u]);var b=Object(a.useCallback)(function(e){var n=t.length;if("ArrowDown"===e.key)u=Object(S.a)(u+1,Math.min(10,n)),l(u);else if("ArrowUp"===e.key)u=Object(S.a)(u-1,Math.min(10,n)),l(u);else if("Enter"===e.key){var r=t[u];r&&f(r)}},[l,u,t]);return 0===t.length?"":c.a.createElement("div",{className:"recent-subpatches"},c.a.createElement("div",{className:"recent-title"},"Recently opened"),t.slice(0,10).map(function(e,t){return c.a.createElement("div",{onClick:function(){return f(e)},className:t===u?"recent selected":"recent"},c.a.createElement("img",{src:"/subpatch-light.svg"}),q(e.zObject,"").list.map(function(e,t){return c.a.createElement("span",{className:0===t?"main-name":""},e)}))}))})),N=Object(b.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setMode;return c.a.createElement("div",{className:"quick-actions"},c.a.createElement("div",{onClick:function(){return t("RECENT_SAMPLES")},className:"pushable action"},"Recent Samples"),c.a.createElement("div",{onClick:function(){return t("ALL_SAMPLES")},className:"pushable action"},"All Samples"))}),P=(n(2827),Object(b.b)(function(e,t){return{}},function(e){return{setFullScreenZObject:function(t){return e(Object(k.uc)(t))}}})(function(e){var t=e.zobject,n=e.setFullScreenZObject,s=Object(a.useState)(!1),o=Object(r.a)(s,2),i=o[0],u=o[1],l=Object(a.useCallback)(function(){var e=t.sequencerEngine.state.zobject.fullScreenZObject;n(e?Array.isArray(e)?[].concat(Object(w.a)(e),[t]):[e,t]:t)},[t]);return c.a.createElement("div",{className:"zobject-command"},c.a.createElement("div",{onClick:function(){return u(!i)},className:"collapse-btn"},c.a.createElement("div",{className:i?"arrow-up":"arrow-down"})),i&&c.a.createElement("div",{className:"command-menu"},c.a.createElement("div",{onClick:l,className:"command-option"},"Add to Full-Screen")))})),x=n(467),M=n(2773),T=Object(b.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.mode,n=e.searchTerm,r=(e.selector,e.sequencerEngine);return c.a.createElement("div",null,c.a.createElement(M.a,{defaultGroupBy:"RECENT_SAMPLES"===t?x.a:x.d,quickAddSearchText:n,sequencerEngine:r}))}),L=n(91),D=n(214),R=n(2),A=n.n(R),z=n(13),F=n(260),I=n(243),Z=n(790),B=n(106),W=(n(138),n(154)),X=n(203),_=n(649),H=["Multiband Compressor","Flam","Max","Poly","First","Last","Staccato","Dot","Dash 1","Dash 2","Rest","Otherwise","Accent","Legato","R.Every","Double","Later","Regular","Flat","Thick","Split","Piano","Pianissimo"],U=Object.keys,V=(Object.values,function(e,t){return t=t.toLowerCase(),U(e).filter(function(e){return e.toLowerCase().includes(t)}).filter(function(e){return!H.includes(e)})}),J=function(){var e=Object(z.a)(A.a.mark(function e(t,n){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=V(Object(W.a)(),t),e.t1=V(X.b,t),e.t2=V(_.b,t),e.t3=G(t,n),e.next=6,Y(t,n);case 6:return e.t4=e.sent,e.next=9,Q(t,n);case 9:return e.t5=e.sent,e.abrupt("return",{AUDIO_FX:e.t0,MIDI_FX:e.t1,LIVE_FX:e.t2,OBJECTS:e.t3,SAMPLES:e.t4,SYNTHS:e.t5});case 11:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),G=function(e,t){var n=Object(F.a)(t.currentSubSequence,!0);return e=e.toLowerCase(),n.filter(function(t){return"string"===typeof t.name&&t.name.toLowerCase().includes(e)||t.args&&"string"===typeof t.args[0]&&t.args[0].toLowerCase().includes(e)||t.text&&"string"===typeof t.text&&t.text.toLowerCase().includes(e)||t._text&&"string"===typeof t._text&&t._text.toLowerCase().includes(e)||t.text&&"number"===typeof t.text&&t.text.toString().includes(e)}).filter(function(e){return!e.getObjectType||e.getObjectType()!==B.a})},Y=function(){var e=Object(z.a)(A.a.mark(function e(t,n){var r;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.b)(t);case 2:return r=e.sent,e.next=5,n.searcher.freeTextSearch(t);case 5:return e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Q=function(){var e=Object(z.a)(A.a.mark(function e(t,n){var r;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.c)(void 0,"MULTI_SYNTH",[],0,8359897,!1,void 0,t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),K=(n(2726),function(e){var t=e.name,n=(e.onClick,e.results),r=e.priorLength,a=void 0===r?0:r,s=e.cursor,o=e.setCursor,i=e.term,u=e.scrollRef;return n&&0!==n.length?[c.a.createElement("div",{className:"type-name"},t)].concat(Object(w.a)(n.map(function(e,n){return c.a.createElement($,{type:t,onClick:function(){return o(n+a)},isCursor:n+a===s,x:e,scrollRef:u,term:i})}))):""}),$=function(e){var t=e.isCursor,n=e.type,r=e.x,s=e.term,o=e.scrollRef,i=e.onClick,u=Object(a.useRef)();return Object(a.useEffect)(function(){if(t){var e=u.current.offsetTop+50,n=o.current.scrollTop;e>n+o.current.offsetHeight&&o.current.scrollTo(0,e-130),e>141&&e-150<n&&o.current.scrollTo(0,e-130)}},[t]),c.a.createElement("div",{onClick:i,ref:u,className:t?"cursor result flex":"result flex"},"Samples"===n?c.a.createElement("img",{src:"/waveform-icon.svg"}):n.includes("FX")?c.a.createElement("img",{src:"/effects-icon.svg"}):"Synth Presets"===n?c.a.createElement("img",{src:"/synth-icon.svg"}):"","string"===typeof r?r:"Synth Presets"===n?r.title:c.a.createElement(ee,{isCursor:t,term:s,zobject:r}))},ee=function(e){var t=e.zobject,n=e.term,r=e.isCursor,a=q(t,n),s=a.tree,o=a.list,i=void 0;if("script"===t.name){var u=t.effect.outlets[Object.keys(t.effect.outlets)[0]];u&&(u.connections.some(function(e){return"fragment shader"===e.destType})?i="fragment shader":u.connections.some(function(e){return"vertex shader"===e.destType})&&(i="vertex shader"))}return t.args&&"string"===typeof t.args[0]&&!i&&(i=t.args[0]),c.a.createElement("div",{className:"zobject-preview"},t.message?c.a.createElement("img",{className:"object-icon",src:t.type===L.c?"/znumber-light.svg":"/zmessage-light.svg"}):t.zObject&&"comment"===t.zObject.name?c.a.createElement("img",{className:"object-icon",src:"/zcomment-light.svg"}):"subpatch"===t.name?c.a.createElement("img",{className:"object-icon",src:"/subpatch-light.svg"}):c.a.createElement("img",{className:"object-icon",src:"/zobject-light.svg"}),s.map(function(e,t){return c.a.createElement("div",{key:t,className:t>0?"tree-part spatch":"main-part tree-part"},o[t])}),i&&c.a.createElement("div",{className:"custom-type"},i),r&&c.a.createElement(P,{zobject:t}))},te=function(e){return e?e.length:0},ne=Object(b.b)(function(e,t){return{}},function(e){return{setWindowPosition:function(t,n){return e(Object(k.Th)(t,n))},setViewableZObjects:function(t){return e(Object(k.Oh)(t))},setShowEditorBottom:function(t){return e(Object(k.Qf)(t))},setViewableSubPatches:function(t){return e(Object(k.Nh)(t))},setFullScreenZObject:function(t){return e(Object(k.uc)(t))}}})(function(e){var t=e.searchTerm,n=e.sequencerEngine,s=e.hide,o=e.inputRef,i=e.setShowEditorBottom,u=e.setWindowPosition,l=e.setViewableZObjects,f=e.setViewableSubPatches,b=e.setFullScreenZObject,d=Object(a.useState)({}),m=Object(r.a)(d,2),g=m[0],E=m[1],v=Object(a.useState)(0),j=Object(r.a)(v,2),p=j[0],O=j[1],h=Object(a.useState)(!1),S=Object(r.a)(h,2),k=S[0],q=S[1],y=Object(a.useRef)(void 0),C=Object(a.useRef)(0);Object(a.useEffect)(function(){if(""===t)E({});else{var e=G(t,n);E({OBJECTS:e});var r=++C.current;setTimeout(function(){r===C.current&&J(t,n).then(function(e){return E(e)})},200)}},[t,E]),Object(a.useEffect)(function(){O(0)},[g,O]);var N=Object(a.useCallback)(function(){return te(g.AUDIO_FX)+te(g.MIDI_FX)+te(g.LIVE_FX)+te(g.OBJECTS)+te(g.SAMPLES)+te(g.SYNTHS)},[g]);Object(a.useEffect)(function(){return window.addEventListener("keydown",P),function(){return window.removeEventListener("keydown",P)}},[g,k,p,O,s,q]);var P=Object(a.useCallback)(function(e){if(k)"ArrowLeft"===e.key&&q(!1);else{if("ArrowUp"===e.key)return e.preventDefault(),L(),!1;if("ArrowDown"===e.key)return e.preventDefault(),M(),!1;if("Enter"===e.key)return e.preventDefault(),x(g,p,e.metaKey||e.ctrlKey),!1;if("Escape"===e.key){if(n.state.zobject.viewableSubPatches.length>0||n.state.zobject.viewableZObjects.length>0)return;return e.preventDefault(),s(),!1}"ArrowRight"===e.key&&x(g,p,!1,!0)}},[g,p,O,s,q,k]);Object(a.useEffect)(function(){k&&o.current.blur()},[k]);var x=Object(a.useCallback)(function(e,t,r,a){var c=e.OBJECTS||[],o=e.AUDIO_FX||[],d=e.MIDI_FX||[],m=e.LIVE_FX||[],g=e.SAMPLES||[],E=e.SYNTHS||[],v=[].concat(Object(w.a)(c),Object(w.a)(o),Object(w.a)(d),Object(w.a)(m),Object(w.a)(g),Object(w.a)(E)),j=([].concat(Object(w.a)(c),Object(w.a)(o),Object(w.a)(d),Object(w.a)(m)),v[t]);if(j)if(te([].concat(Object(w.a)(c),Object(w.a)(o),Object(w.a)(d),Object(w.a)(m)))<=t&&te([].concat(Object(w.a)(c),Object(w.a)(o),Object(w.a)(d),Object(w.a)(m),Object(w.a)(g)))>t){if(a)return void q(j);r?n.scripting.runScript("/"+j+"/"):n.scripting.runScript("/"+j)}else if(t>=te([].concat(Object(w.a)(c),Object(w.a)(o),Object(w.a)(d),Object(w.a)(m),Object(w.a)(g))))r?n.auditionPreset(j,n.getSelectedTrack().trackNumber):n.loadPreset(j,!0);else if(te([].concat(Object(w.a)(c),Object(w.a)(o),Object(w.a)(d),Object(w.a)(m)))>t&&t>=te(c))n.scripting.runScript("+"+j),i(D.a);else{var p=n.state.zobject.fullScreenZObject;if(p&&"three.canvas"!==p.name&&("subpatch"!==j.name||j.effect.isCustom))if(Array.isArray(p))b([].concat(Object(w.a)(p),[j.zObject||j]));else{var O=[p,j.zObject||j];b(O)}else if("subpatch"!==j.name||j.effect.isCustom)if(j.zObject&&(j=j.zObject),j.effect){var h=n.state.zobject.viewableZObjects;u({x:100,y:100}),l([].concat(Object(w.a)(h),[j]))}else{j.subSequence;var S=n.state.zobject.viewableSubPatches;u({x:100,y:100}),f([].concat(Object(w.a)(S),[j.subSequence]))}else{var k=n.state.zobject.viewableSubPatches;u({x:100,y:100}),f([].concat(Object(w.a)(k),[j.effect]))}}s()},[s,q]),M=Object(a.useCallback)(function(){O(Math.min(p+1,N()-1))},[g,p,O]),L=Object(a.useCallback)(function(){0===p&&o.current.blur(),O(Math.max(0,p-1))},[p,O]);return Object(a.useEffect)(function(){q(!1)},[t,q]),k?c.a.createElement(T,{searchTerm:k,sequencerEngine:n}):c.a.createElement("div",{ref:y,className:""===t?"search-results empty":"search-results"},c.a.createElement(K,{scrollRef:y,cursor:p,term:t,name:"Objects (in project)",setCursor:O,results:g.OBJECTS}),c.a.createElement(K,{scrollRef:y,cursor:p,term:t,name:"Create Audio FX",priorLength:te(g.OBJECTS),setCursor:O,results:g.AUDIO_FX}),c.a.createElement(K,{scrollRef:y,cursor:p,term:t,priorLength:te(g.OBJECTS)+te(g.AUDIO_FX),setCursor:O,name:"Create Midi FX",results:g.MIDI_FX}),c.a.createElement(K,{scrollRef:y,cursor:p,term:t,setCursor:O,priorLength:te(g.OBJECTS)+te(g.AUDIO_FX)+te(g.MIDI_FX),name:"Create Live FX",results:g.LIVE_FX}),c.a.createElement(K,{scrollRef:y,cursor:p,term:t,priorLength:te(g.AUDIO_FX)+te(g.MIDI_FX)+te(g.OBJECTS)+te(g.LIVE_FX),name:"Samples",setCursor:O,results:g.SAMPLES}),c.a.createElement(K,{scrollRef:y,cursor:p,term:t,name:"Synth Presets",setCursor:O,priorLength:te(g.AUDIO_FX)+te(g.MIDI_FX)+te(g.OBJECTS)+te(g.SAMPLES)+te(g.LIVE_FX),results:g.SYNTHS}))}),re=n(705),ae=n(8),ce=n(67);function se(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oe(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,c=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw c}}}}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ie=function(e,t){var n=Object(a.useCallback)(function(t){return e.dispatch(t)},[e]),r=function(){n(Object(k.b)())};return{onDrop:Object(a.useCallback)(function(){var a=Object(z.a)(A.a.mark(function a(c){var s,o,i,u,l,f,b,d,m,g,E,v,j,p,O,h,S,q,y,C,N,P,x,M,T,L,D;return A.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=e.state,o=s.instruments,i=s.tracks,u=s.effects,l=s.presets,f=s.selector,b=s.sequencer,d=t(c),m=d.x,g=d.y,E=e.state.spatial.editorPadding,m-=Math.max(0,E.x),g-=Math.max(0,E.y),!o.pullablePartDragging){a.next=13;break}return(v=Object(ae.a)({},o.pullablePartDragging)).x=m,v.y=g,j=[].concat(Object(w.a)(u.pulledEffects),[v]),n(Object(k.De)(j)),r(),a.abrupt("return");case 13:if(!i.trackDragging){a.next=18;break}return(p=i.trackDragging).subSequence.createZTrack(p,m,g),r(),a.abrupt("return");case 18:if(void 0===f.sampleDragging){a.next=44;break}O=se(e.currentSubSequence.pads),a.prev=20,O.s();case 22:if((h=O.n()).done){a.next=31;break}if(S=h.value,!(q=S.containsSample(f.sampleDragging))){a.next=29;break}return S.removeTrack(q),r(),a.abrupt("return");case 29:a.next=22;break;case 31:a.next=36;break;case 33:a.prev=33,a.t0=a.catch(20),O.e(a.t0);case 36:return a.prev=36,O.f(),a.finish(36);case 39:y=f.sampleDragging,e.addSound(y,void 0),r(),a.next=74;break;case 44:if(!f.samplesDragging){a.next=73;break}C=0,N=se(f.samplesDragging),a.prev=47,N.s();case 49:if((P=N.n()).done){a.next=62;break}if(x=P.value,!(C>4)){a.next=53;break}return a.abrupt("break",62);case 53:if(M=x,"string"!==typeof x){a.next=58;break}return M=new ce.a(x),a.next=58,M.load();case 58:e.addSound(M),C++;case 60:a.next=49;break;case 62:a.next=67;break;case 64:a.prev=64,a.t1=a.catch(47),N.e(a.t1);case 67:return a.prev=67,N.f(),a.finish(67);case 70:r(),a.next=74;break;case 73:f.sampleTagDragging&&(e.searchForSounds([f.sampleTagDragging]),r());case 74:l.presetDragging&&(e.loadPreset(l.presetDragging,!0),r()),(T=b.effectDragging||u.midiEffectDragging)&&Object.keys(T).length>1&&((L=T.effect).x=m,L.y=g,D=[].concat(Object(w.a)(u.pulledEffects),[L]),n(Object(k.De)(D)),r());case 77:case"end":return a.stop()}},a,null,[[20,33,36,39],[47,64,67,70]])}));return function(e){return a.apply(this,arguments)}}(),[e])}},ue=Object(b.b)(function(e,t){return{}},function(e){return{setQuickAddSearchText:function(t){return e(Object(k.Fe)(t))},setShowSearchWindow:function(t){return e(Object(k.kg)(t))}}})(function(e){var t=e.showing,n=e.setShowSearchWindow,s=e.sequencerEngine,o=e.setQuickAddSearchText,i=Object(a.useRef)(void 0),u=Object(a.useRef)(0),l=Object(a.useRef)(void 0),f=Object(a.useState)(void 0),b=Object(r.a)(f,2),d=b[0],m=b[1],g=Object(a.useState)(""),E=Object(r.a)(g,2),v=E[0],j=E[1],p=Object(a.useState)(""),O=Object(r.a)(p,2),h=O[0],w=O[1],S=ie(s,function(){return{x:0,y:0}}).onDrop;Object(a.useEffect)(function(){return function(){return o(void 0)}},[]),Object(a.useEffect)(function(){u.current++;var e=u.current;setTimeout(function(){e===u.current&&w(v)},100)},[v,w]);var k=Object(re.a)({ref:i}),q=(k.setCoords,k.onMouseUp,k.onMouseDown,k.coords);Object(a.useEffect)(function(){t&&l.current&&l.current.focus()},[t]),Object(a.useEffect)(function(){return window.addEventListener("keydown",y),function(){return window.removeEventListener("keydowwn",y)}},[]);var y=function(e){"ArrowDown"===e.key||e.key},P={left:q&&q.x,top:q&&q.y},x="search-background";t||(x+=" hide"),Object(a.useEffect)(function(){return window.addEventListener("click",M),function(){return window.removeEventListener("click",M)}},[]);var M=function(){n(!1)};return c.a.createElement("div",{onDrop:S,className:x},c.a.createElement("div",{style:P,onClick:function(e){return e.stopPropagation()},ref:i,className:"search-window"},c.a.createElement("div",{onClick:M,className:"delete-btn"},"x"),c.a.createElement("img",{src:"/search.svg",className:"search-icon"}),c.a.createElement("input",{ref:l,className:"search-text",value:v,onChange:function(e){return j(e.target.value)},placeholder:"Search for objects & actions"}),"RECENT_SAMPLES"===d||"ALL_SAMPLES"===d?c.a.createElement(T,{mode:d,searchTerm:v,sequencerEngine:s}):c.a.createElement(ne,{hide:function(){return n(!1)},searchTerm:h,inputRef:l,sequencerEngine:s}),void 0===d&&""===v&&c.a.createElement(N,{setMode:m,sequencerEngine:s}),""===v&&c.a.createElement(C,{clear:M})))}),le=n(1499),fe=n(318);n(2828);function be(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return de(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,c=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw c}}}}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var me=function(e){var t,n=[],r=be(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,c=a.effect.getOutboundNodes(),s=!1;for(var o in c){var i=c[o][0];if(i&&i.node&&i.node.zObject&&"three.canvas"===i.node.zObject.name){n.push(i.node.zObject),s=!0,i.node.zObject.pluginViewerFor=a;break}}s||n.push(a)}}catch(u){r.e(u)}finally{r.f()}return n},ge=Object(b.b)(function(e,t){var n=e.spatial.showEditorBottom;return{bottomHeight:n===D.b?e.arrangement.bottomHeight:n===D.a?280:40,leftSidebarWidth:e.spatial.leftSidebarWidth,pluginsLoaded:e.plugins.pluginsLoaded,showPluginsPane:e.plugins.showPluginsPane}},function(e){return{setShowPluginsPane:function(t){return e(Object(k.gg)(t))},setPluginsPaneHeight:function(t){return e(Object(k.ve)(t))},setSelectedPulledElements:function(t){return e(Object(k.uf)(t))}}})(function(e){var t=e.setSelectedPulledElements,n=e.pluginsLoaded,r=e.leftSidebarWidth,s=e.setShowPluginsPane,o=e.showPluginsPane,i=e.bottomHeight,u=e.setPluginsPaneHeight,l={bottom:i,left:r,width:window.innerWidth-r-240};n&&(n=me(n));var f=n?Math.max.apply(Math,Object(w.a)(n.map(function(e){return e.height||100}))):void 0;return f=Math.min(300,f)+30,l.minHeight=f,o||(l.height=40,l.minHeight=40),Object(a.useEffect)(function(){u(f)},[f]),n&&0!==n.length?c.a.createElement("div",{onMouseDown:function(){return t({})},style:l,className:o?"plugins-pane showing":"plugins-pane"},c.a.createElement("div",{className:"collapse-and-label"},c.a.createElement("div",{onClick:function(){return s(!o)},className:"collapse-container"},c.a.createElement("div",{className:o?"arrow-right":"arrow-up"})),c.a.createElement("div",{className:"plugins-label"},c.a.createElement("img",{src:"/plugin-icon.svg"}))),o&&c.a.createElement("div",{className:"plugins-container"},n.map(function(e){return c.a.createElement(fe.a,{forceShow:!0,zobject:e})}))):[]}),Ee=n(2684),ve=n(707),je=n(2770),pe=n(20),Oe=n(187),he=n(2598),we=n(1165),Se=n(1145),ke=n(1148),qe=n(105),ye=n(221),Ce=n(136),Ne=n(474),Pe=Object(b.b)(function(e,t){return{presentationMode:e.spatial.presentationMode,pulledEffects:e.effects.pulledEffects}},function(e){return{setPulledEffects:function(t){return e(Object(k.De)(t))}}})(function(e){var t=e.dropdownPosRef,n=e.subSequence,r=e.scale,s=e.dropdownPos,o=e.pulledEffects,i=e.setPulledEffects,u=e.elements,l=Object(he.a)({elements:u,subSequence:n,presentationMode:n.presentationMode}).arrangeWindows,f=Object(a.useCallback)(function(){var e=t.current,r=e.x,a=e.y;n.encapsulateObjects(r,a)},[n]),b=Object(a.useCallback)(function(){for(var e=n.sequencerEngine.state.windows.selectedElements,t=0,r=Object.keys(e);t<r.length;t++){var a=r[t],c=n.sequencerEngine.findNodeById(a);c&&c.setAttribute("Include in Presentation",!0)}},[n]),d=Object(a.useCallback)(function(e){var r=Object(qe.c)(e,n),a=t.current,c=a.x,s=a.y;r.x=c,r.y=s,n.midiEffects.addEffect(r),i([].concat(Object(w.a)(o),[r]))},[n,o]),m=n.state.windows.selectedElements,g=Object.keys(m).filter(function(e){return m[e]});return c.a.createElement(ye.a,{className:"midi-context",dropdownPos:s?{x:s.x/r,y:s.y/r}:void 0},g.length>0&&c.a.createElement(Ce.a,{onMouseDown:f},"Encapsulate Objects"),g.length>0&&c.a.createElement(Ce.a,{onMouseDown:b},"Include in Presentation",c.a.createElement("img",{src:"/presentation-mode.svg"})),g.length>0&&c.a.createElement(Ce.a,{onMouseDown:l},"Pack Objects"),c.a.createElement(Ce.a,{onMouseDown:function(){return Object(ke.a)(n.sequencerEngine,n)}},"Segment All Cables"),c.a.createElement("div",{className:"context-divider"}),c.a.createElement(Ne.a,{name:"Midi Effects"},qe.e.map(function(e){var t=e.label,n=e.value;return c.a.createElement(Ce.a,{onMouseDown:function(){return d(n)}},t)})))}),xe=n(255),Me=n(1146),Te=n(223),Le=n(2626),De=n(717),Re=(Object(b.b)(function(e,t){return t.sequencerEngine?{selectedTrack:t.sequencerEngine.getSelectedTrack()}:{}},function(e){return{}})(function(e){var t=e.selectedTrack;return t?(console.log("track =",t),c.a.createElement("div",{className:"cirklon-element"},c.a.createElement(De.a,{track:t}))):""}),n(1492)),Ae=n(1443),ze=n(2582),Fe=(n(2829),Object(b.b)(function(e,t){return{numPads:t.sequencerEngine.currentSubSequence&&t.sequencerEngine.currentSubSequence.pads.length}},function(e){return{setShowPadSequencer:function(t){return e(Object(k.cg)(t))}}})(function(e){var t=e.pad,n=e.sequencerEngine,s=e.setShowPadSequencer,o=Object(a.useState)(void 0),i=Object(r.a)(o,2),u=i[0],l=i[1],f=Object(a.useState)(""),b=Object(r.a)(f,2),d=b[0],m=b[1],g=Object(a.useRef)(),E=Object(a.useCallback)(function(e){m(e.target.value)},[m]),v=Object(a.useCallback)(function(e){"Enter"===e.key&&(u.name=d,l(void 0))},[u,l,d]),j=Object(a.useCallback)(function(){m(g.current.name),l(g.current)},[m,l]),p=Object(Oe.a)(j,250),O=n.currentSubSequence.pads,h=Object(a.useCallback)(function(e){var t=n.state.tracks.trackDragging;if(console.log("on drop called with pad/trackDragging",e,t),t){for(var r=-1,a=0;a<e.slots.length;a++)if(!e.slots[a]){r=a;break}console.log("slot number=",r),r>-1&&e.addTrack(t,r)}},[]);return c.a.createElement("div",{className:"pad-tabs"},O.map(function(e,n){return c.a.createElement("div",{onDrop:function(){return h(e)},onClick:function(t){g.current=e,s(e),p(t)},className:function(){var n=t===e?"pad-option selected":"pad-option";return e===u&&(n+=" editing"),n}()},u===e?c.a.createElement("input",{onChange:E,placeholder:"Enter name",onKeyDown:v,type:"text",value:d,className:"pad-name-input"}):e.name||"Pad "+(n+1))}),c.a.createElement("div",{onClick:function(){var e=n.currentSubSequence.createPad();s(e)},className:"pushable new-pad-btn"},"+"))})),Ie=n(1130),Ze=n(1493),Be=(n(2830),Object(b.b)(function(e,t){return{tracks:t.pad.tracks,showEditorBottom:e.spatial.showEditorBottom,bottomHeight:e.arrangement.bottomHeight,editorBottomHeight:t.editorBottomRef.current&&t.editorBottomRef.current.offsetHeight,pluginsPaneHeight:e.plugins.pluginsPaneHeight||0,leftSidebarWidth:e.spatial.leftSidebarWidth}},function(e){return{setShowPadSequencer:function(t){return e(Object(k.cg)(t))},setSelectedZObject:function(t){return e(Object(k.Cf)(t))},setShowFreezeModal:function(t){return e(Object(k.Uf)(t))}}})(function(e){var t=e.leftSidebarWidth,n=e.pad,s=e.showEditorBottom,o=e.bottomHeight,i=e.setShowPadSequencer,u=e.setSelectedZObject,l=e.pluginsPaneHeight,f=e.editorBottomRef,b=e.editorBottomHeight,d=e.setShowFreezeModal,m=Object(a.useRef)(void 0),g=Object(a.useState)(0),E=Object(r.a)(g,2),v=(E[0],E[1]),j={},p=Object(a.useCallback)(function(){d(!0)},[n]);s===D.b?j.marginBottom=o:s===D.a?(console.log("editor bottom height",b,f),j.marginBottom=b||400):j.marginBottom=40,j.marginBottom+=l+20;var O=n.slotTracks;return O.sort(function(e,t){return e.trackNumber-t.trackNumber}),c.a.createElement("div",{style:j,onClick:function(){return u(void 0)},className:"pad-sequencer",ref:m},c.a.createElement(ze.a,{setHeight:v,sequencerEngine:n.sequencerEngine}),c.a.createElement(Re.a,{fillSize:!0,sequencerEngine:n.sequencerEngine,scale:1,scrollContainer:m}),c.a.createElement("div",{style:{left:t},className:"pad-sequencer-toolbar"},c.a.createElement("div",{className:"inner-toolbar"},c.a.createElement("div",{onClick:function(){return i(void 0)},className:"arrow-container pad-sequencer-back"},c.a.createElement("div",{className:"arrow-left"})),c.a.createElement(Fe,{pad:n,sequencerEngine:n.sequencerEngine}),c.a.createElement("div",{onClick:p,className:"pushable freeze-pad flex"},c.a.createElement("img",{className:"mt-1",src:"/freeze-icon.svg"})," Freeze"))),O.map(function(e){return c.a.createElement(Ze.a,{forceShow:!0,track:e,scrollContainer:m})}))})),We=n(2777),Xe=(n(1514),Object(b.b)(function(e,t){return{leftSidebarWidth:e.spatial.leftSidebarWidth,showThemeGrid:e.sequencer.showThemeGrid,showPadSequencer:e.spatial.showPadSequencer,position:e.spatial.position,loadingSequence:e.sequencer.loadingSequence,currentSubSequence:t.sequencerEngine&&t.sequencerEngine.currentSubSequence}},function(e){return{setShowTrackInstrument:function(t){return e(Object(k.sg)(t))},setPulledEffects:function(t){return e(Object(k.De)(t))},setSelectedPulledElements:function(t){return e(Object(k.uf)(t))},setSelectedZObject:function(t){return e(Object(k.Cf)(t))},hideColorPicker:function(t){return e(Object(k.ob)(void 0))}}})(function(e){var t,n=e.sequencerEngine,s=e.editorBottomRef,o=e.leftSidebarWidth,i=(e.setShowTrackInstrument,e.showPadSequencer),u=e.currentSubSequence,l=(e.setPulledEffects,e.setSelectedZObject),f=e.hideColorPicker,b=(e.setSelectedPulledElements,e.showThemeGrid),d=Object(a.useRef)(),m=Object(a.useRef)(void 0),g=Object(a.useRef)(void 0),E=Object(a.useState)(1),v=Object(r.a)(E,2),j=v[0],p=v[1],O=Object(Te.a)({containerRef:d,scale:j}).getXY,h=Object(xe.a)({ref:d}),w=h.onContextMenu,S=h.dropdownPos,q=(h.setDropdowPos,Object(a.useRef)(S)),y=Object(a.useRef)({}),C=Object(Me.a)({elements:y}).getSelection,N=u,P=Object(a.useCallback)(function(e){var t=O(e,!0),r=t.x,a=t.y,c=n.state.spatial.editorPadding;r-=Math.max(0,c.x),a-=Math.max(0,c.y),e.stopPropagation(),e.preventDefault(),N.createZObject(r,a)},[N]),x=Object(Oe.a)(P);Object(a.useEffect)(function(){S&&(q.current=S)},[S]);var M=Object(Ae.a)({scrollRef:d,sequencerEngine:n,context:n&&n.currentSubSequence}).onMouseMove;Object(a.useEffect)(function(){n&&n.dispatch(Object(k.id)(d))},[n]);var T=ie(n,O).onDrop;if(!n)return 0;var L={paddingLeft:o},D="editor no-select";return b&&(D+=" show-grid"),c.a.createElement("div",{onContextMenu:w,style:L,onMouseDown:function(){return f()},onClick:x,onDrop:T,ref:d,className:D},!i&&c.a.createElement(Pe,{elements:y,subSequence:N,scale:j,dropdownPosRef:q,dropdownPos:S}),!i&&c.a.createElement(Se.a,{dropdownPos:S,getXY:O,scale:j,sequencerEngine:n,setSelectedZObject:l,onMouseMove:M,getSelection:C,editorRef:d}),i?c.a.createElement(Be,{editorBottomRef:s,pad:!0===i?N.pads[0]:i}):c.a.createElement(We.a,(t={editorRef:d,edgesRef:m,innerRef:g,scale:j,setScale:p,elements:y,dropdownPosRef:q,key:N.id},Object(pe.a)(t,"scale",1),Object(pe.a)(t,"showEffects",!0),Object(pe.a)(t,"subSequence",N),Object(pe.a)(t,"sequencerEngine",n),t),c.a.createElement(we.a,{edgesRef:m,containerRef:d,scale:j,subSequence:N}),c.a.createElement(Re.a,{sequencerEngine:n,scrollContainer:d}),c.a.createElement(Le.a,{scrollContainer:d,sequencerEngine:n})),i&&c.a.createElement(Le.a,{scrollContainer:d,sequencerEngine:n}))})),_e=n(82),He=n(1136),Ue=Object(b.b)(function(e,t){return{viewMode:e.sequencer.viewMode}},function(e){return{setViewMode:function(t){return e(Object(k.Mh)(t))},setContextualHelp:function(t,n){return e(Object(k.wb)(t,n))}}})(function(e){return c.a.createElement("div",{className:"view-buttons"},c.a.createElement("img",Object(pe.a)({onClick:function(){return e.setViewMode(E.e)},src:"/mix-view.svg",className:"view-mode-icon"},"className",e.viewMode===E.e?"view-mode-icon selected":"view-mode-icon")),c.a.createElement("img",{src:"/arrangement-view.svg",onClick:function(){return e.setViewMode(E.a)},className:e.viewMode===E.a?"view-mode-icon selected":"view-mode-icon"}),c.a.createElement("img",{src:"/arrangement-view.svg",onClick:function(){return e.setViewMode(E.b)},className:e.viewMode===E.b?"view-mode-icon selected":"view-mode-icon"}))}),Ve=n(2583),Je=n(2553),Ge=n(2724),Ye=n(75),Qe=Object(b.b)(function(e,t){return{}},function(e){return{setShowProjectsModal:function(t){return e(Object(k.ig)(t))},setShowSearchWindow:function(t){return e(Object(k.kg)(t))},setShowSettings:function(t){return e(Object(k.ng)(t))}}})(function(e){var t=Object(a.useState)(!1),n=Object(r.a)(t,2),s=n[0],o=n[1];return c.a.createElement(Ye.c,{className:"logo-dropdown view-dropdown guilds-dropdown",show:s?"true":"false",isOpen:s,toggle:function(){return o(!s)}},c.a.createElement(Ye.f,{size:"sm",caret:!0,color:"primary"},c.a.createElement("img",{src:"/smol-logo4.svg"})),c.a.createElement(Ye.e,null,c.a.createElement(Ye.d,{onClick:function(){return e.setShowSearchWindow(!0)}},"Search ",c.a.createElement("div",{className:"key-shortcut"},"/")),c.a.createElement(Ye.d,{onClick:function(){return e.setShowSettings(!0)}},"Settings"),c.a.createElement(Ye.d,{onClick:function(){return e.setShowProjectsModal(!0)}},"Open Project"),c.a.createElement(Ye.d,{onClick:function(){window.location.href="/v3"}},"New Project")))}),Ke=n(2604),$e=n(1177),et=n(706),tt=n(1127),nt=n(2687),rt=n(2644),at=(n(2831),Object(b.b)(function(e,t){return{showLFOs:e.sequencer.showLFOs,showEnvelopes:e.sequencer.showEnvelopes,show:e.spatial.sidebarsShowing,showMoulators:e.spatial.showModulators,viewMode:e.sequencer.viewMode,showSave:e.toolbar.showSaveModal}},function(e){return{setShowEnvelopes:function(t){return e(Object(k.Rf)(t))},setShowLFOs:function(t){return e(Object(k.Xf)(t))},setShowSave:function(t){return e(Object(k.jg)(t))}}})(function(e){var t=e.showSave,n=e.setShowSave,r=Object(_e.a)(e,["showSave","setShowSave"]),s=Object(a.useRef)(),o=Object(a.useCallback)(function(e,t,a){r.sequencerEngine.save(e,t,!0,a),n(!1)},[n,r.sequencerEngine]);Object(a.useEffect)(function(){return window.addEventListener("keydown",i),function(){return window.removeEventListener("keydown",i)}},[r.showLFOs,r.showEnvelopes]);var i=Object(a.useCallback)(function(e){},[r.showLFOs,r.showEnvelopes]);return c.a.createElement("div",{ref:s,className:"top-toolbar"},c.a.createElement("div",{className:"main-row toolbar-row"},c.a.createElement(Qe,r),r.sequencerEngine?r.viewMode===E.a?c.a.createElement(Ie.a,{sequencerEngine:r.sequencerEngine}):c.a.createElement(rt.a,{subSequence:r.sequencerEngine.currentSubSequence}):"",r.sequencerEngine&&c.a.createElement($e.a,{sequencerEngine:r.sequencerEngine}),r.sequencerEngine&&c.a.createElement(Ke.a,{sequencerEngine:r.sequencerEngine}),r.sequencerEngine&&c.a.createElement(et.a,{sequencerEngine:r.sequencerEngine}),r.sequencerEngine&&c.a.createElement(Ge.a,{sequencerEngine:r.sequencerEngine}),r.sequencerEngine&&c.a.createElement(Ue,{sequencerEngine:r.sequencerEngine}),c.a.createElement("div",{className:"menu-and-transactions"},c.a.createElement(Je.a,null),r.sequencerEngine&&c.a.createElement(tt.a,{store:r.sequencerEngine.store})),c.a.createElement("div",{onClick:function(){return n(!0)},className:"pushable save-project-button"},"Save"),c.a.createElement(He.a,{sequencerEngine:r.sequencerEngine}),c.a.createElement(nt.a,{sequencerEngine:r.sequencerEngine,onSave:function(e,t,n){return o(e,t,n)},onHide:function(){return n(!1)},show:t})),(r.showLFOs||r.showEnvelopes)&&c.a.createElement("div",{className:r.showLFOs?"overlaying toolbar-row showLFOs":"showEnvelopes overlaying toolbar-row"},c.a.createElement(Ve.a,{scrollContainer:s,sequencerEngine:r.sequencerEngine,envelopesTrack:r.sequencerEngine.envelopesTrack,lfosTrack:r.sequencerEngine.lfosTrack})))})),ct=n(515),st=n(711),ot=(n(2640),n(41)),it=n.n(ot),ut=Object(b.b)(function(e,t){return{currentSubSequence:t.sequencerEngine.currentSubSequence}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.currentSubSequence,r=e.style,a=t.subSequences.map(function(e,t){return{label:e.name,value:e.id}});return c.a.createElement("div",{style:r,className:"subsequence-navigator"},c.a.createElement(it.a,{onChange:function(e){return t.switchToSubSequence(e.value)},value:a.find(function(e){return e.value===n.id}),options:a}),c.a.createElement("div",{onClick:function(){return t.newSubSequence()},className:"new-sub-btn"},"+"),c.a.createElement("div",{onClick:function(){return t.deleteSubSequence()},className:"delete-sub-btn"},"-"))}),lt=(n(2555),n(2642)),ft=Object(b.b)(function(e,t){var n=t.pad.id;return{_tracks:t.pad.tracks,_tracksLength:t.pad.tracks.length,hidden:e.spatial.hiddenObjects[n],locked:e.spatial.lockedObjects[n]}},function(e){return{setShowPadSequencer:function(t){return e(Object(k.cg)(t))},setUXLockObject:function(t,n){return e(Object(k.Dh)(t,n))},setUXHideObject:function(t,n){return e(Object(k.Ch)(t,n))}}})(function(e){var t=e.setShowPadSequencer,n=e.pad,s=e.isSelected,o=e.number,i=e.leftSidebarWidth,u=e.selectedZObject,l=(e.setSelectedZObject,e.hidden,e.locked,e.setUXLockObject,e.setUXHideObject,Object(a.useState)(!0)),f=Object(r.a)(l,2),b=f[0],d=f[1],m="pad-container";s&&(m+=" selected"),m+=b?" opened":" closed";var g=Object(a.useCallback)(function(e){e.stopPropagation(),d(!b)},[d,b]);return c.a.createElement("div",{className:m},c.a.createElement("div",{onClick:function(){t(n)},className:n===u?"selected zpad":"zpad"},c.a.createElement("div",{style:{backgroundColor:n.color},className:"pad-icon object-icon"}),c.a.createElement("div",{className:"pad-name"},i>100&&(n.name||"Pad "+o)),b?c.a.createElement("div",{onClick:g,className:"pushable arrow-down"}):c.a.createElement("div",{onClick:g,className:"pushable arrow-up"})),b&&c.a.createElement("div",{className:"pad-tracks"},n.tracks.filter(function(e){return e}).map(function(e){return c.a.createElement(lt.a,{selectedZObject:u,track:e})})))}),bt=(n(256),n(2717),n(2778),Object(b.b)(function(e,t){var n=t.sequencerEngine&&t.sequencerEngine.currentSubSequence;return n?{pads:n.pads,selectedZObject:e.zobject.selectedZObject,showPadSequencer:e.spatial.showPadSequencer,show:e.spatial.sidebarsShowing,tracks:t.sequencerEngine.tracks&&t.sequencerEngine.tracks.length,leftSidebarWidth:e.spatial.leftSidebarWidth}:{}},function(e){return{setSelectedZObject:function(t){return e(Object(k.Cf)(t))},setViewableSubPatches:function(t){return e(Object(k.Nh)(t))},setWindowPosition:function(t,n){return e(Object(k.Th)(t,n))},setViewableZObjects:function(t){return e(Object(k.Oh)(t))},setLeftSidebarWidth:function(t){return e(Object(k.cd)(t))}}})(function(e){var t=e.setWindowPosition,n=e.show,s=e.setSelectedZObject,o=e.setViewableSubPatches,i=e.setViewableZObjects,u=e.leftSidebarWidth,l=e.setLeftSidebarWidth,f=e.sequencerEngine,b=e.selectedZObject,d=e.pads,m=e.showPadSequencer,g=Object(a.useState)(!1),E=Object(r.a)(g,2),v=E[0],j=E[1],p=Object(a.useState)(""),O=Object(r.a)(p,2),h=O[0],S=(O[1],Object(a.useState)("Tracks")),k=Object(r.a)(S,2),q=(k[0],k[1]);Object(a.useEffect)(function(){return window.addEventListener("mousemove",y),window.addEventListener("mouseup",C),function(){window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",C)}},[v,j]);var y=Object(a.useCallback)(function(e){v&&l(Math.max(50,Math.min(240,e.pageX)))},[v]),C=Object(a.useCallback)(function(){v&&j(!1)},[v,j]);Object(a.useEffect)(function(){b&&b.getObjectType()===B.c?q("Tracks"):q("Objects")},[q,b]);var N=Object(a.useCallback)(function(e){var n=void 0;if(e.effect&&e.effect.zObjects)n=e.effect.id,o([e.effect]);else if(e.subSequence.zObjects&&e.subSequence.inletObjects){var r=e.state.zobject.viewableZObjects;t(e.window.id,{x:100,y:100}),i([].concat(Object(w.a)(r),[e]))}n&&t(n,0,0),s(e)},[]);Object(Oe.a)(N,250,function(e){return s(e)});if(!n)return"";var P=c.a.createElement("div",{className:"object-explorer"},f&&""===h&&d.map(function(e,t){return c.a.createElement(ft,{isSelected:m===e,leftSidebarWidth:u,number:t+1,selectedZObject:b,pad:e})}));return c.a.createElement("div",{style:{width:u,minWidth:u},className:"sidebar left-sidebar"},c.a.createElement(ut,{style:u<140?{display:"none"}:{},sequencerEngine:f}),c.a.createElement(Ie.a,{sequencerEngine:f}),P,c.a.createElement("div",{onMouseDown:function(){return j(!0)},className:"right-edge"}))})),dt=n(14),mt=n.n(dt),gt=n(341),Et=(n(55),n(33)),vt=function(){var e=Object(z.a)(A.a.mark(function e(t,n){var r;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.map(function(e){return e.uploadAudioBuffer(n)}),t.forEach(function(e){return e.title=e.name}),e.next=4,Promise.all(r);case 4:e.sent,0===n&&Et.a.newSamplesWithMetadata(t,n);case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),jt=(n(2832),Object(b.b)(function(e,t){return{userToken:e.sequencer.userToken,samplesToSave:e.samples.samplesToSave,guildId:e.guilds.selectedGuild?e.guilds.selectedGuild.guildId:0}},function(e){return{setShowLogin:function(t){return e(Object(k.Yf)(t))},setUploadingFile:function(t){return e(Object(k.Gh)(t))},setSamplesToSave:function(t){return e(Object(k.We)(t))},setRecentlyAddedSounds:function(t){return e(Object(k.He)(t))}}})(function(e){var t=e.setShowLogin,n=e.userToken,s=e.setRecentlyAddedSounds,o=e.setSamplesToSave,i=e.sequencerEngine,u=e.setUploadingFile,l=e.samplesToSave,f=e.guildId,b=Object(a.useState)(!1),d=Object(r.a)(b,2),m=d[0],g=d[1],E=Object(a.useRef)(void 0),v=Object(a.useState)([]),j=Object(r.a)(v,2),p=j[0],O=j[1],h=Object(a.useState)([]),k=Object(r.a)(h,2),q=(k[0],k[1],Object(a.useState)("")),y=Object(r.a)(q,2),C=y[0],N=y[1],P=Object(a.useRef)(new gt.a(mt.a.Master.context)),x=Object(a.useState)(void 0),M=Object(r.a)(x,2),T=M[0],L=M[1],D=Object(a.useCallback)(function(e,t){e||(e=l[t]),e&&(P.current.setBuffer(e.audioBuffer),P.current.playSound(0),L(t))},[L,l]);Object(a.useEffect)(function(){return window.addEventListener("keydown",R),function(){return window.removeEventListener("keydown",R)}},[l,L,T,O,p,C]);var R=Object(a.useCallback)(function(e){"Enter"===e.key?A():"ArrowUp"===e.key?D(void 0,Object(S.a)(T-1,l.length)):"ArrowDown"===e.key&&D(void 0,Object(S.a)(T+1,l.length))},[l,L,T,O,p,C]),A=Object(a.useCallback)(function(){O([].concat(Object(w.a)(p),[C])),N("")},[C,p,O,N]);Object(a.useEffect)(function(){l.forEach(function(e){return e.tags=Array.from(new Set([].concat(Object(w.a)(e.tags),Object(w.a)(p))))})},[p,l]);var z=Object(a.useCallback)(function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||0!==f){u(!0);var e=l;vt(l,f).then(function(t){console.log("finished bulk uploading..."),s(e),u(!1)}),o([])}else g(!0)},[f,g,l]),F=Object(re.a)({ref:E,initialCoords:{x:500,y:300}}),I=(F.setCoords,F.onMouseUp),Z=F.onMouseDown,B=F.coords;return l&&0!==l.length?c.a.createElement("div",{ref:E,className:"samples-to-save",onMouseUp:I,onMouseDown:Z,style:B?{top:B.y,left:B.x}:{}},m&&c.a.createElement("div",{className:"confirmation"},c.a.createElement("div",{className:"confirmation-text"},"Are you sure you want to save this samples publicly? Anyone will be able to see them."),c.a.createElement("div",{className:"buttons"},c.a.createElement("div",{onClick:function(){return z(!0)},className:"save-btn pushable"},"Yes"),c.a.createElement("div",{onClick:function(){return g(!1)},className:"save-btn pushable cancel"},"Cancel"))),c.a.createElement("div",{className:"samples-list"},l.map(function(e,t){return c.a.createElement("div",{onClick:function(){return D(e,t)},className:t===T?"sample-to-save selected":"sample-to-save"},c.a.createElement("div",{className:"sts-name"},e.name),e.tags&&e.tags.map(function(e){return c.a.createElement("div",{className:"sts-tag"},e)}))})),c.a.createElement("div",{className:"tags-editor"},c.a.createElement("div",{className:"tags-container"},p.map(function(e){return c.a.createElement("div",{className:"tag-option"},e)})),c.a.createElement("div",{className:"tag-input-container"},c.a.createElement("input",{placeholder:"Enter tags for these sounds",value:C,onChange:function(e){return N(e.target.value)},className:"tag-input"}),c.a.createElement("div",{onClick:A,className:"add-btn pushable"},"+"))),n?c.a.createElement("div",{className:"buttons"},c.a.createElement(tt.a,{store:i.store}),c.a.createElement("div",{onClick:function(){return z(!1)},className:"save-btn pushable"},"Save ",0===f?"Publicly":" to Guild")):c.a.createElement("div",{className:"buttons"},c.a.createElement("span",{onClick:function(){return t(!0)},className:"pushable show-login-btn"},"Login")," to save these sounds.")):""})),pt=n(1418);n(1173),n(1174),n(1175),n(964),n(1515),n(1149),n(1150),n(1151),n(714),n(1152),n(1153),n(1154),n(1157),n(1526),n(1501),n(968),n(1137),n(1155),n(1163),n(1502),n(973),n(1132),n(1156),n(1158),n(969),n(1176),t.default=Object(b.b)(function(e,t){return{theme:e.sequencer.wallpaper?"dark":e.sequencer.theme,backgroundColor:e.sequencer.backgroundColor,presentationMode:!1,showPianoRoll:e.sequencer.showPianoRoll,showSearchWindow:e.spatial.showSearchWindow,viewMode:e.sequencer.viewMode,creatingNewPack:e.packs.creatingNewPack,packToEdit:e.packs.packToEdit,fullScreenZObject:e.zobject.fullScreenZObject,wallpaper:e.sequencer.wallpaper,showPadSequencer:e.spatial.showPadSequencer}},function(e){return{setFullScreenZObject:function(t){return e(Object(k.uc)(t))},setSelectedZObject:function(t){return e(Object(k.Cf)(t))},setWallpaper:function(t){return e(Object(k.Ph)(t))},setTheme:function(t){return e(Object(k.Sg)(t))},setShowThemeGrid:function(t){return e(Object(k.pg)(t))},setArrangementBottomHeight:function(t){return e(Object(k.D)(t))},setBackgroundColor:function(t){return e(Object(k.cb)(t))}}})(function(e){var t=Object(a.useRef)(void 0),n=Object(a.useRef)(void 0),l=e.sequencerEngine?[void 0,b,void 0]:Object(ct.a)(e),f=Object(r.a)(l,3),b=(f[0],f[1]);f[2];e.sequencerEngine&&(b=e.sequencerEngine);var w=Object(st.a)({sequencerEngine:b});Object(r.a)(w,1)[0];if(Object(O.a)({theme:e.theme,backgroundColor:e.backgroundColor}),Object(a.useEffect)(function(){if(window.isNFT)return!1;var t=s.a.getItem("wallpaper");t&&e.setWallpaper(t),(t=s.a.getItem("theme"))&&e.setTheme(t),(t=s.a.getItem("show-theme-grid"))&&e.setShowThemeGrid(JSON.parse(t)),(t=s.a.getItem("backgroundColor"))&&e.setBackgroundColor(t)},[]),e.fullScreenZObject)return c.a.createElement("div",{ref:t,className:"v3 dark no-select full-screen"},c.a.createElement(v.a,{containerRef:t}),e.showSearchWindow&&c.a.createElement(ue,{sequencerEngine:b,showing:e.showSearchWindow}),c.a.createElement("div",{onClick:function(){return e.setSelectedZObject(void 0)},className:"editor full-screen-editor"},!window.isNFT&&c.a.createElement(d,null),c.a.createElement(u.a,{sequencerEngine:b}),c.a.createElement("img",{className:"pushable expand-icon",onClick:function(){return e.setFullScreenZObject(void 0)},src:"/expand-icon.svg"}),Array.isArray(e.fullScreenZObject)?c.a.createElement("div",{className:"multi-full-screen"},e.fullScreenZObject.map(function(e){return c.a.createElement(j.default,{key:e.id,isMulti:!0,sequencerEngine:b,zObject:e})})):c.a.createElement(j.default,{isMulti:!0,sequencerEngine:b,zObject:e.fullScreenZObject})));var S={},k="v3 no-select dark ";return e.wallpaper&&(S.backgroundImage="url("+m.a.getHashUrl(e.wallpaper)+")",k+=" has-wallpaper"),e.showPadSequencer&&(k+=" showing-pad-sequencer"),"light"===e.theme?k+=" light-theme":k+=" dark-theme",e.presentationMode&&(k+=" presentation-mode"),c.a.createElement("div",{style:S,ref:t,className:k},c.a.createElement(ve.a,{sequencerEngine:b}),c.a.createElement(o.a,null),c.a.createElement(pt.a,null),c.a.createElement(at,{sequencerEngine:b}),c.a.createElement(u.a,{sequencerEngine:b}),c.a.createElement(v.a,{containerRef:t}),c.a.createElement(jt,{sequencerEngine:b}),b&&c.a.createElement(p.a,{sequencerEngine:b}),e.creatingNewPack||e.packToEdit?c.a.createElement(h.a,{json:e.packToEdit}):"",e.showSearchWindow&&c.a.createElement(ue,{sequencerEngine:b,showing:e.showSearchWindow}),e.showPianoRoll?c.a.createElement(Ee.a,{sequencerEngine:b}):e.viewMode===E.a?c.a.createElement(g.a,{sequencerEngine:b}):e.viewMode===E.e?c.a.createElement(i.a,{sequencerEngine:b}):c.a.createElement("div",{className:"editor-and-sidebars"},c.a.createElement(bt,{sequencerEngine:b}),c.a.createElement(Xe,{editorBottomRef:n,isDocumentation:e.isDocumentation,sequencerEngine:b}),c.a.createElement(je.a,{sequencerEngine:b}),b&&c.a.createElement(ge,{scrollRef:t,sequencerEngine:b}),b&&c.a.createElement(le.a,{editorBottomRef:n,scrollRef:t,sequencerEngine:b})))})}}]);