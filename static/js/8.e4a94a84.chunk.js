(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{2242:function(e,t,n){"use strict";n.d(t,"g",function(){return a}),n.d(t,"f",function(){return i}),n.d(t,"e",function(){return s}),n.d(t,"h",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return p});var r=n(2251),a=function(e,t,n){return{type:r.i,sequenceId:e,subSequenceId:t,patternNumber:n}},i=function(e){return{type:r.f,work:e,isTransport:!0}},s=function(e){return{type:r.e,work:e}},o=function(e){return{type:r.j,work:e}},c=function(e,t){return{type:r.c,sequenceId:e,transpose:t}},u=function(e,t){return{type:r.d,sequenceId:e,volume:t}},l=function(e,t){return{type:r.b,sequenceId:e,color:t}},p=function(e){return{type:r.a,bpm:e}}},2243:function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(6),s=n(11),o=n(1),c=n(0),u=n.n(c),l=n(12),p=n(988),d=n(2238),h=n(989);n(2245);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(o.a)(e);if(t){var a=Object(o.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var m=function(e){Object(i.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"onClickSequencer",value:function(){window.location="/create/"}},{key:"onClickSampler",value:function(){"DISCOVER"!==this.props.view&&(window.location="/discover/")}},{key:"onClickExplore",value:function(){"EXPLORE"!==this.props.view&&(window.location="/explore/")}},{key:"onClickLogo",value:function(){window.location="/"}},{key:"render",value:function(){var e=this,t=this.props.view||"",n="DISCOVER"===t?"navigator-button selected":"navigator-button",r="EXPLORE"===t?"navigator-button selected":"navigator-button";return u.a.createElement("div",{className:"navigator"},u.a.createElement(h.a,{show:this.props.showLogin}),u.a.createElement("div",{onClick:function(){return e.onClickLogo()},className:"universal-sequences-logo "+t},"ZEQUENCER"),u.a.createElement("div",{onClick:function(){return e.onClickSequencer()},className:"navigator-button"},"CREATE"),u.a.createElement("div",{onClick:function(){return e.onClickExplore()},className:r},"EXPLORE"),u.a.createElement("div",{onClick:function(){return e.onClickSampler()},className:n},"SAMPLE"),u.a.createElement("div",{className:"guilds-menu-container"},u.a.createElement(d.a,{store:this.props.store}),u.a.createElement(p.a,{store:this.props.store})))}}]),n}(c.Component);t.a=Object(l.b)(function(e){return{showLogin:e.sequencer.showLogin}},null)(m)},2245:function(e,t,n){},2251:function(e,t,n){"use strict";n.d(t,"i",function(){return r}),n.d(t,"f",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"j",function(){return s}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"h",function(){return p}),n.d(t,"g",function(){return d});var r=1,a=2,i=3,s=4,o=5,c=6,u=7,l=8,p=9,d=10},2259:function(e,t,n){"use strict";var r=n(3),a=n.n(r),i=n(10),s=n(13),o=n(9),c=n(2),u=n(4),l=n(6),p=n(11),d=n(1),h=n(2251),f=n(14),m=n.n(f),g=n(8);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var a=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(p.a)(this,n)}}t.a=function(e){return function(e){Object(l.a)(n,e);var t=v(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).events=[],e.hasEdits=!1,e}return Object(u.a)(n,[{key:"isRecordingMix",get:function(){return this.state.explore.isRecordingMix}},{key:"currentTransportTime",get:function(){var e=parseFloat(m.a.Transport.position.split(":")[2]);return"0:0:"+(e-Math.floor(e)+this.trackStep/2)}},{key:"dispatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.currentTransportTime,r=e.sequenceId&&this.getSequencerEngine(e.sequenceId);switch(e.type){case h.i:this.switchToPattern(r,e.subSequenceId,e.patternNumber);break;case h.f:this.playWork(e.work);break;case h.e:this.loadWork(e.work);break;case h.j:this.unloadWork(e.work);break;case h.c:this.changeTranspose(r,e.transpose);break;case h.d:this.changeVolume(r,e.volume);break;case h.b:this.changeColor(r,e.color);break;case h.a:this.changeBPM(e.bpm)}!t&&this.isRecordingMix&&(e=Object(o.a)({},e,{time:n}),this.events.push(e),this.hasEdits=!0)}},{key:"playWork",value:function(e){this.play(e),this.isNothingPlaying()&&this.clearScheduledEvents()}},{key:"worksLoaded",get:function(){return this.state.explore.worksLoaded}},{key:"loadWork",value:function(){var e=Object(s.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("MultiMix.loadWork =",t),!this.worksLoaded.some(function(e){return e.newSequence===t.newSequence})){e.next=5;break}return n=this.getSequencerEngine(t.newSequence),this.setWorkDefaults(n),e.abrupt("return");case 5:return this.store.dispatch(Object(g.Rh)([].concat(Object(i.a)(this.worksLoaded),[t]))),e.next=8,this.loadTrack(t.newSequence);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"unloadWork",value:function(e){if(this.worksLoaded.some(function(t){return t.newSequence===e.newSequence})){var t=Object(i.a)(this.worksLoaded),n=t.indexOf(e);t.splice(n,1),this.store.dispatch(Object(g.Rh)(t)),this.unloadTrack(e.newSequence)}}},{key:"switchToPattern",value:function(e,t,n){e&&(e.switchToSubSequence(t),e.switchToPattern(n))}},{key:"changeColor",value:function(e,t){e&&(e.channelMixer.mixEffects.filter=t,this.store.dispatch(Object(g.nd)(e.sequenceId,t)))}},{key:"changeTranspose",value:function(e,t){e&&(e.transpose=t,this.store.dispatch(Object(g.Ph)(e.sequenceId,t)))}},{key:"changeVolume",value:function(e,t){e&&(e.setMasterVolume(t,.05),this.store.dispatch(Object(g.Qh)(e.sequenceId,t)))}},{key:"changeBPM",value:function(e){this.updateBpm(e)}},{key:"setInitialValuesForMix",value:function(){if(this.initialState){var e=this.initialState,t=e.workVolumes,n=e.worksLoaded,r=e.workTransposes,a=e.mixColorValues,i=e.bpm;for(var s in i&&this.changeBPM(i),t){var o=this.getSequencerEngine(s);o&&this.changeVolume(o,t[s])}for(var c in r){var u=this.getSequencerEngine(c);u&&this.changeTranspose(u,r[c])}for(var l in n)this.loadWork(n[l]);for(var p in a){var d=this.getSequencerEngine(p);d&&this.changeColor(d,a[p])}}}},{key:"saveInitialValuesForMix",value:function(){var e=this.store.getState();this.initialState={worksLoaded:Object(i.a)(e.explore.worksLoaded),workTransposes:Object(o.a)({},e.explore.workTransposes),workVolumes:Object(o.a)({},e.explore.workVolumes),bpm:e.user.bpm,mixColorValues:Object(o.a)({},e.explore.mixColorValues)}}},{key:"playMix",value:function(e){var t=this;e?(this.isRecordingMix?this.saveInitialValuesForMix():this.setInitialValuesForMix(),this.eventIds=this.events.map(function(e){return m.a.Transport.schedule(function(n){e.type===h.f&&(n=0),setTimeout(function(){t.dispatch(e,!0)},n)},e.time)}),this.play()):(this.clearScheduledEvents(),this.stop())}},{key:"clearScheduledEvents",value:function(){this.eventIds&&(this.eventIds.forEach(function(e){return m.a.Transport.clear(e)}),this.eventIds=[])}},{key:"setWorkDefaults",value:function(e){this.changeTranspose(e,0),this.changeVolume(e,0)}},{key:"hasEdits",set:function(e){this.store.dispatch(Object(g.pd)(e))}},{key:"unloadAll",value:function(){this.clearMix(),this.stop(),this.hasEdits=!1;var e=Object(i.a)(this.worksLoaded);for(var t in e)this.unloadWork(e[t])}}]),n}(e)}},2280:function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(6),s=n(11),o=n(1),c=n(0),u=n.n(c),l=n(12),p=n(2242);function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(o.a)(e);if(t){var a=Object(o.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var h=["A","B","C","D","E","F","G","H"],f=function(e){Object(i.a)(n,e);var t=d(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"switchPattern",value:function(e){var t=this.props.sequencerEngine;t.multiSequencerEngine.dispatch(Object(p.g)(t.sequenceId,t.currentSubSequence.id,e))}},{key:"chooseSubSequence",value:function(e){this.props.sequencerEngine.switchToSubSequence(e)}},{key:"getSubSequencesComponent",value:function(){var e=this,t=this.props.subSequences||[];return u.a.createElement("div",{className:"sub-sequence-buttons"},t.map(function(t,n){return u.a.createElement("div",{key:h[n],onClick:function(){return e.chooseSubSequence(t)},className:t===e.props.currentSubSequence?"sub-sequence selected":"sub-sequence"},h[n])}))}},{key:"render",value:function(){var e=this;return void 0===this.props.sequencerEngine.tracks[0]?this.getSubSequencesComponent():u.a.createElement("div",null,u.a.createElement("div",{className:"pattern-buttons"},this.props.sequencerEngine.tracks[0].patterns.map(function(t,n){return u.a.createElement("div",{style:e.props.color&&e.props.currentPattern===n?{backgroundColor:e.props.color}:{},onClick:function(){return e.switchPattern(n)},className:e.props.currentPattern===n?"current pattern-button":"pattern-button"},n+1)})),this.getSubSequencesComponent())}}]),n}(c.Component);t.a=Object(l.b)(function(e,t){var n=t.sequencerEngine.engineId,r=t.sequencerEngine.currentSubSequence.id;return{currentPattern:e.sequencer.currentPattern[r]||0,subSequenceId:r,subSequences:e.sequencer.subSequences[n],currentSubSequence:e.sequencer.currentSubSequence[n]}},null)(f)},2281:function(e,t,n){"use strict";var r=n(3),a=n.n(r),i=n(13),s=n(2),o=n(4),c=n(8),u=(n(1325),n(2259),n(14)),l=n.n(u),p=n(539),d=n(1001),h=n(604),f=function(){function e(t){Object(s.a)(this,e),this.store=t,this.idToSequencerEngine={},this.headSequencerEngine=void 0,this.sequencerEnginesToPlay=[],this.sequenceIdQueue=[],window.sequencerEngine=this,this.initAubio()}return Object(o.a)(e,[{key:"getHead",value:function(){return this.idToSequencerEngine[Object.keys(this.idToSequencerEngine)[0]]}},{key:"state",get:function(){return this.store.getState()}},{key:"trackStep",get:function(){for(var e in this.idToSequencerEngine){var t=this.idToSequencerEngine[e].trackStepReal;if(t>0)return t}return 0}},{key:"initAubio",value:function(){var e=this;window.Aubio().then(function(t){e.aubio=t})}},{key:"sampleRate",set:function(e){p.a.setSampleRate(e)}},{key:"stop",value:function(){for(var e in this.idToSequencerEngine)this.idToSequencerEngine[e].stop();l.a.Transport.stop()}},{key:"updateBpm",value:function(e){for(var t in this.idToSequencerEngine)this.idToSequencerEngine[t].updateBpm(e)}},{key:"getSequencerEngine",value:function(e){return void 0===e?this.idToSequencerEngine[Object.keys(this.idToSequencerEngine)[0]]:this.idToSequencerEngine[e]}},{key:"stepOneCallback",value:function(e){this.sequencerEnginesToPlay.forEach(function(t){var n=l.a.Transport.getTicksAtTime(e),r=new l.a.TransportTime(n,"i");t.play(r)}),this.sequencerEnginesToPlay=[]}},{key:"getSamplerPlaySequence",value:function(){return null}},{key:"isNothingPlaying",value:function(){return 0===this.getSequencesPlaying().length}},{key:"getSequencesPlaying",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.store.getState().sequencer.isPlaying;return Object.keys(this.idToSequencerEngine).filter(function(n){return!1===e&&void 0===t[n]||t[n]===e})}},{key:"unloadTrack",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.idToSequencerEngine[e];n.playing&&n.stop(),delete this.idToSequencerEngine[e];var r=this.sequenceIdQueue.indexOf(e);r>-1&&this.sequenceIdQueue.splice(r,1),this.store.dispatch(Object(c.Hc)(e,void 0)),t&&setTimeout(function(){n.dispose()},500)}},{key:"loadTrack",value:function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r,i,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getSequencesPlaying(!1),this.sequenceIdQueue.length>7&&(n.length>0?this.unloadTrack(n[0]):(r=this.sequenceIdQueue.shift(),this.unloadTrack(r))),this.store.dispatch(Object(c.cd)(t,!0)),(i=new d.default(this.store,!0,void 0,this.aubio)).channelMixer.connectMixEffects(),s=new h.a(i,!0),i.setScripting(s),i.multiSequencerEngine=this,i.loadedSequenceId=t,i.setMasterVolume(1),this.sequenceIdQueue.push(t),this.idToSequencerEngine[t]=i,this.store.dispatch(Object(c.Hc)(t,!1)),e.next=15,i.loadSequence(t);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"initSamplerTrack",value:function(){}},{key:"sequenceRolling",value:function(){for(var e in this.idToSequencerEngine){if(this.idToSequencerEngine[e].isSequenceRolling)return!0}return!1}},{key:"play",value:function(e){var t=this,n=this.getSequencerEngine(e&&e.id);if(void 0!==n){n.playing&&this.getSequencesPlaying(!0).length,e&&e.playing&&this.setHeadSequencerEngine(void 0);var r=this.getSequencesPlaying(!0);0==this.getSequencesPlaying(!0).length||n.playing?(this.store.dispatch(Object(c.Ic)(!0)),n.playing||0!=r.length||this.setHeadSequencerEngine(n),n.play()):this.sequencerEnginesToPlay.push(n),(r=r.map(function(e){return t.idToSequencerEngine[e]}).filter(function(e){return e!==n})).length>0&&r.every(function(e){return void 0===e.stepOneCallback})&&this.setHeadSequencerEngine(r[0])}}},{key:"setHeadSequencerEngine",value:function(e){var t=this;void 0!==e||void 0===this.headSequencerEngine?(this.headSequencerEngine=e,this.headSequencerEngine.stepOneCallback=function(e){return t.stepOneCallback(e)}):this.headSequencerEngine.stepOneCallback=void 0}}]),e}();t.a=f},2290:function(e,t,n){"use strict";var r=n(7),a=n(0),i=n.n(a),s=n(2288),o=n(2249),c=n(2256),u=n(8),l=n(2272),p=n(2262),d=n(12),h=(Object(d.b)(function(e,t){return{}},function(e){return{}})(function(e){return i.a.createElement("div",{className:"sequencer-scale"},"Scale:")}),n(347)),f=Object(d.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.dropdownPos,r=e.setDropdownPos;Object(h.a)({clear:function(){return r(void 0)},selected:n});var s=Object(a.useCallback)(function(){t.createPad()},[s]),o=Object(a.useCallback)(function(){t.createPad(t.tracks)},[s]);return n&&n?i.a.createElement("div",{style:{left:n.x,top:n.y},className:"sequencer-context-menu context-menu"},i.a.createElement("div",{onMouseDown:s,className:"menu-item"},"Create Pad"),i.a.createElement("div",{onMouseDown:o,className:"menu-item"},"Create Pad From Tracks")):[]}),m=n(1321),g=(n(119),n(2252)),v=(n(2261),n(42)),k=n(2250),b=n(1322),E=n(92),y=(n(1025),n(603),n(313));t.a=Object(d.b)(function(e,t){e.arrangement.bottomMode;var n=e.sequencer.showPianoRoll;return{showSelectorMode:e.sequencer.showSelectorMode,sidebarCollapsed:e.selector.sidebarCollapsed,sidebarViewMode:e.sequencer.sidebarViewMode,trackFocused:e.sequencer.trackFocused,tracks:t.sequencerEngine.tracks,numTracks:t.sequencerEngine.tracks&&t.sequencerEngine.tracks.length,showingPiano:n,selectedTrack:n&&e.mix.selectedTrack,isMapping:e.effects.accumulatorParameterSelected,stepsGroupMode:e.groups.stepsGroupMode}},function(e){return{setTransformationEdgeDragging:function(t){return e(Object(u.wh)(t))},setSelectedSteps:function(t){return e(Object(u.nf)(t))},setStepsGroupMode:function(t){return e(Object(u.Hg)(t))}}})(function(e){var t=Object(a.useRef)(void 0),n=e.sequencerEngine,u=Object(a.useState)(void 0),d=Object(r.a)(u,2),h=d[0],O=d[1],S=e.viewMode!==E.e?"full-view":void 0!==e.trackFocused?"tracks-container focused":e.stretchTracks?"tracks-container showing-selector":"tracks-container";(e.isMapping||e.stepsGroupMode)&&(S+=" mapping"),e.sidebarCollapsed||!e.showSelectorMode&&e.sidebarViewMode===y.g||(S+=" showing-selector");e.showSequences||e.showInstruments||e.showSelectorMode||e.showPresets;var w=n.tracks||[];e.showingPiano&&(w=(w=n.tracks[e.selectedTrack])?[w]:[]),Object(a.useEffect)(function(){e.setSelectedSteps(void 0),e.setStepsGroupMode(!1)},[n.currentSubSequence]);var j=Object(a.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),O({x:e.clientX,y:e.clientY})},[O]);return i.a.createElement("div",{dropabble:"true",id:"#start",onContextMenu:j,ref:t,className:S},i.a.createElement(f,{sequencerEngine:n,setDropdownPos:O,dropdownPos:h}),i.a.createElement(m.a,{scrollContainer:t}),i.a.createElement(s.a,{sequencerEngine:n}),i.a.createElement(p.a,{scrollContainer:t,sequencerEngine:n}),i.a.createElement(v.a,{condition:!e.showingPiano&&w.length>0},i.a.createElement(k.a,{scrollContainer:t,sequencerEngine:n,envelopesTrack:n.envelopesTrack,lfosTrack:e.sequencerEngine.lfosTrack})),i.a.createElement(o.a,{sequencerEngine:e.sequencerEngine}),w.filter(function(t){return void 0===e.trackFocused||e.trackFocused===t.trackNumber}).map(function(e,n){return i.a.createElement(b.a,{key:e.id,scrollContainer:t,track:e})}),i.a.createElement(c.a,{scrollContainer:t,sequencerEngine:n}),!e.showingPiano&&w.length>0?i.a.createElement("div",{className:"sub-sequence-control"},i.a.createElement(g.a,{scrollContainer:t,sequencerEngine:n}),i.a.createElement(l.a,{scrollContainer:t,sequencerEngine:n})):"")})},2294:function(e,t,n){"use strict";var r=n(2),a=n(4),i=n(6),s=n(11),o=n(1),c=n(0),u=n.n(c),l=n(10),p=n(2278),d=n(31),h=n(12),f=n(8),m=new d.a,g=function(e){var t=e.track,n=e.onClick,r=m.getColorForTrack(t);return u.a.createElement("div",{onClick:n,style:{color:r,borderColor:r},className:"hidden-track"},t.trackNumber+1,". ",Object(p.a)(t.presetName||t.getName(),24))},v=(Object(h.b)(function(e,t){return{tracksToHide:e.tracks.tracksToHide,currentSubSequence:t.sequencerEngine.currentSubSequence}},function(e){return{setTracksToHide:function(t){return e(Object(f.th)(t))}}})(function(e){var t=e.tracksToHide,n=e.sequencerEngine,r=e.setTracksToHide,a=t.filter(function(e){return n.tracks.indexOf(e)>-1});a.sort(function(e,t){return e.trackNumber-t.trackNumber});var i=Object(c.useCallback)(function(e){var n=Object(l.a)(t),a=n.indexOf(e);a>-1&&(n.splice(a,1),r(n))},[t]);return u.a.createElement("div",{className:"hidden-tracks"},a.map(function(e){return u.a.createElement(g,{onClick:function(){return i(e)},track:e})}))}),n(436)),k=n(22),b=n(40),E=(n(92),n(60));function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(o.a)(e);if(t){var a=Object(o.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var O=function(e){Object(i.a)(n,e);var t=y(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"play",value:function(){this.props.sequencerEngine.schedulePlay()}},{key:"record",value:function(){var e=!this.props.isRecording;this.props.sequencerEngine.recording(e)}},{key:"resample",value:function(){this.props.sequencerEngine.masterResampler.prepare(),this.props.setResampleMaster(!0)}},{key:"toggleQuantize",value:function(){this.props.setQuantized(!this.props.quantized)}},{key:"onClickRollingMode",value:function(){this.props.sequencerEngine.resolution=this.props.displayResolution,this.props.sequencerEngine.trackRolling=!this.props.trackRolling}},{key:"isLoading",get:function(){var e=this;return Object.keys(this.props.loadingSequence).some(function(t){return!0===e.props.loadingSequence[t]})}},{key:"updateBpm",value:function(e){var t=this;Object(E.a)(e)&&(e=parseFloat(e),this.props.sequencerEngine.updateBpm(e),this.setState(this.state),void 0!==this.timestretchTimeout&&clearTimeout(this.timestretchTimeout),this.timestretchTimeout=setTimeout(function(){t.props.sequencerEngine.tracks.map(function(t){return t.soundIds.map(function(n){var r=t.samplers[n];r.tempoSynced&&r.syncTempo(e)})}),t.timestretchTimeout=void 0},150))}},{key:"updateSwing",value:function(e){Object(E.a)(e)&&(this.props.sequencerEngine.updateSwing(e),this.setState(this.state))}},{key:"toggleLock",value:function(){this.props.sequencerEngine.togglePatternLock()}},{key:"render",value:function(){var e=this,t="play-button ";this.props.playScheduled&&(t+=" flashit");var n="sequencer-buttons-container";return this.isLoading&&(n+=" loading"),u.a.createElement("div",{className:n},u.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(b.ib)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.play()},className:"action-buttons"},u.a.createElement("span",{className:t},this.props.isPlaying?"STOP":"PLAY")),u.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(b.ub)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:"action-buttons",onClick:function(){return e.record()}},u.a.createElement("span",{className:this.props.isRecording?"recording record-button":"record-button"},this.props.isRecordingExpanded?"RECORDING +":this.props.isRecording?"RECORDING":"RECORD")),u.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(b.xb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:"action-buttons",onClick:function(){return e.onClickRollingMode()}},u.a.createElement("span",{className:this.props.trackRolling?"infinity-mode infinity-button":"infinity-button"},"ROLL")),u.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(b.nb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:"action-buttons",onClick:function(){return e.toggleQuantize()}},u.a.createElement("span",{className:this.props.quantized?"infinity-mode infinity-button":"infinity-button"},this.props.quantized?"QUANTIZED":"UNQUANTIZED")),this.props.sequencerEngine.bpmParameter?u.a.createElement("div",{className:"bpm-container"},u.a.createElement(k.a,{name:"BPM",contextualHelp:b.m,parameter:this.props.sequencerEngine.bpmParameter,root:1,step:1,min:1,isParameter:!0,max:250})):"",u.a.createElement(v.a,{contextualHelp:b.l,patternLocked:this.props.patternLocked,toggleLock:function(){return e.toggleLock()}}))}}]),n}(c.Component);t.a=Object(h.b)(function(e,t){var n=t.sequencerEngine.getSequenceId();return{viewMode:e.sequencer.viewMode,quantized:e.sequencer.quantized,isRecording:e.sequencer.isRecording,isRecordingExpanded:e.sequencer.isRecordingExpanded,isPlaying:e.sequencer.isPlaying[n]||!1,isCommandDown:e.keyboard.isCommandDown,sequenceName:e.sequencer.sequenceName,loadingSequence:e.sequencer.loadingSequence,trackRolling:e.sequencer.trackRolling,patternLocked:e.sequencer.patternLocks[t.sequencerEngine.currentPattern]||!1,playScheduled:e.clock.playScheduled,commandPrefix:e.commands.commandPrefix,displayResolution:e.sequencer.displayResolution,isResampling:e.tracks.isResampling||e.sequencer.resampleMaster}},function(e){return{setViewMode:function(t){return e(Object(f.Hh)(t))},setQuantized:function(t){return e(Object(f.Ae)(t))},setContextualHelp:function(t){return e(Object(f.vb)(t))},setIsRecording:function(t){return e(Object(f.Kc)(t))},setTrackRolling:function(t){return e(Object(f.kh)(t))},setCommandPrefix:function(t){return e(Object(f.qb)(t))},setIsRecordingExpanded:function(t){return e(Object(f.Lc)(t))},setCommandInput:function(t){return e(Object(f.pb)(t))},setResampleMaster:function(t){return e(Object(f.Fe)(t))}}})(O)},2392:function(e,t,n){},2393:function(e,t,n){},2394:function(e,t,n){},2421:function(e,t,n){"use strict";n.r(t);var r=n(9),a=n(3),i=n.n(a),s=n(13),o=n(10),c=n(2),u=n(4),l=n(18),p=n(6),d=n(11),h=n(1),f=n(0),m=n.n(f),g=n(75);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var k=function(e){Object(p.a)(n,e);var t=v(n);function n(e){var r;return Object(c.a)(this,n),r=t.call(this,e),console.log("userName = "+e.userName),r.state={editingName:!1,nameValue:r.props.userName||""},r}return Object(u.a)(n,[{key:"doesUserOwnPage",value:function(){var e=Object(s.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t1=this.props.userId,e.next=3,this.props.ethereum.getUser();case 3:if(e.t2=e.sent,e.t0=e.t1===e.t2,e.t0){e.next=7;break}e.t0=void 0===this.props.userId;case 7:return t=e.t0,console.log("does user own page = "+t),e.abrupt("return",t);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickName",value:function(){console.log("onClickName"),this.props.isEditing&&this.setState({editingName:!0})}},{key:"onKeyPress",value:function(e){"Enter"===e.key&&this.chooseUserName()}},{key:"chooseUserName",value:function(){this.props.ethereum.users.setUserName(this.state.nameValue),this.setState({editingName:!1}),""!==this.state.nameValue&&this.props.onUserNameUpdated(this.state.nameValue)}},{key:"isEditing",value:function(){return void 0===this.props.userName||this.state.editingName}},{key:"render",value:function(){var e=this,t="";return t=this.isEditing()&&this.doesUserOwnPage()?m.a.createElement(g.h,{className:"tag-sound-input"},m.a.createElement(g.g,{onChange:function(t){e.state.nameValue=t.target.value,e.setState(e.state)},value:this.state.nameValue,onKeyUp:function(t){return e.onKeyPress(t)},placeholder:"Choose a user name",className:"tag-sound-input-box"}),m.a.createElement(g.i,{addonType:"append"},m.a.createElement(g.b,{size:"sm",onClick:function(){return e.chooseUserName()},color:"secondary"},"Done"))):m.a.createElement("span",{onClick:function(){return e.onClickName()},className:"user-name"},this.props.userName),m.a.createElement("div",{className:"user-info"},m.a.createElement("div",{className:"user-profile-picture-container"},void 0===this.props.profilePicture?m.a.createElement("div",{className:"user-no-profile-picture"}):""),m.a.createElement("div",{className:"user-main-info-container"},m.a.createElement("div",{className:"user-info-part-container"},t),m.a.createElement("div",{className:"user-info-part-container"},m.a.createElement("span",{className:"user-location"},"World Galaxy"))))}}]),n}(f.Component),b=n(14),E=n.n(b),y=n(42),O=n(1021),S=n(2243);function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}f.Component;var j=n(12),q=n(8),C=n(844),x=n(103),N=n.n(x);function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var M=function(e){Object(p.a)(n,e);var t=T(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).play=r.play.bind(Object(l.a)(r)),r}return Object(u.a)(n,[{key:"play",value:function(){if(this.isPlaying()){for(var e in this.props.isPlaying)if(this.props.isPlaying[e])for(var t in this.props.tracks)this.props.tracks[t].id===e&&this.props.multiSequencerEngine.play(this.props.tracks[t])}else this.props.multiSequencerEngine.play(this.props.tracks[0])}},{key:"isPlaying",value:function(){var e=this;return Object.keys(this.props.isPlaying).filter(function(t){return e.props.isPlaying[t]}).length>0}},{key:"onChangeBPM",value:function(e){this.props.multiSequencerEngine.updateBpm(e)}},{key:"render",value:function(){var e=this;return 0===this.props.tracks.length?m.a.createElement("div",null):m.a.createElement("div",{className:"mix-player-pane"},m.a.createElement("div",{className:"mix-controls-container"},m.a.createElement(C.a,{play:this.play,isPlaying:this.isPlaying()}),m.a.createElement("div",{className:"bpm-container"},m.a.createElement("div",{className:"bpm-label"},"BPM: ",this.props.bpm),m.a.createElement("div",{className:"clear-fix"}),m.a.createElement("div",{className:"spotlight-fader"},m.a.createElement(N.a,{value:this.props.bpm,change:function(t){return e.onChangeBPM(t.target.value)},step:1,className:"spotlight-fader",max:250,min:1,orientation:"horizontal",reversed:!1})))),m.a.createElement("div",null,this.props.children))}}]),n}(f.Component),R=Object(j.b)(function(e,t){return{isPlaying:e.sequencer.isPlaying,viewMode:e.user.viewMode,currentMix:e.user.currentMix,loadedTracks:e.user.loadedTracks,bpm:e.user.bpm}},void 0)(M),P=n(2310),I=n(186),D=n(2309),L=n(414);function B(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var U=function(e){Object(p.a)(n,e);var t=B(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={text:""},r}return Object(u.a)(n,[{key:"onInputType",value:function(e){this.setState({text:e})}},{key:"onTag",value:function(){var e=Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.a.tagSequence(this.props.sequence.id,this.state.text);case 2:this.setState({text:""});case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return m.a.createElement("div",{className:"track-tagger"},m.a.createElement(g.h,null,m.a.createElement(g.g,{onChange:function(t){return e.onInputType(t.target.value)},value:this.state.text,placeholder:"Type tag",className:"sequence-tag-input"}),m.a.createElement(g.i,{addonType:"append"},m.a.createElement(g.b,{onClick:function(){return e.onTag()},color:"secondary"},"Tag"))))}}]),n}(f.Component),G=0,H=function(){function e(){Object(c.a)(this,e),this.id=G++,this.name=void 0,this.tracks=[],this.bpm=void 0}return Object(u.a)(e,[{key:"deleteTrack",value:function(e){var t=this.tracks.indexOf(e);this.tracks.splice(t,1)}},{key:"fromJson",value:function(e){if(void 0!==e)return"name"in e&&(this.name=e.name),"tracks"in e&&(this.tracks=e.tracks),"bpm"in e&&(this.bpm=e.bpm),"id"in e&&(this.id=e.id),this}},{key:"getJson",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={name:this.name,tracks:this.tracks,bpm:this.bpm};return e&&(t.id=this.id),t}}]),e}(),A=n(2280),V=n(177),F=n.n(V),W=n(995);function z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var J=new(n(31).a),K=function(e){Object(p.a)(n,e);var t=z(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={sequence:r.props.sequence,userName:void 0,showComments:!1,showTagger:!1,numNotes:void 0},r.loadDate(),r.loadUser(),r.loadNumNotes(),r}return Object(u.a)(n,[{key:"loadNumNotes",value:function(){var e=Object(s.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(P.a)(this.props.sequence.id,!1);case 2:if(void 0!==(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:this.setState({numNotes:t.length});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadUser",value:function(){var e=Object(s.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.ethereum.users.getUserName(this.props.sequence.user);case 2:t=e.sent,this.setState({userName:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadDate",value:function(){var e=Object(s.a)(i.a.mark(function e(){var t,n,r,a=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:this.props.sequence,e.next=3,this.props.ethereum.web3.eth.getBlock(t.blockNumber);case 3:n=e.sent,r=new Date(1e3*n.timestamp).toLocaleString(),this.setState({date:r});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickDelete",value:function(){this.props.isPlayable?this.props.unloadTrack():(void 0!==this.props.sequencerEngine&&this.props.sequencerEngine.dispose(),this.props.onClickDelete())}},{key:"onClickTrackName",value:function(){this.props.isPlayable||(void 0!==this.props.sequencerEngine?this.props.unloadTrack():this.props.loadTrack())}},{key:"onChangeVolume",value:function(e){this.props.sequencerEngine.setMasterVolume(e),this.setState(this.state)}},{key:"isLoaded",value:function(){return!!this.props.isPlayable&&(void 0!==this.props.loadingSequence&&!this.props.loadingSequence[this.state.sequence.id]&&void 0!==this.props.sequencerEngine)}},{key:"onClickEdit",value:function(){this.props.onEditSequence(this.props.sequencerEngine)}},{key:"onClickComment",value:function(){this.setState({showComments:!0})}},{key:"onClickTag",value:function(){this.setState({showTagger:!0})}},{key:"getSequenceName",value:function(){return this.state.sequence?this.state.sequence.name:""}},{key:"onDragOver",value:function(e){e.preventDefault()}},{key:"onDragStart",value:function(e){this.props.viewMode!==W.c&&this.props.viewMode!==W.b||this.isLoaded()?e.preventDefault():this.props.setDraggingSpotlightTrack(this.props.sequence)}},{key:"onDrop",value:function(e){if(this.props.viewMode!==W.c&&this.props.viewMode!==W.b||this.isLoaded())e.preventDefault();else{var t=Object(o.a)(this.props.tracks),n=t.map(function(e){return e.id}).indexOf(this.props.draggingSpotlightTrack.id);if(!(n<0)){if(t=Object(I.b)(n,this.props.i,t),this.props.viewMode===W.c)this.props.setSpotlightTracks(Object.keys(t).map(function(e){return t[e]}));else{var r=(new H).fromJson(this.props.currentMix);r.tracks=Object.values(t),this.props.setCurrentUserMix(r.getJson())}this.props.setUserHasEditsToSave(!0)}}}},{key:"render",value:function(){var e=this,t=void 0!==this.props.sequencerEngine&&(void 0===this.props.loadingSequence||this.props.loadingSequence[this.state.sequence.id]),n={};return this.props.isEditing&&(n.backgroundColor=J.brighten(J.getColorForHash(this.props.sequence.id),1)),m.a.createElement("div",{onDragStart:function(t){return e.onDragStart(t)},onDragOver:function(t){return e.onDragOver(t)},onDrop:function(t){return e.onDrop(t)},draggable:!0,style:n,className:this.isLoaded()?"loaded spotlight-track":"spotlight-track"},this.props.isEditing||this.isLoaded()?m.a.createElement("div",{onClick:function(){return e.onClickDelete()},className:"delete-button"},"x"):"",m.a.createElement("div",{className:"volume-pane"},this.isLoaded()?m.a.createElement(N.a,{value:this.props.masterVolume,change:function(t){return e.onChangeVolume(t.target.value)},step:.1,className:"spotlight-fader",max:6,min:-40,orientation:"vertical",reversed:!0}):""),m.a.createElement("div",{className:"track-pane"},m.a.createElement("div",{onClick:function(){return e.onClickTrackName()},className:"track-name"},this.getSequenceName()),this.isLoaded()?m.a.createElement(C.a,{play:this.props.play,isPlaying:this.props.isPlaying,sequencerEngine:this.props.sequencerEngine}):"",m.a.createElement("div",{className:"clear-fix"}),m.a.createElement("div",{className:"date-and-name"},m.a.createElement("div",{className:"track-user-name"},this.state.userName),m.a.createElement("div",{className:"track-date"},this.state.date?this.state.date:"")),m.a.createElement(F.a,{sizeUnit:"px",size:10,color:"#42f4f1",loading:t}),this.isLoaded()?m.a.createElement(A.a,{currentPattern:this.props.currentPattern,sequencerEngine:this.props.sequencerEngine}):""),m.a.createElement(y.a,{condition:this.isLoaded()&&!this.state.showComments},m.a.createElement("div",{onClick:function(){return e.onClickEdit()},className:"edit-button red-button common-button"},"Edit"),m.a.createElement("div",{onClick:function(){return e.onClickTag()},className:"edit-button green-button common-button"},"Tag"),m.a.createElement("div",{onClick:function(){return e.onClickComment()},className:"edit-button green-button common-button"},this.state.numNotes?this.state.numNotes+" Notes":"Notes")),m.a.createElement("div",{className:"clear-fix"}),m.a.createElement(y.a,{condition:this.state.showComments},m.a.createElement(D.a,{onHide:function(){return e.setState({showComments:!1})},userId:this.props.userId,sequence:this.props.sequence})),m.a.createElement(y.a,{condition:this.state.showTagger},m.a.createElement(U,{onHide:function(){return e.setState({showComments:!1})},sequence:this.props.sequence})))}}]),n}(f.Component),Q=Object(j.b)(function(e,t){return{masterVolume:e.sequencer.masterVolumes[t.sequence.id],currentMix:e.user.currentMix}},function(e){return{setSpotlightTracks:function(t){return e(Object(q.zg)(t))},setUserHasEditsToSave:function(t){return e(Object(q.Dh)(t))},setCurrentUserMix:function(t){return e(Object(q.Gb)(t))}}})(K),Y=(n(1001),n(604),n(74)),X=n(39),Z=n.n(X);function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var $=function(e){Object(p.a)(n,e);var t=_(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={guilds:[],selectedGuild:void 0,ownUserName:""},r.fetchUserName(),r.fetchGuilds(),r}return Object(u.a)(n,[{key:"fetchUserName",value:function(){var e=Object(s.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.ethereum.users.getUserName(this.state.userId);case 2:t=e.sent,this.setState({ownUserName:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchGuilds",value:function(){var e=Object(s.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.guilds.getGuildsForUser();case 2:t=e.sent,this.setState({guilds:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getGuildsOptions",value:function(){return this.state.guilds.map(function(e){return{label:e.name,value:e.guildId}})}},{key:"onSelectGuild",value:function(e){this.setState({selectedGuild:e})}},{key:"getSelectedGuild",value:function(){return this.state.selectedGuild}},{key:"connectWithUser",value:function(){void 0!==this.state.selectedGuild?this.props.guilds.requestToAddMember(this.state.selectedGuild.value,this.props.userId):this.props.guilds.connectWithUser(this.props.userId),this.props.hide()}},{key:"render",value:function(){var e=this;void 0!==this.props.preset&&this.props.preset.name;return m.a.createElement(Y.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.props.hide},m.a.createElement(Y.a.Header,{closeButton:!0},m.a.createElement(Y.a.Title,null,"Connect with ",this.props.userName)),m.a.createElement(Y.a.Body,null,m.a.createElement(y.a,{condition:this.state.guilds.length>0},m.a.createElement(Z.a,{className:"",options:this.getGuildsOptions(),onChange:function(t){return e.onSelectGuild(t)},value:this.getSelectedGuild(),placeholder:"Choose guild to connect via"})),"Send a request to link up to your ",this.state.ownUserName," account."),m.a.createElement(Y.a.Footer,null,m.a.createElement(g.b,{variant:"secondary",onClick:function(){return e.connectWithUser()}},"Ok"),m.a.createElement(g.b,{variant:"primary",onClick:this.props.hide},"Cancel")))}}]),n}(f.Component),ee=n(32);function te(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var ne=function(e){Object(p.a)(n,e);var t=te(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={commentText:""},r}return Object(u.a)(n,[{key:"onMessage",value:function(){var e=Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.a.messaging.sendMessage(void 0,void 0,void 0,this.state.commentText);case 2:this.props.hide();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return m.a.createElement(Y.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.props.hide},m.a.createElement(Y.a.Header,{closeButton:!0},m.a.createElement(Y.a.Title,null,"Message ",this.props.userName)),m.a.createElement(Y.a.Body,null,m.a.createElement(g.h,{className:"tag-sound-input"},m.a.createElement(g.g,{onChange:function(t){e.state.commentText=t.target.value,e.setState(e.state)},type:"textarea",value:this.state.commentText,placeholder:"Write a note",className:"comment-input-box"}),m.a.createElement(g.i,{addonType:"append"},m.a.createElement(g.b,{size:"sm",onClick:function(){return e.onMessage()},color:"secondary"},"Send")))),m.a.createElement(Y.a.Footer,null,m.a.createElement(g.b,{variant:"secondary",onClick:function(){return e.onMessage()}},"Done"),m.a.createElement(g.b,{variant:"primary",onClick:this.props.hide},"Cancel")))}}]),n}(f.Component);function re(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var ae=function(e){Object(p.a)(n,e);var t=re(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={showConnectModal:!1,showMessageModal:!1},r}return Object(u.a)(n,[{key:"onClickDirectMessage",value:function(){this.setState({showMessageModal:!0})}},{key:"onClickConnect",value:function(){this.setState({showConnectModal:!0})}},{key:"onClickMessage",value:function(){}},{key:"render",value:function(){var e=this;return m.a.createElement("div",{className:"profile-navigator"},m.a.createElement(ne,{userName:this.props.userName,userId:this.props.userId,hide:function(){return e.setState({showMessageModal:!1})},show:this.state.showMessageModal}),m.a.createElement($,{userName:this.props.userName,ethereum:this.props.ethereum,guilds:this.props.guilds,userId:this.props.userId,hide:function(){return e.setState({showConnectModal:!1})},show:this.state.showConnectModal}),m.a.createElement("div",{onClick:function(){return e.props.setUserViewMode(W.c)},className:this.props.viewMode===W.c?"selected navigator-option":"navigator-option"},"Spotlight"),m.a.createElement("div",{onClick:function(){return e.props.setUserViewMode(W.b)},className:this.props.viewMode===W.b?"selected navigator-option":"navigator-option"},"Mixes"),m.a.createElement(y.a,{condition:this.props.isEditing},m.a.createElement("div",{onClick:function(){return e.props.setUserViewMode(W.a)},className:this.props.viewMode===W.a?"selected navigator-option":"navigator-option"},"Links")),m.a.createElement(y.a,{condition:this.props.hasEditsToSave&&this.props.isEditing},m.a.createElement("div",{onClick:this.props.onClickSave,className:"navigator-option save-option"},"SAVE")),m.a.createElement(y.a,{condition:!0},m.a.createElement("div",{className:"left-buttons"},m.a.createElement("div",null,m.a.createElement("img",{onClick:function(){return e.onClickDirectMessage()},className:"direct-message-button",src:"/direct-message.png"})),m.a.createElement("div",{onClick:function(){return e.onClickConnect()},className:"common-button pink-button connect-button"},"CONNECT"))))}}]),n}(f.Component),ie=Object(j.b)(function(e,t){return{viewMode:e.user.viewMode,hasEditsToSave:e.user.hasEditsToSave}},function(e){return{setUserViewMode:function(t){return e(Object(q.Fh)(t))}}})(ae);function se(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var oe=function(e){Object(p.a)(n,e);var t=se(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={draggingSpotlightTrack:void 0},r}return Object(u.a)(n,[{key:"play",value:function(e){this.props.multiSequencerEngine.play(e)}},{key:"unloadTrack",value:function(e){this.props.unloadTrack(e)}},{key:"loadTrack",value:function(e){this.props.loadTrack(e)}},{key:"getSequencerEngine",value:function(e){return this.props.multiSequencerEngine.getSequencerEngine(e)}},{key:"setDraggingSpotlightTrack",value:function(e){this.setState({draggingSpotlightTrack:e})}},{key:"render",value:function(){var e=this;return m.a.createElement("div",{className:"user-tracks"},this.props.tracks.map(function(t,n){return m.a.createElement(Q,{isPlayable:e.props.isPlayable,play:function(){return e.play(t)},i:n,viewMode:e.props.viewMode,tracks:e.props.tracks,isEditing:e.props.isEditing,ethereum:e.props.ethereum,setDraggingSpotlightTrack:function(t){return e.setDraggingSpotlightTrack(t)},draggingSpotlightTrack:e.state.draggingSpotlightTrack,isPlaying:e.props.isPlaying[t.id],unloadTrack:function(){return e.unloadTrack(t.id)},loadTrack:function(){return e.loadTrack(t.id)},key:"sequence-"+t.id,onEditSequence:e.props.onEditSequence,sequencerEngine:e.getSequencerEngine(t.id),userId:e.props.userId,onClickDelete:function(){return e.props.onDeleteTrack(t)},loadingSequence:e.props.loadingSequence,store:e.props.store,sequence:t})}))}}]),n}(f.Component),ce=Object(j.b)(function(e,t){return{isPlaying:e.sequencer.isPlaying,loadingSequence:e.sequencer.loadingSequence,loadedTracks:e.user.loadedTracks,viewMode:e.user.viewMode}},function(e){return{setIsPlaying:function(t,n){return e(Object(q.Hc)(t,n))}}})(oe);function ue(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var le=function(e){Object(p.a)(n,e);var t=ue(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t=this.props.viewMode===W.c?"ADD TRACKS TO SPOTLIGHT":"ADD TRACKS TO MIX";return this.props.isEditing&&this.props.userLoaded?m.a.createElement("div",{onClick:function(){return e.props.onClickAddTrack()},className:"add-spotlight-track"},t):(console.log("did not show the add tracks button because isEditing = "+this.props.isEditing+" and userLoaded="+this.props.userLoaded),m.a.createElement("div",null))}}]),n}(f.Component);function pe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var de=function(e){Object(p.a)(n,e);var t=pe(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"onClickMix",value:function(e){this.props.setCurrentUserMix(e.getJson())}},{key:"onClickDeleteMix",value:function(e,t){e.stopPropagation(),this.props.onClickDeleteMix(t)}},{key:"render",value:function(){var e=this;return m.a.createElement("div",null,this.props.mixes.map(function(t){return m.a.createElement("div",{onClick:function(){return e.onClickMix(t)},className:"user-mix"},t.name,m.a.createElement(y.a,{condition:e.props.isEditing},m.a.createElement("div",{onClick:function(n){return e.onClickDeleteMix(n,t)},className:"delete-button"},"x")))}))}}]),n}(f.Component),he=Object(j.b)(null,function(e){return{setCurrentUserMix:function(t){return e(Object(q.Gb)(t))}}})(de);function fe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var me=function(e){Object(p.a)(n,e);var t=fe(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={nameValue:"",editingName:!1},r}return Object(u.a)(n,[{key:"onNewMix",value:function(){var e=(new H).getJson();this.props.setCurrentUserMix(e),this.props.addEditedMix((new H).fromJson(e)),this.props.setUserHasEditsToSave(!0),this.setState({nameValue:""})}},{key:"onKeyPress",value:function(e){"Enter"===e.key&&this.chooseMixName()}},{key:"chooseMixName",value:function(){if(this.props.isEditing){var e=(new H).fromJson(this.props.currentMix);e.name=this.state.nameValue,this.props.setCurrentUserMix(e.getJson()),this.props.setUserHasEditsToSave(!0),this.setState({editingName:!1})}}},{key:"getName",value:function(){return void 0===this.props.currentMix?void 0:(new H).fromJson(this.props.currentMix).name}},{key:"onBackToMixes",value:function(){this.props.addEditedMix((new H).fromJson(this.props.currentMix)),this.props.setCurrentUserMix(void 0)}},{key:"onClickName",value:function(){this.props.isEditing&&this.setState({editingName:!0,nameValue:this.getName()})}},{key:"render",value:function(){var e=this;return void 0===this.props.currentMix&&this.props.isEditing?m.a.createElement("div",{onClick:function(){return e.onNewMix()},className:"new-mix-button"},"NEW MIX"):m.a.createElement("div",{className:"mix-name-container"},m.a.createElement(y.a,{condition:this.props.isEditing&&(this.state.editingName||void 0===this.getName())},m.a.createElement(g.h,{className:"tag-sound-input mix-name-container"},m.a.createElement(g.g,{onChange:function(t){e.state.nameValue=t.target.value,e.setState(e.state)},value:this.state.nameValue,onKeyUp:function(t){return e.onKeyPress(t)},placeholder:"Choose a mix name",className:"tag-sound-input-box"}),m.a.createElement(g.i,{addonType:"append"},m.a.createElement(g.b,{size:"sm",onClick:function(){return e.chooseMixName()},color:"secondary"},"Done")))),m.a.createElement(y.a,{condition:!this.state.editingName&&void 0!==this.getName()},m.a.createElement("div",{className:"mix-name-and-back"},m.a.createElement("div",{onClick:function(){return e.onClickName()},className:"mix-name"},this.getName()),m.a.createElement("div",{onClick:function(){return e.onBackToMixes()},className:"back-to-mixes"},"BACK"))),m.a.createElement("div",{className:"clear-fix"}))}}]),n}(f.Component),ge=Object(j.b)(function(e,t){return{currentMix:e.user.currentMix}},function(e){return{setCurrentUserMix:function(t){return e(Object(q.Gb)(t))},setUserHasEditsToSave:function(t){return e(Object(q.Dh)(t))}}})(me);function ve(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var ke=function(e){Object(p.a)(n,e);var t=ve(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={guilds:[]},r.fetchGuilds(),r}return Object(u.a)(n,[{key:"fetchGuilds",value:function(){var e=Object(s.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.ethereum.guilds.getGuildsForUser();case 2:t=e.sent,this.setState({guilds:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"leaveGuild",value:function(){if(window.confirm("Are you sure you want to leave this guild?")){this.props.ethereum.guilds.leaveGuild(this.props.selectedGuild);var e=Object(o.a)(this.state.guilds),t=e.indexOf(this.props.selectedGuild);e.splice(t,1),this.setState({guilds:e}),this.props.onClickGuild(this.props.selectedGuild)}}},{key:"renameGuild",value:function(){}},{key:"render",value:function(){var e=this;return 0===this.state.guilds.length?m.a.createElement("div",null):m.a.createElement("div",{className:"guilds"},m.a.createElement("div",{className:"linked-count"},"And ",m.a.createElement("span",{className:"linked-count-number"},this.state.guilds.length)," guilds"),this.state.guilds.map(function(t){return m.a.createElement(be,{selected:t.guildId===e.props.selectedGuild,onClickGuild:function(){return e.props.onClickGuild(t.guildId)},guild:t})}),m.a.createElement(y.a,{condition:this.props.selectedGuild},m.a.createElement("div",{className:"guild-action-buttons"},m.a.createElement("div",{onClick:function(){return e.leaveGuild()},className:"guild-action-button common-button pink-button"},"Leave Guild"),m.a.createElement("div",{onClick:function(){return e.renameGuild()},className:"guild-action-button common-button pink-button"},"Rename Guild"))))}}]),n}(f.Component),be=function(e){Object(p.a)(n,e);var t=ve(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.selected?"guild selected":"guild";return m.a.createElement("div",{onClick:this.props.onClickGuild,className:e},m.a.createElement("div",{className:"linked-user-name"},""===this.props.guild.name?this.props.guild.guildId:this.props.guild.name))}}]),n}(f.Component),Ee=ke;function ye(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var Oe=function(e){Object(p.a)(n,e);var t=ye(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={nameValue:""},r}return Object(u.a)(n,[{key:"onInputType",value:function(e){this.setState({nameValue:e})}},{key:"setGuildName",value:function(){this.props.ethereum.guilds.setGuildName(this.props.member.guildId,this.state.nameValue),this.props.hide()}},{key:"render",value:function(){var e=this;if(void 0===this.props.member)return console.log("returning nothing"),m.a.createElement("div",null);var t=this.props.member?this.props.member.userName:"",n=this.props.member?this.props.member.guildName:void 0;return m.a.createElement(Y.a,{dialogClassName:"preset-modal",show:void 0!==this.props.member,onHide:this.props.hide},m.a.createElement(Y.a.Header,{closeButton:!0},m.a.createElement(Y.a.Title,null,t)),m.a.createElement(Y.a.Body,null,m.a.createElement(y.a,{condition:""===n},"Name the guild between you and ",t,m.a.createElement(g.g,{value:this.state.nameValue,onChange:function(t){return e.onInputType(t.target.value)},placeholder:"Type name for guild",className:"tag-input"}))),m.a.createElement(Y.a.Footer,null,m.a.createElement(g.b,{variant:"secondary",onClick:function(){return e.setGuildName()}},"Ok"),m.a.createElement(g.b,{variant:"primary",onClick:this.props.hide},"Cancel")))}}]),n}(f.Component);function Se(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var we=function(e){Object(p.a)(n,e);var t=Se(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={members:[],selectedMember:void 0},r.fetchMembers(),r}return Object(u.a)(n,[{key:"fetchMembers",value:function(){var e=Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickMember",value:function(e){""===e.guildName?this.setState({selectedMember:e}):window.open("/user/"+e.userName,"_blank")}},{key:"onHideModal",value:function(){console.log("on hide"),this.setState({selectedMember:void 0})}},{key:"getLinkedMembers",value:function(){var e=this;return void 0===this.props.selectedGuild?this.state.members:this.state.members.filter(function(t){return t.guildId===e.props.selectedGuild})}},{key:"render",value:function(){var e=this;return m.a.createElement("div",{className:"linked-members"},m.a.createElement(Oe,{ethereum:this.props.ethereum,hide:function(){return e.onHideModal()},member:this.state.selectedMember}),m.a.createElement("div",{className:"linked-count"},"You are connected to ",m.a.createElement("span",{className:"linked-count-number"}," ",this.state.members.length," ")," artists"),this.getLinkedMembers().map(function(t){return m.a.createElement(je,{onClickMember:function(){return e.onClickMember(t)},member:t})}))}}]),n}(f.Component),je=function(e){Object(p.a)(n,e);var t=Se(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return m.a.createElement("div",{onClick:this.props.onClickMember,className:"linked-member"},m.a.createElement("div",{className:"linked-user-name"},this.props.member.userName," "),m.a.createElement(y.a,{condition:""!==this.props.member.guildName},m.a.createElement("div",{className:"guild-name"},this.props.member.guildName)))}}]),n}(f.Component),qe=we,Ce=n(1332);function xe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var Ne=function(e){Object(p.a)(n,e);var t=xe(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={selectedGuild:void 0},r}return Object(u.a)(n,[{key:"onClickGuild",value:function(e){e===this.state.selectedGuild?this.setState({selectedGuild:void 0}):this.setState({selectedGuild:e})}},{key:"render",value:function(){var e=this;return m.a.createElement("div",{className:"links-view"},m.a.createElement(qe,{selectedGuild:this.state.selectedGuild,ethereum:this.props.ethereum}),m.a.createElement(Ee,{selectedGuild:this.state.selectedGuild,onClickGuild:function(t){return e.onClickGuild(t)},ethereum:this.props.ethereum}),m.a.createElement(Ce.a,{ethereum:this.props.ethereum}))}}]),n}(f.Component);function Te(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var Me=function(e){Object(p.a)(n,e);var t=Te(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={showSequences:!1,newMix:!1},r.loadTrack=r.loadTrack.bind(Object(l.a)(r)),r.unloadTrack=r.unloadTrack.bind(Object(l.a)(r)),r}return Object(u.a)(n,[{key:"onClickAddTrack",value:function(){this.setState({showSequences:!0})}},{key:"hideSequences",value:function(){this.setState({showSequences:!1})}},{key:"getOrderedTracks",value:function(){var e=this;return this.props.viewMode==W.b?void 0===this.props.currentMix?[]:(new H).fromJson(this.props.currentMix).tracks:this.props.spotlightTracks.filter(function(t){return void 0!==e.props.multiSequencerEngine.getSequencerEngine(t.id)}).concat(this.props.spotlightTracks.filter(function(t){return!e.props.multiSequencerEngine.getSequencerEngine(t.id)}))}},{key:"getTracks",value:function(){return this.props.viewMode==W.b?void 0===this.props.currentMix?[]:(new H).fromJson(this.props.currentMix).tracks:this.props.spotlightTracks}},{key:"getAllTracks",value:function(){var e={};for(var t in this.props.spotlightTracks)e[this.props.spotlightTracks[t].id]=this.props.spotlightTracks[t];for(var n in this.props.mixes){var r=this.props.mixes[n];for(var a in r.tracks)e[r.tracks[a].id]=r.tracks[a]}return Object.values(e)}},{key:"filterLoadedTracks",value:function(e,t){var n=this;if(t){var r=new Set(this.props.loadedTracks);return e.filter(function(e){return r.has(e.id)})}return e.filter(function(e){return!n.props.multiSequencerEngine.getSequencerEngine(e.id)})}},{key:"loadTrack",value:function(e){this.props.multiSequencerEngine.loadTrack(e);var t=new Set(this.props.loadedTracks);t.add(e),this.props.setLoadedTracks(Array.from(t))}},{key:"unloadTrack",value:function(e){this.props.multiSequencerEngine.unloadTrack(e);var t=new Set(this.props.loadedTracks);t.delete(e),this.props.setLoadedTracks(Array.from(t))}},{key:"saveAsMix",value:function(e){var t=new H;t.tracks=e,this.props.setCurrentUserMix(t.getJson()),this.props.addEditedMix(t),this.props.setUserHasEditsToSave(!0),this.props.setViewMode(W.b)}},{key:"render",value:function(){var e=this;return void 0!==this.props.sequencerEngineEditing?m.a.createElement("div",null):this.props.viewMode===W.a?m.a.createElement(Ne,{ethereum:this.props.ethereum,userId:this.props.userId}):m.a.createElement("div",{className:"profile-details"},m.a.createElement("div",{className:"left-pane"},m.a.createElement(y.a,{condition:this.props.viewMode==W.b},m.a.createElement(ge,{isEditing:this.props.isEditing,addEditedMix:this.props.addEditedMix,currentMix:this.props.currentMix})),m.a.createElement("div",{className:"spotlight-pane"},m.a.createElement(y.a,{condition:!this.state.showSequences&&(this.props.viewMode===W.c||void 0!==this.props.currentMix)},m.a.createElement(le,{viewMode:this.props.viewMode,userLoaded:this.props.userLoaded,isEditing:this.props.isEditing,onClickAddTrack:function(){return e.onClickAddTrack()}})),m.a.createElement(y.a,{condition:void 0===this.props.currentMix&&this.props.viewMode==W.b},m.a.createElement(he,{isEditing:this.props.isEditing,onClickDeleteMix:this.props.onClickDeleteMix,mixes:this.props.mixes}))),m.a.createElement("div",{className:"clear-fix"}),m.a.createElement(ce,{multiSequencerEngine:this.props.multiSequencerEngine,loadTrack:this.loadTrack,unloadTrack:this.unloadTrack,tracks:this.getTracks(),isEditing:this.props.isEditing,ethereum:this.props.ethereum,onEditSequence:this.props.onEditSequence,onDeleteTrack:this.props.onDeleteTrack,store:this.props.store})),m.a.createElement("div",null,m.a.createElement(R,{isEditing:this.props.isEditing,saveAsMix:function(t){return e.saveAsMix(t)},multiSequencerEngine:this.props.multiSequencerEngine,tracks:this.filterLoadedTracks(this.getAllTracks(),!0)},m.a.createElement(ce,{isPlayable:!0,multiSequencerEngine:this.props.multiSequencerEngine,userId:this.props.userId,tracks:this.filterLoadedTracks(this.getAllTracks(),!0),loadTrack:this.loadTrack,unloadTrack:this.unloadTrack,isEditing:this.props.isEditing,ethereum:this.props.ethereum,onEditSequence:this.props.onEditSequence,onDeleteTrack:this.props.onDeleteTrack,store:this.props.store})),m.a.createElement(y.a,{condition:this.state.showSequences},m.a.createElement("div",{className:"sequences-chooser-wrapper"},m.a.createElement("div",{onClick:function(){return e.hideSequences()},className:"add-spotlight-track"},"HIDE")))))}}]),n}(f.Component),Re=Object(j.b)(void 0,function(e){return{setLoadedTracks:function(t){return e(Object(q.bd)(t))},setCurrentUserMix:function(t){return e(Object(q.Gb)(t))},setUserHasEditsToSave:function(t){return e(Object(q.Dh)(t))},setViewMode:function(t){return e(Object(q.Hh)(t))}}})(Me),Pe=n(7),Ie=n(855),De=n(94),Le=n(1020),Be=n(119),Ue=n(45),Ge=n(122),He=n(67),Ae=n(603),Ve=n(598),Fe=n(2261),We=n(2323),ze=n(23),Je=n(2285),Ke=n(1018),Qe=n(1261),Ye=n(1262),Xe=n(2302),Ze=n(92),_e=n(60),$e=n(214);n(156),n(998);function et(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var tt=function(e){Object(p.a)(n,e);var t=et(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={},console.log(e.midiEngine),r}return Object(u.a)(n,[{key:"componentWillUnmount",value:function(){this.props.sequencerEngine.clockSync.stopListening()}},{key:"onLatencyChanged",value:function(e){Object(_e.a)(e)&&this.props.setLatency(e)}},{key:"componentDidMount",value:function(){var e=Object(s.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("preferences component did mount"),this.props.sequencerEngine.clockSync.startListening(),e.next=4,this.props.midiEngine.loadAvailableDevices();case 4:this.props.sequencerEngine.channelMixer.updateChannelCount(),this.setState(this.state);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"syncChanged",value:function(){this.setState(this.state)}},{key:"isMultiChannelRecording",value:function(){return!this.props.channelMixer.stereoConnected}},{key:"switchOutputs",value:function(e){this.props.channelMixer.switchOutputs(e),this.setState(this.state)}},{key:"onChooseAudio",value:function(e,t){this.props.sequencerEngine.audioInputManager.newInputSource(e,t),this.setState(this.state)}},{key:"render",value:function(){var e,t=this;return m.a.createElement("div",{className:"preferences-view"},m.a.createElement(Xe.a,{headerText:"Preferences",onClickBack:function(){return t.props.setViewMode(Ze.e)}}),m.a.createElement("div",{className:"preferences-flex"},m.a.createElement("div",{className:"midi-preferences panel"},m.a.createElement("div",{className:"midi-preferences-subsection"},m.a.createElement("div",{className:"sub-header"},"MIDI"),m.a.createElement("div",{className:"inputs-heading"},"INPUTS"),this.props.midiEngine.getInputs().map(function(e){return m.a.createElement(nt,{syncChanged:function(){return t.syncChanged()},input:e,midiEngine:t.props.midiEngine})})),m.a.createElement("div",{className:"midi-preferences-subsection"},m.a.createElement("div",{className:"outputs-heading"},"OUTPUTS"),this.props.midiEngine.getOutputs().map(function(e){return m.a.createElement(rt,{output:e,midiEngine:t.props.midiEngine})}))),m.a.createElement("div",{className:"audio-preferences panel"},m.a.createElement("div",{className:"sub-header"},"AUDIO"),m.a.createElement(Qe.a,{sequencerEngine:this.props.sequencerEngine}),m.a.createElement(Ke.a,{deviceId:this.props.sequencerEngine.audioInputManager.deviceId,defaultClassName:"preferences-audio-chooser",onChooseAudio:function(e,n){return t.onChooseAudio(e,n)}}),m.a.createElement(at,{isMultiChannelOutput:this.isMultiChannelRecording(),numberOfChannels:this.props.channelMixer.numberOfChannels(),onClick:function(e){return t.switchOutputs(e)}}),m.a.createElement("div",{className:"latency-container"},m.a.createElement("div",null,"Latency (ms)"),m.a.createElement("input",(e={className:"chord-input",onChange:function(e){return t.onLatencyChanged(e.target.value)},value:this.props.latency,placeholder:"Latency"},Object(ze.a)(e,"className","tags-input"),Object(ze.a)(e,"type","text"),e))),m.a.createElement(Ye.a,{sequencerEngine:this.props.sequencerEngine}))))}}]),n}(f.Component),nt=function(e){Object(p.a)(n,e);var t=et(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={},r}return Object(u.a)(n,[{key:"onClickSynced",value:function(){this.props.midiEngine.isInputSynced(this.props.input)?(console.log("unsyncing "+this.props.input),this.props.midiEngine.unsyncInput(this.props.input)):this.props.midiEngine.syncInput(this.props.input),this.props.syncChanged(),this.setState(this.state)}},{key:"onClickTracked",value:function(){this.props.midiEngine.isInputTracked(this.props.input)?this.props.midiEngine.untrackInput(this.props.input):this.props.midiEngine.trackInput(this.props.input),this.setState(this.state)}},{key:"onClickKeys",value:function(){this.props.midiEngine.setInputMode(this.props.input,$e.h),this.setState(this.state)}},{key:"onClickPads",value:function(){this.props.midiEngine.setInputMode(this.props.input,$e.i),this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.props.midiEngine.isInputSynced(this.props.input),n=this.props.midiEngine.isInputTracked(this.props.input),r=this.props.midiEngine.getInputMode(this.props.input.name);return console.log("tracked = "+n),m.a.createElement("div",{className:"midi-input"},m.a.createElement("div",{className:"midi-name"},this.props.input.name),m.a.createElement("div",{className:"midi-options"},m.a.createElement("div",{onClick:function(){return e.onClickTracked()},className:n?"midi-option enabled":"midi-option"},"TRACK"),m.a.createElement("div",{onClick:function(){return e.onClickSynced()},className:t?"midi-option enabled":"midi-option"},"SYNC"),m.a.createElement("div",{onClick:function(){return e.onClickKeys()},className:r===$e.h?"midi-option enabled":"midi-option"},"KEYS"),m.a.createElement("div",{onClick:function(){return e.onClickPads()},className:r==$e.i?"midi-option enabled":"midi-option"},"PADS")))}}]),n}(f.Component),rt=function(e){Object(p.a)(n,e);var t=et(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={},r}return Object(u.a)(n,[{key:"onClickSync",value:function(){console.log("onClickSync called with props otput = "),console.log(this.props.output),this.props.midiEngine.syncOutput(this.props.output),this.setState(this.state)}},{key:"onClickTracked",value:function(){this.props.midiEngine.isOutputTracked(this.props.output)?this.props.midiEngine.untrackOutput(this.props.output):this.props.midiEngine.trackOutput(this.props.output),this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.props.midiEngine.isOutputTracked(this.props.output),n=this.props.midiEngine.systemOutput===this.props.output;return m.a.createElement("div",{className:"midi-output"},m.a.createElement("div",{className:"midi-name"},this.props.output.name),m.a.createElement("div",{className:"midi-options"},m.a.createElement("div",{onClick:function(){return e.onClickTracked()},className:t?"midi-option enabled":"midi-option"},"TRACK"),m.a.createElement("div",{onClick:function(){return e.onClickSync()},className:n?"midi-option enabled":"midi-option"},"SYNC")))}}]),n}(f.Component),at=(f.Component,function(e){Object(p.a)(n,e);var t=et(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={},r}return Object(u.a)(n,[{key:"onClick",value:function(){this.props.onClick(!this.props.decentralized),this.setState(this.state)}},{key:"render",value:function(){var e=this;return m.a.createElement("div",{onClick:function(){return e.props.onClick(!e.props.isMultiChannelOutput)},className:"audio-outputs-option"},this.props.isMultiChannelOutput?"MULTI CHANNEL OUTPUT ":"SINGLE OUTPUT ","(",this.props.numberOfChannels," channels)")}}]),n}(f.Component)),it=Object(j.b)(function(e){return{decentralized:e.sequencer.decentralized,latency:e.sequencer.latency}},function(e){return{setViewMode:function(t){return e(Object(q.Hh)(t))},setDecentralized:function(t){return e(Object(q.Kb)(t))},setLatency:function(t){return e(Object(q.Xc)(t))}}})(tt),st=n(2283),ot=n(2325),ct=n(2290),ut=n(433),lt=n(990),pt=n(125),dt=n(2294);function ht(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var ft=function(e){Object(p.a)(n,e);var t=ht(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return m.a.createElement("div",{className:"auto-complete-suggestions"},this.props.suggestions.map(function(e){return m.a.createElement("div",{className:"suggestion"},e)}))}}]),n}(f.Component),mt=n(138),gt=n(173),vt=n(550),kt=n(2239);n(2392);function bt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var Et=function(e){Object(p.a)(n,e);var t=bt(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={focused:e.scriptingFocused,command:"",info:"",suggestions:[]},r.sequencerEngine=r.props.sequencerEngine,e.scripting.onFlashInfo=function(e){return r.onFlashInfo(e)},r}return Object(u.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.state.focused!=e.scriptingFocused&&e.scriptingFocused&&this.input.focus(),this.state.focused=e.scriptingFocused,!0}},{key:"onFlashInfo",value:function(e){var t=this;this.setState({info:e}),setTimeout(function(){t.setState({info:""})},2e3)}},{key:"handleChange",value:function(e){""===e.target.value&&this.setState({suggestions:[]}),this.setState({command:e.target.value})}},{key:"onKeyPress",value:function(e){var t=this;if("Enter"===e.key)this.props.scripting.runScript(this.state.command)&&(this.props.update(),this.setState({running:!0}),setTimeout(function(){t.setState({running:!1}),t.setState({command:"",suggestions:[]}),t.input.blur()},100),this.props.setCommandPrefix(void 0));else if("ArrowUp"===e.key)this.setState({command:this.props.scripting.upHistory()});else if("ArrowDown"===e.key)this.setState({command:this.props.scripting.downHistory()});else if("Tab"===e.key)return e.preventDefault(),this.autoComplete(),!1}},{key:"autoComplete",value:function(){var e=Object(s.a)(i.a.mark(function e(){var t,n,r,a,s,c,u,l,p,d,h,f,m,g,v;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("auto complete called"),!this.state.command.startsWith("/")){e.next=18;break}if(t=this.state.command.slice(1),n=this.terms,void 0!==(t=n[n.length-1])){e.next=7;break}return e.abrupt("return");case 7:if(1!==n.length){e.next=15;break}return e.next=10,this.props.sequencerEngine.searcher.freeTextSearch(t);case 10:r=e.sent,1===(a=r[pt.d].map(function(e){return e.value})).length?(n[n.length-1]=a[0],this.setState({suggestions:[],command:"/"+n.join("+")})):(s=this.getLongestCommonPrefix(a),this.setState({suggestions:a}),s&&this.setState({command:"/"+s})),e.next=16;break;case 15:n.length>1&&this.searchForTags(n);case 16:e.next=19;break;case 18:this.state.command.startsWith("+")&&(c=Object(lt.c)(this.state.command.slice(1)),u=c.effectName,l=c.parameters,this.state.command.includes("[")?(f=0===l.length?"":""===l[l.length-1].value?l[l.length-1].parameter:"",1===(m=Object(lt.b)(this.props.sequencerEngine,u,f)).length?(g="+"+u+"[",v=l.slice(0,l.length-1),g+=v.map(function(e){return e.parameter+"="+e.value}).join(" "),v.length>0&&(g+=" "),g+=m[0],this.setState({suggestions:[],command:g})):this.setState({suggestions:m})):(p=Object.keys(mt.b).filter(function(e){return e.toLowerCase().startsWith(u.toLowerCase())}),d=Object.keys(gt.b).filter(function(e){return e.toLowerCase().startsWith(u.toLowerCase())}),h=Object.keys(vt.b).filter(function(e){return e.toLowerCase().startsWith(u.toLowerCase())}),1===(p=[].concat(Object(o.a)(p),Object(o.a)(d),Object(o.a)(h))).length?this.setState({command:"+"+p[0]}):p.length>1&&this.setState({suggestions:p})));case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"searchForTags",value:function(){var e=Object(s.a)(i.a.mark(function e(t){var n,r,a,s,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.slice(0,t.length-1),r=t[t.length-1],(a=this.props.sequencerEngine.searcher).selectedTags=n,e.next=6,a.getTopTags();case 6:if(s=e.sent,a.selectedTags=[],1!==(s=s.map(function(e){return e.value}).filter(function(e){return e.toLowerCase().includes(r.toLowerCase())})).length){e.next=12;break}return this.setState({command:"/"+n.join("+")+"+"+s[0],suggestions:[]}),e.abrupt("return");case 12:if(this.setState({suggestions:s}),""!==n){e.next=15;break}return e.abrupt("return");case 15:(o=this.getLongestCommonPrefix(s))&&this.setState({command:"/"+n.join("+")+"+"+o});case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getLongestCommonPrefix",value:function(e){var t=void 0;for(var n in e)if(void 0===t)t=e[n];else if(void 0===(t=this.getCommonPrefix(e[n],t)))return;return t}},{key:"getCommonPrefix",value:function(e,t){for(var n="",r=0;r<Math.min(e.length,t.length)&&e[r]===t[r];r++)n+=e[r];return""===n?void 0:n}},{key:"terms",get:function(){return this.state.command.slice(1).split("+")}},{key:"setInput",value:function(e){void 0===this.input&&(this.input=e,this.props.onSetInput(e),this.props.setCommandInput(e))}},{key:"render",value:function(){var e=this,t="script-input";return this.state.running&&(t+=" running"),m.a.createElement("div",null,m.a.createElement("div",{className:"bottom-toolbar"},m.a.createElement("div",{className:"bottom-toolbar-left"},m.a.createElement(y.a,{condition:this.state.suggestions.length>0},m.a.createElement(ft,{suggestions:this.state.suggestions})),m.a.createElement(y.a,{condition:0===this.state.suggestions.length},m.a.createElement(dt.a,{sequencerEngine:this.props.sequencerEngine})),m.a.createElement("div",{className:"clear-fix"}),m.a.createElement("div",{className:"bar"}),m.a.createElement("div",{className:"script-container"},m.a.createElement("div",{className:"command-label"},m.a.createElement(y.a,{condition:void 0!==this.props.commandPrefix},this.props.commandPrefix),m.a.createElement(y.a,{condition:void 0===this.props.commandPrefix},">")),m.a.createElement("div",{className:"command-container"},""!==this.state.info?m.a.createElement("div",{className:"error-message"},this.state.info," "):m.a.createElement("input",{value:this.state.command,onChange:function(t){return e.handleChange(t)},onKeyDown:function(t){return e.onKeyPress(t)},ref:function(t){e.setInput(t)},className:t,type:"text"})),m.a.createElement("div",{className:"sequence-name-container"},void 0!==this.props.sequenceName?this.props.sequenceName:""),m.a.createElement("div",{onClick:function(){return e.props.setShowPianoRoll(!0)},className:"collapse-toggle bottom-shower"},m.a.createElement("div",{className:"arrow-left"})))),m.a.createElement(kt.a,{sequencerEngine:this.props.sequencerEngine})))}}]),n}(f.Component),yt=Object(j.b)(function(e,t){var n=e.sequencer.sequencerEngine.getSequenceId();return{sequencerEngine:e.sequencer.sequencerEngine,viewMode:e.sequencer.viewMode,quantized:e.sequencer.quantized,isRecording:e.sequencer.isRecording,isRecordingExpanded:e.sequencer.isRecordingExpanded,isPlaying:e.sequencer.isPlaying[n]||!1,isCommandDown:e.keyboard.isCommandDown,sequenceName:e.sequencer.sequenceName,trackRolling:e.sequencer.trackRolling,patternLocked:e.sequencer.patternLocks[t.sequencerEngine.currentPattern]||!1,playScheduled:e.clock.playScheduled,commandPrefix:e.commands.commandPrefix}},function(e){return{setViewMode:function(t){return e(Object(q.Hh)(t))},setShowPianoRoll:function(t){return e(Object(q.ag)(t))},setQuantized:function(t){return e(Object(q.Ae)(t))},setContextualHelp:function(t){return e(Object(q.vb)(t))},setIsRecording:function(t){return e(Object(q.Kc)(t))},setTrackRolling:function(t){return e(Object(q.kh)(t))},setCommandPrefix:function(t){return e(Object(q.qb)(t))},setIsRecordingExpanded:function(t){return e(Object(q.Lc)(t))},setCommandInput:function(t){return e(Object(q.pb)(t))}}})(Et);n(1017),n(849),n(2393),n(1010),n(1011),n(1012),n(1013),n(848),n(1014),n(993),n(1015);function Ot(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return St(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return St(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw i}}}}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var wt=Object(j.b)(function(e,t){return{viewMode:e.sequencer.viewMode,isTrackFocused:void 0!==e.sequencer.trackFocused,showPianoRoll:e.sequencer.showPianoRoll,bottomMode:e.arrangement.bottomMode,wallpaper:e.sequencer.wallpaper,animateWallpaper:e.sequencer.animateWallpaper,creatingNewPack:e.packs.creatingNewPack,packToEdit:e.packs.packToEdit,backgroundColor:e.sequencer.backgroundColor,fullScreenZObject:e.zobject.fullScreenZObject}},function(e){return{setSequencerEngine:function(t){return e(Object(q.Gf)(t))},setArrangementBottomHeight:function(t){return e(Object(q.C)(t))},setArrangementBottomResizing:function(t){return e(Object(q.E)(t))},setSamplesDragging:function(t){return e(Object(q.Re)(t))},setViewMode:function(t){return e(Object(q.Hh)(t))},setSampleDragging:function(t){return e(Object(q.Le)(t))},setWallpaper:function(t){return e(Object(q.Kh)(t))},setAnimateWallpaper:function(t){return e(Object(q.z)(t))},setSampleTagDragging:function(t){return e(Object(q.Pe)(t))},setPresetDragging:function(t){return e(Object(q.ue)(t))},setPackWindowPosition:function(t,n){return e(Object(q.Id)(t,n))},setPulledEffects:function(t){return e(Object(q.ze)(t))},setEffectDragging:function(t){return e(Object(q.h)(t))},setMidiEffectDragging:function(t){return e(Object(q.jd)(t))},setPullablePartDragging:function(t){return e(Object(q.ye)(t))},setTrackDragging:function(t){return e(Object(q.Wg)(t))}}})(function(e){var t=Object(ut.a)(e),n=Object(Pe.a)(t,3),a=(n[0],n[1]),c=n[2],u=Object(f.useState)(!1),l=Object(Pe.a)(u,2),p=l[0],d=(l[1],Object(f.useState)(void 0)),h=Object(Pe.a)(d,2),g=(h[0],h[1]),v=Object(Ae.a)({sequencerEngine:a}),k=(Object(Pe.a)(v,1)[0],e.viewMode===Ze.a?"scroll-area arrange":"scroll-area"),b=e.isTrackFocused?"sequencer-container focused":"sequencer-container";e.showPianoRoll&&e.viewMode!==Ze.a&&(b+=" show-piano-roll"),Object(f.useEffect)(function(){e.showPianoRoll&&(e.bottomMode===Be.d?e.setArrangementBottomHeight(window.innerHeight-40):e.bottomMode===Be.e&&e.setArrangementBottomHeight(350))},[e.bottomMode,e.showPianoRoll]),Object(f.useEffect)(function(){window._isNFT&&e.setViewMode(Ze.b)},[a]);var E=Object(f.useCallback)(function(t){var n=a.state;if(n.arrangement.isBottomResizing&&e.bottomMode!==Be.d){var r=window.innerHeight-t.pageY+n.arrangement.bottomOffset;e.viewMode===Ze.a&&(r+=25),e.setArrangementBottomHeight(r)}n.packs.draggingWindow&&e.setPackWindowPosition(t.pageX-n.packs.draggingWindow.x,t.pageY-n.packs.draggingWindow.y)},[a,e.viewMode,e.showPianoRoll,e.bottomMode]),y=Object(f.useCallback)(function(t){e.store.getState().arrangement.isBottomResizing&&e.setArrangementBottomResizing(!1),function(){var e=a.state,t=e.instruments,n=e.tracks,r=(e.effects,e.presets,e.selector);return e.sequencer,t.pullablePartDragging||n.trackDragging||r.sampleDragging||r.samplesDragging||r.sampleTagDragging}()&&O()},[a]),O=function(){e.setSampleDragging(void 0),e.setPullablePartDragging(void 0),e.setSamplesDragging(void 0),e.setSampleTagDragging(void 0),e.setPresetDragging(void 0),e.setMidiEffectDragging(void 0),e.setEffectDragging(void 0),e.setTrackDragging(void 0)},S=Object(f.useCallback)(function(){var t=Object(s.a)(i.a.mark(function t(n){var s,c,u,l,p,d,h,f,m,g,v,k,b,E,y,S,w,j,q,C,x,N,T;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s=a.state,c=s.instruments,u=s.tracks,l=s.effects,p=s.presets,d=s.selector,h=s.sequencer,!c.pullablePartDragging){t.next=9;break}return(f=Object(r.a)({},c.pullablePartDragging)).x=n.pageX-5,f.y=n.pageY-100,m=[].concat(Object(o.a)(l.pulledEffects),[f]),e.setPulledEffects(m),O(),t.abrupt("return");case 9:if(!u.trackDragging){t.next=21;break}if(!(g=u.trackDragging).sequencer){t.next=17;break}return g.sequencer.removeTrack(g),O(),t.abrupt("return");case 17:if(!g.pad){t.next=21;break}return g.pad.removeTrack(g),O(),t.abrupt("return");case 21:if(void 0===d.sampleDragging){t.next=47;break}v=Ot(a.currentSubSequence.pads),t.prev=23,v.s();case 25:if((k=v.n()).done){t.next=34;break}if(b=k.value,!(E=b.containsSample(d.sampleDragging))){t.next=32;break}return b.removeTrack(E),O(),t.abrupt("return");case 32:t.next=25;break;case 34:t.next=39;break;case 36:t.prev=36,t.t0=t.catch(23),v.e(t.t0);case 39:return t.prev=39,v.f(),t.finish(39);case 42:y=d.sampleDragging,a.addSound(y,void 0),O(),t.next=77;break;case 47:if(!d.samplesDragging){t.next=76;break}S=0,w=Ot(d.samplesDragging),t.prev=50,w.s();case 52:if((j=w.n()).done){t.next=65;break}if(q=j.value,!(S>4)){t.next=56;break}return t.abrupt("break",65);case 56:if(C=q,"string"!==typeof q){t.next=61;break}return C=new He.a(q),t.next=61,C.load();case 61:a.addSound(C),S++;case 63:t.next=52;break;case 65:t.next=70;break;case 67:t.prev=67,t.t1=t.catch(50),w.e(t.t1);case 70:return t.prev=70,w.f(),t.finish(70);case 73:O(),t.next=77;break;case 76:d.sampleTagDragging&&(a.searchForSounds([d.sampleTagDragging]),O());case 77:p.presetDragging&&(a.loadPreset(p.presetDragging,!0),O()),(x=h.effectDragging||l.midiEffectDragging)&&Object.keys(x).length>1&&((N=x.effect).x=n.pageX-5,N.y=n.pageY-100,T=[].concat(Object(o.a)(l.pulledEffects),[N]),e.setPulledEffects(T),O());case 80:case"end":return t.stop()}},t,null,[[23,36,39,42],[50,67,70,73]])}));return function(e){return t.apply(this,arguments)}}(),[a,e.sampleDragging]);if(Object(f.useEffect)(function(){if(window.isNFT)return!1;var t=De.a.getItem("wallpaper");t&&e.setWallpaper(t),void 0!==(t=De.a.getItem("animateWallpaper"))&&e.setAnimateWallpaper("true"===t)},[]),!a)return m.a.createElement("div",null);var w={};return e.wallpaper?(w.backgroundImage="url("+Ue.a.getHashUrl(e.wallpaper)+")",b+=" has-wallpaper"):b+=" no-wallpaper",e.animateWallpaper&&(b+=" animate"),Ge.isMobile&&(b+=" mobile"),b+=" "+e.viewMode,window._isNFT&&(b+=" NFT"),w.backgroundColor=e.backgroundColor,e.fullScreenZObject?m.a.createElement(Ie.default,{sequencerEngine:a,zObject:e.fullScreenZObject}):m.a.createElement("div",{onDrop:S,onMouseMove:E,onMouseUp:y,style:w,onDragOver:function(e){return e.preventDefault()},className:b},m.a.createElement("div",{className:k},e.showPianoRoll&&e.viewMode===Ze.e||e.wallpaper?"":m.a.createElement("div",{color:"radial-gradient(75.29% 75.29% at 64.96% 24.36%, #F0DFA7 0.52%, #FDBDAA 18.75%, #FEA186 34.38%, #F09277 49.48%, #D27584 74.48%, #6B7B8A 100%)",className:"coke-machine-glow"}),e.creatingNewPack||e.packToEdit?m.a.createElement(Le.a,{json:e.packToEdit}):"",m.a.createElement("div",null,m.a.createElement(Je.a,null)),m.a.createElement("div",{className:"main-area"},m.a.createElement(Ve.a,{sequencerEngine:a}),e.viewMode!==Ze.e||e.showPianoRoll&&e.bottomMode===Be.d?e.viewMode===Ze.b?m.a.createElement(Fe.a,{sequencerEngine:a}):e.viewMode===Ze.a?m.a.createElement(We.a,{sequencerEngine:a}):e.viewMode===Ze.d?m.a.createElement(it,{midiEngine:a.midi,channelMixer:a.channelMixer,sequencerEngine:a}):"":m.a.createElement(ct.a,{onDrop:S,isTrackFocused:e.isTrackFocused,viewMode:e.viewMode,sequencerEngine:a}),!(e.showPianoRoll&&e.bottomMode===Be.d)&&m.a.createElement(ot.a,{sequencerEngine:a,ethereumSearcher:c}))),e.showPianoRoll&&e.viewMode===Ze.e?m.a.createElement(st.a,{sequencerEngine:a}):e.viewMode===Ze.e?m.a.createElement(yt,{sequencerEngine:a,onSetInput:g,update:function(){return[]},showScriptingView:function(){return[]},scripting:a.scripting,scriptingFocused:p}):"")}),jt=n(2281);function qt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var Ct=function(e){Object(p.a)(n,e);var t=qt(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return m.a.createElement("div",{className:"ethereum-instructions"},m.a.createElement("div",{className:"ethereum-action"},"1. You need the Metamask Chrome-plugin to connect Universal Sequences with Ethereum. Install it ",m.a.createElement("a",{href:"https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn?hl=en"}," here "),". Unless you have it installed, but are not logged in. If so click on the metamask and type your password."),m.a.createElement("div",{className:"ethereum-action"},"2. Watch the first minute of this ",m.a.createElement("a",{href:"https://www.youtube.com/watch?v=6Gf_kRE4MJU"}," video ")," to learn how to set up a new account. All sounds you sample and tracks you create will be tied to the account you have logged on in Metamask."),m.a.createElement("div",{className:"ethereum-action"},'3. Switch to the "Ropsten" test network on Metamask'),m.a.createElement("div",{className:"ethereum-action"},m.a.createElement("img",{src:"/metamask-ropsten.png"})),m.a.createElement("div",{className:"ethereum-action"},"4. Get free test Ether from this ",m.a.createElement("a",{href:"https://faucet.metamask.io/"}," website "),' and clicking the "request 1 ether from faucet" button.'),m.a.createElement("div",{className:"ethereum-action"},'5. Reload this page and choose a user name. When you choose your name, Metamask will pop-up asking you to confirm a transaction, costing some (free) Ether. It\'s test money (i.e. not worth anything) so go ahead and click "Confirm".'),m.a.createElement("div",{className:"ethereum-action"},"6. Go to the ",m.a.createElement("a",{href:"/sequencer/"}," sequencer ")," page and make a track. When you hit save, a Metamask pop-up will ask you to confirm that transaction. Whenever we save stuff (whether new sounds or tracks), you will need to confirm the transaction and cough up free test Ether."),m.a.createElement("div",{className:"ethereum-action"},"7. Finally, have fun."))}}]),n}(f.Component),xt=(n(2394),n(331));function Nt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var Tt=function(e){Object(p.a)(n,e);var t=Nt(n);function n(e){var r;Object(c.a)(this,n),r=t.call(this,e),"MacIntel"===navigator.platform?E.a.setContext(new AudioContext({sampleRate:xt.e})):E.a.setContext(new AudioContext({sampleRate:xt.d}));var a=void 0!=e.match.params.userId?e.match.params.userId:void 0;return r.state={mixes:[],profile:void 0,userName:a,hasEthereum:!0,loadedUser:!1,userId:void 0,userNameNotFound:!1,sequencerEngineEditing:void 0,spotlightTracks:[],isPermissionedUser:void 0===a},E.a.context.latencyHint="balanced",r.props.setIsPlayingMix(!0),r.loadProfile(),r.multiSequencerEngine=new jt.a(r.props.store),ee.a.crypto.store=r.props.store,r.onClickSave=r.onClickSave.bind(Object(l.a)(r)),r}return Object(u.a)(n,[{key:"onClickSave",value:function(){var e=this.props.spotlightTracks.map(function(e){return e.id}),t=this.props.profile;void 0===t&&(t={mixes:[]}),t.spotlightTracks=e,void 0!==this.props.currentMix&&this.addEditedMix((new H).fromJson(this.props.currentMix)),t.mixes=this.state.mixes.map(function(e){return e.getJson(!1)}),ee.a.users.setProfile(t),this.props.setUserHasEditsToSave(!1)}},{key:"deleteTrack",value:function(e){var t=this,n=this.multiSequencerEngine.getSequencerEngine(e.id);if(void 0!==n&&(n.playing&&n.stop(),setTimeout(function(){t.multiSequencerEngine.unloadTrack(e.id)},5e3)),this.props.viewMode===W.b){var r=(new H).fromJson(this.props.currentMix);r.deleteTrack(e),this.props.setCurrentUserMix(r.getJson()),this.props.setUserHasEditsToSave(!0)}else{var a=Object(o.a)(this.props.spotlightTracks),i=a.indexOf(e);a.splice(i,1),this.props.setSpotlightTracks(a),this.props.setUserHasEditsToSave(!0)}}},{key:"loadMixes",value:function(){var e=Object(s.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t&&void 0!==t.mixes){e.next=2;break}return e.abrupt("return");case 2:n=t.mixes.map(function(e){return(new H).fromJson(e)}),this.setState({mixes:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"loadSpotlightTracks",value:function(){var e=Object(s.a)(i.a.mark(function e(t){var n=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=4;break}this.props.setSpotlightTracks([]),e.next=5;break;case 4:return e.delegateYield(i.a.mark(function e(){var r,a,o,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(c in r=t.spotlightTracks,console.log("loading spotlight tracks profile.tracks = "),console.log(r),a=[],o=function(e){a.push(new Promise(function(){var t=Object(s.a)(i.a.mark(function t(a,s){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=a,t.t1=n,t.next=4,ee.a.getSequence(r[e]);case 4:t.t2=t.sent,t.t3=t.t1.convertSequence.call(t.t1,t.t2),(0,t.t0)(t.t3);case 7:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()))},r)o(c);return e.t0=n.props,e.next=9,Promise.all(a);case 9:e.t1=e.sent,e.t0.setSpotlightTracks.call(e.t0,e.t1);case 11:case"end":return e.stop()}},e)})(),"t0",5);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"convertSequence",value:function(e){return Object(r.a)({},e,{name:e.title,id:e.newSequence})}},{key:"addTrack",value:function(e){if(console.log("add track = "),console.log(e),this.props.viewMode===W.b){var t=(new H).fromJson(this.props.currentMix);t.tracks.push(e),this.props.setCurrentUserMix(t.getJson()),this.props.setUserHasEditsToSave(!0)}else this.props.setUserHasEditsToSave(!0),this.props.setSpotlightTracks(this.props.spotlightTracks.concat([e]))}},{key:"addEditedMix",value:function(e){var t=[],n=!1;for(var r in this.state.mixes){var a=this.state.mixes[r];a.id===e.id?(t.push(e),n=!0):t.push(a)}n||t.push(e),this.setState({mixes:t})}},{key:"onClickDeleteMix",value:function(e){var t=void 0;for(var n in this.state.mixes)if(this.state.mixes[n].id===e.id){t=n;break}if(void 0!==t){var r=Object(o.a)(this.state.mixes);r.splice(t,1),this.setState({mixes:r}),this.props.setUserHasEditsToSave(!0)}}},{key:"doesUserOwnPage",value:function(){var e=Object(s.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t1=this.state.userId,e.next=3,ee.a.getUser();case 3:if(e.t2=e.sent,e.t0=e.t1===e.t2,e.t0){e.next=7;break}e.t0=void 0===this.state.userId;case 7:return t=e.t0,e.abrupt("return",t);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadProfile",value:function(){var e=Object(s.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,void 0===this.state.userName){e.next=13;break}return e.next=4,ee.a.users.isUserNameAvailable(this.state.userName);case 4:if(e.sent){e.next=11;break}return e.next=8,ee.a.users.getUserId(this.state.userName);case 8:this.state.userId=e.sent,e.next=13;break;case 11:return this.setState({userNameNotFound:!0,userLoaded:!0}),e.abrupt("return");case 13:return e.next=15,ee.a.users.getProfile(this.state.userId);case 15:t=e.sent,this.setState({profile:t,userLoaded:!0}),this.loadMixes(t),this.loadSpotlightTracks(t),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),"no user name"==e.t0||("no profile"===e.t0?this.setState({userLoaded:!0}):"no ethereum"===e.t0&&this.setState({hasEthereum:!1}));case 24:return e.prev=24,e.next=27,ee.a.users.getUserName(this.state.userId);case 27:n=e.sent,this.setState({userName:n}),e.next=34;break;case 31:e.prev=31,e.t1=e.catch(24),console.log("error loading username "+e.t1);case 34:case"end":return e.stop()}},e,this,[[0,21],[24,31]])}));return function(){return e.apply(this,arguments)}}()},{key:"onEditSequence",value:function(e){this.setState({sequencerEngineEditing:e})}},{key:"onGoBack",value:function(){this.setState({sequencerEngineEditing:void 0})}},{key:"render",value:function(){var e=this;if(this.state.userNameNotFound)return m.a.createElement("div",{className:""},"User name not found");var t=m.a.createElement(Re,{userLoaded:this.state.userLoaded,userId:this.state.userId,onClickDeleteMix:function(t){return e.onClickDeleteMix(t)},mixes:this.state.mixes,currentMix:this.props.currentMix,onClickSave:function(){return e.onClickSave()},spotlightTracks:this.props.spotlightTracks,sequencerEngineEditing:this.state.sequencerEngineEditing,multiSequencerEngine:this.multiSequencerEngine,setIsPlayingMix:function(t){return e.props.setIsPlayingMix(t)},isEditing:void 0===this.state.userId,ethereum:ee.a,addEditedMix:function(t){return e.addEditedMix(t)},onDeleteTrack:function(t){return e.deleteTrack(t)},viewMode:this.props.viewMode,addTrack:function(t){return e.addTrack(t)},setLoadingSequence:this.props.setLoadingSequence,onEditSequence:function(t){return e.onEditSequence(t)},loadedTracks:this.props.loadedTracks,isPlaying:this.props.isPlaying,store:this.props.store,profile:this.state.profile});return this.state.sequencerEngineEditing?m.a.createElement("div",null,m.a.createElement(wt,{onGoBack:function(){return e.onGoBack()},store:this.props.store,sequencerEngine:this.state.sequencerEngineEditing}),t):m.a.createElement("div",{className:"user-page"},m.a.createElement(S.a,null),m.a.createElement(O.a,{crypto:ee.a.crypto,show:!0}),m.a.createElement(y.a,{condition:this.state.hasEthereum},m.a.createElement("div",{className:"profile-container"},m.a.createElement("div",{className:"banner"},m.a.createElement(k,{onUserNameUpdated:function(t){return e.setState({userName:t})},userId:this.state.userId,isEditing:void 0===this.state.userId,ethereum:ee.a,userName:this.state.userName,profilePicture:this.state.profilePicture,profile:this.state.profile})),m.a.createElement(ie,{ethereum:ee.a,guilds:ee.a.guilds,userName:this.state.userName,userId:this.state.userId,isEditing:void 0===this.state.userId,onClickSave:this.onClickSave}),t)),m.a.createElement(y.a,{condition:!this.state.hasEthereum},m.a.createElement("div",{className:"profile-container"},m.a.createElement("div",{className:"profile-details"},m.a.createElement(Ct,null)))))}}]),n}(f.Component);t.default=Object(j.b)(function(e){return{viewMode:e.user.viewMode,currentMix:e.user.currentMix,loadedTracks:e.user.loadedTracks,isPlaying:e.sequencer.isPlaying,spotlightTracks:e.user.spotlightTracks}},function(e){return{setIsPlayingMix:function(t){return e(Object(q.Ic)(t))},setLoadingSequence:function(t,n){return e(Object(q.cd)(t,n))},setUserHasEditsToSave:function(t){return e(Object(q.Dh)(t))},setCurrentUserMix:function(t){return e(Object(q.Gb)(t))},setSpotlightTracks:function(t){return e(Object(q.zg)(t))}}})(Tt)}}]);