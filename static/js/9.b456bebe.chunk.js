(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{2211:function(e,t,n){},2223:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return d}),n.d(t,"b",function(){return f});var a=n(42),r=n.n(a),c=n(56),o=n(121),i=(n(122),n(142),n(1161)),s=n(159),u=n(169),l=n(161);new i.a;var d=function(){var t=Object(c.a)(r.a.mark(function t(n,a,c,i,d){var f,m,p,b,v,h,g,E;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return f=d.creatorShare,m=d.ownerShare,p=d.minterShare,console.log("JSON = ",n),t.next=4,o.a.addJson(n);case 4:return b=t.sent,v="https://zequencer.io/ipfs/"+b,h=JSON.stringify({description:c,mimeType:"text/json",image:"https://zequencer.io/ipfs/"+i,name:a}),t.next=9,o.a.addBuffer(e.from(h));case 9:g=t.sent,E=[a,v,g,Object(s.c)(b),[f,m,p]],console.log(E),new u.a(l.q,"createPlugin",E).execute();case 14:case"end":return t.stop()}},t)}));return function(e,n,a,r,c){return t.apply(this,arguments)}}(),f=function(){var t=Object(c.a)(r.a.mark(function t(n,a,c,i,d){var f,m,p,b;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.addJson(n);case 2:return f=t.sent,m="https://zequencer.io/ipfs/"+f,p=JSON.stringify({description:c,mimeType:"text/json",image:"https://zequencer.io/ipfs/"+i,name:a}),t.next=7,o.a.addBuffer(e.from(p));case 7:b=t.sent,new u.a(l.q,"updatePlugin",[d,m,b,Object(s.c)(f)]).execute();case 10:case"end":return t.stop()}},t)}));return function(e,n,a,r,c){return t.apply(this,arguments)}}()}).call(this,n(112).Buffer)},2233:function(e,t,n){},2241:function(e,t,n){},2242:function(e,t,n){"use strict";(function(e){n(42),n(56),n(760),n(141),n(159),n(169),n(161),n(23),n(118),n(1188),n(121)}).call(this,n(112).Buffer)},2243:function(e,t,n){},2381:function(e,t,n){},2382:function(e,t,n){},2384:function(e,t,n){},2385:function(e,t,n){},2515:function(e,t,n){},2587:function(e,t,n){},2588:function(e,t,n){},2589:function(e,t,n){},2590:function(e,t,n){},2591:function(e,t,n){},2592:function(e,t,n){},2593:function(e,t,n){},2594:function(e,t,n){},2595:function(e,t,n){},2777:function(e,t,n){"use strict";n.r(t);var a=n(32),r=n(42),c=n.n(r),o=n(56),i=n(110),s=n(3),u=n.n(s),l=n(189),d=n(23),f=n(55),m=n(121),p=n(11),b=n(114),v=n(21);function h(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}new b.a;var E=function(e,t){return(e%t+t)%t},k=Object(f.b)(function(e,t){return{step:t.sequencerEngine&&t.sequencerEngine.trackStep}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.row,a=e.part,r=e.step,c=void 0===r?0:r,o=Object(s.useCallback)(function(){var e=new v.a(Math.pow(2,2+Math.floor(a/2)),a%2===1);t.resolution=e,t.sequenceRolling=!0,t.trackRolling=!0},[t,a]),i=Object(s.useCallback)(function(){t.sequenceRolling=!1,t.trackRolling=!1},[t,a]),l=Object(s.useRef)(!1),d=Object(s.useRef)(void 0),f=new Set,m={},b=a===4*Math.floor(c/4)%32/32*8;if(t){var g,k=h(t.subSequences);try{for(k.s();!(g=k.n()).done;){var O,j=h(g.value.tracks);try{for(j.s();!(O=j.n()).done;){var y=O.value,w=y.notesTriggered||{};for(var S in w)S=E(S,12),f.add(S),m[S]||(m[S]=[]),m[S].push(y)}}catch(P){j.e(P)}finally{j.f()}}}catch(P){k.e(P)}finally{k.f()}}var C=2*n,x=2*n+1,N="triangle";if(f.has(C)||f.has(x)){var q=m[C]||[],T=m[x]||[],M=[].concat(Object(p.a)(q),Object(p.a)(T)).map(function(e){return"white"});b&&(l.current=!0,d.current=M[a%M.length],N+=" triggered")}else b&&c%4===0&&(l.current=!1);var I={};return l.current&&(N+=" old-trigger",void 0!==d.current?I.borderBottomColor=d.current:N+=" track-0"),u.a.createElement("div",{onMouseDown:o,onMouseUp:i,style:I,className:N})}),O=function(e){var t=e.sequencerEngine,n=e.row;return u.a.createElement("div",{className:"row"},[0,1,2,3,4,5,6,7].map(function(e){return u.a.createElement(k,{sequencerEngine:t,row:n,part:e})}))},j=n(767),y=(n(2211),[j.a,j.b]),w=Object(f.b)(function(e,t){return{screenshots:e.nft.screenshots,editionSize:t.sequencerEngine.erc721EditionSize}},function(e){return{}})(function(e){var t=e.text,n=e.editionSize,a=void 0===n?10:n,r=e.screenshots,c=void 0===r?[]:r;console.log("editionSize=%s screenshots=",a,c);var o=new Array(Math.max(0,a-c.length)).fill(0);return u.a.createElement("div",{className:"modal-backdrop prep"},u.a.createElement("div",{className:"preparing-nft flex-col flex"},y.map(function(e){return u.a.createElement("div",{className:t===e?"step selected":"step"},e)}),u.a.createElement("div",{className:"screenshots flex flex-wrap max-w-full flex flex-1 overflow-auto"},c.map(function(e){return u.a.createElement("img",{className:"w-16 h-16 border border-solid m-1",src:m.a.getHashUrl(e)})}),o.map(function(e){return u.a.createElement("div",{className:"w-16 h-16 border border-solid m-1"})}))))}),S=n(265),C=n(418),x=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.set,n=e.get,a=e.name,r=e.isTextArea,c=e.units,o=Object(s.useState)(!1),l=Object(i.a)(o,2),d=l[0],f=l[1],m="zora-field ";return(d||""!==n)&&(m+=" focused"),r&&(m+=" text-area"),u.a.createElement("div",{className:m},u.a.createElement("div",{className:"field-name"},a),r?u.a.createElement("textarea",{onFocus:function(e){return f(!0)},onBlur:function(e){return f(!1)},value:n,onChange:function(e){return t(e.target.value)},type:"text"}):u.a.createElement("input",{onFocus:function(e){return f(!0)},onBlur:function(e){return f(!1)},value:n,onChange:function(e){return t(e.target.value)},type:"text"}),u.a.createElement("div",{className:"units"},c))}),N=n(2223),q=n(220),T=n(146),M=Object(f.b)(function(e,t){return{mintingProgress:e.nft.mintingProgress,newZoraTokenId:e.nft.newZoraTokenId}},function(e){return{setPluginToSave:function(t){return e(Object(d.Ad)(t))}}})(function(e){var t=e.zobject,n=e.setPluginToSave;console.log("zobject.plugin=",t.plugin,t);var a=Object(s.useState)(t.plugin?t.plugin.name:""),r=Object(i.a)(a,2),c=r[0],o=r[1],l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],m=d[1],p=Object(s.useState)(""),b=Object(i.a)(p,2),v=b[0],h=b[1],g=Object(s.useCallback)(function(){var e=t.getPresetJson();t.plugin?Object(N.b)(e,c,f,v,t.plugin.tokenId):Object(N.a)(e,c,f,v,{creatorShare:4,ownerShare:4,minterShare:92})},[t,c,f,v]);return u.a.createElement(q.a,{dialogClassName:"zora-modal preset-modal",show:!0,onHide:function(){n(void 0)}},u.a.createElement(q.a.Body,null,u.a.createElement("div",{className:"zora-configuration"},u.a.createElement(x,{set:o,get:c,name:"name"}),u.a.createElement(x,{set:m,get:f,name:"description",isTextArea:!0}),u.a.createElement(C.a,{placeholder:"Drop the thumbnail image for your work, here",imageHash:v,setImageHash:h}))),u.a.createElement(q.a.Footer,null,u.a.createElement(T.b,{variant:"primary",onClick:g},t.plugin?"Update Plugin":"Mint Plugin")))}),I=n(768),P=n(362),R=(n(2233),Object(f.b)(function(e,t){return{}},function(e){return{setShowFreezeModal:function(t){return e(Object(d.De)(t))}}})(function(e){var t=e.sequencerEngine,n=e.setShowFreezeModal,a=Object(s.useState)("pad"),r=Object(i.a)(a,2),c=r[0],o=r[1],l=Object(s.useCallback)(function(){"pad"===c?t.state.spatial.showPadSequencer.zObject.executeAction("Freeze Pads"):Object(P.e)(t.getSelectedTrack()),n(!1)},[c,t]);return u.a.createElement(q.a,{dialogClassName:"freeze-modal",show:!0,onHide:function(){return n(!1)}},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,"Freeze",u.a.createElement("img",{src:"/freeze-icon.svg"}))),u.a.createElement(q.a.Body,null,u.a.createElement("div",{className:"freeze-options"},u.a.createElement("div",{onClick:function(e){return o("pad")},className:"pad"===c?"selected freeze-option":"freeze-option"},"Pad ",u.a.createElement("img",{src:"/zpad-light.svg"})),u.a.createElement("div",{onClick:function(e){return o("track")},className:"track"===c?"selected freeze-option":"freeze-option"},"Track"),u.a.createElement("div",{className:"freeze-description"},"pad"===c?"Bounce audio from all tracks into a single frozen stem.":"Bounce audio from the selected track into a frozen stem."))),u.a.createElement(q.a.Footer,null,u.a.createElement(T.b,{onClick:l,className:"pushable",variant:"secondary"},"Start Freezing")))})),D=Object(f.b)(function(e,t){return{}},function(e){return{setHicDialog:function(t){return e(Object(d.cc)(t))}}})(function(e){var t=e.setHicDialog,n=e.hicDialog,a="https://zequencer.io/ipfs/"+n.page,r=Object(s.useCallback)(function(){window.open("https://zequencer.io/ipfs/"+n.zip)},[n]);return u.a.createElement(q.a,{dialogClassName:"hic-modal preset-modal",show:!0,onHide:function(){return t(void 0)}},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,"Hicetnunc Assets")),u.a.createElement(q.a.Body,null,"Check this url to see if your NFT is showing correctly",u.a.createElement("div",{className:"ipfs-url"},u.a.createElement("a",{href:a,target:"_blank"},a))),u.a.createElement(q.a.Footer,null,u.a.createElement(T.b,{variant:"secondary",onClick:r},"Download Zip")))}),A=n(1),L=n(232),z=function(e,t){console.log("triggering refresh=",t,e,"/"),fetch("/refreshContract/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({contractAddress:t,transactionHash:e})})},H="0xf8333542541C1ECbee62392798157dfc357Da394",U=[{inputs:[{internalType:"address",name:"creatorAddress",type:"address"},{internalType:"address",name:"metadataRendererAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"creator",type:"address"},{indexed:!0,internalType:"address",name:"contractAddress",type:"address"},{indexed:!0,internalType:"uint64",name:"editionSize",type:"uint64"},{indexed:!1,internalType:"uint104",name:"publicSalePrice",type:"uint104"},{indexed:!1,internalType:"string",name:"name",type:"string"},{indexed:!1,internalType:"string",name:"collectionImage",type:"string"}],name:"ZequencerDropCreated",type:"event"},{inputs:[{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"symbol",type:"string"},{internalType:"string",name:"description",type:"string"},{internalType:"uint104",name:"publicSalePrice",type:"uint104"},{internalType:"uint64",name:"editionSize",type:"uint64"},{internalType:"uint16",name:"royaltyBPS",type:"uint16"},{internalType:"string",name:"baseAppURI",type:"string"},{internalType:"string",name:"baseImageURI",type:"string"},{internalType:"string",name:"collectionImage",type:"string"},{internalType:"bytes32[]",name:"traitTypes",type:"bytes32[]"},{internalType:"bytes32[]",name:"traitValues",type:"bytes32[]"}],name:"newDrop",outputs:[],stateMutability:"payable",type:"function"}],G=n(167);function F(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var W=function(){var e=Object(o.a)(c.a.mark(function e(t,n,a,r,o,i,s,u,l,d){var f,m,b,v,h,g,E,k,O,j,y,w,S=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(f=S.length>10&&void 0!==S[10]?S[10]:{},console.log("new Drop =",f),m=[],f[1]&&(m=f[1].map(function(e){return e.trait_type})),b=[],v=1;v<=i;v++)if(h=f[v],console.log("attr %s",v,h),h){g=F(h);try{for(g.s();!(E=g.n()).done;)k=E.value,O=k.value,b.push(O.toString())}catch(c){g.e(c)}finally{g.f()}h.length<m.length&&b.push("")}else b=[].concat(Object(p.a)(b),Object(p.a)(new Array(m.length).fill("")));return j=[n,a,r,o,i,s,u,l,d,m.map(function(e){return G.a.utils.padRight(G.a.utils.fromAscii(e),64)}),b.map(function(e){return G.a.utils.padRight(G.a.utils.fromAscii(e),64)})],console.log("args=",j),y=new L.a.Contract(H,U,t),e.next=11,y.newDrop.apply(y,j.concat([{value:0}]));case 11:return w=e.sent,w.hash,e.abrupt("return",w);case 14:case"end":return e.stop()}},e)}));return function(t,n,a,r,c,o,i,s,u,l){return e.apply(this,arguments)}}(),V=n(249),Q=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){for(var t=e.imageManifest,n=e.screenshotsCount,a=[],r=0;r<n;r++)a.push(r+1);return u.a.createElement("div",{className:"gallery-preview"},a.map(function(e){return u.a.createElement("div",{className:"preview-container"},u.a.createElement("img",{className:"preview-image",src:"https://arweave.net/"+t+"/"+e}),u.a.createElement("div",{className:"drop-label"},"Drop #",e))}))}),J=n(540),_=(n(14),Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.thumbnails,n=e.selected,a=e.setThumbnail;return u.a.createElement("div",{className:"alternate-thumbnails"},t.map(function(e){return u.a.createElement("img",{onClick:function(){return a(e)},src:"/ipfs/"+e,className:n===e?"pushable alternate-thumbnail selected":"pushable alternate-thumbnail"})}))})),Y=n(303),Z=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.royalties;return u.a.createElement("div",{className:"royalties zora-field focused"},u.a.createElement("div",{className:"field-name"},"your royalties %"),t&&u.a.createElement(Y.a,{units:"%",width:200,parameter:t}))}),X=(n(2241),Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.name,n=e.description,a=e.royalties,r=e.thumbnail,c=e.setName,o=e.setDescription,i=e.setThumbnail,s=e.alternateThumbnails;return u.a.createElement("div",{className:"zora-configuration"},u.a.createElement(x,{set:c,get:t,name:"name"}),u.a.createElement(x,{set:o,get:n,name:"description",isTextArea:!0}),u.a.createElement(_,{selected:r,setThumbnail:i,thumbnails:s}),u.a.createElement(C.a,{placeholder:"Drop the thumbnail image for your work, here",imageHash:r,setImageHash:i}),u.a.createElement(Z,{royalties:a}))}),Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){e.metadata;var t=e.contentURI;return u.a.createElement("iframe",{height:"519",width:"100%",src:t,className:"zora-mediaObject css-hnzuw7 zora-mediaObject--mediaLoaded zora-mediaObject--isFullPage",style:{border:0}})}));n(2242),n(2243);var K=Object(f.b)(function(e,t){return{mintingProgress:e.nft.mintingProgress,newZoraTokenId:e.nft.newZoraTokenId}},function(e){return{setNewZoraTokenId:function(t){return e(Object(d.Tc)(t))},setZoraDialog:function(t){return e(Object(d.Cg)(t))},setMintingProgress:function(t){return e(Object(d.Kc)(t))}}})(function(e){var t=e.setZoraDialog,n=e.data,a=e.sequencerEngine,r=(e.setMintingProgress,e.mintingProgress,e.newZoraTokenId,e.setNewZoraTokenId,Object(V.k)()),l=r.data,d=(r.isError,r.isLoading,Object(s.useState)()),f=Object(i.a)(d,2),m=f[0],p=f[1],b=Object(s.useState)({name:"",symbol:"",description:"",editionSize:a.erc721EditionSize||10,publicSalePrice:"0.01"}),v=Object(i.a)(b,2),h=v[0],g=v[1],E=Object(s.useCallback)(Object(o.a)(c.a.mark(function e(){var t,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=L.a.utils.parseEther(h.publicSalePrice),p("Waiting for you to confirm in wallet"),e.next=5,W(l,h.name,h.symbol,h.description,t,parseInt(h.editionSize),500,"https://arweave.net/"+n.appManifest+"/?tokenId=","https://arweave.net/"+n.imageManifest+"/","https://arweave.net/"+n.imageManifest+"/1",a.erc721Attributes);case 5:return r=e.sent,o=r.hash,z(o,H),p("Waiting for block to be mined"),e.next=11,r.wait();case 11:p("Completed!"),console.log("tx =",r);case 13:case"end":return e.stop()}},e)})),[h,n,l,p]);return u.a.createElement("div",{className:"z-modal-backdrop"},u.a.createElement("div",{className:"z-modal-body zora-dialog-modal mint-dialog"},u.a.createElement("div",{className:"zora-dialog-inner"},m&&u.a.createElement("div",{className:"progress-text"},m),u.a.createElement(X,{contentURI:"https://arweave.net/"+n.appManifest}),u.a.createElement("div",null,u.a.createElement(Q,{screenshotsCount:a.erc721EditionSize||h.editionSize,imageManifest:n.imageManifest}),u.a.createElement("div",{className:"configuration"},u.a.createElement(x,{set:function(e){return g(Object(A.a)({},h,{name:e}))},get:h.name,name:"Name"}),u.a.createElement(x,{set:function(e){return g(Object(A.a)({},h,{symbol:e}))},get:h.symbol,name:"Symbol"}),u.a.createElement(x,{set:function(e){return g(Object(A.a)({},h,{description:e}))},get:h.description,name:"Description",isTextArea:!0}),u.a.createElement(x,{set:function(e){return g(Object(A.a)({},h,{editionSize:e}))},get:h.editionSize,name:"Edition Size"}),u.a.createElement(x,{set:function(e){return g(Object(A.a)({},h,{publicSalePrice:e}))},get:h.publicSalePrice,units:"eth",name:"Public Sale Price"}),u.a.createElement("div",{className:"connect-button-container"},u.a.createElement(J.a,{accountStatus:"address",showBalance:{smallScreen:!1,largeScreen:!1},label:"Connect Wallet"}))))),u.a.createElement("div",{className:"z-footer"},u.a.createElement("div",{className:"buttons"},u.a.createElement(T.b,{variant:"secondary",onClick:function(){return t(void 0)}},"Cancel"),u.a.createElement(T.b,{variant:"primary",onClick:E},"Mint on Zora (test-net)")))))}),$=n(1499),ee=n(1197),te=(n(2274),n(172)),ne=n(235),ae=n(2744),re=n(2745),ce=Object(te.b)([ne.b.mainnet,ne.b.goerli],[Object(ae.a)({infuraId:"2f3dce2af1044e88b4851c3d73c3d00c"}),Object(re.a)()]),oe=ce.chains,ie=ce.provider,se=Object($.a)({appName:"Spore Players",chains:oe}).connectors,ue=Object(V.b)({autoConnect:!0,connectors:se,provider:ie}),le=function(e){return u.a.createElement(V.a,{client:ue},u.a.createElement(J.d,{chains:oe,theme:Object(ee.a)({accentColor:"black",accentColorForeground:"white",borderRadius:"small"})},u.a.createElement(K,e)))},de=n(174),fe=n.n(de),me=Object(f.b)(function(e,t){return{loops:e.freeze.loops}},function(e){return{setLoopsToFreeze:function(t){return e(Object(d.Dc)(t))}}})(function(e){var t=e.loops,n=e.setLoopsToFreeze;return u.a.createElement("div",null,u.a.createElement("div",{className:"parameter-label"},"Loops To Freeze: ",t),u.a.createElement(fe.a,{value:Math.log2(t),change:function(e){return n(Math.pow(2,e.target.value))},step:1,max:6,min:0,orientation:"horizontal",reversed:!1}))}),pe=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.input,n=e.midiEngine,a=e.syncedInput,r=e.setSyncedInput,c=Object(s.useState)(n.isInputTracked(t)),o=Object(i.a)(c,2),l=o[0],d=o[1],f=a===t,m=Object(s.useCallback)(function(){n.isInputSynced(t)?(n.unsyncInput(t),r(void 0)):(n.syncInput(t),r(t))},[r]),p=Object(s.useCallback)(function(e){n.isInputTracked(t)?n.untrackInput(t):n.trackInput(t),d(!l)},[d,l]);return u.a.createElement("div",{className:"midi-input"},u.a.createElement("div",{className:"midi-name"},t.name),u.a.createElement("div",{className:"midi-options"},u.a.createElement("div",{onClick:p,className:l?"midi-option enabled":"midi-option"},"TRACK"),u.a.createElement("div",{onClick:m,className:f?"midi-option enabled":"midi-option"},"SYNC")))}),be=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.output,n=e.midiEngine,a=e.syncedOutput,r=e.setSyncedOutput,c=Object(s.useState)(n.isOutputTracked(t)),o=Object(i.a)(c,2),l=o[0],d=o[1],f=a===t,m=Object(s.useCallback)(function(){n.isOutputSynced(t)?(n.unsyncOutput(t),r(void 0)):(n.syncOutput(t),r(t))},[r]),p=Object(s.useCallback)(function(e){n.isOutputTracked(t)?n.untrackOutput(t):n.trackOutput(t),d(!l)},[d,l]);return u.a.createElement("div",{className:"midi-input"},u.a.createElement("div",{className:"midi-name"},t.name),u.a.createElement("div",{className:"midi-options"},u.a.createElement("div",{onClick:p,className:l?"midi-option enabled":"midi-option"},"TRACK"),u.a.createElement("div",{onClick:m,className:f?"midi-option enabled":"midi-option"},"SYNC")))}),ve=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine.midi,n=Object(s.useState)(t.systemInput),a=Object(i.a)(n,2),r=a[0],c=a[1],o=Object(s.useState)(t.systemOutput),l=Object(i.a)(o,2),d=l[0],f=l[1],m=t.getInputs(),p=t.getOutputs();return u.a.createElement("div",{className:"midi-settings"},u.a.createElement("div",{className:"midi-header"},"Input:"),m.map(function(e){return u.a.createElement(pe,{midiEngine:t,syncedInput:r,setSyncedInput:c,input:e})}),u.a.createElement("div",{className:"midi-header"},"Output:"),p.map(function(e){return u.a.createElement(be,{midiEngine:t,syncedOutput:d,setSyncedInput:f,output:e})}))}),he=n(6),ge=n.n(he),Ee=n(115),ke=n.n(Ee),Oe="interactive",je=[Oe,"balanced","playback"].map(function(e){return{label:e,value:e}}),ye=function(e){return{label:e,value:e}},we=Object(f.b)(function(e,t){return{latencyHint:t.sequencerEngine.latencyHint}},function(e){return{}})(function(e){var t=Object(s.useState)(e.latencyHint||Oe),n=Object(i.a)(t,2),a=n[0],r=n[1],c=Object(s.useState)(!1),o=Object(i.a)(c,2),d=o[0],f=o[1],m=Object(s.useCallback)(function(t){t=t.value,l.a.setItem("latencyHint",t),r(t),e.sequencerEngine.save("Test","PUBLIC",!1),f(!0)},[r,d]);return u.a.createElement("div",{className:"sample-rate-chooser"},u.a.createElement("div",{className:"dropdown-title"},"Latency Hint:"),u.a.createElement(ke.a,{className:"audio-input-chooser-dropdown",controlClassName:"audio-input-chooser-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:je,onChange:m,value:ye(a),placeholder:"Audio Input"}),d?u.a.createElement("div",{className:"needs-reload"},"Reload page to use new latency hint"):"")}),Se=n(4),Ce=n(5),xe=n(7),Ne=n(8),qe=n(2);function Te(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var Me=function(e){Object(xe.a)(n,e);var t=Te(n);function n(e){var a;return Object(Se.a)(this,n),(a=t.call(this,e)).state={options:[]},a.getOptions(),a}return Object(Ce.a)(n,[{key:"getOptions",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==navigator.mediaDevices){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,navigator.mediaDevices.enumerateDevices();case 4:t=e.sent,n=t.filter(function(e){return"audioinput"===e.kind}).map(function(e){return{label:e.label,value:e.deviceId}}),void 0!==this.props.deviceId||(a=this.props.defaultInput||"default",(r=t.filter(function(e){return e.label.includes(a)})).length>0&&void 0===this.props.audioInputSource&&this.onChangeInput(r[0].deviceId)),this.setState({options:n});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getOption",value:function(e){return void 0===e&&(e="default"),this.state.options.filter(function(t){return t.value===e})[0]}},{key:"onChangeInput",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:{deviceId:t,echoCancellation:!1}});case 2:n=e.sent,l.a.setItem("deviceId",t),console.log("choosing stream=",n,t),this.props.onChooseAudio(n,t);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.defaultClassName||"audio-input-chooser";return u.a.createElement("div",{className:t},u.a.createElement("div",{className:"dropdown-title"},"Input Device:"),u.a.createElement(ke.a,{className:"audio-input-chooser-dropdown",controlClassName:"audio-input-chooser-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.state.options,onChange:function(t){return e.onChangeInput(t.value)},value:this.getOption(this.props.deviceId),placeholder:"Audio Input"}))}}]),n}(s.Component),Ie=Object(f.b)(function(e){return{audioInputSource:e.sequencer.audioInputSource}},function(e){return{}})(Me),Pe=n(777),Re=[Pe.c,Pe.b,Pe.d,Pe.e,Pe.a].map(function(e){return{label:e,value:e}}),De=function(e){return{label:e,value:e}},Ae=Object(f.b)(function(e,t){return{sampleRate:t.sequencerEngine.context.sampleRate}},function(e){return{}})(function(e){var t=Object(s.useState)(e.sampleRate),n=Object(i.a)(t,2),a=n[0],r=n[1],c=Object(s.useState)(!1),o=Object(i.a)(c,2),d=o[0],f=o[1],m=Object(s.useCallback)(function(t){t=t.value,l.a.setItem("sampleRate",t),r(t),e.sequencerEngine.save("Test","PUBLIC",!1),f(!0)},[r,d]);return u.a.createElement("div",{className:"sample-rate-chooser"},u.a.createElement("div",{className:"dropdown-title"},"SampleRate:"),u.a.createElement(ke.a,{className:"audio-input-chooser-dropdown",controlClassName:"audio-input-chooser-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:Re,onChange:m,value:De(a),placeholder:"Audio Input"}),d?u.a.createElement("div",{className:"needs-reload"},"Reload page to use new sample rate"):"")}),Le=function(e){return u.a.createElement("div",{onClick:function(){return e.onClick(!e.isMultiChannelOutput)},className:"audio-outputs-option"},e.isMultiChannelOutput?"MULTI CHANNEL OUTPUT ":"SINGLE OUTPUT ","(",e.numberOfChannels," channels)")},ze=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=Object(s.useState)(void 0),a=Object(i.a)(n,2),r=(a[0],a[1]),c=Object(s.useState)(!t.channelMixer.stereoConnected),o=Object(i.a)(c,2),l=o[0],d=o[1],f=Object(s.useCallback)(function(e,n){t.audioInputManager.newInputSource(e,n),r(n)},[r]),m=Object(s.useCallback)(function(e){t.channelMixer.switchOutputs(e),d(e)},[d]);return u.a.createElement("div",{className:"audio"},u.a.createElement(Ae,{sequencerEngine:t}),u.a.createElement(we,{sequencerEngine:t}),u.a.createElement(Ie,{deviceId:t.audioInputManager.deviceId,defaultClassName:"preferences-audio-chooser",onChooseAudio:f}),u.a.createElement(Le,{isMultiChannelOutput:l,numberOfChannels:t.channelMixer.numberOfChannels(),onClick:m}))}),He=n(141),Ue=n(127),Ge=n(69),Fe=n(72),Be=n(118),We=n(83),Ve=function(){var e=Object(o.a)(c.a.mark(function e(t,n,a){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("getClockASks for userId=",n),fetch("/getClockAsks/"+n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(){var e=Object(o.a)(c.a.mark(function e(r){var o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.json();case 2:if(0===(o=e.sent)||"0"===o){e.next=7;break}t(o),e.next=12;break;case 7:if(!a.current){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,Object(We.a)(1e3);case 11:Ve(t,n,a);case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}();Ge.a,Ge.c;var Qe=Object(f.b)(function(e){return{clockType:e.sequencer.clockType,availableUsers:e.sequencer.clockType===Ge.a?[]:e.clock.availableUsers,connectedUserName:e.clock.connectedUserName,connectionStatus:e.clock.connectionStatus}},function(e){return{}})(function(e){var t=Object(s.useState)(void 0),n=Object(i.a)(t,2),a=n[0],r=n[1],l=Object(s.useState)(void 0),d=Object(i.a)(l,2),f=d[0],m=d[1],p=Object(s.useRef)(!1);Object(s.useEffect)(function(){a&&Be.a.users.getUserName(a).then(m)},[a,m]),Object(s.useEffect)(function(){return He.a.getAccount().then(function(e){return Ve(r,e,p)}),function(){return p.current=!0}},[]),Object(s.useEffect)(function(){e.sequencerEngine.clockSync.startListening()},[]);var b=Object(s.useCallback)(function(){var t=Object(o.a)(c.a.mark(function t(n){var a;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.connectionStatus!==Fe.c){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Be.a.users.getUserId(n);case 4:a=t.sent,e.sequencerEngine.clockSync.askToConnect(a);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),[e.connectionStatus]),v=Object(s.useCallback)(function(){a&&(e.sequencerEngine.clockSync.setClockType(Ge.c),e.sequencerEngine.clockSync.syncToUser(a))},[a]),h=Object(s.useCallback)(function(t){return t===e.connectedUserName?"available-user selected":"available-user"},[e.connectedUserName,a]);return e.connectionStatus===Fe.c?u.a.createElement("div",{className:"clock-type-container"},u.a.createElement("div",{className:"sub-header"},"Clock Syncing"),"Connected with ",u.a.createElement("span",{className:"clock-user"},e.connectedUserName)):e.connectionStatus===Fe.d?u.a.createElement("div",{className:"clock-type-container"},u.a.createElement("div",{className:"sub-header"},"Clock Syncing"),"Waiting to connect..."):f?u.a.createElement("div",{className:"clock-type-container"},u.a.createElement("div",{className:"sub-header"},"Clock Syncing"),u.a.createElement("div",{className:"ask-text"},u.a.createElement("span",{className:"clock-user"},f)," wants to sync clocks with you."),u.a.createElement("div",{className:"ask-buttons"},u.a.createElement("div",{onClick:v,className:"ok-btn"},"Connect"),u.a.createElement("div",{className:"cancel-btn"},"Cancel"))):u.a.createElement("div",{className:"clock-type-container"},u.a.createElement("div",{className:"sub-header"},"Clock Syncing"),u.a.createElement("div",{className:"available-users"},"People available to connect:",e.availableUsers.map(function(t){return u.a.createElement("div",{onClick:function(){return b(t)},className:h(t)},t,u.a.createElement(Ue.a,{condition:e.connectionStatus===Fe.c},u.a.createElement("div",{className:"user-status"},"CONNECTED")))})))}),Je=n(391),_e=n(169),Ye=n(142),Ze=n(1157),Xe=n(122),Ke=n(159),$e=n(161);function et(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var nt=(new Ze.a).contractAddress,at=function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ct(t);case 2:return n=e.sent,console.log("thumb = ",n),e.next=6,new _e.a($e.v,"newWallpaper",[Object(Ke.c)(t),Object(Ke.c)(n)]).execute();case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),rt=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,i,s,u,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Ye.a(nt).from(Xe.O).select("wallpaperHash").select("thumbnailHash"),t&&n.where("wallpaperHash",t),e.next=4,n.executeQuery();case 4:a=e.sent,r={},o=et(a);try{for(o.s();!(i=o.n()).done;)s=i.value,r[s.thumbnailHash]=s.wallpaperHash}catch(c){o.e(c)}finally{o.f()}for(l in u=[],r)u.push({wallpaper:r[l],thumbnail:l});return e.abrupt("return",u);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ct=function(e){return new Promise(function(t){var n=new Image,a=document.createElement("canvas"),r=a.getContext("2d");n.onload=function(){a.width=300,a.height=300,r.drawImage(n,0,0,300,300);var e=function(e){for(var t=atob(e.split(",")[1]),n=(e.split(",")[0].split(":")[1].split(";")[0],new ArrayBuffer(t.length)),a=new Uint8Array(n),r=0;r<t.length;r++)a[r]=t.charCodeAt(r);return n}(a.toDataURL());m.a.addArrayBuffer(e).then(t)},n.src=m.a.getHashUrl(e)})};var ot=n(791),it=Object(f.b)(function(e,t){return{theme:e.sequencer.theme,wallpaper:e.sequencer.wallpaper,animateWallpaper:e.sequencer.animateWallpaper,backgroundColor:e.sequencer.backgroundColor,showThemeGrid:e.sequencer.showThemeGrid}},function(e){return{setShowThemeGrid:function(t){return e(Object(d.Ue)(t))},setTheme:function(t){return e(Object(d.rf)(t))},setWallpaper:function(t){return e(Object(d.hg)(t))},setBackgroundColor:function(t){return e(Object(d.O)(t))},setAnimateWallpaper:function(t){return e(Object(d.y)(t))}}})(function(e){var t=Object(s.useRef)(void 0),n=Object(s.useState)(e.wallpaper),a=Object(i.a)(n,2),r=a[0],c=a[1],o=Object(s.useState)(void 0),d=Object(i.a)(o,2),f=d[0],p=d[1],b=Object(s.useState)(!1),v=Object(i.a)(b,2),h=v[0],g=v[1],E=Object(s.useState)({hex:e.backgroundColor}),k=Object(i.a)(E,2),O=k[0],j=k[1];Object(s.useEffect)(function(){e.backgroundColor!==O.hex&&(e.setBackgroundColor(O.hex),window.localStorage.setItem("backgroundColor",O.hex))},[O,e.backgroundColor]);var y=Object(ot.a)(t,9,!0).size;Object(s.useEffect)(function(){r&&(l.a.setItem("wallpaper",r),f&&!f.map(function(e){return e.wallpaper}).includes(r)&&at(r),e.setWallpaper(r))},[r,f]),Object(s.useEffect)(function(){rt().then(p)},[p]);var w=f||[];return u.a.createElement("div",{className:"appearance"},u.a.createElement("div",{className:"wallpaper-toolbar"},"Color Theme:",u.a.createElement("div",{style:{backgroundColor:O.hex},onClick:function(){return g(!h)},className:"color-btn"}),h&&u.a.createElement(Je.a,{color:O,onChange:j}),e.wallpaper&&u.a.createElement("div",{onClick:function(){e.setWallpaper(void 0),window.localStorage.removeItem("wallpaper")},className:"pushable clear-wallpaper"},"Clear Wallpaper")),u.a.createElement(C.a,{placeholder:"Drag new wallpaper here",imageHash:r,setImageHash:c}),u.a.createElement("div",{ref:t,className:"gallery"},w.slice(0,y).map(function(e){var t=e.wallpaper,n=e.thumbnail;return u.a.createElement("img",{key:t,onClick:function(){return c(t)},src:m.a.getHashUrl(n),className:"wallpaper-choice"})})))}),st=(n(2381),function(e){var t=e.option,n=e.setOption,a=e.selectedOption,r="settings-option";return t===a&&(r+=" selected"),u.a.createElement("div",{onClick:function(){return n(t)},className:r},t)}),ut=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=Object(s.useState)("Appearance"),n=Object(i.a)(t,2),a=n[0],r=n[1];return u.a.createElement("div",{className:"settings"},u.a.createElement("div",{className:"settings-sidebar"},u.a.createElement(st,{option:"Appearance",selectedOption:a,setOption:r}),e.onlyAppearance?"":u.a.createElement(st,{option:"MIDI",selectedOption:a,setOption:r}),e.onlyAppearance?"":u.a.createElement(st,{option:"Audio",selectedOption:a,setOption:r}),e.onlyAppearance?"":u.a.createElement(st,{option:"Freeze",selectedOption:a,setOption:r}),e.onlyAppearance?"":u.a.createElement(st,{option:"Clock",selectedOption:a,setOption:r})),u.a.createElement("div",{className:"settings-content"},"Appearance"===a?u.a.createElement(it,{sequencerEngine:e.sequencerEngine}):"","MIDI"===a?u.a.createElement(ve,{sequencerEngine:e.sequencerEngine}):"","Audio"===a?u.a.createElement(ze,{sequencerEngine:e.sequencerEngine}):"","Freeze"===a?u.a.createElement(me,{sequencerEngine:e.sequencerEngine}):"","Clock"===a?u.a.createElement(Qe,{sequencerEngine:e.sequencerEngine}):""))}),lt=Object(f.b)(function(e,t){return{}},function(e){return{setShowSettings:function(t){return e(Object(d.Se)(t))}}})(function(e){var t=Object(s.useCallback)(function(){e.setShowSettings(!1),e.hide&&e.hide()},[]);return u.a.createElement(q.a,{dialogClassName:"preset-modal",show:!0,onHide:t},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,"Settings")),u.a.createElement(q.a.Body,null,u.a.createElement(ut,{onlyAppearance:e.onlyAppearance,sequencerEngine:e.sequencerEngine})),u.a.createElement(q.a.Footer,null,u.a.createElement(T.b,{variant:"secondary",onClick:t},"Done")))}),dt=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){e.favorited;var t=e.setViewMode,n=e.viewMode,a=(e.setFavorited,e.starred,e.setStarred,e.setFilterMine),r=e.filterMine,c=(e.setOld,e.old,e.setSongs),o=e.songs;return u.a.createElement("div",{className:"search-options"},u.a.createElement("div",{onClick:function(){return a(!0)},className:r?"selected search-option":"search-option"},"My Projects"),u.a.createElement("div",{onClick:function(){return a(!1)},className:r?"search-option":"selected search-option"},"All Projects"),u.a.createElement("div",{onClick:function(){return c(!o)},className:o?"selected music-icon search-option":"music-icon search-option"},u.a.createElement("img",{src:"/musical-note.svg"})),!1,u.a.createElement("div",{className:"view-modes"},u.a.createElement("div",{onClick:function(){return t("LIST")},className:"LIST"===n?"selected view-mode":"view-mode"},u.a.createElement("img",{src:"/list-icon.svg"})),u.a.createElement("div",{onClick:function(){return t("GRID")},className:"GRID"===n?"selected view-mode":"view-mode"},u.a.createElement("img",{src:"/grid-icon.svg"}))))}),ft=n(44),mt=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.color,a=e.patternNumber,r=t.patterns[a];if(!r)return[];var c=new Array(Math.min(16,r.size/2)).fill(0);return u.a.createElement("div",{className:"track-steps"},c.map(function(e,t){return u.a.createElement("div",{style:r[2*t]?{backgroundColor:n}:{},className:"track-step"})}))}),pt=function(e){var t=e.pattern,n=e.isCurrent,a=e.setPatternNumber,r="mini-pattern-btn";return n&&(r+=" current"),u.a.createElement("div",{className:r,onClick:function(){return a(t)}},t+1)},bt=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.patternNumber,n=e.setPatternNumber,a=e.patterns,r=new Array(a).fill(0);return u.a.createElement("div",{className:"pattern-numbers"},r.map(function(e,a){return u.a.createElement(pt,{pattern:a,isCurrent:t===a,setPatternNumber:n})}))}),vt=["A","B","C","D","E","F","G","H"],ht=function(e){var t=e.subSequence,n=e.isCurrent,a=e.setSubSequence,r="mini-subsequence-btn";return n&&(r+=" current"),u.a.createElement("div",{className:r,onClick:function(){return a(t)}},vt[t])},gt=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.subSequence,n=e.setSubSequence,a=e.subSequences,r=new Array(a).fill(0);return u.a.createElement("div",{className:"subsequence-buttons"},r.map(function(e,a){return u.a.createElement(ht,{subSequence:a,isCurrent:t===a,setSubSequence:n})}))}),Et=(new b.a,Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.color,a=e.onClick,r=e.isSelected,c={backgroundColor:n};if(t.sample){var o=t.sample.getThumbnail();o&&""!==o&&(console.log("url = ",o),c.backgroundImage="url("+o+")")}return u.a.createElement("div",{onClick:a,style:c,className:r?"mini-thumbnail selected":"mini-thumbnail"})})),kt=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be.a.guildSequences.getGuildSequence(t);case 2:if(void 0!==(n=e.sent)||!He.a.isLoggedIn()){e.next=8;break}return e.next=6,Be.a.encryption.getSequencesSharedWithUser(t);case 6:n=(n=e.sent)[0];case 8:if(void 0===n){e.next=15;break}return e.next=11,Be.a.crypto.fetchAndDecrypt(t,n);case 11:return a=e.sent,e.abrupt("return",JSON.parse(a));case 15:return e.next=17,Be.a.encryption.getEncryptedSequenceIfAny(t);case 17:if(void 0===(r=e.sent)){e.next=24;break}return e.t0=JSON,e.next=22,Be.a.crypto.fetchAndDecrypt(t,r);case 22:return e.t1=e.sent,e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 24:return e.abrupt("return",m.a.getJson(t));case 25:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Ot=(n(675),n(148)),jt=n(143),yt=n(138);function wt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return St(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return St(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ct=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,i,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kt(t);case 2:n=e.sent,a=[],r=wt(n.subSequences),e.prev=5,r.s();case 7:if((o=r.n()).done){e.next=15;break}return i=o.value,e.next=11,xt(i);case 11:s=e.sent,a.push(s);case 13:e.next=7;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return e.abrupt("return",a);case 24:case"end":return e.stop()}},e,null,[[5,17,20,23]])}));return function(t){return e.apply(this,arguments)}}(),xt=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,i,s,u,l,d,f,m,p;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=0,r=wt(t.tracksData),e.prev=3,r.s();case 5:if((o=r.n()).done){e.next=30;break}if(i=o.value,s=i.type,u=i.instrumentType,l=i.presetName,d=i.samplers,f=Object.keys(d),m={type:s,instrumentType:u,name:l||Ot.d[u]},s===jt.e&&(m.name="Multi Freeze"),!(f.length>0)){e.next=17;break}return p=new yt.a(f[0]),e.next=15,p.fetchMetadata();case 15:m.name=p.name,m.sample=p;case 17:m.patterns=t.tracks[a],m.patternParameters=t.tracksPatterns[a],m.trackEffects=t.tracksEffectsChains[a][0],m.trackMidiEffects=t.tracksMidiEffects[a],m.trackLiveEffects=t.tracksLiveEffects[a],m.parameters=t.tracksParameters[a],m.trackData=t.tracksData[a],m.envelopes=t.envelopes,m.lfos=t.lfos,n.push(m),a++;case 28:e.next=5;break;case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(3),r.e(e.t0);case 35:return e.prev=35,r.f(),e.finish(35);case 38:return e.abrupt("return",n);case 39:case"end":return e.stop()}},e,null,[[3,32,35,38]])}));return function(t){return e.apply(this,arguments)}}(),Nt=new b.a,qt=["A","B","C","D","E","F","G","H"],Tt=function(e){e.loadModule;var t=e.sub,n=(e.moduleName,e.patternNumber),a=e.onClickTrack,r=e.selectedTracks,c=e.sequencerEngine;Object(s.useCallback)(function(){c.operationManager.dispatch(Object(ft.l)(r.length>0?r:t,n))},[r,n,t]);return u.a.createElement("div",{className:"sub"},t.map(function(e){return u.a.createElement(Mt,{onClick:function(){return a(e)},isSelected:r.includes(e),patternNumber:n,track:e})}))},Mt=function(e){var t=e.track,n=e.patternNumber,a=e.onClick,r=e.isSelected,c=t.sample?t.sample.getId():t.name,o=c?Nt.getColorForHash(c):"red";return u.a.createElement("div",{className:"mini-track"},u.a.createElement(Et,{isSelected:r,onClick:a,color:o,track:t}),u.a.createElement("div",{className:"track-name"},It(t.name)),u.a.createElement(mt,{color:o,track:t,patternNumber:n}))},It=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return e&&e.length>t?e.slice(0,t)+"...":e},Pt=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.project,a=Object(s.useState)(0),r=Object(i.a)(a,2),c=r[0],o=r[1],l=Object(s.useState)(0),d=Object(i.a)(l,2),f=d[0],m=d[1],b=Object(s.useState)(void 0),v=Object(i.a)(b,2),h=v[0],g=v[1],E=Object(s.useState)([]),k=Object(i.a)(E,2),O=k[0],j=k[1],y=Object(s.useCallback)(function(e){void 0===e?t.loadSequence(n.newSequence):t.loadSequence(n.newSequence,parseInt(e))},[n]);Object(s.useEffect)(function(){Ct(n.newSequence).then(g)},[g]);var w=Object(s.useCallback)(function(e){O.includes(e)?j(O.filter(function(t){return t!==e})):j([].concat(Object(p.a)(O),[e]))},[O,j]);return h&&0!==h.length?u.a.createElement("div",{className:"expanded-project"},u.a.createElement("div",{className:"expanded-toolbar"},h[0]&&h[0][0]&&u.a.createElement(bt,{patterns:h[0][0].patterns.length,patternNumber:c,setPatternNumber:o}),u.a.createElement(gt,{subSequences:h.length,subSequence:f,setSubSequence:m}),u.a.createElement("div",{onClick:function(){return y()},className:"load-project-btn"},"Load Entire Project")),u.a.createElement(Tt,{loadModule:function(){return y(f)},sequencerEngine:t,onClickTrack:w,selectedTracks:O,patternNumber:c,moduleName:qt[f],sub:h[f]})):[]}),Rt=n(792);function Dt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return At(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return At(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Lt={},zt=function(e,t){return new Promise(function(){var n=Object(o.a)(c.a.mark(function n(a){return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t in Lt)){n.next=3;break}if(Lt[t].lenggth!==e.length){n.next=3;break}return n.abrupt("return",a(Object(p.a)(Lt[t])));case 3:return n.t0=fetch,n.t1=JSON,n.next=7,He.a.getAccount();case 7:n.t2=n.sent,n.t3=0===e.length,n.t4=e,n.t5={user:n.t2,all:n.t3,ids:n.t4},n.t6=n.t1.stringify.call(n.t1,n.t5),n.t7={Accept:"application/json","Content-Type":"appliction/json"},n.t8={method:"POST",body:n.t6,headers:n.t7},(0,n.t0)("/querySample/",n.t8).then(function(e){return e.json()}).then(function(e){var n=[];if(!e||!Array.isArray(e))return Lt[t]=n,a(n);var r,c=Dt(e);try{for(c.s();!(r=c.n()).done;){var o=r.value,i=new yt.a(o.id);i.name=o.title,i.packs=o.packs,i.videoId=o.videoId,i.favorited=5===o.rating,i.blockNumber=o.blockNumber,i.sampledByUser=o.user,i.artistName=o.artistName,i.releaseName=o.releaseName,i.guildId=o.guildId,i.year=o.year,i.discogsId=o.discogsId,i.coverArtHash=""===o.coverArtHash?void 0:o.coverArtHash,i.tags=Array.from(new Set(o.tags||[])),n.push(i)}}catch(s){c.e(s)}finally{c.f()}Lt[t]=n,a(n)});case 15:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}())};window.getBulkSampleInfo=zt;n(2382);function Ht(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ut(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function Ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Gt=new b.a,Ft=Be.a.presets,Bt=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={},a=Ht(t),e.prev=2,a.s();case 4:if((r=a.n()).done){e.next=11;break}return o=r.value,e.next=8,Ft.getPresetTitle(o);case 8:n[o]=e.sent;case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}},e,null,[[2,13,16,19]])}));return function(t){return e.apply(this,arguments)}}(),Wt=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.projectHash,n=e.metadata,a=n&&n.thumbnailHash?m.a.getHashUrl(n.thumbnailHash):void 0,r=Object(s.useState)({}),c=Object(i.a)(r,2),o=c[0],l=c[1],d=Object(s.useState)([]),f=Object(i.a)(d,2),p=f[0],b=f[1];return Object(s.useEffect)(function(){n&&n.presets&&Bt(n.presets).then(l)},[n,l]),Object(s.useEffect)(function(){n&&n.samples&&0!==n.samples.length&&zt(n.samples,t).then(function(e){return b(e.filter(function(e){return e.name}))})},[n,b,t]),n?(console.log("we had metadata=",a),u.a.createElement("div",{className:"project-metadata"},a&&u.a.createElement("img",{src:a,className:"project-thumbnail"}),Object.keys(o).length>0&&u.a.createElement("div",{className:"presets"},Object.keys(o).map(function(e){return u.a.createElement("div",{className:"preset-name"},u.a.createElement("div",{className:"dot",style:{backgroundColor:Gt.getColorForHash(e)}}),o[e])})),p.length>0&&u.a.createElement("div",{className:"samples"},p.map(function(e){return u.a.createElement("div",{className:"sample-name"},Object(Rt.a)(e.tags[0]||e.name))})))):""}),Vt=$e.y.SEQUENCE_METADATA.options.address,Qt={},Jt={},_t=new(function(){function e(){Object(Se.a)(this,e)}return Object(Ce.a)(e,[{key:"tagSequence",value:function(){var e=Object(o.a)(c.a.mark(function e(t,n){var a,r=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>2&&void 0!==r[2]?r[2]:0,e.abrupt("return",new _e.a($e.u,"tagSequence",[Object(Ke.c)(t),Object(Ke.b)(n),a]).execute());case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"starSequence",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,e.abrupt("return",new _e.a($e.u,"starSequence",[Object(Ke.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"favoriteSequence",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,e.abrupt("return",new _e.a($e.u,"favoriteSequence",[Object(Ke.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"unstarSequence",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,e.abrupt("return",new _e.a($e.u,"unstarSequence",[Object(Ke.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"unfavoriteSequence",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,e.abrupt("return",new _e.a($e.u,"unfavoriteSequence",[Object(Ke.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"isSequenceFavorited",value:function(){var e=Object(o.a)(c.a.mark(function e(t,n){var a,r,o,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=n.toLowerCase(),!((a=t+n)in Qt)){e.next=4;break}return e.abrupt("return",Qt[a]);case 4:return e.next=6,new Ye.a(Vt).from(Xe.nb).select("ipfsHash").where("ipfsHash",t).where("user",n).executeQuery();case 6:return r=e.sent,e.next=9,new Ye.a(Vt).from(Xe.qb).select("ipfsHash").where("ipfsHash",t).where("user",n).executeQuery();case 9:return o=e.sent,i=r.length-o.length,Qt[a]=i>0,e.abrupt("return",Qt[a]);case 13:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"isSequenceStarred",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in Jt)){e.next=2;break}return e.abrupt("return",Jt[t]);case 2:return e.next=4,new Ye.a(Vt).from(Xe.ob).select("ipfsHash").where("ipfsHash",t).executeQuery();case 4:return n=e.sent,e.next=7,new Ye.a(Vt).from(Xe.rb).select("ipfsHash").where("ipfsHash",t).executeQuery();case 7:return a=e.sent,Jt[t]=n.length-a.length>0,e.abrupt("return",Jt[t]);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTags",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ye.a(Vt).from(Xe.pb).select("tag").where("ipfsHash",t).executeQuery();case 2:return n=e.sent,e.abrupt("return",n.map(function(e){return e.tag}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getStarredSequences",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a,r,o,i,s,u=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u.length>0&&void 0!==u[0]?u[0]:0,e.next=3,new Ye.a(Vt).from(Xe.ob).select("ipfsHash").where("guildId",0).executeQuery();case 3:return t=e.sent,e.next=6,new Ye.a(Vt).from(Xe.rb).select("ipfsHash").where("guildId",0).executeQuery();case 6:for(r in n=e.sent,a={},t)(o=t[r]).ipfsHash in a||(a[o.ipfsHash]=0),a[o.ipfsHash]++;for(i in n)(s=n[i]).ipfsHash in a||(a[s.ipfsHash]=0),a[s.ipfsHash]--;return e.abrupt("return",Object.keys(a).filter(function(e){return a[e]>0}));case 11:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getFavoritedSequences",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,i,s,u,l,d=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:0,t=t.toLowerCase(),e.next=4,new Ye.a(Vt).from(Xe.nb).select("ipfsHash").where("user",t).where("guildId",n).executeQuery();case 4:return a=e.sent,e.next=7,new Ye.a(Vt).from(Xe.qb).select("ipfsHash").where("user",t).executeQuery();case 7:for(i in r=e.sent,o={},a)(s=a[i]).ipfsHash in o||(o[s.ipfsHash]=0),o[s.ipfsHash]++;for(u in r)(l=r[u]).ipfsHash in o||(o[l.ipfsHash]=0),o[l.ipfsHash]--;return e.abrupt("return",Object.keys(o).filter(function(e){return o[e]>0}));case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getFavorites",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,i,s,u,l,d,f,m,p;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ye.a(Vt).from(Xe.nb).select("ipfsHash").select("user").where("ipfsHash",t).executeQuery();case 2:return n=e.sent,e.next=5,new Ye.a(Vt).from(Xe.qb).select("ipfsHash").select("user").where("ipfsHash",t).executeQuery();case 5:for(i in a=e.sent,r={},o={},n)s=n[i],(u=n[i].user)in r||(r[u]=0,o[u]=[]),r[u]++,o[u].push(s);for(l in a)a[l],(d=a[l].user)in r||(r[d]=0),r[d]--;f=[],e.t0=c.a.keys(r);case 12:if((e.t1=e.t0()).done){e.next=20;break}if(m=e.t1.value,!(r[m]<=0)){e.next=16;break}return e.abrupt("continue",12);case 16:p=o[m],f.push(p[p.length-1]),e.next=12;break;case 20:return e.abrupt("return",f);case 21:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),e}()),Yt=function(e){var t=e.track,n=e.guildId,a=void 0===n?0:n,r=Object(s.useState)(!1),u=Object(i.a)(r,2),l=u[0],d=u[1],f=Object(s.useState)(!1),m=Object(i.a)(f,2),p=m[0],b=m[1],v=Object(s.useState)(!1),h=Object(i.a)(v,2),g=h[0],E=h[1];function k(){return(k=Object(o.a)(c.a.mark(function e(n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.stopPropagation(),He.a.isLoggedIn()){e.next=3;break}return e.abrupt("return");case 3:l?(_t.unfavoriteSequence(t.id,a),d(!1)):(_t.favoriteSequence(t.id,a),d(!0));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function O(){return(O=Object(o.a)(c.a.mark(function e(n){var r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.stopPropagation(),e.next=3,He.a.getAccount();case 3:if(r=e.sent,Kt(r,t.user)){e.next=6;break}return e.abrupt("return");case 6:p?(_t.unstarSequence(t.id,a),b(!1)):(_t.starSequence(t.id,a),b(!0),E(!0));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(s.useEffect)(function(){!function(e,t){Xt.apply(this,arguments)}(t.id,d),function(e,t,n){Zt.apply(this,arguments)}(t,E,b)},[t.blockNumber,b,E,t]),{showStar:g,isStarred:p,isFavorited:l,onStarClicked:function(e){return O.apply(this,arguments)},onFavoriteClicked:function(e){return k.apply(this,arguments)}}};function Zt(){return(Zt=Object(o.a)(c.a.mark(function e(t,n,a){var r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,He.a.getAccount();case 2:return r=e.sent,e.next=5,_t.isSequenceStarred(t.id);case 5:((o=e.sent)||Kt(r,t.user))&&n(!0),a(o);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Xt(){return(Xt=Object(o.a)(c.a.mark(function e(t,n){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,He.a.getAccount();case 2:if(void 0!==(a=e.sent)){e.next=5;break}return e.abrupt("return");case 5:return e.t0=n,e.next=8,_t.isSequenceFavorited(t,a);case 8:e.t1=e.sent,(0,e.t0)(e.t1);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Kt=function(e,t){return void 0!==e&&void 0!==t&&e.toLowerCase()===t.toLowerCase()},$t=n(305),en=n(484),tn=n(43);function nn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return an(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return an(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function an(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var rn=new b.a,cn=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,i,s,l,d=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:8,a={},e.prev=2,e.next=5,window.sequencerEngine.encryptedIpfs.getJson(t.newSequence,t.guildId,5e3);case 5:if("object"===typeof(a=e.sent)){e.next=8;break}return e.abrupt("return","");case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(2),console.log("ERROR = ",e.t0),e.abrupt("return","");case 14:return e.next=16,sn(Object(en.a)(a));case 16:for(s in r=e.sent,o=[],i=[],a.subSequences)o=[].concat(Object(p.a)(o),Object(p.a)(a.subSequences[s].tracks.map(function(e){return e.map(function(e){return Object.keys(e).filter(function(e){return Object(tn.a)(e)}).map(parseFloat).filter(function(e){return e<32})})}))),i=[].concat(Object(p.a)(i),Object(p.a)(a.subSequences[s].tracksData.map(function(e){return on("SAMPLER"===e.type?e.samplers:e.presetName||e.type)})));return l=r.filter(function(e){return e.getThumbnail()}),e.abrupt("return",{graphic:[u.a.createElement("div",{className:"bpm"},a.bpm)].concat(Object(p.a)(o.map(function(e,t){return u.a.createElement("div",{key:"track-"+t,className:"track-graphic"},e[0].map(function(e,a){return u.a.createElement("div",{key:t+"-"+e+"-step",style:{left:e*n,backgroundColor:i[t]},className:"step-graphic"})}))})),[l.length>0?u.a.createElement("div",{className:"work-sounds"},l.map(function(e){return u.a.createElement($t.a,{sample:e})})):""]),bpm:a.bpm,wallpaper:a.wallpaper});case 22:case"end":return e.stop()}},e,null,[[2,10]])}));return function(t){return e.apply(this,arguments)}}(),on=function(e){if("object"===typeof e&&(e=Object.keys(e)[0]),void 0!==e)return rn.saturate(rn.getColorForHash(e),3)},sn=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=nn(t),e.prev=2,a.s();case 4:if((r=a.n()).done){e.next=12;break}return o=r.value,i=new yt.a(o),e.next=9,i.load(!1);case 9:n.push(i);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),a.e(e.t0);case 17:return e.prev=17,a.f(),e.finish(17);case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}},e,null,[[2,14,17,20]])}));return function(t){return e.apply(this,arguments)}}();function un(e){return e.getMonth()+1+"/"+e.getDate()}var ln=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=l.a).getItem("blockDate."+t)){e.next=3;break}return e.abrupt("return",new Date(1e3*n.getItem("blockDate."+t)));case 3:if(void 0!==t){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.next=7,G.a.eth.getBlock(t);case 7:if(null!==(a=e.sent)){e.next=10;break}return e.abrupt("return",new Date);case 10:return r=new Date(1e3*a.timestamp),n.setItem("blockDate."+t,a.timestamp),e.abrupt("return",r);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),dn=(n(2384),new b.a),fn=Object(f.b)(function(e,t){return{}},function(e){return{setShowProjectsModal:function(t){return e(Object(d.Oe)(t))}}})(function e(t){var n=t.project,a=t.sequencerEngine,r=t.expanded,l=t.odd,d=t.setExpandedProject,f=t.setShowProjectsModal,p=t.viewMode,b=Object(s.useState)(void 0),v=Object(i.a)(b,2),h=v[0],g=v[1],E=Object(s.useState)(void 0),k=Object(i.a)(E,2),O=k[0],j=k[1],y=Object(s.useState)(""),w=Object(i.a)(y,2),S=w[0],C=w[1],x=Object(s.useState)([]),N=Object(i.a)(x,2),q=N[0],T=N[1],M=Object(s.useState)(void 0),I=Object(i.a)(M,2),P=I[0],R=I[1],D=Object(s.useState)(void 0),A=Object(i.a)(D,2),L=(A[0],A[1],Object(s.useState)("")),z=Object(i.a)(L,2),H=z[0],U=z[1];n.id=n.newSequence;var G=Yt({track:n}),F=G.isFavorited,B=G.isStarred;Object(s.useEffect)(function(){n.guildId?Be.a.guildSequences._decryptQueryResult(n).then(function(e){return U(e.title)}):U(n.title)},[n,U]),Object(s.useEffect)(function(){O?function(e){return new Promise(function(){var t=Object(o.a)(c.a.mark(function t(n,a){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("getting edits for project=",e),r={project:e},fetch("/projectEdits/",{method:"POST",body:JSON.stringify(r),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){n(e)});case 3:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}(n.newSequence).then(function(e){console.log("edits for project = ",n.title,e),T(e)}):T([])},[O,n]),Object(s.useEffect)(function(){Be.a.users.getUserName(n.user).then(function(e){return C(e||n.user)}),ln(n.blockNumber).then(function(e){return g(e)}),n.guildId?Be.a.guilds.getGuildName(n.guildId).then(R):R(void 0)},[n,C,g]);var W=Object(s.useCallback)(function(){r?(f(!1),a.loadSequence(n.newSequence)):d(n)},[d,n,r]),V={color:S?dn.getColorForHash(S):""},Q=(S&&dn.getColorForHash(S),{});P&&(Q.color=dn.getColorForHash(P));var J="project-option";r&&(J+=" expanded"),n.metadata&&(J+=" has-metadata");var _=u.a.createElement("div",{className:J},u.a.createElement("div",{className:"project-name"},H),u.a.createElement("div",{style:V,className:"project-author"},S),n.edits>0?u.a.createElement("div",{onClick:function(){return j(!O)},className:O?"edits-btn showing":"edits-btn"},n.edits," Edits"):"",F?u.a.createElement("div",{className:"heart favorited"}):"",B?u.a.createElement("div",{className:"star starred"},u.a.createElement("span",null,"\u2606")):"",u.a.createElement("div",{className:"p-metadata"},n.Metadata.patternsCount>0&&u.a.createElement("div",{className:"project-bpm"},u.a.createElement("div",{style:{width:60*Math.min(1,n.bpm/200)},className:"bpm-slider"}),u.a.createElement("div",{className:"bpm-text"},"BPM: ",n.Metadata.BPM)),n.Metadata.patternsCount>0?u.a.createElement("div",{className:"project-patterns"},u.a.createElement("div",{className:"bpm-text"},n.Metadata.patternsCount," ",u.a.createElement("span",{className:"patterns"},"patterns"))):"",""!==n.Metadata.thumbnailHash?u.a.createElement("div",{className:"project-visual"},u.a.createElement("img",{className:"visual-thumbnail",src:m.a.getHashUrl(n.Metadata.thumbnailHash)})):""),u.a.createElement("div",{className:"project-date"},h?un(h):""),n.contentKey?u.a.createElement("div",{className:"private-project"},"Private"):"",P?u.a.createElement("div",{style:Q,className:"project-guild"},P):"",n.isLocal?u.a.createElement("div",{className:"local-only"},"Not Synced"):"");if(O)return u.a.createElement("div",{className:"expanded-project"},_,u.a.createElement("div",{className:"project-edits"},q.map(function(t){return u.a.createElement(e,{setExpandedProject:d,expanded:r,project:t,sequencerEngine:a})})));var Y=n.Metadata?"project-option-wrapper has-metadata":"project-option-wrapper";return l&&(Y+=" odd"),"GRID"===p&&(Y+=" pushable"),u.a.createElement("div",{onClick:W,className:Y},_,u.a.createElement(Wt,{projectHash:n.newSequence,metadata:n.Metadata}))}),mn=n(591),pn=Object(f.b)(function(e,t){return{guildId:e.guilds.selectedGuild?e.guilds.selectedGuild.guildId:0}},function(e){return{}})(function(e){var t=e.guildId,n=e.viewMode,a=e.sequencerEngine,r=e.searchTerm,c=e.filterMine,o=e.setExpandedProject,l=e.expandedProject,d=e.starred,f=e.favorited,m=e.old,p=e.songs,b=Object(s.useState)([]),v=Object(i.a)(b,2),h=v[0],g=v[1],E=Object(s.useState)(!1),k=Object(i.a)(E,2),O=k[0],j=k[1],y=Object(s.useRef)(void 0),w=Object(ot.a)(y,24,!0,r,l).size;Object(s.useEffect)(function(){l||(j(!0),Object(mn.a)(r,c,d,f,void 0,void 0,t,void 0,m).then(function(e){j(!1),"GRID"===n&&(e=e.filter(function(e){return e.Metadata&&e.Metadata.thumbnailHash})),p&&(e=e.filter(function(e){return e.Metadata&&e.Metadata.patternsCount>0})),g(e)}))},[p,n,r,m,g,c,j,l,d,f,t]);var C={height:window.innerHeight-216},x=l?"has-expanded-project sequences-list":"sequences-list";return"GRID"===n&&(x+=" grid-mode"),u.a.createElement("div",{ref:y,style:C,className:x},O?u.a.createElement(S.a,{text:"Loading Projects"}):l?u.a.createElement("div",{className:"project-and-back"},u.a.createElement("div",{onClick:function(){return o(void 0)},className:"selector-back-button"}),u.a.createElement(fn,{setExpandedProject:o,viewMode:n,sequencerEngine:a,project:l,expanded:!0})):h.slice(0,w).map(function(e,t){return u.a.createElement(fn,{viewMode:n,odd:t%2===1,key:t+"-"+e.newSequence,setExpandedProject:o,sequencerEngine:a,project:e})}),l?u.a.createElement(Pt,{project:l,sequencerEngine:a}):"")});n(1083);var bn=n(119),vn=n(160),hn=[{value:"day",label:"Day"},{value:"tag",label:"Tag"}],gn=0,En=Object(f.b)(function(e,t){return{}},function(e){return{setContextualHelp:function(t,n){return e(Object(d.hb)(t,n))}}})(function(e){var t=e.setContextualHelp,n=e.onChange,a=e.displayOption,r=e.setDisplayOption,c=e.quickAddSearchText,o=e.groupBy,l=e.setGroupBy,d=e.hideFilter,f=e.setFilterFavorites,p=e.filterFavorites,b=e.sourceToSearch,v=e.children,h=Object(s.useRef)(void 0),g=Object(s.useState)(c),E=Object(i.a)(g,2),k=E[0],O=E[1],j=Object(s.useState)(void 0),y=Object(i.a)(j,2),w=y[0],S=y[1];Object(s.useEffect)(function(){return window.addEventListener("keydown",C),function(){return window.removeEventListener("keydown",C)}},[]);var C=Object(s.useCallback)(function(e){"/"===e.key&&(e.ctrlKey||e.metaKey)||"ArrowDown"!==e.key&&"ArrowUp"!==e.key||(e.preventDefault(),h.current.blur())},[]);Object(s.useEffect)(function(){h.current.focus()},[]),Object(s.useEffect)(function(){if(b){var e=b.videoId,t=b.releaseId;t?Be.a.getCoverArtForDiscogs(t).then(function(e){var t=e.coverArtHash;return S(m.a.getHashUrl(t))}):S(function(e){return""===e||void 0===e?"":"https://img.youtube.com/vi/"+e+"/1.jpg"}(e))}else S(void 0)},[b,S]);var x=Object(s.useCallback)(function(e){var t=++gn,a=e.target.value;O(a),setTimeout(function(){t===gn&&n(a)},600)},[O,n]);return Object(s.useEffect)(function(){c&&O(c)},[c,O]),u.a.createElement(vn.a,{element:bn.Y,className:"entire-search-container"},v,u.a.createElement("div",{className:"search-rest"},u.a.createElement("div",{className:"search-container"},u.a.createElement("input",{ref:h,placeholder:"Type to search",autoComplete:"off",type:"text",value:k,onKeyDown:C,onChange:x,id:"sample-search-input"}),w?u.a.createElement("img",{src:w,className:"source-to-search"}):"",u.a.createElement("div",{onClick:function(){return x({target:{value:""}})},className:"search-clear-button"},"x"),void 0!==r?u.a.createElement("img",{onMouseOver:function(e){e.stopPropagation(),t(bn.V)},onMouseLeave:function(){return t(void 0)},onClick:function(){return r("GRID")},className:"GRID"===a?"selected":"",src:"/grid-icon.png"}):"",void 0!==r?u.a.createElement("img",{onMouseOver:function(e){e.stopPropagation(),t(bn.W)},onMouseLeave:function(){return t(void 0)},onClick:function(){return r("LIST")},className:"LIST"===a?"selected":""!==k||p?"":"disabled",src:"/list-icon.png"}):""),d?"":u.a.createElement("div",{className:"filter-options"},u.a.createElement("div",{className:p?"favorited heart":"heart",onClick:function(){return f(!p)}}),u.a.createElement(ke.a,{onChange:function(e){return l(e.value)},value:hn.find(function(e){return e.value===o}),options:hn}))))}),kn=Object(f.b)(function(e,t){return{expandedProject:e.selector.expandedProject}},function(e){return{setExpandedProject:function(t){return e(Object(d.Lb)(t))}}})(function(e){var t=Object(s.useState)(""),n=Object(i.a)(t,2),a=n[0],r=n[1],c=Object(s.useState)(He.a.isLoggedIn()),o=Object(i.a)(c,2),l=o[0],d=o[1],f=Object(s.useState)(!1),m=Object(i.a)(f,2),p=m[0],b=m[1],v=Object(s.useState)("LIST"),h=Object(i.a)(v,2),g=h[0],E=h[1],k=Object(s.useState)(!1),O=Object(i.a)(k,2),j=O[0],y=O[1],w=Object(s.useState)(!1),S=Object(i.a)(w,2),C=S[0],x=S[1],N=Object(s.useState)(!1),q=Object(i.a)(N,2),T=q[0],M=q[1],I=e.setExpandedProject,P=e.expandedProject,R=Object(s.useCallback)(function(e){r(e)},[r]);return u.a.createElement("div",{className:"new-selector sequences"},u.a.createElement("div",{className:"search-and-back"},u.a.createElement(En,{onChange:R,hideFilter:!0})),P?"":u.a.createElement(dt,{songs:T,setSongs:M,viewMode:g,setViewMode:E,favorited:p,old:j,setOld:y,starred:C,setFavorited:b,setStarred:x,setFilterMine:d,filterMine:l}),u.a.createElement(pn,{expandedProject:P,viewMode:g,setExpandedProject:I,songs:T,sequencerEngine:e.sequencerEngine,old:j,favorited:p,starred:C,searchTerm:a,filterMine:l}))}),On=(n(2385),Object(f.b)(function(e,t){return{}},function(e){return{setShowProjectsModal:function(t){return e(Object(d.Oe)(t))}}})(function(e){var t=Object(s.useCallback)(function(){e.setShowProjectsModal(!1)},[]);return u.a.createElement(q.a,{dialogClassName:"projects-modal",show:!0,onHide:t},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,"Projects")),u.a.createElement(q.a.Body,null,u.a.createElement(kn,{sequencerEngine:e.sequencerEngine})))})),jn=n(794),yn=n(31),wn=(n(419),n(1219)),Sn=n.n(wn);function Cn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var xn=function(e){Object(xe.a)(n,e);var t=Cn(n);function n(e){var a;return Object(Se.a)(this,n),(a=t.call(this,e)).state={username:"",password:"",loginFailed:!1},a.onClickDone=a.onClickDone.bind(Object(yn.a)(a)),a.onClickCancel=a.onClickCancel.bind(Object(yn.a)(a)),a}return Object(Ce.a)(n,[{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"onClickDone",value:function(){var e=Object(o.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.signingUp){e.next=4;break}He.a.signUp(this.state.userName,this.state.password),e.next=12;break;case 4:return e.next=6,He.a.login(this.state.userName,this.state.password);case 6:if(e.sent){e.next=10;break}return this.setState({loginFailed:!0}),e.abrupt("return");case 10:this.props.transactionUponLogin&&(this.props.transactionUponLogin.execute(),this.props.clearTransactions()),Be.a.guilds.acceptAnyNewRequests();case 12:this.setState({loginFailed:!1}),this.props.hide();case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickCancel",value:function(){this.props.setSigningUp(!1),this.props.hide()}},{key:"render",value:function(){var e=this;return u.a.createElement(q.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,this.props.signingUp?"Sign Up":"Log In")),u.a.createElement(q.a.Body,null,u.a.createElement(Ue.a,{condition:this.state.loginFailed},"The username/password you entered was incorrect. Please try again."),u.a.createElement(Ue.a,{condition:this.props.transactionUponLogin},"Need to login again to save your transaction with us."),u.a.createElement(T.h,null,u.a.createElement(T.g,{onChange:function(t){return e.setState({userName:t.target.value})},value:this.state.userName,placeholder:"Enter your username",className:"email-address-input"})),u.a.createElement(Sn.a,{id:"password",name:"password",placeholder:"Enter password",value:this.state.password,onChange:this.handlePasswordChange.bind(this)}),!this.props.signingUp&&u.a.createElement("div",{className:"sign-up-text"},"No account yet? Chill, you can sign up ",u.a.createElement("span",{onClick:function(){return e.props.setSigningUp(!0)},className:"sign-up-here pushable"},"here"),".")),u.a.createElement(q.a.Footer,null,u.a.createElement(T.b,{variant:"secondary",onClick:this.onClickDone},"Done"),u.a.createElement(T.b,{variant:"primary",onClick:this.onClickCancel},"Cancel")))}}]),n}(s.Component),Nn=Object(f.b)(function(e){return{transactionUponLogin:e.transactions.transactionUponLogin,signingUp:e.sequencer.signingUp}},function(e){return{setSigningUp:function(t){return e(Object(d.cf)(t))},hide:function(t){return e(Object(d.He)(!1))},clearTransactions:function(){return e(Object(d.Uf)(void 0))}}})(xn),qn=n(795),Tn=n(198);function Mn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var In=function(e){Object(xe.a)(n,e);var t=Mn(n);function n(){return Object(Se.a)(this,n),t.apply(this,arguments)}return Object(Ce.a)(n,[{key:"render",value:function(){var e=this;if(0===this.props.guildOptions.length&&!this.props.showPublic)return u.a.createElement("div",{className:"guild-options-container"},"You are not a part of any guilds yet. To create one, go ",u.a.createElement("a",{href:"/guilds"},"here"),".");return u.a.createElement("div",{className:"guild-options-container"},"Only members of selected guild will have access",u.a.createElement("div",{className:"guild-options"},u.a.createElement(Ue.a,{condition:this.props.showPublic},u.a.createElement(Pn,{guild:{guildId:0,name:"Public"},onClick:function(){return e.props.onSelectGuild(void 0)},isSelected:void 0===this.props.selectedGuild})),this.props.guildOptions.map(function(t){return u.a.createElement(Pn,{guild:t,onClick:function(){return e.props.onSelectGuild(t)},isSelected:e.isSelected(t)})})))}},{key:"isSelected",value:function(e){return void 0===this.props.selectedGuild?0===e.id:this.props.selectedGuild.guildId===e.guildId}}]),n}(s.Component),Pn=function(e){Object(xe.a)(n,e);var t=Mn(n);function n(){return Object(Se.a)(this,n),t.apply(this,arguments)}return Object(Ce.a)(n,[{key:"render",value:function(){var e="guild-option";return this.props.isSelected&&(e+=" selected"),u.a.createElement("div",{onClick:this.props.onClick,className:e},this.props.guild.name)}}]),n}(s.Component),Rn=In;function Dn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}s.Component;var An=n(208),Ln=n.n(An);function zn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}s.Component,n(262);function Hn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}s.Component,n(301);var Un=n(411);function Gn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var Fn=function(e){Object(xe.a)(n,e);var t=Gn(n);function n(e){var a;return Object(Se.a)(this,n),(a=t.call(this,e)).state={nameValue:"",isEffects:!1,guildOptions:[],saveOption:Un.c,selectedGuild:void 0,guildIds:[]},a.input=void 0,a.onClickDone=a.onClickDone.bind(Object(yn.a)(a)),a.onClickCancel=a.onClickCancel.bind(Object(yn.a)(a)),console.log("PRESET CONS"),a}return Object(Ce.a)(n,[{key:"getPresetGuilds",value:function(){var e=Object(o.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getGuilds(),this.input&&this.input.focus(),this.getPresetGuilds()}},{key:"getGuilds",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be.a.guilds.getGuildsForUser();case 2:t=e.sent,void 0!==this.props.selectedGuild&&this.setState({saveOption:Un.a}),this.setState({selectedGuild:this.props.selectedGuild,guildOptions:t.filter(function(e){return e.name.split(",").length<2})});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onSelectGuild",value:function(e){this.setState({selectedGuild:e})}},{key:"selectedZObject",get:function(){var e=this.props.sequencerEngine.state.zobject.selectedZObject,t=this.props.sequencerEngine.state.zobject.viewableSubPatches,n=e||t&&t[0]&&t[0].zObject;return n.getObjectType()!==Tn.e&&n.getObjectType()!==Tn.a&&(n=void 0),n}},{key:"isZObject",value:function(){return void 0!==this.selectedZObject}},{key:"onClickDone",value:function(){var e=this.selectedZObject;e?e.getObjectType()===Tn.a?Object(qn.b)(e.getJson(!0),this.state.nameValue):this.props.sequencerEngine.saveZObjectPreset(e,this.state.nameValue):this.props.sequencerEngine.saveTrackPreset(this.props.track.trackNumber,this.state.nameValue,this.state.isEffects,void 0===this.state.selectedGuild?0:this.state.selectedGuild.guildId),this.props.onHide()}},{key:"onClickCancel",value:function(){this.props.onHide()}},{key:"onInputType",value:function(e){this.setState({nameValue:e})}},{key:"handleCheckboxChange",value:function(e){this.setState({isEffects:"track"!==e.target.name})}},{key:"login",value:function(){this.props.setShowLogin(!0)}},{key:"render",value:function(){var e=this;if(!this.props.userToken)return u.a.createElement(q.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,"Save Preset")),u.a.createElement(q.a.Body,null,u.a.createElement("span",{onClick:function(){return e.login()},className:"login-btn"},"Login")," to save preset"));var t=this.selectedZObject;return u.a.createElement(q.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,t?"Save Object Preset ("+t.name+")":"Save Preset")),u.a.createElement(q.a.Body,null,u.a.createElement("input",{value:this.state.nameValue,onChange:function(t){return e.onInputType(t.target.value)},ref:function(t){e.input=t},placeholder:"Type name of preset",className:"tag-input"}),!t&&u.a.createElement("form",null,u.a.createElement("input",{name:"track",type:"checkbox",checked:!this.state.isEffects,onChange:function(t){return e.handleCheckboxChange(t)}}),u.a.createElement("label",null,"Track"),u.a.createElement("input",{name:"effects",type:"checkbox",checked:this.state.isEffects,onChange:function(t){return e.handleCheckboxChange(t)}}),u.a.createElement("label",null,"Effects"))),u.a.createElement(q.a.Footer,null,u.a.createElement(T.b,{variant:"secondary",onClick:this.onClickDone},"Save"),u.a.createElement(T.b,{variant:"primary",onClick:this.onClickCancel},"Cancel")))}}]),n}(s.Component),Bn=Object(f.b)(function(e){var t=e.presets.trackPresetSaving;return{userToken:e.sequencer.userToken,selectedGuild:e.guilds.selectedGuild,track:t,show:t}},function(e){return{setContextualHelp:function(t){return e(Object(d.hb)(t))},setShowLogin:function(t){return e(Object(d.He)(t))},onHide:function(){return e(Object(d.If)(void 0))}}})(Fn);function Wn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}s.Component;function Vn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}s.Component;var Qn=function(e){Object(xe.a)(n,e);var t=Vn(n);function n(e){var a;return Object(Se.a)(this,n),(a=t.call(this,e)).state={date:""},a.fetchDate(),a}return Object(Ce.a)(n,[{key:"fetchDate",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.ethereum.web3.eth.getBlock(this.props.blockNumber);case 2:t=e.sent,n=new Date(1e3*t.timestamp).toLocaleString(),this.setState({date:n});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"accept",value:function(){this.props.ethereum.guilds.acceptRequestToAddToGuild(this.props.guildId),this.props.onAccept()}},{key:"reject",value:function(){this.props.ethereum.guilds.rejectRequestToAddToGuild(this.props.guildId),this.props.onReject()}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"new-member-request"},u.a.createElement("div",{className:"user-field"},u.a.createElement("a",{className:"user-hyperlink",href:"/user/"+this.props.userName},this.props.userName)),u.a.createElement("div",{className:"action-description"},"requested to add you to ",this.props.guildName),u.a.createElement("span",{className:"action-date"},this.state.date),u.a.createElement("div",{className:"action-btns"},u.a.createElement("div",{onClick:function(){return e.accept()},className:"common-button pink-button"},"ACCEPT"),u.a.createElement("div",{onClick:function(){return e.reject()},className:"common-button pink-button"},"REJECT")))}}]),n}(s.Component),Jn=Object(f.b)(function(e){return{toast:e.explore.toast}},function(e){return{setExploreToast:function(t){return e(Object(d.Qb)(t))}}})(function(e){var t=e.toast,n=e.setExploreToast;return t?u.a.createElement("div",{className:"toast-box"},u.a.createElement("div",{onClick:function(){return n(void 0)},className:"delete-button"},"x"),t):u.a.createElement("div",null)}),_n=function(e){var t=Object(s.useState)([]),n=Object(i.a)(t,2),a=n[0],r=n[1];Object(s.useEffect)(function(){Be.a.guilds.getNewMemberRequests().then(function(e){r(e)})},[r]);var c=Object(s.useCallback)(function(e){Be.a.guilds.acceptRequestToAddToGuild(e.guildId);var t=Object(p.a)(a),n=a.indexOf(e);t.splice(n,1),r(t)},[r,a]);return 0===a.length?u.a.createElement("div",null):u.a.createElement("div",{className:"guild-requests"},a.map(function(e){return u.a.createElement(Yn,{accept:function(){return c(e)},request:e})}))},Yn=function(e){var t=e.request,n=e.accept;return u.a.createElement("div",{className:"guild-request"},"You've been invited to join",u.a.createElement("span",{className:"guild-name"},t.guildName),u.a.createElement("span",{onClick:n,className:"accept-button"},"Accept"))};function Zn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var Xn=function(e){Object(xe.a)(n,e);var t=Zn(n);function n(){return Object(Se.a)(this,n),t.apply(this,arguments)}return Object(Ce.a)(n,[{key:"render",value:function(){var e=this;return u.a.createElement("div",null,u.a.createElement("div",{className:"passphrase-label"},"Name of new guild:"),u.a.createElement(T.h,{className:"guild-name-input-group"},u.a.createElement(T.g,{autoComplete:"off",onChange:function(t){return e.props.onNameChange(t.target.value)},value:this.props.name,placeholder:"Type name for guild",id:"guild-name-input"})),u.a.createElement("div",{className:"passphrase-label"},"Encrypted with passphrase:"),u.a.createElement(T.h,{className:"guild-name-input-group"},u.a.createElement(T.g,{autoComplete:"off",onChange:function(t){return e.props.onPassphraseChange(t.target.value)},value:this.props.passphrase,placeholder:"Type passphrase for guild",id:"passphrase-input"})))}}]),n}(s.Component),Kn=function(e){var t=Object(s.useState)(""),n=Object(i.a)(t,2),a=n[0],r=n[1],l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],m=d[1],p=Object(s.useCallback)(Object(o.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Be.a.guilds.newGuild(a,f);case 2:e.done();case 3:case"end":return t.stop()}},t)})),[a,f]);return u.a.createElement("div",{className:"create-new-guild"},u.a.createElement(Xn,{name:a,passphrase:f,onNameChange:r,onPassphraseChange:m}),u.a.createElement("div",{className:"toolbar"},u.a.createElement("div",{onClick:p,className:"done-button"},"Create"),u.a.createElement("div",{onClick:e.cancel,className:"cancel-button"},"Cancel")))};function $n(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ea(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ea(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ta=function(e){var t=e.guild,n=Object(s.useState)([]),a=Object(i.a)(n,2),r=a[0],l=a[1];return Object(s.useEffect)(function(){t&&Be.a.guilds.getNewMemberRequestsFromGuild(t.guildId).then(function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=$n(t),e.prev=2,a.s();case 4:if((r=a.n()).done){e.next=13;break}return o=r.value,e.t0=n,e.next=9,Be.a.users.getUserName(o.newMember);case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t2=e.catch(2),a.e(e.t2);case 18:return e.prev=18,a.f(),e.finish(18);case 21:l(Array.from(new Set(n)));case 22:case"end":return e.stop()}},e,null,[[2,15,18,21]])}));return function(t){return e.apply(this,arguments)}}())},[t,l]),0===r.length?u.a.createElement("div",null):(console.log("requests = ",r),u.a.createElement("div",{className:"outbound-requests"},u.a.createElement("div",{className:"requests-header"},"Pending Invites"),r.map(function(e){return u.a.createElement("div",null,e)})))},na=function(e){var t=e.user,n=e.inviteUser;return u.a.createElement("div",{onClick:function(){return n(t)},className:"potential-user"},t)},aa=n(299),ra=n(757);function ca(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return oa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oa(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function oa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ia=Object(f.b)(null,function(e){return{setExploreToast:function(t){return e(Object(d.Qb)(t))}}})(function(e){var t=e.guild,n=e.setExploreToast,a=(e.numPending,e.onHide),r=e.onLeftGuild,l=Object(s.useState)(0),d=Object(i.a)(l,2),f=d[0],m=d[1],p=Object(s.useState)(0),b=Object(i.a)(p,2),v=b[0],h=b[1],g=Object(s.useState)(!1),E=Object(i.a)(g,2),k=E[0],O=E[1],j=Object(s.useState)([]),y=Object(i.a)(j,2),w=y[0],S=y[1];Object(s.useEffect)(function(){Be.a.encryption.getPotentialUsers().then(function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=ca(t),e.prev=2,a.s();case 4:if((r=a.n()).done){e.next=13;break}return o=r.value,e.t0=n,e.next=9,Be.a.users.getUserName(o);case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t2=e.catch(2),a.e(e.t2);case 18:return e.prev=18,a.f(),e.finish(18);case 21:S(n.filter(function(e){return e&&""!==e}));case 22:case"end":return e.stop()}},e,null,[[2,15,18,21]])}));return function(t){return e.apply(this,arguments)}}())},[S]),Object(s.useEffect)(function(){if(void 0!==t){var e=new Ye.a((new aa.a).contractAddress).from(Xe.cb).select("ipfsHash").where("guildId",t.guildId);e.executeQuery().then(function(e){return m(new Set(e.map(function(e){return e.ipfsHash})).size)}),(e=new Ye.a((new ra.a).contractAddress).from(Xe.w).select("contentHash").where("guildId",t.guildId)).executeQuery().then(function(e){return h(new Set(e.map(function(e){return e.contentHash})).size)}),O(!1)}},[t,m,h,O]);var C=Object(s.useCallback)(function(e){console.log("invite user =",e),Be.a.users.getUserId(e).then(function(a){Be.a.guilds.requestToAddMember(t.guildId,a),n("Invited "+e+" to "+t.name)})},[t]),x=Object(s.useCallback)(function(){Be.a.guilds.leaveGuild(t.guildId),r(t),a()},[t,a]);if(void 0===t)return u.a.createElement("div",null);var N=t.members.map(function(e){return e.userName});return u.a.createElement("div",{className:"guild-details"},u.a.createElement(Ue.a,{condition:k},u.a.createElement("div",{className:"guild-members inviting"},u.a.createElement("div",{className:"invite-header"},"Invite"),u.a.createElement("div",{className:"people-container"},w.filter(function(e){return-1===N.indexOf(e)}).map(function(e){return u.a.createElement(na,{inviteUser:C,user:e})})),u.a.createElement("div",{onClick:function(){return O(!1)},className:"cancel-button"},"Cancel"))),u.a.createElement(Ue.a,{condition:!k},u.a.createElement("div",{className:"guild-members"},u.a.createElement("div",{className:"members-header"},"Members"),u.a.createElement("div",{className:"people-container"},t.members.map(function(e){return u.a.createElement("div",{className:"member"},e.userName)})),u.a.createElement("div",{onClick:function(){return O(!0)},className:"invite-button"},"Invite"))),u.a.createElement("div",{className:"guild-stats"},u.a.createElement("div",{className:"samples-count"},f," samples"),u.a.createElement("div",{className:"samples-count"},v," sequences"),u.a.createElement(ta,{guild:t}),u.a.createElement("div",{onClick:x,className:"leave-guild-btn"},"Leave Group")))}),sa=function(e){var t="guild-option";return e.selected&&(t+=" selected"),u.a.createElement("div",{onClick:e.onClick,className:t},e.guild.name)},ua=Object(f.b)(function(e,t){return{numPending:e.transactions.pendingTransactions.length}},null)(function(e){var t=e.numPending,n=Object(s.useState)(void 0),a=Object(i.a)(n,2),r=a[0],l=a[1],d=Object(s.useState)(!1),f=Object(i.a)(d,2),m=f[0],b=f[1],v=Object(s.useState)(!1),h=Object(i.a)(v,2),g=h[0],E=h[1],k=Object(s.useState)([]),O=Object(i.a)(k,2),j=O[0],y=O[1],w=Object(s.useCallback)(function(){S(),b(!1)},[y,b]);Be.a.guilds.newGuildCallback=w;var S=Object(s.useCallback)(function(){Be.a.guilds.getGuildsForUser().then(function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],e.t0=c.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=14;break}if(a=e.t1.value,!((r=t[a]).name.split(",").length>=2)){e.next=7;break}return e.abrupt("continue",2);case 7:return e.next=9,Be.a.guilds.getUsersInGuild(r.guildId);case 9:o=e.sent,r.members=o,n.push(r),e.next=2;break;case 14:y(n);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},[y,t]);Object(s.useEffect)(function(){S()},[y]);var C=Object(s.useCallback)(function(e){var t=j.indexOf(e),n=Object(p.a)(j);n.splice(t,1),y(n)},[j,y]);return g?u.a.createElement("div",{className:"explore-guilds"},u.a.createElement(Kn,{done:function(){E(!1),b(!0)},cancel:function(){return E(!1)}})):u.a.createElement("div",{className:"explore-guilds"},u.a.createElement("div",{className:"top-bar"},u.a.createElement("div",{onClick:function(){return E(!0)},className:"create-guild-button"},"Create New Group"),u.a.createElement(Jn,null),u.a.createElement(_n,null)),u.a.createElement(Ue.a,{condition:m},"Syncing guild changes",u.a.createElement(Ln.a,{sizeUnit:"px",size:10,color:"#42f4f1",loading:!0})),u.a.createElement("div",{className:"guilds-content"},u.a.createElement("div",{className:"guilds-chooser"},j.map(function(e){return u.a.createElement(sa,{selected:e===r,onClick:function(){return l(e)},guild:e})})),u.a.createElement(ia,{onLeftGuild:C,onHide:function(){return l(void 0)},guild:r})))}),la=Object(f.b)(function(e,t){return{isManaging:e.guilds.isManaging}},function(e){return{setIsManagingGuilds:function(t){return e(Object(d.jc)(t))}}})(function(e){var t=e.isManaging,n=e.setIsManagingGuilds;return t?(console.log("MANAGING"),u.a.createElement(q.a,{dialogClassName:"preset-modal guilds-modal",show:!0,onHide:function(){return n(!1)}},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,"Groups")),u.a.createElement(q.a.Body,null,u.a.createElement(ua,null)),u.a.createElement(q.a.Footer,null,u.a.createElement(T.b,{variant:"secondary",onClick:function(){return n(!1)}},"Done")))):[]}),da=(Object(f.b)(function(e,t){return{trackPresetSaving:e.presets.trackPresetSaving,showLogin:e.sequencer.showLogin,transcribing:e.sequencer.isTranscribing,loadingText:e.sequencer.loadingText,loadingSequence:e.sequencer.loadingSequence,uploadingFile:e.sequencer.uploadingFile,showSettings:e.sequencer.showSettings,hicDialog:e.nft.hicDialog,zoraDialog:e.nft.zoraDialog,isPreparingNFT:e.nft.isPreparingNFT,showProjectsModal:e.spatial.showProjectsModal,trackToConvert:e.tracks.trackToConvert,pluginToSave:e.plugins.pluginToSave,showFreezeModal:e.freeze.showFreezeModal}},function(e){return{}})(function(e){var t=Object.keys(e.loadingSequence).some(function(t){return e.loadingSequence[t]});return u.a.createElement("div",{className:"modals-container"},u.a.createElement(Ue.a,{condition:e.showLogin},u.a.createElement(Nn,{show:e.showLogin})),e.hicDialog&&u.a.createElement(D,{hicDialog:e.hicDialog}),e.zoraDialog&&u.a.createElement(le,{data:e.zoraDialog,sequencerEngine:e.sequencerEngine}),t?u.a.createElement(jn.a,{sequencerEngine:e.sequencerEngine}):"",e.isPreparingNFT&&u.a.createElement(w,{sequencerEngine:e.sequencerEngine,text:e.isPreparingNFT}),e.loadingText?u.a.createElement(S.a,{text:e.loadingText,sequencerEngine:e.sequencerEngine}):"",e.transcribing?u.a.createElement(S.a,{text:"Transcribing",sequencerEngine:e.sequencerEngine}):"",u.a.createElement(la,null),e.uploadingFile?u.a.createElement(S.a,{text:"Uploading File",sequencerEngine:e.sequencerEngine}):"",e.showSettings?u.a.createElement(lt,{sequencerEngine:e.sequencerEngine}):"",e.trackPresetSaving?u.a.createElement(Bn,{sequencerEngine:e.sequencerEngine}):"",e.showProjectsModal?u.a.createElement(On,{sequencerEngine:e.sequencerEngine}):"",e.trackToConvert?u.a.createElement(I.a,{show:!0,track:e.trackToConvert,sequencerEngine:e.sequencerEngine}):"",e.showFreezeModal&&u.a.createElement(R,{sequencerEngine:e.sequencerEngine}),e.pluginToSave&&u.a.createElement(M,{zobject:e.pluginToSave}))}),Object(f.b)(function(e,t){return{step:t.sequencerEngine.trackStep,isSequenceRolling:t.sequencerEngine.isSequenceRolling}},function(e){return{}})(function(e){var t=e.step,n=void 0===t?0:t,a=e.isSequenceRolling,r=e.sequencerEngine,c=void 0,o=void 0,i="";if(a){var s=r.tracks[0];if(s){var l=s.getFactoredResolution().getNumberOfStepsAtBaseResolution();s.patternRollStepNumber,s.pattern.stepBuckets.length,c=l,o=s.patternRollStepNumber}c=c;var d=o,f={left:4*Math.floor(d/4)%32*96/32+"vw",width:4*Math.floor(c/4)%32*96/32+"vw"};i=u.a.createElement("div",{className:"playhead roll-visualizer",style:f})}var m={left:4*Math.floor(n/4)%32*100/32+"vw"};return[i,u.a.createElement("div",{style:m,className:"playhead"})]})),fa=(n(1504),n(2515),Object(f.b)(function(e,t){return{wallpaper:e.sequencer.wallpaper}},function(e){return{setIsPlayingMix:function(t){return e(Object(d.lc)(t))}}})(function(e){var t=e.sequencerEngine;e.wallpaper;return u.a.createElement("div",{className:"exhibit"},t?u.a.createElement(da,{sequencerEngine:t}):"",u.a.createElement(O,{sequencerEngine:t,row:0}),u.a.createElement(O,{sequencerEngine:t,row:1}),u.a.createElement(O,{sequencerEngine:t,row:2}),u.a.createElement(O,{sequencerEngine:t,row:3}),u.a.createElement(O,{sequencerEngine:t,row:4}),u.a.createElement(O,{sequencerEngine:t,row:5}))}),n(162)),ma=(n(1496),n(665)),pa=function(e){var t=e.setToggled,n=e.toggled,a=e.url,r=void 0===a?"/zequencer-logo-hiero.svg":a;return u.a.createElement("img",{onClick:function(){return t(!n)},className:n?"logo-hiero toggled":"logo-hiero",src:r})},ba=n(194),va=n(310),ha=Object(f.b)(function(e,t){return{pulledEffects:e.effects.pulledEffects}},function(e){return{}})(function(e){var t=e.track,n=e.pulledEffects,a=Object(s.useState)(t.midiEffects.effects),r=Object(i.a)(a,2),c=r[0],o=r[1],l=Object(s.useCallback)(function(e){var n=Object(ba.d)(e,t);t.sequencerEngine.operationManager.dispatch(Object(ft.b)(n,t)),o(Object(p.a)(t.midiEffects.effects))},[o,c,t]),d=Object(s.useCallback)(function(){o(Object(p.a)(t.midiEffects.effects))},[c,o]);return u.a.createElement("div",{className:"effects-overview"},c.map(function(e){return u.a.createElement(va.a,{sequencerEngine:t.sequencerEngine,isPulled:n.includes(e),key:e.id,onDeleteEffect:d,effect:e,track:t,tracks:t.sequencerEngine.tracks,onEffectsChange:function(){return[]}})}),u.a.createElement("div",{className:"add-effect-type"},u.a.createElement(ke.a,{className:"delay-time-dropdown",option:void 0,options:ba.f,onChange:function(e){return l(e.value)},placeholder:"MIDI FX"})))}),ga=Object(f.b)(function(e,t){var n=t.pad.sequencerEngine.tracks[e.mix.selectedTrack];return{selectedTrack:e.mix.selectedTrack,loaded:n&&n.getSampler(0),tracks:t.pad.tracks}},function(e){return{}})(function(e){e.div,e._track,e.pad,e.selectedTrack}),Ea=n(1534),ka=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=Object(s.useRef)(void 0),a="";return t.getTrackType()===jt.f?a=u.a.createElement(ga,{div:n,pad:t,_track:t}):t.getTrackType()===jt.b&&t.getInstrumentType()===Ot.f&&(a=u.a.createElement(Ea.a,{sequencerEngine:t.sequencerEngine,track:t,instrument:t.instrument})),u.a.createElement("div",{ref:n,className:"instrument-overview"},a)}),Oa=n(392),ja=Object(f.b)(function(e,t){return{pulledEffects:e.effects.pulledEffects}},function(e){return{}})(function(e){var t=e.track,n=e.pulledEffects,a=Object(s.useState)(t.effects),r=Object(i.a)(a,2),c=r[0],o=r[1],l=Object(s.useCallback)(function(e){var n=Object(ba.c)(e,t.sequencerEngine);n.enable(!0),t.sequencerEngine.operationManager.dispatch(Object(ft.b)(n,t)),o(Object(p.a)(t.effects))},[o,c,t]),d=Object(s.useCallback)(function(){o(Object(p.a)(t.effects))},[c,o]);return u.a.createElement("div",{className:"effects-overview"},c.map(function(e){return u.a.createElement(Oa.a,{sequencerEngine:t.sequencerEngine,isPulled:n.includes(e),key:e.id,onDeleteEffect:d,effect:e,track:t,tracks:t.sequencerEngine.tracks,onEffectsChange:function(){return[]}})}),u.a.createElement("div",{className:"add-effect-type"},u.a.createElement(ke.a,{className:"delay-time-dropdown",option:void 0,options:ba.a,onChange:function(e){return l(e.value)},placeholder:"Audio FX"})))}),ya=n(793),wa=Object(f.b)(function(e,t){var n=t.track;n&&n.tracks&&n.tracks[0]&&(n=n.tracks[0].track);var a=e.mix.selectedTrack===t.track.trackNumber&&t.track.sequencerEngine.currentSubSequence===t.track.subSequence,r=(e.tracks.trackIsEnabled[t.track.subSequence.id]||{})[t.track.id];return{isSelected:a,id:void 0===n?0:void 0!==n.sample&&void 0!==n.sample.getId()?n.sample.getId():n.presetName||n.getName(),isEnabled:r,numEffects:n.effects.length}},function(e){return{setTrackDragging:function(t){return e(Object(d.wf)(t))}}})(function(e){var t=e.track,n=e.isSelected,a=e.isEnabled,r=e.setTrackDragging,c=e.setExpandTrack,o=e.numEffects,l=Object(ya.a)(t,t.sample),d=Object(s.useState)(void 0),f=Object(i.a)(d,2),m=f[0],p=f[1],b="tr-overview";n&&(b+=" selected"),Object(s.useEffect)(function(){c(m?{id:t.id,numEffects:o}:void 0)},[o,m,c,t]);var v=Object(s.useCallback)(function(){t.sequencerEngine.selectTrack(t.trackNumber)},[t]);return u.a.createElement("div",{onClick:v,className:b},u.a.createElement("div",{className:"tr-inner"},u.a.createElement("div",{className:"track-number"},t.trackNumber+1),u.a.createElement("div",{onClick:function(){return t.toggleEnabled()},className:a?"dot enabled":"dot"}),u.a.createElement("div",{onClick:function(){return p("M_FX"===m?void 0:"M_FX")},className:"M_FX"===m?"m-fx showing":"m-fx"},"m. fx"),u.a.createElement("img",{className:"right-arr",src:"/right-arrow.svg"}),u.a.createElement("div",{draggable:!0,onMouseDown:function(e){return e.stopPropagation()},onDragStart:function(e){e.stopPropagation(),r(t)},onDragOver:function(e){return e.preventDefault()},onClick:function(){return p("INST"===m?void 0:"INST")},style:{backgroundColor:t.color},className:"INST"===m?"inst showing":"inst"},l),u.a.createElement("img",{className:"right-arr",src:"/right-arrow.svg"}),u.a.createElement("div",{onClick:function(){return p("A_FX"===m?void 0:"A_FX")},className:"A_FX"===m?"a-fx showing":"a-fx"},"fx")),"INST"===m&&u.a.createElement(ka,{track:t}),"A_FX"===m&&u.a.createElement(ja,{track:t}),"M_FX"===m&&u.a.createElement(ha,{track:t}))}),Sa=n(342),Ca=(n(2587),Object(f.b)(function(e,t){return{coords:e.windows.windowPositions[t.subSequence.id],numTracks:t.subSequence.tracks&&t.subSequence.tracks.length}},function(e){return{}})(function(e){var t=e.setOrdering,n=e.ordering,a=e.scale,r=e.subSequence,c=e.scrollContainer,o=e.elements,l=e.sizeRef,d=e.size,f=e.setSize,m=(e.isCurrent,e.padsExpand,e.coords),p=(e.isSelected,Object(s.useRef)(void 0)),b=Object(s.useState)(void 0),v=Object(i.a)(b,2),h=v[0],g=v[1],E=Object(Sa.a)({scale:a,ref:p,sequencerEngine:r.sequencerEngine,windowPosition:m,sizeRef:l,expand:h?r.tracks.length+h.id+h.numEffects:r.tracks.length,containerRef:c,size:d,setSize:f,elements:o,element:r,setOrdering:t,ordering:n}),k=E.style,O=(E.onContextMenu,E.onMouseDown),j=E.onMouseUp;E.setCoords;Object(s.useEffect)(function(){m&&(r.x=m.x,r.y=m.y)},[m]);var y=Object(A.a)({},k);return m&&(y=Object(A.a)({},k,{top:m.y,left:m.x})),u.a.createElement("div",{style:y,className:"module-overview",onMouseDown:O,onMouseUp:j,ref:p},r.tracks.map(function(e){return u.a.createElement(wa,{setExpandTrack:g,track:e})}))}),n(1522)),xa=n(150),Na=(n(527),new b.a),qa=n(634),Ta=n(227),Ma=Object(f.b)(function(e,t){return{drawingEdge:e.pads.drawingEdges[t.pad.subSequence.id]}},function(e){return{setDrawingPadEdge:function(t,n){return e(Object(d.wb)(t,n))}}})(function(e){var t=e.setDrawingPadEdge,n=e.isSpeaker,a=e.drawingEdge,r=e.fx,c=e.pad,o=e.id,i="effect-input-"+(void 0===o?r.id:o),l=Object(s.useCallback)(function(e){if(a){var o=a.effect,i=a.rack,s=a.outputNumber;(i=i||c.effectRack).connectNodes(o,n?void 0:r,s),t(c.subSequence.id,void 0)}},[a]);return u.a.createElement("div",{onMouseUp:l,id:i,className:"effect-input"})}),Ia=n(59),Pa=Object(f.b)(function(e,t){return{}},function(e){return{setDrawingPadEdge:function(t,n){return e(Object(d.wb)(t,n))}}})(function(e){var t=e.isControl,n=e.containerRef,a=e.pad,r=e.setDrawingPadEdge,c=e.fx,o=e.rack,i=e.id,l=void 0===i?c.id:i,d=e.coords,f=e.nodeRef,m=e.outputNumber,p="effect-output-"+l;void 0!==m&&(p="effect-output-"+m+"-"+l);var b=Object(s.useRef)(void 0),v=Object(Ta.a)({ref:b}),h=v.onContextMenu,g=v.dropdownPos,E=v.setDropdownPos,k=Object(s.useRef)({x:0,y:0});Object(s.useEffect)(function(){if(d&&f&&f.current){var e=d.x,t=d.y;e+=f.current.offsetWidth+20,k.current.x=e,k.current.y=t}},[d]);var O=Object(s.useCallback)(function(e){n.current.getBoundingClientRect();var i=e.clientX,s=e.clientY,u=(a.state.spatial.edgesPadding,{effect:t?c.inputNode:c,outputNumber:m,rack:o,x1:i,y1:s,x2:i,y2:s});e.stopPropagation(),r(a.subSequence.id,u)},[]),j=c.getEffectType&&c.getEffectType()===Ia.c,y={};return c.numberOfOutputs>1&&(y.top=30+20*m+"%"),u.a.createElement("div",{ref:b,style:y,onContextMenu:h,id:p,onMouseDown:O,className:"effect-output"},!t&&u.a.createElement(qa.a,{isMidi:j,setDropdownPos:E,outputNumber:m,dropdownPosRef:k,effectOptions:j?ba.f:Object(ba.a)(),initializeEffect:j?ba.d:ba.c,dropdownPos:g,effect:c,node:a}))}),Ra=Object(f.b)(function(e,t){return t.pad.effectRack?{coords:e.windows.windowPositions[t.pad.effectRack.outputNode.id],isSelected:e.windows.selectedElements[t.pad.effectRack.outputNode.id]}:{}},function(e){return{}})(function(e){var t=e.isMidi,n=e.pad,a=e.isSelected,r=e.coords,c=Object(xa.a)(e,["isMidi","pad","isSelected","coords"]),o=Object(s.useRef)(void 0),i=Object(Ta.a)({ref:o}),l=i.onContextMenu,d=i.dropdownPos,f=i.setDropdownPos,m=Object(s.useRef)({x:0,y:0}),p=Object(Sa.a)(Object(A.a)({ref:o,element:n.effectRack&&n.effectRack.outputNode,windowPosition:r,sequencerEngine:n.sequencerEngine},c)),b=p.style,v=(p.isDragging,p.onMouseDown),h=p.onMouseUp,g=(p.setCoords,function(e){var t=e.id;return{backgroundColor:Na.getColorForHash(t)}}({id:n&&n.effectRack&&n.effectRack.id}));Object(s.useEffect)(function(){r&&(m.current={x:r.x+150,y:r.y+150})},[r]);var E="pad-effect-control speakers";a&&(E+=" selected");var k=Object(A.a)({},b,g);return t&&(delete k.backgroundColor,E+=" midi-speakers"),r&&(k.left=r.x,k.top=r.y),n&&n.effectRack?[u.a.createElement("div",{key:1,onContextMenu:function(e){l(e),p.onContextMenu(e)},onMouseDown:v,onMouseUp:h,ref:o,style:k,className:E},t?u.a.createElement("div",{className:"speaker-name"},"Out"):u.a.createElement("img",{draggable:!1,src:"/speakers.svg"}),t?"":u.a.createElement(qa.a,{effectOptions:ba.a,initializeEffect:ba.c,dropdownPosRef:m,dropdownPos:d,setDropdownPos:f,node:n}),u.a.createElement(Ma,{isSpeaker:!0,id:n.effectRack.id+"-speakers",containerRef:c.containerRef,pad:n,fx:n.effectRack.outputNode}))]:""}),Da=(n(970),new b.a),Aa=Object(f.b)(function(e,t){return{coords:e.windows.windowPositions[t.pad.effectRack.id],isCollapsed:e.effects.effectCollapsed[t.pad.effectRack.id],isSelected:e.windows.selectedElements[t.pad.effectRack.id],isMacroMapping:e.effects.isMacroMapping,hidden:e.spatial.hiddenObjects[t.pad.id]}},function(e,t){return{setParameterToMap:function(t){return e(Object(d.md)(t))},setIsCollapsed:function(n){return e(Object(d.Bb)(t.pad.effectRack.id,n))}}})(function(e){var t=e.pad,n=e.setIsCollapsed,a=e.isCollapsed,r=e.coords,c=e.isSelected,o=Object(xa.a)(e,["pad","setIsCollapsed","isCollapsed","coords","isSelected"]),i=Object(s.useRef)(void 0),l=Object(s.useRef)(void 0),d=t.fxMacro.macroParameter;Object(s.useEffect)(function(){n(t.effectRack.isCollapsed)},[]),Object(s.useEffect)(function(){t.effectRack.isCollapsed=a},[a]);var f=Object(Ta.a)({ref:i}),m=f.onContextMenu,p=f.dropdownPos,b=f.setDropdownPos,v=Object(s.useRef)({x:0,y:0}),h=Object(Sa.a)(Object(A.a)({ref:i,element:t.effectRack,windowPosition:r,sequencerEngine:t.sequencerEngine},o)),g=h.style,E=(h.isDragging,h.onMouseDown),k=h.onMouseUp;h.setCoords;Object(s.useEffect)(function(){r&&(v.current={x:r.x+100,y:r.y+50})},[r]);var O=Object(s.useCallback)(function(e){e.stopPropagation(),o.isMacroMapping&&(d.isMapped||o.setParameterToMap(d));var r=(new Date).getTime();e.stopPropagation(),r-l.current<=450&&(t.effectRack.isCollapsed=!a,n(!a)),l.current=r},[o.isMacroMapping,n,a]),j="pad-effect-control";a||(j+=" expanded"),c&&(j+=" selected");var y=Object(A.a)({},g,{backgroundColor:Da.getColorForHash(t.effectRack.id)});return r&&(y.left=r.x,y.top=r.y),o.isMacroMapping&&(j+=" plane-mapping"),o.hidden?"":[u.a.createElement("div",{onClick:O,key:1,onContextMenu:function(e){m(e),h.onContextMenu(e)},onMouseDown:E,onMouseUp:k,ref:i,style:y,className:j},u.a.createElement("div",{className:"control-inner"},u.a.createElement(Y.a,{color:"white",name:"",parameter:t.fxMacro.macroParameter}),u.a.createElement(qa.a,{allowSendsOnly:!0,effectOptions:ba.a,initializeEffect:ba.c,addToBack:!1,dropdownPosRef:v,setDropdownPos:b,dropdownPos:p,node:t}),u.a.createElement(Ma,{containerRef:o.containerRef,pad:t,fx:t.effectRack}),!a&&u.a.createElement(Pa,{outputNumber:0,isControl:!0,containerRef:o.containerRef,pad:t,fx:t.effectRack}),u.a.createElement("div",{className:"control-name"},"FX")))]}),La=n(522),za=n(523),Ha=n(972),Ua=n(1417),Ga=n(914),Fa=n(393),Ba=n(669),Wa=n(331),Va=n(951),Qa=n(889),Ja=new b.a,_a=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.onDeleteEffect,n=e.sequencerEngine,a=e.instrumentPart,r=Object(s.useState)(void 0),c=Object(i.a)(r,2),o=c[0],l=c[1],d=Object(s.useState)(void 0),f=Object(i.a)(d,2),m=f[0],p=f[1],b=a.effect,v=a.instrument,h=a.track,g=a.type,E=a.subType,k="",O=u.a.createElement("div",{className:"pulled-header"},v&&g===Wa.d&&u.a.createElement("div",{className:"lfo-name"},"LFO ",v.number),v&&"MODULE_ENVELOPE"===g&&u.a.createElement("div",{className:"lfo-name"},"Envelope ",v.number),h&&u.a.createElement("div",{style:{backgroundColor:Ja.getColorForTrack(h)},className:"effect-from"},h.envelopesTrack?h.name:h.trackNumber+1+". "+h.getName()),u.a.createElement("div",{onClick:t,className:"delete-button"},"-")),j=Ja.getColorForTrack(h);if(g===Wa.e)k=u.a.createElement(Ba.a,{isDraggable:!1,setOscillatorDetails:l,oscillatorDetails:o,showWaveform:m,setShowWaveform:p,color:j,sequencerEngine:n,instrument:v});else if("SYNTH_ENVELOPE"===g){var y;"Amp"===E?y=v.ampEnvelope:"A"===E?y=v.oscillatorNodes[1].ampEnvelope:"B1"===E?y=v.oscillatorNodes[2].ampEnvelope:"B2"===E&&(y=v.oscillatorNodes[3].ampEnvelope),console.log("subtype = ",E),k=u.a.createElement(Fa.a,{instrument:v,width:200,fillColor:j,lineColor:j,sequencerEngine:n,envelope:y,name:E,hasRelease:!0,hasLevel:!1})}else"MODULE_ENVELOPE"===g?k=u.a.createElement(Fa.a,{name:"Env "+E,envelope:v,width:200,hasRelease:!0,hasLevel:!1,sequencerEngine:n}):g===Wa.f?k=u.a.createElement(Qa.a,{effect:b}):g===Wa.c?k=u.a.createElement(Va.a,{isDraggable:!1,effect:b}):g===Wa.b?k=u.a.createElement(Ga.a,{isDraggable:!1,effect:b}):g===Wa.a?k=u.a.createElement(Ua.a,{isDraggable:!1,color:j,sequencerEngine:n,instrument:v}):g===Wa.d&&(k=u.a.createElement(Ha.a,{isDraggable:!1,hideName:!0,lfo:v,sequencerEngine:n}));return u.a.createElement("div",{className:"pulled-instrument"},O,k)}),Ya=n(541),Za=(n(1446),Object(f.b)(function(e,t){return{coords:e.windows.windowPositions[t.fx.id],isCollapsed:e.effects.effectCollapsed[t.fx.id],numberOfOutputs:t.fx.numberOfOutputs,isSelected:e.windows.selectedElements[t.fx.id]}},function(e){return{}})(function(e){var t=e.fx,n=e.scale,a=e.containerRef,r=e.sequencerEngine,c=e.setSize,o=e.elements,i=e.size,l=e.sizeRef,d=e.setOrdering,f=e.ordering,m=e.rack,p=e.coords,b=e.isSelected,v=e.onDelete,h=e.showDelete,g=e.isCollapsed,E=e.pad,k=e.isStatic,O=Object(s.useRef)(void 0),j=Object(Sa.a)({scale:n,ref:O,sequencerEngine:r,sizeRef:l,windowPosition:p,containerRef:a,size:i,setSize:c,elements:o,element:t,expand:g,setOrdering:d,ordering:f}),y=j.style,w=j.onContextMenu,S=j.isDragging,C=j.onMouseDown,x=j.onMouseUp,N=(j.setCoords,"pulled-effect");S&&(N+=" dragging"),b&&(N+=" selected");var q=Object(A.a)({},y);p&&(q.left=p.x,q.top=p.y);var T=t.numberOfOutputs||1,M=new Array(T).fill(0).map(function(e,t){return t});return[u.a.createElement("div",{key:1,style:q,onContextMenu:w,onMouseDown:k?function(){return[]}:C,onMouseUp:k?function(){return[]}:x,ref:O,className:N},t.instrument?u.a.createElement(_a,{onDeleteEffect:v,showStar:!0,sequencerEngine:r,instrumentPart:t}):t.getEffectType()===Ia.a?u.a.createElement(Oa.a,{showDelete:h,isDraggable:!1,sequencerEngine:r,showStar:!0,featured:!0,track:t.track,compact:!0,instrument:!0,onDeleteEffect:v,effect:t,send:void 0}):t.getEffectType()===Ia.b?u.a.createElement(Ya.a,{featured:!0,isDraggable:!1,sequencerEngine:r,showStar:!0,onDeleteEffect:v,effect:t,track:t.track,onEffectsChange:function(){return[]}}):u.a.createElement(va.a,{showDelete:h,isDraggable:!1,featured:!0,sequencerEngine:r,track:t.track,showStar:!0,compact:!0,instrument:!0,onDeleteEffect:v,effect:t,send:void 0}),E&&u.a.createElement(Ma,{containerRef:a,fx:t,pad:E}),E&&M.map(function(e){return u.a.createElement(Pa,{nodeRef:O,rack:m,coords:p,outputNumber:e,containerRef:a,fx:t,pad:E})}),u.a.createElement(La.a,{effect:t}),u.a.createElement(za.a,{subSequence:t.track&&t.track.subSequence,containerRef:a,scale:n,effect:t}))]})),Xa=Object(f.b)(function(e,t){var n=t.track.effectRack&&t.track.effectRack.id;return{effects:e.pads.trackMidiEffects[t.track.id],isCollapsed:e.effects.effectCollapsed[n]}},function(e){return{}})(function(e){var t=e.track,n=(e.effects,e.isCollapsed),a=Object(xa.a)(e,["track","effects","isCollapsed"]),r=Object(s.useCallback)(function(e){t.effectRack.deleteEffect(e),t.updateMidiEffectsRedux()},[]);return t.effectRack&&t.zObject&&!n?[u.a.createElement(Ra,Object.assign({isMidi:!0,key:5,pad:t},a)),,].concat(Object(p.a)(t.effectRack.effects.map(function(e){return u.a.createElement(Za,Object.assign({onDelete:r,key:e.id,fx:e,rack:t.effectRack,showDelete:!0,sequencerEngine:t.sequencerEngine,pad:t},a))}))):[]}),Ka=function(e){var t="ztoolbar-option  ";return e.expanded&&(t+=" selected"),e.hideOnPadSequencer&&(t+=" hide-on-pad-sequencer"),u.a.createElement("div",Object.assign({},e,{className:t}),u.a.createElement("img",Object.assign({},e,{onClick:function(){return 0}})))},$a=function(e){e.subSequence;var t=e.type,n=e.drag;return u.a.createElement("div",{className:"modulator-expansion"},u.a.createElement("div",{className:"modulator-type"},"MODULE_ENVELOPE"===t?"Envelopes":"LFOs"),[1,2,3,4].map(function(e){return u.a.createElement("div",{draggable:!0,onDragStart:function(){return n(t+" "+e)},className:"modulator-number"},e)}))},er=Object(f.b)(function(e,t){var n=t.subpatch||t.subSequence;return{uxLocked:e.zobject.uxLocked,showLFOs:e.sequencer.showLFOs,showEnvelopes:e.sequencer.showEnvelopes,showPadSequencer:e.spatial.showPadSequencer,presentationMode:n.presentationMode}},function(e){return{setShowEnvelopes:function(t){return e(Object(d.Ae)(t))},setShowLFOs:function(t){return e(Object(d.Ge)(t))},setTypeDragging:function(t){return e(Object(d.zg)(t))},setUXLocked:function(t){return e(Object(d.ag)(t))},setShowModulators:function(t){return e(Object(d.Ie)(t))},setPresentationMode:function(t){return e(Object(d.Cd)(t))}}})(function(e){e.setPresentationMode;var t=e.presentationMode,n=e.showPadSequencer,a=e.setShowEnvelopes,r=e.showLFOs,c=e.showEnvelopes,o=e.setShowLFOs,l=e.children,d=e.subpatch,f=e.subSequence,m=e.setTypeDragging,p=e.setUXLocked,b=(e.setShowModulators,e.uxLocked),v=Object(s.useState)(void 0),h=Object(i.a)(v,2),g=h[0],E=h[1],k=Object(s.useState)(void 0),O=Object(i.a)(k,2),j=O[0],y=O[1],w=Object(s.useRef)(0);Object(s.useEffect)(function(){return g?window.addEventListener("mouseup",S):window.removeEventListener("mouseup",S),function(){return window.removeEventListener("mouseup",S)}},[g,E]);var S=Object(s.useCallback)(function(){E(void 0)},[g,E]),C=Object(s.useCallback)(function(e){m(e),y(void 0),e.includes("LFO")||e.includes("MODULE_ENVELOPE")||E(void 0),w.current++},[E,y]),x=Object(s.useCallback)(function(e){var t=w.current;setTimeout(function(){t===w.current&&y(e)},250)},[y]),N=Object(s.useCallback)(function(){w.current++,y(void 0)},[]),q=Object(s.useCallback)(function(){p(!b)},[b]),T=Object(s.useCallback)(function(){var e=d||f;console.log("setting presentation mode = ",!e.presentationMode,e),e.presentationMode=!e.presentationMode},[d,f,t]),M="",I=0;if(j)switch(j){case"zobject":M="Drag an object into the canvas",I=0;break;case"zmessage":M="Drag a message box into the canvas",I=1;break;case"zcomment":M="Drag a comment box into the canvas",I=2;break;case"zbutton":M="Drag a button into the canvas",I=3;break;case"ztoggle":M="Drag a toggle into the canvas",I=5;break;case"znumber":M="Drag a number button into the canvas",I=6;break;case"zpad":M="Drag a drum pad into the canvas",I=5;break;case"sequencer":M="Drag a step sequencer into the canvas",I=7;break;case"zlock":M="Toggle the UI to lock in place or be editable",I=8}var P="zobject-toolbar";return n&&(P+=" showing-pad-sequencer"),u.a.createElement("div",{className:P},j&&u.a.createElement("div",{className:"toolbar-tooltip",style:{left:25*I}},M),u.a.createElement(Ka,{onMouseOver:function(){return x("zobject")},onMouseLeave:N,hideOnPadSequencer:!0,draggable:"true",onDragStart:function(){return C("zobject")},src:"/zobject-light.svg"}),u.a.createElement(Ka,{onMouseLeave:N,hideOnPadSequencer:!0,onMouseOver:function(){return x("zmessage")},draggable:"true",onDragStart:function(){return C("zmessage")},src:"/zmessage-light.svg"}),u.a.createElement(Ka,{onMouseLeave:N,hideOnPadSequencer:!0,onMouseOver:function(){return x("zcomment")},draggable:"true",onDragStart:function(){return C("zcomment")},src:"/zcomment-light.svg"}),u.a.createElement(Ka,{draggable:"true",hideOnPadSequencer:!0,onMouseLeave:N,onMouseOver:function(){return x("zbutton")},onDragStart:function(){return C("zbutton")},src:"/zbutton-light.svg"}),u.a.createElement(Ka,{draggable:"true",onMouseLeave:N,hideOnPadSequencer:!0,onMouseOver:function(){return x("ztoggle")},onDragStart:function(){return C("ztoggle")},src:"/ztoggle-light.svg"}),u.a.createElement(Ka,{draggable:"true",onMouseLeave:N,hideOnPadSequencer:!0,onMouseOver:function(){return x("znumber")},onDragStart:function(){return C("znumber")},src:"/znumber-light.svg"}),!d&&u.a.createElement(Ka,{draggable:"true",onMouseLeave:N,hideOnPadSequencer:!0,onMouseOver:function(){return x("zpad")},onDragStart:function(){return C("zpad")},src:"/zpad-light.svg"}),!d&&u.a.createElement(Ka,{className:r?"expanded":"",expanded:r,draggable:"false",onClick:function(){return o(!r)},src:"/zlfo-light.svg"}),!d&&u.a.createElement(Ka,{draggable:"false",expanded:c,className:c?"expanded":"",onClick:function(){return a(!c)},src:"/zenvelope-light.svg"}),g&&u.a.createElement($a,{drag:C,subSequence:f,type:g}),u.a.createElement(Ka,{onClick:function(){console.log("CLICKED TOGGLE"),T()},expanded:t,onMouseOver:function(){return x("zlock")},hideOnPadSequencer:!0,onMouseLeave:N,className:"presentation-icon",src:"/presentation-mode.svg"}),u.a.createElement(Ka,{onClick:q,onMouseOver:function(){return x("zlock")},hideOnPadSequencer:!0,onMouseLeave:N,expanded:b,src:b?"/zlock-closed.svg":"/zlock-open.svg"}),d&&l)}),tr=(n(1402),n(2588),Object(f.b)(function(e,t){return{collapsed:e.pads.modulesCollapsed[t.subSequence.id],isCurrent:t.subSequence===t.subSequence.sequencerEngine.currentSubSequence}},function(e,t){return{setCollapsed:function(n){return e(Object(d.Oc)(t.subSequence.id,n))},setModuleColor:function(n){return e(Object(d.Pc)(t.subSequence.id,n))}}})(function(e){var t=e.subSequence,n=e.collapsed,a=e.isCurrent,r=e.setCollapsed,c=e.setModuleColor,o=Object(s.useState)(t.color),l=Object(i.a)(o,2),d=(l[0],l[1]),f=Object(s.useState)(!1),m=Object(i.a)(f,2),p=(m[0],m[1],Object(s.useCallback)(function(e){t.color=e.hex,d(e.hex),c(e.hex)},[t,d]),"module-tab grids-name");a&&(p+=" selected");var b=Object(s.useCallback)(function(){t.sequencerEngine.switchToSubSequence(t.id)},[t]);return u.a.createElement("div",{onMouseDown:b,className:p},t.name,!n&&u.a.createElement(er,{subSequence:t}),u.a.createElement("div",{onClick:function(){return r(!n)},className:"collapse-button"},u.a.createElement("div",{className:n?"arrow-left":"arrow-down"})))})),nr=n(287),ar=n(1445),rr=n(1444),cr=Object(f.b)(function(e,t){return{effects:e.pads.padEffects[t.pad.id],isCollapsed:e.effects.effectCollapsed[t.pad.effectRack.id]}},function(e){return{}})(function(e){var t=e.pad,n=e.effects,a=e.isCollapsed,r=Object(xa.a)(e,["pad","effects","isCollapsed"]),c=Object(s.useCallback)(function(e){console.log("on delete fx =",e),t.effectRack.deleteEffect(e),t.updateEffectRedux()},[]);return t.effectRack&&n&&0!==n.length?a?[u.a.createElement(Aa,Object.assign({key:0,pad:t},r))]:[u.a.createElement(Aa,Object.assign({key:0,pad:t},r)),u.a.createElement(Ra,Object.assign({key:5,pad:t},r)),,].concat(Object(p.a)(t.effectRack.effects.map(function(e){return u.a.createElement(Za,Object.assign({onDelete:c,key:e.id,rack:t.effectRack,fx:e,showDelete:!0,sequencerEngine:t.sequencerEngine,pad:t},r))}))):[]}),or=n(1500),ir=n(525),sr=n(1492),ur=new b.a,lr=Object(f.b)(function(e,t){var n=e.mix.selectedTrack===t.track.trackNumber,a=t.track,r=a;return a&&a.tracks&&a.tracks[0]&&(r=a.tracks[0].track),{trackId:a.id,id:r.presetName?r.presetName:void 0!==r.sample&&void 0!==r.sample.getId()?r.sample.getId():r.getName(),isSelectedTrack:n,resolution:e.sequencer.displayResolution,muted:e.tracks.trackMutes[t.track.id],trackLength:a.length}},function(e){return{setStepNumberDraggingFrom:function(t){return e(Object(d.hf)(t))},setSelectedPianoRollSteps:function(t){return e(Object(d.he)(t))},setStepsSelection:function(t){return e(Object(d.lf)(t))},mouseDown:function(t){return e(Object(d.l)(t))}}})(function(e){var t=e.track,n=e.id,a=e.isSelectedTrack,r=e.resolution,c=e.mouseDown,o=e.setSelectedPianoRollSteps,i=e.setStepsSelection,l=e.onTrackRendered,d=e.setStepNumberDraggingFrom,f=e.isHiding,m=e.setIsHiding,p=e.sequencerScale,b=e.muted,v=e.trackLength,h=Object(s.useRef)(void 0),g=ur.getColorForTrack(t),E=ur.brighten(void 0===n?"#353535c7":g,.64),k=t.sequencerEngine;Object(s.useEffect)(function(){setTimeout(function(){l(t,h)},100)},[v]);var O=Object(s.useCallback)(function(){c(!1);var e=k.store.getState().steps.stepsSelection;if(void 0!==e&&e.toStep-e.fromStep>0){var n=t.getEasyPattern().getSelectedSteps(e,r);0===n.length?o(void 0):o(n)}i(void 0),d(void 0)},[t,r]),j=Object(s.useCallback)(function(e){t.sequencerEngine.selectTrack(t.trackNumber)},[t]),y=Object(s.useCallback)(function(){m(f===t?void 0:t)},[f,m]),w=f===t;if(f&&f!==t)return[];var S="track";return f&&(S+=" hiding"),S+=a?" selected":" not-selected",b&&(S+=" muted"),u.a.createElement("div",{ref:h,style:{},onMouseDown:j,onMouseUp:O,className:S},u.a.createElement("div",{className:"track-inner"},u.a.createElement($t.a,{hasBorder:!0,isSelectedTrack:a,onMouseDown:function(e){e.stopPropagation(),j()},track:t,sample:t.sample,onClickThumbnail:y}),w?u.a.createElement(ma.a,{color:E,track:t}):u.a.createElement(sr.a,{sequencerScale:p,key:1,isSelectedTrack:a,sequencerEngine:t.sequencerEngine,store:t.sequencerEngine.store,trackNumber:t.trackNumber,id:n,trackColor:E,sample:t.sample,track:t,isMini:!0,trackData:t})),u.a.createElement("div",{style:{color:g},className:"delete-track-trash",onClick:function(){return t.sequencerEngine.deleteTrack(t.trackNumber)}},"x"))}),dr=n(633);function fr(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return mr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mr(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var pr=Object(f.b)(function(e,t){return{coords:e.windows.windowPositions[t.sequencer.id],isSelected:e.windows.selectedElements[t.sequencer.id],tracks:t.sequencer.tracks,numTracks:t.sequencer.tracks.length,isStarred:e.effects.effectStarred[t.sequencer.id]}},function(e,t){return{setStarred:function(n){return e(Object(d.Gb)(t.sequencer.id,n))},setTrackDragging:function(t){return e(Object(d.wf)(t))},setSampleDragging:function(t){return e(Object(d.Qd)(t))},setSampleTagDragging:function(t){return e(Object(d.Td)(t))}}})(function(e){var t=e.sequencer,n=e.scale,a=(e.pad,e.scrollContainer),r=e.elements,c=e.sizeRef,o=e.size,l=e.setSize,d=e.isCurrent,f=e.setTrackDragging,m=e.numTracks,p=e.setOrdering,b=e.isStarred,v=e.setStarred,h=e.coords,g=e.ordering,E=e.setSampleDragging,k=e.setSampleTagDragging,O=e.isSelected,j=Object(s.useRef)(void 0),y=Object(s.useState)({}),w=Object(i.a)(y,2),S=w[0],C=w[1],x=Object(s.useState)(!1),N=Object(i.a)(x,2),q=N[0],T=N[1],M=Object(s.useRef)(void 0),I=Object(s.useRef)(void 0),P=Object(s.useCallback)(function(e,t){var n=Object(A.a)({},S);n[e.id]=t,C(n)},[S,C]),R=r?Object(Sa.a)({scale:n,ref:j,sizeRef:c,sequencerEngine:t.sequencerEngine,windowPosition:h,containerRef:a,size:o,setSize:l,elements:r,element:t,setOrdering:p,ordering:g}):{},D=R.setWindowScale,L=R.style,z=R.adjust,H=R.windowScale,U=R.onContextMenu,G=R.onMouseDown,F=R.onMouseUp,B=(R.setCoords,R.startResizing);Object(s.useEffect)(function(){h&&(t.x=h.x,t.y=h.y)},[h]),Object(s.useEffect)(function(){r&&setTimeout(function(){if(M.current)if(M.current.clientHeight<M.current.scrollHeight){var e={x:I.current,y:M.current.scrollHeight+30};D(e)}else z(t.x,t.y)},50)},[m,D]),Object(s.useEffect)(function(){H&&(I.current=H.x)},[H]);var W=Object(s.useCallback)(function(e){e.stopPropagation(),t.sequencerEngine.switchToSubSequence(t.subSequence.id);var n=t.sequencerEngine.state,a=n.tracks.trackDragging,r=n.selector,c=r.sampleDragging,o=r.sampleTagDragging,i=t.subSequence,s=t.sequencerEngine;if((a||c||o)&&i.pads.length,a){var u,l=fr(t.subSequence.sequencers);try{for(l.s();!(u=l.n()).done;){var d=u.value;if(d!==t&&d.tracks.includes(a)){d.removeTrack(a);break}}}catch(p){l.e(p)}finally{l.f()}t.addTrack(a)}else if(c)s.addSound(c).then(function(e){return t.addTrack(e)});else if(o){var m=s.state.selector.sampleTagDragging;Array.isArray(m)||(m=[m]),s.searchForSounds(m,void 0,void 0,void 0,!0).then(function(e){return t.addTrack(e)})}f(void 0),E(void 0),k(void 0)},[]),V=Object(A.a)({},L);H&&0!==H.x&&(q?(V.minWidth=H.x,V.minHeight=H.y):(V.width=H.x,V.height=H.y)),h&&(V.left=h.x,V.top=h.y);var Q=q||!H?1:H.x/420;1!=Q&&(t.scale=Q);var J="pulled-sequencer";return d&&(J+=" current"),O&&(J+=" selected"),u.a.createElement("div",{style:V,onDrop:W,onContextMenu:U,onMouseDown:G,onMouseUp:F,ref:j,className:J},u.a.createElement("div",{className:"pulled-header"},u.a.createElement("div",{className:"header-name"},"Sequencer"),u.a.createElement("div",{onClick:function(){return v(!b)},className:b?"starred star":"star"},u.a.createElement("span",null,"\u2606")),u.a.createElement("div",{onClick:function(){return t.dispose()},className:"delete-button"},"x")),u.a.createElement("div",{style:r&&Q&&!q?{width:V.width/Q,maxHeight:V.height/Q,transform:"scale("+.95*Q+")"}:{},ref:M,className:"inner-sequencer"},0===t.tracks.length&&u.a.createElement("div",{className:"drop-here"},"Drop Tracks Here"),t.tracks.map(function(e){return u.a.createElement(lr,{onTrackRendered:P,sequencerScale:Q,setIsHiding:T,isHiding:q,key:e.id,scrollContainer:a,track:e})})),u.a.createElement("div",{onMouseDown:function(e){return B(dr.b,e)},className:"top-left-edge"}),u.a.createElement("div",{onMouseDown:function(e){return B(dr.a,e)},className:"top-right-edge"}),u.a.createElement("div",{onMouseDown:function(e){return B(dr.d,e)},className:"bottom-left-edge"}),u.a.createElement("div",{onMouseDown:function(e){return B(dr.c,e)},className:"bottom-right-edge"}),t.tracks.map(function(e,r){return u.a.createElement(ir.a,{sequencerScale:Q,isMidi:!0,trackPositions:S,number:r,containerRef:a,sequencerEngine:t.sequencerEngine,scale:n,node:e})}))}),br=n(949),vr=Object(f.b)(function(e,t){return{coords:e.windows.windowPositions[t.pad.id],hidden:e.spatial.hiddenObjects[t.pad.id],isSelectedZObject:e.zobject.selectedZObject===t.pad,isSelected:e.windows.selectedElements[t.pad.id],isCurrent:t.pad.subSequence===t.pad.sequencerEngine.currentSubSequence,padsExpand:e.pads.padsExpand}},function(e){return{setSelectedZObject:function(t){return e(Object(d.oe)(t))}}})(function(e){var t=e.hidden,n=e.setOrdering,a=e.ordering,r=e.scale,c=e.pad,o=e.scrollContainer,i=e.elements,l=e.sizeRef,d=e.size,f=e.setSize,m=e.isCurrent,p=e.padsExpand,b=e.coords,v=e.isSelected,h=(e.setSelectedZObject,e.isSelectedZObject,Object(s.useRef)(void 0)),g=Object(Sa.a)({scale:r,ref:h,sequencerEngine:c.sequencerEngine,windowPosition:b,sizeRef:l,containerRef:o,size:d,setSize:f,elements:i,element:c,isPad:!0,expand:p,setOrdering:n,ordering:a}),E=g.style,k=g.onContextMenu,O=g.onMouseDown,j=g.onMouseUp;g.setCoords;Object(s.useEffect)(function(){b&&(c.x=b.x,c.y=b.y)},[b]);var y="pulled-pad";m&&(y+=" current"),v&&(y+=" selected");var w=Object(A.a)({},E);return b&&(w.left=b.x,w.top=b.y),p&&p.pad===c&&(y+=" expanded"),t?"":u.a.createElement("div",{style:w,onMouseDown:function(e){O(e)},onContextMenu:k,onMouseUp:j,ref:h,className:y},u.a.createElement(br.a,{isPulled:!0,scrollContainer:o,pad:c}),u.a.createElement(ir.a,{isRoot:!0,useClick:!0,hideNumber:!0,sequencerEngine:c.sequencerEngine,node:c}),u.a.createElement(La.a,{effect:c}),u.a.createElement(za.a,{subSequence:c.subSequence,containerRef:o,effect:c}))}),hr=(n(1447),Object(f.b)(function(e,t){return{pads:t.subSequence?t.subSequence.pads:t.sequencerEngine.currentSubSequence.pads}},function(e){return{}})(function(e){var t=e.pads,n=e.scrollContainer;return u.a.createElement("div",{className:"pads-container"},t.map(function(e,t){return u.a.createElement(br.a,{key:t,scrollContainer:n,pad:e})}))}),n(642)),gr=function(){function e(t,n){Object(Se.a)(this,e),this.root={x:0,y:0,w:t,h:n}}return Object(Ce.a)(e,[{key:"fit",value:function(e){var t,n,a;for(t=0;t<e.length;t++)a=e[t],(n=this.findNode(this.root,a.w,a.h))&&(a.fit=this.splitNode(n,a.w,a.h))}},{key:"findNode",value:function(e,t,n){return e.used?this.findNode(e.right,t,n)||this.findNode(e.down,t,n):t<=e.w&&n<=e.h?e:null}},{key:"splitNode",value:function(e,t,n){return e.used=!0,e.down={x:e.x,y:e.y+n,w:e.w,h:e.h-n},e.right={x:e.x+t,y:e.y,w:e.w-t,h:n},e}}]),e}(),Er=n(237),kr=n(238),Or=n(1384),jr=Object(f.b)(function(e,t){return{pulledEffects:e.effects.pulledEffects,currentSubSequence:t.subSequence||t.sequencerEngine.currentSubSequence}},function(e){return{setPulledEffects:function(t){return e(Object(d.Jd)(t))}}})(function(e){var t=e.setHeight,n=e.containerRef,a=e.sizeRef,r=e.setSize,c=e.size,o=e.all,i=e.pulledEffects,l=e.sequencerEngine,d=e.setPulledEffects,f=e.scale,m=e.currentSubSequence,p=(e.playhead,e.noWrapper),b=e.elements,v=e.ordering,h=e.setOrdering,g=Object(s.useRef)(),E=Object(s.useRef)({}),k=Object(s.useCallback)(function(e){d(i.filter(function(t){return t!==e}))},[i]),O=Object(s.useCallback)(function(e){return!!e&&(Object(Or.a)(e)?o||Object(Or.a)(e).subSequence===m||Object(Or.a)(e)===m:!(!e.instrument||!e.instrument.context||e.instrument.context.subSequence!==m)||e.track===m)},[m,o]);Object(s.useEffect)(function(){if(g.current){var e=g.current.getBoundingClientRect().height;t(e)}},[i,t]);var j=i.filter(O),y=j.map(function(e){return u.a.createElement(Za,{key:e.id,isStatic:!p,scale:f,elements:b||E,sizeRef:a,setOrdering:h,ordering:v,containerRef:n,size:c,setSize:r,effects:j,onDelete:function(){return k(e)},sequencerEngine:l,fx:e})});return p?y:u.a.createElement("div",{ref:g,className:"pulled-effects"},y)});function yr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,a=arguments.length>3?arguments[3]:void 0,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return(e-t)/(n-t)}(e,t,n,a);return a*Math.pow(r,2)}var wr=function(e,t){return Math.abs(e.y-t.y)},Sr=Object(f.b)(function(e,t){return{playing:t.track.notesTriggered&&Object.keys(t.track.notesTriggered).length>0,notesTriggered:t.track.notesTriggered,disabled:t.track.disabled,volume:t.track.sequencerEngine.playing?t.track.pattern.volume:t.track.volumeParameter.get()}},function(e){return{setParameterSliderDown:function(t){return e(Object(d.ld)(t))}}})(function(e){var t=e.track,n=e.playing,a=e.notesTriggered,r=e.setParameterSliderDown,c=e.toggled,o=e.setSelectedTrack,l=t.disabled,d=Object(s.useState)(!0),f=Object(i.a)(d,2),m=f[0],p=(f[1],Object(s.useRef)(void 0)),b=Object(s.useState)(void 0),v=Object(i.a)(b,2),h=v[0],g=v[1],E=Object(s.useState)(!1),k=Object(i.a)(E,2),O=k[0],j=k[1],y=Object(s.useState)(!1),w=Object(i.a)(y,2),S=w[0],C=w[1],x=Object(s.useRef)(0),N="grid";n&&(N+=" pressed"),l&&(N+=" disabled");var q={},T=a&&Object.keys(a)[0];T&&(T=parseInt(T),q.filter="hue-rotate("+4*T+"deg)");var M=Object(s.useCallback)(function(e){if(O){e.preventDefault(),e.stopPropagation();var n=e.clientY;e.touches&&(n=e.touches[0].clientY);var a=p.current.getBoundingClientRect(),r=p.current.offsetHeight,c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,a=arguments.length>3?arguments[3]:void 0,r=(e=Math.min(Math.max(0,e),a))/a,c=Math.pow(r,.5);return t+(n-t)*c}(r-(n-a.top),-65,6,r);t.setVolume(c,!1,!1),C({x:e.clientX,y:e.clientY})}},[C,O,t]),I={height:yr(t.volumeParameter.get(),-65,6,p.current&&p.current.offsetHeight)},P=Object(s.useCallback)(function(e){c?o(t):(r(t.volumeParameter),j(!0),g({x:e.clientX,y:e.clientY}),x.current=(new Date).getTime())},[j,g,c,o,t]),R=Object(s.useCallback)(function(e){var n=(new Date).getTime();S&&wr(h,S),(!S||wr(h,S)<=8)&&n-x.current<250&&(t.disabled=!t.disabled),C(void 0),j(!1),r(void 0)},[C,j,S,h]);return Object(s.useEffect)(function(){p.current.addEventListener("touchmove",M,{capture:!0})},[M,C,O,t]),u.a.createElement("div",{ref:p,onMouseMove:M,onMouseDown:P,onTouchStart:P,onMouseUp:R,onMouseLeave:function(){j(!1),C(void 0),r(void 0)},style:q,className:N},m?u.a.createElement($t.a,{onMouseDown:function(e){return e.stopPropagation()},showPresetName:!0,track:t}):"",u.a.createElement("div",{className:O?"volume-indicator":"volume-indicator skinny",style:I}))});n(2589);function Cr(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return xr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xr(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function xr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Nr=Object(f.b)(function(e,t){return{pulledEffects:e.effects.pulledEffects,pulledSequencers:e.pads.sequencers,numTracks:t.subSequence.tracks&&t.subSequence.tracks.length,collapsed:e.pads.modulesCollapsed[t.subSequence.id]}},function(e){return{setPulledEffects:function(t){return e(Object(d.Jd)(t))},setSelectedPulledElements:function(t){return e(Object(d.je)(t))},setSize:function(t){return e(Object(d.Qc)(5,t))}}})(function(e){var t=e.setSize,n=e.isExplore,a=e.scale,r=(e.showEffects,e.pulledEffects),c=e.setPulledEffects,o=e.setSelectedPulledElements,l=e.toggled,f=e.setSelectedTrack,m=e.subSequence,b=e.collapsed,v=Object(s.useRef)(void 0),h=Object(s.useRef)({}),g=Object(Ta.a)({ref:v}),E=g.onContextMenu,k=g.dropdownPos,O=(g.setDropdowPos,Object(hr.a)({ref:v})),j=O.sizeRef,y=O.ordering,w=O.setOrdering,S=Object(s.useRef)(k),C={width:500,height:500},x=function(e){e.ref;var t=e.elements,n=e.subSequence,a=e.presentationMode;return{arrangeWindows:Object(s.useCallback)(function(){if(t.current){var e=n.sequencerEngine.state.windows.moduleSizes[n.id],r=n.state.windows.selectedElements,c=[];for(var o in r)r[o]&&c.push(o);var i=[],s=[];for(var u in t.current)if(!(c.length>0)||c.includes(u)){var l=t.current[u].current;if(l){var f={element:l,id:u,h:l.offsetHeight+15,w:l.offsetWidth+15};i.push(f),s.push(Object(A.a)({},f,{x:l.offsetLeft,y:l.offsetTop}))}}i.sort(function(e,t){return Math.max(t.w,t.h)-Math.max(e.w,e.h)});var m,b,v=e.width||200,h=e.height||200;c.length>0&&(m=Math.min.apply(Math,Object(p.a)(s.map(function(e){return e.x}))),b=Math.min.apply(Math,Object(p.a)(s.map(function(e){return e.y}))),v=Math.max.apply(Math,Object(p.a)(s.map(function(e){return e.x+e.w})))-m,h=Math.max.apply(Math,Object(p.a)(s.map(function(e){return e.y+e.h})))-b),new gr(v,2*h).fit(i);for(var g={},E=0,k=i;E<k.length;E++){var O=k[E];O.fit&&(c.length>0?g[O.id]={x:O.fit.x+m,y:O.fit.y+b}:g[O.id]=Object(A.a)({},O.fit))}console.log("BULK ARRANGING"),a?n.dispatch(Object(d.T)(g)):n.dispatch(Object(d.U)(g))}},[t,n,a])}}({ref:v,elements:h,subSequence:m,size:C}).arrangeWindows,N=Object(s.useState)(void 0),q=Object(i.a)(N,2),T=q[0],M=q[1],I=Object(nr.a)({containerRef:v,scale:a}).getXY,P=Object(ar.a)({elements:h}).getSelection,R=Object(s.useCallback)(function(e){var t=I(e),n=t.x,a=t.y;M({x1:n,y1:a,x2:n,y2:a})},[M,a]),D=Object(s.useCallback)(function(e){var t=I(e),n=t.x,a=t.y;M(Object(A.a)({},T,{x2:n,y2:a}))},[T,M,a]),L=Object(s.useCallback)(function(e){if(T&&T.x2-T.x1>1){var t,n={},a=Cr(P(T));try{for(a.s();!(t=a.n()).done;)n[t.value.id]=!0}catch(r){a.e(r)}finally{a.f()}o(n)}T&&M(void 0)},[T,M]);Object(s.useEffect)(function(){k&&(S.current=k)},[k]);var z=[0,1,2],H=m.tracks,U=void 0===H?[]:H;U=U.filter(function(e){return n||void 0===e.pad});var G=Object(s.useCallback)(function(e){var t=Object(ba.d)(e,m),n=S.current,a=n.x,o=n.y;t.x=a,t.y=o,m.midiEffects.addEffect(t),c([].concat(Object(p.a)(r),[t]))},[m,r]),F=Object(s.useCallback)(function(e){m.sequencerEngine.switchToSubSequence(m.id)},[m]),B=Object(s.useCallback)(function(){var e=m.createSequencer(),t=S.current,n=t.x,a=t.y;e.x=n,e.y=a},[m]),W=Object(s.useCallback)(function(){var e=m.createPad(),t=S.current,n=t.x,a=t.y;e.x=n,e.y=a},[m]);if(!m||!m.tracks)return[];var V=u.a.createElement("div",null,!n&&u.a.createElement(rr.a,{selection:T,scale:a,elements:h,containerRef:v}),u.a.createElement(Er.a,{className:"midi-context",dropdownPos:k?{x:k.x/a,y:k.y/a}:void 0},u.a.createElement(kr.a,{onMouseDown:B},"New Sequencer"),u.a.createElement(kr.a,{onMouseDown:W},"New Pad"),u.a.createElement(kr.a,{onMouseDown:x},"Arrange Windows"),u.a.createElement("div",{className:"context-divider"}),ba.f.map(function(e){var t=e.label,n=e.value;return u.a.createElement(kr.a,{onMouseDown:function(){return G(n)}},t)})),n&&u.a.createElement("div",{className:"grid-rows"},[0,1,2,3,4].map(function(e){return u.a.createElement("div",{key:e,className:"grid-row"},z.map(function(t){return U[3*e+t]?u.a.createElement(Sr,{scale:a,toggled:l,setSelectedTrack:f,key:3*e+t,track:U[3*e+t],row:e,col:t}):""}))})),u.a.createElement(jr,{scale:a,sizeRef:j,setSize:t,size:C,ordering:y,setOrdering:w,playhead:!0,elements:h,containerRef:v,noWrapper:!0,sequencerEngine:m.sequencerEngine,subSequence:m}),!n&&m.pads.map(function(e){return u.a.createElement(vr,{key:e.id,scale:a,size:C,ordering:y,setOrdering:w,setSize:t,sizeRef:j,elements:h,scrollContainer:v,pad:e})}),!n&&u.a.createElement(or.a,{containerRef:v,scale:a,subSequence:m}),!n&&m.tracks.map(function(e){return u.a.createElement(Xa,{scale:a,ordering:y,setOrdering:w,size:C,setSize:t,sizeRef:j,elements:h,containerRef:v,track:e})}),!n&&m.pads.filter(function(e){return e.effectRack}).map(function(e){return u.a.createElement(cr,{scale:a,ordering:y,setOrdering:w,size:C,setSize:t,sizeRef:j,elements:h,containerRef:v,pad:e})}),!n&&m.sequencers.map(function(e){return u.a.createElement(pr,{ordering:y,setOrdering:w,scrollContainer:v,scale:a,size:C,setSize:t,sizeRef:j,elements:h,sequencer:e})}));return u.a.createElement("div",{onClick:F,onMouseDown:R,onMouseMove:D,onMouseUp:L,onContextMenu:E,className:b?"grids collapsed":"grids not-collapsed"},u.a.createElement(tr,{subSequence:m}),u.a.createElement("div",{ref:v,style:{},className:"grids-inner"},b?u.a.createElement(Ca.a,{subSequence:m}):V))}),qr=n(796),Tr=(n(2590),Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.onClickCancel,a=Object(s.useState)(""),r=Object(i.a)(a,2),l=r[0],d=r[1],f=Object(s.useState)(8),m=Object(i.a)(f,2),p=m[0],b=m[1],v=Object(s.useState)(.1),h=Object(i.a)(v,2),g=h[0],E=h[1],k=Object(s.useState)(!1),O=Object(i.a)(k,2),j=O[0],y=O[1],w=Object(s.useState)(!1),C=Object(i.a)(w,2),x=(C[0],C[1]),N=Object(s.useCallback)(Object(o.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.next=3,Object(qr.b)(t,l,p,g*Math.pow(10,18));case 3:x(!0),y(!1);case 5:case"end":return e.stop()}},e)})),[g,l,p,y,x]);return u.a.createElement(q.a,{dialogClassName:"mint-modal preset-modal render-modal",show:!0,onHide:n},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,"Mint NFT")),u.a.createElement(q.a.Body,null,j?u.a.createElement(S.a,{text:"Minting your nft"}):u.a.createElement("div",null,u.a.createElement("input",{placeholder:"Title your work",value:l,type:"text",onChange:function(e){return d(e.target.value)}}),u.a.createElement("div",{className:"editions"},u.a.createElement("div",{className:"value"},"Editions: ",p),u.a.createElement(fe.a,{value:p,change:function(e){return b(e.target.value)},step:1,max:1e3,min:1,orientation:"horizontal",reversed:!1})),u.a.createElement("div",{className:"price"},u.a.createElement("div",{className:"value"},"Price: ",g," eth"),u.a.createElement(fe.a,{value:g,change:function(e){return E(e.target.value)},step:.001,max:1,min:.001,orientation:"horizontal",reversed:!1})))),u.a.createElement(q.a.Footer,null,u.a.createElement(T.b,{variant:"secondary",onClick:N},"Mint!"),u.a.createElement(T.b,{variant:"primary",onClick:n},"Cancel")))}));function Mr(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ir(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ir(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function Ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Pr=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a,r,o,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be.a.encryption.getPotentialUsers();case 2:t=e.sent,[],n=[],a=Mr(t),e.prev=6,a.s();case 8:if((r=a.n()).done){e.next=16;break}return o=r.value,e.next=12,Be.a.users.getUserName(o);case 12:(i=e.sent)&&""!==i&&n.push({id:o,userName:i});case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),a.e(e.t0);case 21:return e.prev=21,a.f(),e.finish(21);case 24:return console.log("USERS =",n),e.abrupt("return",n);case 26:case"end":return e.stop()}},e,null,[[6,18,21,24]])}));return function(){return e.apply(this,arguments)}}(),Rr=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.onSharedWithChanged,n=(e.guildId,Object(s.useState)("")),a=Object(i.a)(n,2),r=a[0],c=a[1],o=Object(s.useState)([]),l=Object(i.a)(o,2),d=l[0],f=l[1],m=Object(s.useState)([]),b=Object(i.a)(m,2),v=b[0],h=b[1],g=Object(s.useState)([]),E=Object(i.a)(g,2),k=E[0],O=E[1];Object(s.useEffect)(function(){},[f]),Object(s.useEffect)(function(){t(d)},[d]),Object(s.useEffect)(function(){Pr().then(function(e){return h(e)})},[h]);var j=Object(s.useCallback)(function(e){f([].concat(Object(p.a)(d),[e])),c(""),O([])},[d,f,O]),y=Object(s.useCallback)(function(e){"Enter"===e.key&&j(r)},[f,r,d]);Object(s.useEffect)(function(){if(""===r.trim())O([]);else{var e=v.filter(function(e){return e.userName.toLowerCase().includes(r.toLowerCase())});O(e)}},[r,O]);var w=Object(s.useCallback)(function(e){f(d.filter(function(t){return t!==e}))},[f,d]);return u.a.createElement("div",{className:"share-with-people"},u.a.createElement("div",{className:"people-input-container"},d.map(function(e){return u.a.createElement("div",{className:"shared-user"},e,u.a.createElement("div",{onClick:function(){return w(e)},className:"delete-user"},"x"))}),u.a.createElement("input",{placeholder:"Type collaborators to share this with",className:"people-input",value:r,type:"text",onKeyDown:y,onChange:function(e){return c(e.target.value)}})),u.a.createElement("div",{className:"auto-completion-users"},k.map(function(e){return u.a.createElement("div",{onClick:function(){return j(e.userName)},className:"auto-completed-user"},e.userName)})))});function Dr(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ar(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ar(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function Ar(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Lr=function(e){return new Promise(function(){var t=Object(o.a)(c.a.mark(function t(n){var a,r,o,i,s,u,l,d,f,m,b;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=Be.a.users,r=Be.a.guilds,o=void 0,i=Object(p.a)(e),t.t0=e,t.next=6,a.getUserName();case 6:t.t1=t.sent,t.t0.push.call(t.t0,t.t1),s=Dr(e),t.prev=9,s.s();case 11:if((u=s.n()).done){t.next=23;break}return l=u.value,t.next=15,a.getUserId(l);case 15:return d=t.sent,t.next=18,r.getGuildsForUser(d);case 18:f=t.sent,f=new Set(f.map(function(e){return e.guildId})),o=void 0===o?f:zr(o,f);case 21:t.next=11;break;case 23:t.next=28;break;case 25:t.prev=25,t.t2=t.catch(9),s.e(t.t2);case 28:return t.prev=28,s.f(),t.finish(28);case 31:if(o=Array.from(o),m=void 0,0!==o.length){t.next=40;break}return t.delegateYield(c.a.mark(function t(){var o,s,u,l,d,f,p;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.join(","),t.next=3,r.newGuild(o);case 3:s=t.sent;case 4:return t.next=7,r.getGuildsForUser();case 7:if(u=t.sent,console.log("GUILDS found =",u),!(m=u.find(function(e){return e.name===o}))){t.next=13;break}return m=m.guildId,t.abrupt("break",17);case 13:return t.next=15,Object(We.a)(2e3);case 15:t.next=4;break;case 17:r.saveGuildKey(m,s),n(m),l=Dr(i),t.prev=20,l.s();case 22:if((d=l.n()).done){t.next=31;break}return f=d.value,t.next=26,a.getUserId(f);case 26:return p=t.sent,t.next=29,r.requestToAddMember(m,p);case 29:t.next=22;break;case 31:t.next=36;break;case 33:t.prev=33,t.t0=t.catch(20),l.e(t.t0);case 36:return t.prev=36,l.f(),t.finish(36);case 39:return t.abrupt("return",{v:void 0});case 40:case"end":return t.stop()}},t,null,[[20,33,36,39]])})(),"t3",35);case 35:if("object"!==typeof(b=t.t3)){t.next=38;break}return t.abrupt("return",b.v);case 38:t.next=41;break;case 40:m=o[0];case 41:n(m);case 42:case"end":return t.stop()}},t,null,[[9,25,28,31]])}));return function(e){return t.apply(this,arguments)}}())},zr=function(e,t){var n,a=[],r=Dr(e);try{for(r.s();!(n=r.n()).done;){var c=n.value;t.has(c)&&a.push(c)}}catch(u){r.e(u)}finally{r.f()}var o,i=Dr(t);try{for(i.s();!(o=i.n()).done;){var s=o.value;e.has(s)&&a.push(s)}}catch(u){i.e(u)}finally{i.f()}return new Set(a)},Hr=Object(f.b)(function(e,t){t.sequencerEngine,t.id,t.renderLength;return{currentTime:e.freeze.offlineEngine&&e.freeze.offlineEngine.context&&Math.floor(e.freeze.offlineEngine.context._context.currentTime),currentExportInfo:e.freeze.currentExportInfo}},null)(function(e){var t=e.currentTime,n=void 0===t?0:t,a=e.renderLength,r=e.width,c=void 0===r?380:r,o=e.currentExportInfo,i=n/(a*(new ge.a.Time("1n").toMilliseconds()/1e3)),s={width:c*i},l=o;return u.a.createElement("div",{className:"progress-bar"},u.a.createElement("div",{className:"inner-progress-bar"},u.a.createElement("div",{className:"progress",style:s}),u.a.createElement("div",{className:"loading-text"},l?"Exporting "+l.name+" "+(l.index+1)+"/"+l.total+" ":"Exporting Project ","(",Math.round(100*i),"%)...")))}),Ur=n(308);function Gr(e){var t=e.sequencerEngine,n=(e.selectedGuild,t.getAllRecordingsToSave().length);return 0===n?u.a.createElement("div",null):u.a.createElement("div",{className:"save-recordings"},"You have ",n," new sounds to",u.a.createElement("span",{onClick:function(){return t.saveAnyNewRecordings(0)},className:"save-recordings-button"},"save"),".")}function Fr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var Br=function(e){Object(xe.a)(n,e);var t=Fr(n);function n(e){var a;return Object(Se.a)(this,n),(a=t.call(this,e)).state={sequenceHash:void 0,creatingLink:!1},a}return Object(Ce.a)(n,[{key:"getLink",value:function(){return window.explore?"https://zequencer.io/explore/"+this.state.sequenceHash:"https://zequencer.io/v3/"+this.state.sequenceHash}},{key:"copyLink",value:function(){var e=this,t=this.linkInput;t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),this.setState({copied:!0}),setTimeout(function(){return e.setState({copied:!1})},1e3)}},{key:"createLink",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({creatingLink:!0}),e.next=3,this.props.sequencerEngine.save(void 0,Un.c,!1);case 3:t=e.sent,this.setState({sequenceHash:t,creatingLink:!1});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"exportToWAV",value:function(){Object(Ur.a)(this.props.sequencerEngine)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"link-creator"},u.a.createElement(Ue.a,{condition:void 0===this.state.sequenceHash},u.a.createElement("div",{onClick:function(){return e.createLink()},className:"link-button"},"Create Public Link")),u.a.createElement(Ue.a,{condition:void 0!==this.state.sequenceHash},u.a.createElement("div",null,"Link: ",u.a.createElement("input",{type:"text",value:this.getLink(),id:"linkInput",ref:function(t){e.linkInput=t}})),u.a.createElement("div",{onClick:function(){return e.copyLink()},className:"small-button pink-button"},"Copy Link"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Ue.a,{condition:this.state.copied},u.a.createElement("div",{className:"copied-info"},"Copied to clipboard!"))),u.a.createElement("div",{onClick:function(){return e.props.onClickExport()},className:"link-button export-to-wav-btn"},"Export to WAV"))}}]),n}(s.Component),Wr=n(1329);function Vr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var Qr=function(e){Object(xe.a)(n,e);var t=Vr(n);function n(e){var a;return Object(Se.a)(this,n),(a=t.call(this,e)).state={nameValue:"",numTokens:1,saveOption:Un.b,metamaskInstalled:!0,showBuying:!1,sequenceHash:void 0,copied:!1,selectedGuild:void 0,guildOptions:[],renderLength:64,mintNFT:!1,renderOption:Wr.b,shareWith:[],formingGuild:!1},a.input=void 0,a.onClickDone=a.onClickDone.bind(Object(yn.a)(a)),a.onClickCancel=a.onClickCancel.bind(Object(yn.a)(a)),a.onClickExport=a.onClickExport.bind(Object(yn.a)(a)),Be.a.tokenizedSequences.callback=function(){return a.onBalanceUpdated()},a}return Object(Ce.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.show&&e.show!==this.props.show&&this.getGuilds(),e.show||e.show===this.props.show||(this.state.sequenceHash=void 0,this.state.copied=!1),!0}},{key:"getGuilds",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be.a.guilds.getGuildsForUser();case 2:t=e.sent,void 0!==this.props.selectedGuild&&this.setState({saveOption:Un.a}),this.setState({selectedGuild:this.props.selectedGuild||t[0],guildOptions:t.filter(function(e){return e.name.split(",").length<2})});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.show!=e.show){this.input&&this.input.focus();var n=this.props.sequencerEngine.sequenceId;0===n&&-1===n&&void 0===n||Be.a.guildSequences.getGuildSequence(n).then(function(e){e?(console.log("GUILD SEQUENCE =",e),t.setState({sequenceGuildId:e.guildId})):t.setState({sequenceGuildId:void 0})})}return!0}},{key:"onClickDone",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({showExportMode:!1}),!this.state.showBuying){e.next=6;break}Be.a.tokenizedSequences.buyTokens(parseInt(this.state.numTokens)),this.setState({onPurchased:!0,showBuying:!1}),e.next=18;break;case 6:if(t=this.state.shareWith,n=void 0,!(this.state.saveOption===Un.b&&t.length>0)){e.next=17;break}return this.setState({formingGuild:!0}),e.next=12,Lr(t);case 12:n=e.sent,this.setState({formingGuild:!1}),this.props.onSave(this.state.nameValue,Un.a,{guildId:n}),e.next=18;break;case 17:this.props.onSave(this.state.nameValue,this.state.saveOption,this.state.selectedGuild);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickCancel",value:function(){if(this.state.showBuying)this.setState({showBuying:!1});else{this.setState({showExportMode:!1,mintNFT:!1}),this.props.onHide();var e=this.props.sequencerEngine.state.freeze.offlineEngine;console.log("OFFLINE ENGINE =",e),e&&(console.log("SUSPENDING"),e.stop(),e.context._context.suspend(e.context._context.currentTime+.5).then(function(){console.log("DISPOSING"),e.dispose()}))}}},{key:"onInputType",value:function(e){this.setState({nameValue:e})}},{key:"handleCheckboxChange",value:function(e){this.setState({saveOption:e.target.name})}},{key:"onTokenType",value:function(e){""===e&&this.setState({numTokens:0}),Object(tn.a)(e)&&this.setState({numTokens:e})}},{key:"onSelectGuild",value:function(e){this.setState({selectedGuild:e})}},{key:"showExportMode",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({showExportMode:e})}},{key:"onClickExport",value:function(){var e=this;this.setState({bouncing:!0}),setTimeout(Object(o.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Ur.a)(e.props.sequencerEngine,e.state.renderLength,e.state.renderOption);case 2:e.setState({bouncing:!1}),e.onClickCancel(),e.onClickCancel();case 5:case"end":return t.stop()}},t)})),80)}},{key:"onChangeRenderLength",value:function(e){try{var t=parseInt(e);this.setState({renderLength:t})}catch(n){}}},{key:"login",value:function(){this.props.setShowLogin(!0)}},{key:"render",value:function(){var e=this;return this.state.mintNFT?u.a.createElement(Tr,{onClickCancel:function(){return e.onClickCancel()},sequencerEngine:this.props.sequencerEngine}):this.state.showExportMode?u.a.createElement(q.a,{dialogClassName:"preset-modal render-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,"Export Project")),u.a.createElement(q.a.Body,null,u.a.createElement("div",{className:"render-options"},u.a.createElement("div",{className:"render-label"},"Rendered Track"),u.a.createElement("div",{onClick:function(){return e.setState({renderOption:Wr.b})},className:this.state.renderOption===Wr.b?"selected render-option":"render-option"},"Master"),u.a.createElement("div",{onClick:function(){return e.setState({renderOption:Wr.a})},className:this.state.renderOption===Wr.a?"selected render-option":"render-option"},"Groups")),u.a.createElement("div",{className:"render-length"},u.a.createElement("div",{className:"render-label"},"Render Length"),u.a.createElement("input",{onChange:function(t){return e.onChangeRenderLength(t.target.value)},className:"render-length-input",value:this.state.renderLength})),this.state.bouncing?u.a.createElement(Hr,{renderLength:this.state.renderLength}):""),u.a.createElement(q.a.Footer,null,this.state.bouncing?"":u.a.createElement(T.b,{variant:"secondary",onClick:this.onClickExport},"Export"),this.state.bouncing?"":u.a.createElement(T.b,{variant:"primary",onClick:this.onClickCancel},"Cancel"))):this.props.userToken?u.a.createElement(q.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,"Save Project")),u.a.createElement(q.a.Body,null,u.a.createElement("input",{value:this.state.nameValue,onChange:function(t){return e.onInputType(t.target.value)},ref:function(t){e.input=t},placeholder:"Type name of project",className:"tag-input"}),u.a.createElement("form",null,u.a.createElement("input",{name:Un.c,type:"checkbox",checked:this.state.saveOption===Un.c,onChange:function(t){return e.handleCheckboxChange(t)}}),u.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(bn.O)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Public"),u.a.createElement("input",{name:Un.b,value:Un.b,type:"checkbox",checked:this.state.saveOption===Un.b,onChange:function(t){return e.handleCheckboxChange(t)}}),u.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(bn.M)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Private"),u.a.createElement("input",{name:Un.a,value:Un.a,type:"checkbox",checked:this.state.saveOption===Un.a,onChange:function(t){return e.handleCheckboxChange(t)}}),u.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(bn.M)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Guild")),u.a.createElement(Gr,{selectedGuild:this.state.selectedGuild,sequencerEngine:this.props.sequencerEngine}),u.a.createElement(Ue.a,{condition:this.state.saveOption===Un.b},u.a.createElement(Rr,{guildId:this.state.sequenceGuildId,onSharedWithChanged:function(t){return e.setState({shareWith:t})}}),this.state.formingGuild?u.a.createElement(S.a,{text:"Creating encrypted group"}):""),u.a.createElement(Ue.a,{condition:this.state.saveOption===Un.a},u.a.createElement(Rn,{onSelectGuild:function(t){return e.onSelectGuild(t)},selectedGuild:this.state.selectedGuild,guildOptions:this.state.guildOptions})),u.a.createElement(Br,{onClickMint:function(){return e.setState({mintNFT:!0})},onClickExport:function(){return e.showExportMode(!0)},sequencerEngine:this.props.sequencerEngine})),this.state.formingGuild?"":u.a.createElement(q.a.Footer,null,u.a.createElement(T.b,{variant:"secondary",onClick:this.onClickDone},"Save"),u.a.createElement(T.b,{variant:"primary",onClick:this.onClickCancel},"Cancel"))):u.a.createElement(q.a,{dialogClassName:"preset-modal save-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(q.a.Header,{closeButton:!0},u.a.createElement(q.a.Title,null,"Save Sequence")),u.a.createElement(q.a.Body,null,u.a.createElement("div",{className:"no-metamask"},u.a.createElement("span",{onClick:function(){return e.login()},className:"login-btn"},"Login")," to save your song to your account."),u.a.createElement(Br,{onClickMint:function(){return e.setState({mintNFT:!0})},onClickExport:function(){return e.showExportMode(!0)},sequencerEngine:this.props.sequencerEngine})),u.a.createElement(q.a.Footer,null,u.a.createElement(T.b,{variant:"secondary",onClick:this.onClickCancel},"Done")))}}]),n}(s.Component);var Jr=Object(f.b)(function(e){return{selectedGuild:e.guilds.selectedGuild,userToken:e.sequencer.userToken}},function(e){return{setShowLogin:function(t){return e(Object(d.He)(t))},setContextualHelp:function(t){return e(Object(d.hb)(t))}}})(Qr),_r=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=Object(s.useState)(!1),a=Object(i.a)(n,2),r=a[0],c=a[1],o=Object(s.useCallback)(function(e,n,a){t.save(e,n,!0,a),c(!1)},[c,t]);return u.a.createElement("div",null,u.a.createElement(Jr,{sequencerEngine:t,onSave:o,onHide:function(){return c(!1)},show:r}),u.a.createElement("div",{onClick:function(){return c(!0)},className:"work-save-button"}))}),Yr=Object(f.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{setWorksLoaded:function(t){return e(Object(d.og)(t))}}})(function(e){var t=e.setWorksLoaded,n=e.multiSequencerEngine,a=e.sequencerEngine,r=e.worksLoaded,c=Object(s.useCallback)(function(){var e=Object.values(n.idToSequencerEngine).filter(function(e){return e!==a});e.forEach(function(e){return a.subSequences=[].concat(Object(p.a)(a.subSequences),Object(p.a)(e.subSequences))}),e.forEach(function(e){return n.unloadTrack(e.getSequenceId(),!1)});var c=r.filter(function(e){return e.newSequence===a.getSequenceId()});t(c)},[r,a]);return r&&r.length>1?u.a.createElement("div",{onClick:c,className:"combine-works-button"},"Combine Projects"):""}),Zr=new b.a,Xr=Object(f.b)(function(e,t){var n=t.sequencerEngine.idToSequencerEngine[t.work.newSequence];return n?{worksLoaded:e.explore.worksLoaded,numSubSequences:n&&n.subSequences.length,pulledEffects:e.effects.pulledEffects}:{}},function(e){return{}})(function(e){var t=e.work,n=e.sequencerEngine,a=Object(s.useState)(!1),r=Object(i.a)(a,2),c=r[0],o=r[1],l=Object(s.useState)(void 0),d=Object(i.a)(l,2),f=d[0],m=d[1],p=n.idToSequencerEngine[t.newSequence];return p?(Object(s.useEffect)(function(){c||m(void 0)},[c,m]),u.a.createElement("div",{className:"explore-work"},c&&f?u.a.createElement(ma.a,{color:Zr.getColorForTrack(f),track:f}):p.subSequences.map(function(e){return u.a.createElement(Nr,{isExplore:!0,setSelectedTrack:m,toggled:c,subSequence:e,sequencerEngine:p})}),u.a.createElement(pa,{setToggled:o,toggled:c}),u.a.createElement(Yr,{multiSequencerEngine:n,sequencerEngine:p}),u.a.createElement(_r,{sequencerEngine:p}))):""}),Kr=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.pendingComments,n=Object(s.useState)(""),a=Object(i.a)(n,2),r=a[0],c=a[1];Object(s.useEffect)(function(){He.a.getUserName().then(c)},[c]);var o=Object(p.a)(t);return o.reverse(),o.map(function(e){return u.a.createElement("div",null,u.a.createElement("div",{className:"annotation"},u.a.createElement("div",{className:"author"},r,":"),u.a.createElement("div",{className:"content"},e)))})}),$r=new b.a,ec={},tc=function(e){var t=e.annotation,n=e.style,a=Object(s.useState)(""),r=Object(i.a)(a,2),c=r[0],o=r[1],l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],p=d[1],b=Object(s.useState)([]),v=Object(i.a)(b,2),h=v[0],g=v[1];return Object(s.useEffect)(function(){var e=G.a.utils.fromAscii(t.annotationData),n=Object(Ke.a)(e);ec[n]?o(ec[n]):m.a.getJson(n).then(function(e){ec[n]=e,o(e)}),Be.a.users.getUserName(t.address).then(function(e){return p(e)})},[t,o,p]),Object(s.useEffect)(function(){Be.a.xanadu.getContentReferences(t.annotationData).then(g)},[t,g]),u.a.createElement("div",{style:n,className:"annotation"},u.a.createElement("div",{className:"author"},f,":"),u.a.createElement("div",{className:"content"},c),u.a.createElement("div",{className:"references"},h.map(function(e){return u.a.createElement("div",{style:{backgroundColor:$r.getColorForHash(e)},className:"dot content-reference"})})))},nc=function(e){var t=e.works,n=e.linkType,a=void 0===n?"SEQUENCE_ANNOTATION":n,r=Object(s.useState)([]),c=Object(i.a)(r,2),o=c[0],u=c[1];return Object(s.useEffect)(function(){var e;(e=Be.a.xanadu).getFlattenedAnnotations.apply(e,[a].concat(Object(p.a)(t.map(function(e){return e.newSequence})))).then(function(e){u(Object(p.a)(e))})},[t,u]),{comments:o}},ac=(new b.a,Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.works,n=e.linkType,a=nc({works:t,linkType:void 0===n?"SEQUENCE_ANNOTATION":n}).comments,r={};return a.reverse(),u.a.createElement("div",null,a.map(function(e){return u.a.createElement(tc,{style:r,key:e.annotationData,annotation:e})}))})),rc=(new b.a,Object(f.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{}})(function(e){var t=e.worksLoaded,n=e.linkType,a=void 0===n?"SEQUENCE_ANNOTATION":n,r=Object(s.useState)(""),c=Object(i.a)(r,2),o=c[0],l=c[1],d=Object(s.useState)([]),f=Object(i.a)(d,2),m=f[0],b=f[1];Object(s.useEffect)(function(){b([])},[t]);var v=Object(s.useCallback)(function(){t.map(function(e){var t=e.newSequence;return Be.a.xanadu.newAnnotationContent(a,t,o)}),l(""),b([].concat(Object(p.a)(m),[o]))},[t,o,l,m,b]);return 0===t.length?[]:u.a.createElement("div",{className:"comments-pane"},u.a.createElement("div",{className:"work-comments"},u.a.createElement(ac,{works:t}),u.a.createElement(Kr,{pendingComments:m})),u.a.createElement(T.g,{type:"textarea",value:o,className:"comment-text",placeholder:"Write a comment here",onChange:function(e){return l(e.target.value)}}),u.a.createElement("div",{onClick:v,className:""===o?"submit-comment-btn disabled":"submit-comment-btn"},"Send"))}));function cc(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return oc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oc(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function oc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ic=(new(n(1156).a)).contractAddress,sc=G.a.utils.padLeft("0x0",64),uc=function(){return new Ye.a(ic)},lc=function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new _e.a($e.e,"deleteList",[Object(Ke.c)(t)]).execute();case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),dc=function(){var e=Object(o.a)(c.a.mark(function e(t,n,a,r){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new _e.a($e.e,"bulkEdit",[t.map(function(e){return Object(Ke.c)(e)}),n.map(function(e){return e?Object(Ke.c)(e):sc}),a.map(function(e){return G.a.utils.fromAscii(e)}),r]).execute();case 2:case"end":return e.stop()}},e)}));return function(t,n,a,r){return e.apply(this,arguments)}}(),fc=function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=uc().from(Xe.g).select("newContent").select("previousContent").select("title"),e.t0=mc,e.t1=pc,e.next=5,t.executeQuery();case 5:return e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.next=9,(0,e.t0)(e.t3);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),mc=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.map(function(e){return e.newContent}),n=uc().from(Xe.f).select("contentHash"),e.t0=Set,e.next=5,n.executeQuery();case 5:return e.t1=e.sent.map(function(e){return e.contentHash}),a=new e.t0(e.t1),e.abrupt("return",t.filter(function(e){return!a.has(e.newContent)}));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),pc=function(e){var t,n={},a=cc(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;r.previousContent&&r.previousContent!==r.newContent&&(n[r.newContent]=r.previousContent)}}catch(f){a.e(f)}finally{a.f()}var c,o={},i=cc(e);try{for(i.s();!(c=i.n()).done;){var s=c.value,u=bc(s.newContent,n);u in o||(o[u]=[]),o[u].push(s)}}catch(f){i.e(f)}finally{i.f()}var l=[];for(var d in o)o[d].sort(function(e,t){return t.blockNumber-e.blockNumber}),l.push(o[d][0]);return l},bc=function e(t,n){var a=n[t];return void 0===a?t:e(a,n)};function vc(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return hc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hc(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function hc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var gc=Object(f.b)(function(e,t){return{unpublished:e.explore.unpublished}},function(e){return{setExploreUnpublished:function(t){return e(Object(d.Rb)(t))}}})(function(e){var t=e.setExploreUnpublished,n=e.unpublished;Object(s.useEffect)(function(){var e=l.a.getItem("unsavedLists");e&&t(JSON.parse(e))},[]);var a=Object(s.useCallback)(Object(o.a)(c.a.mark(function e(){var a,r,o,i,s,u,d,f,p;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=[],r=[],o=[],i=[],s=vc(n),e.prev=5,s.s();case 7:if((u=s.n()).done){e.next=21;break}return d=u.value,e.next=11,m.a.addJson(d);case 11:f=e.sent,p=d.hash,d.hash=f,d.newContent=f,a.push(f),r.push(p),o.push(d.name),i.push(0);case 19:e.next=7;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(5),s.e(e.t0);case 26:return e.prev=26,s.f(),e.finish(26);case 29:l.a.setItem("publishingLists",JSON.stringify(n)),l.a.removeItem("unsavedLists"),dc(a,r,o,i),t(void 0);case 33:case"end":return e.stop()}},e,null,[[5,23,26,29]])})),[n]);return n&&0!==n.length?u.a.createElement("div",{onClick:a,className:"save-unpublished-btn"},"Publish Changes ",u.a.createElement("span",{className:"unpublished-count"},n.length)):u.a.createElement("div",null)}),Ec=n(20),kc=Object(f.b)(function(e,t){return{projectDragging:e.explore.projectDragging}},function(e){return{setProjectDragging:function(t){return e(Object(d.Hd)(t))},setExploreUnpublished:function(t){return e(Object(d.Rb)(t))}}})(function(e){var t=e.hide,n=e.projectDragging,a=e.setProjectDragging,r=e.list,d=e.setExploreUnpublished,f=e.onDelete,m=Object(s.useState)(""),b=Object(i.a)(m,2),v=b[0],h=b[1],g=Object(s.useState)([]),E=Object(i.a)(g,2),k=E[0],O=E[1],j=Object(s.useState)(void 0),y=Object(i.a)(j,2),w=y[0],S=y[1],x=Object(s.useState)(void 0),N=Object(i.a)(x,2),q=N[0],T=N[1];Object(s.useEffect)(function(){r&&(O(r.projects),h(r.name),S(r.image))},[r]);var M=Object(s.useCallback)(function(e){n&&(O([].concat(Object(p.a)(k),[n])),a(void 0))},[n,k,O]),I=Object(s.useCallback)(function(e){if(q){var t=k.indexOf(q),n=Object(p.a)(k);n.splice(t,1);var a=n.indexOf(e);n=[].concat(Object(p.a)(n.slice(0,a)),[q],Object(p.a)(n.slice(a))),T(void 0),O(n)}},[q,O,k,T]),P=Object(s.useCallback)(function(e){var t=k.indexOf(e),n=Object(p.a)(k);n.splice(t,1),O(n)},[k,O]),R=Object(s.useCallback)(Object(o.a)(c.a.mark(function e(){var n,a,o,i,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={name:v,title:v,projects:k,image:w,id:Object(Ec.uuid)()},r&&(n.hash=r.newContent,n.newContent=r.newContent),a=(a=l.a.getItem("unsavedLists"))?JSON.parse(a):[],!(r&&a.length>0)){e.next=16;break}e.t0=c.a.keys(a);case 6:if((e.t1=e.t0()).done){e.next=14;break}if(o=e.t1.value,!((i=a[o]).name===r.name||r.hash&&i.hash===r.hash)){e.next=12;break}return a[o]=n,e.abrupt("break",14);case 12:e.next=6;break;case 14:e.next=17;break;case 16:a.push(n);case 17:s=JSON.stringify(a),l.a.setItem("unsavedLists",s),d(a),t(n);case 21:case"end":return e.stop()}},e)})),[v,k,w,t,r]);return u.a.createElement("div",{className:"new-list"},u.a.createElement("div",{onDrop:M,onDragOver:function(e){return e.preventDefault()},className:"inner"},u.a.createElement("input",{placeholder:"Type name for list",value:v,onChange:function(e){return h(e.target.value)},type:"text"}),u.a.createElement("div",{className:"projects"},k.map(function(e){return u.a.createElement("div",{key:e.newSequence,onDrop:function(){return I(e)},onDragOver:function(e){return e.preventDefault()},onDragStart:function(){return T(e)},draggable:!0,className:"project"},u.a.createElement("div",{className:"project-name"},e.title),u.a.createElement("div",{onClick:function(){return P(e)},className:"delete-btn"},"x"))})),u.a.createElement("div",{className:"drop-here"},u.a.createElement("span",null,"Drop projects here")),u.a.createElement("div",{className:"btns"},u.a.createElement("div",{onClick:R,className:"done-btn"},"Done"),u.a.createElement("div",{onClick:function(){return t()},className:"cancel-btn"},"Cancel"))),u.a.createElement("div",{className:"inner"},u.a.createElement(C.a,{imageHash:w,setImageHash:S}),r?u.a.createElement("div",{onClick:function(){window.confirm("Confirm delete")&&f()},className:"delete-list-btn"},"Delete List"):""))}),Oc=Object(f.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{}})(function(e){var t=e.loadWork,n=Object(s.useState)(!1),a=Object(i.a)(n,2),r=a[0],c=a[1],o=Object(s.useState)(!1),l=Object(i.a)(o,2),d=l[0],f=l[1],p=Object(s.useState)(Object(A.a)({},e.list)),b=Object(i.a)(p,2),v=b[0],h=b[1],g={backgroundImage:"url("+m.a.getHashUrl(v.image)+")"};Object(s.useEffect)(function(){He.a.getAccount().then(function(e){e&&(v.user?c(e.toLowerCase()===v.user.toLowerCase()):c(!0))})},[c]);var E=Object(s.useCallback)(function(t){t&&(h(t),e.onListChanged(t)),f(!1)},[h,f]),k=Object(s.useCallback)(function(t){var n="project";return e.worksLoaded.some(function(e){return e.newSequence===t.newSequence})&&(n+=" loaded"),n},[e.worksLoaded]);return Object(s.useEffect)(function(){e.list.projects[0]&&0===e.worksLoaded.length&&t(v.projects[0])},[]),d?u.a.createElement(kc,{onDelete:e.onDelete,list:v,hide:E}):u.a.createElement("div",{style:g,className:"list"},r?u.a.createElement("div",{onClick:function(){return f(!0)},className:"edit-button"},"Edit"):"",u.a.createElement("div",{className:"projects"},v.projects.map(function(e){return u.a.createElement("div",{onClick:function(){return t(e)},className:k(e)},e.title)})),u.a.createElement("div",{className:"list-title"},v.name),u.a.createElement("div",{onClick:e.removeList,className:"delete-btn"},"x"))}),jc=(n(2591),Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.creatingNewList,n=e.lists,a=(e.hide,e.loadWork),r=e.removeList,c=e.onListChanged;return u.a.createElement("div",{className:"lists-container"},n.map(function(e,t){return u.a.createElement(Oc,{onListChanged:c,onDelete:function(){c(e,!0),r(e)},removeList:function(){return r(e)},key:e.name,loadWork:a,list:e})}),t?u.a.createElement(kc,{hide:c}):"",u.a.createElement(gc,null))})),yc=Object(f.b)(function(e,t){return{personSelected:e.explore.personSelected}},function(e){return{setPersonSelected:function(t){return e(Object(d.Pb)(t))}}})(function(e){var t=e.onNewList,n=e.personSelected,a=e.setPersonSelected,r=e.children,c=Object(s.useState)(void 0),o=Object(i.a)(c,2),l=o[0],d=o[1],f=Object(s.useState)(!1),m=Object(i.a)(f,2),p=m[0],b=m[1];return Object(s.useEffect)(function(){n?Be.a.users.getUserName(n).then(d):d(void 0)},[n,d]),u.a.createElement("div",{className:"explore-toolbar"},u.a.createElement("div",{className:"toolbar-btn"},u.a.createElement(T.c,{className:"view-dropdown",show:p?"true":"false",isOpen:p,toggle:function(){return b(!p)}},u.a.createElement(T.f,{size:"sm",caret:!0,color:"primary"},u.a.createElement("img",{className:"explore-commands-icon",src:"/automation-icon-disabled.png"})),u.a.createElement(T.e,null,u.a.createElement(T.d,{onClick:t,key:"",size:"sm"},"New List")))),l?u.a.createElement("div",{onClick:function(){return a(void 0)},className:"user-selected"},l):"",r)}),wc=function(e){var t=e.work,n=(e.numPending,Object(s.useState)([])),a=Object(i.a)(n,2),r=a[0],c=a[1];return Object(s.useEffect)(function(){t&&Be.a.xanadu.getAnnotations("SEQUENCE_TAG",t.newSequence).then(function(e){return c(Array.from(new Set(e.map(function(e){return e.annotationData}))))})},[c,t]),{newTag:Object(s.useCallback)(function(e){""!==e.trim()&&(Be.a.xanadu.newAnnotation("SEQUENCE_TAG",t.newSequence,e),c([].concat(Object(p.a)(r),[e])))},[t,r,c]),tags:r,setTags:c}},Sc=Object(f.b)(null,null)(function(e){var t=e.work,n=Object(s.useState)(""),a=Object(i.a)(n,2),r=a[0],c=a[1],o=Object(s.useRef)(void 0),l=wc({work:t}),d=l.newTag,f=l.setTags,m=l.tags,p=Object(s.useCallback)(function(e){c(e.target.value)},[c]);Object(s.useEffect)(function(){o.current&&o.current.focus()},[]);var b=Object(s.useCallback)(function(){d(r),c("")},[c,r,m,t,f]);return u.a.createElement("div",{className:"tags-editor"},u.a.createElement("div",{className:"input-container"},u.a.createElement("input",{ref:o,placeholder:"Type tag here",className:"tags-input",type:"text",onChange:p,value:r}),u.a.createElement("div",{onClick:b,className:"tag-button"},"Tag")),u.a.createElement("div",{className:"work-tags"},m.map(function(e){return u.a.createElement("div",{className:"work-tag"},e)})))}),Cc=function(e){var t=e.edit,n=Object(s.useState)(""),a=Object(i.a)(n,2),r=a[0],c=a[1],o=Object(s.useState)(""),l=Object(i.a)(o,2),d=l[0],f=l[1];return Object(s.useEffect)(function(){Be.a.users.getUserName(t.user).then(function(e){return c(e)})},[t,c]),Object(s.useEffect)(function(){Be.a.getBlockDate(t.blockNumber).then(function(e){return f(e.toISOString().substring(0,10))})},[f,t]),u.a.createElement("div",{className:"sequence-edit"},u.a.createElement("div",{className:"title"},t.title," -"),u.a.createElement("div",{className:"author"},r),u.a.createElement("div",{className:"date"},d))},xc=Object(f.b)(function(e,t){return{allSequences:e.explore.allSequences}},null)(function(e){var t=e.work,n=e.allSequences,a=Object(s.useState)([]),r=Object(i.a)(a,2),c=r[0],o=r[1];Object(s.useEffect)(function(){var e=Be.a.getEditsForSequence(t.newSequence,n);console.log("edits = ",e),o(e)},[o,t,n]);return u.a.createElement("div",null,u.a.createElement("div",{className:"sequence-edits"},c.map(function(e){return u.a.createElement(Cc,{edit:e})})),u.a.createElement("div",{onClick:function(){window.open("/create/"+t.newSequence)},className:"new-edit-button"},"Create New Edit"))}),Nc={},qc=function(e){var t=e.annotation,n=e.style,a=Object(s.useState)(""),r=Object(i.a)(a,2),c=r[0],o=r[1],l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],p=d[1];return Object(s.useEffect)(function(){var e=G.a.utils.fromAscii(t.annotationData),n=Object(Ke.a)(e);Nc[n]?o(Nc[n]):m.a.getJson(n).then(function(e){Nc[n]=e,o(e)}),Be.a.users.getUserName(t.address).then(function(e){return p(e)})},[t,o,p]),u.a.createElement("div",{style:n,className:"annotation"},u.a.createElement("div",{className:"author"},f,":"),u.a.createElement("div",{className:"content"},c))},Tc=Object(f.b)(function(e,t){return{numPending:e.transactions.pendingTransactions.length}},null)(function(e){var t=e.work,n=e.contentId,a=void 0===n?t&&t.newSequence:n,r=e.numPending,c=e.linkType,o=void 0===c?"SEQUENCE_ANNOTATION":c,l=e.color,d=Object(s.useState)(""),f=Object(i.a)(d,2),m=f[0],p=f[1],b=Object(s.useState)(!1),v=Object(i.a)(b,2),h=(v[0],v[1]),g=Object(s.useState)([]),E=Object(i.a)(g,2),k=E[0],O=E[1],j=Object(s.useCallback)(function(e){p(e.target.value)},[p]),y=Object(s.useCallback)(function(){Be.a.xanadu.newAnnotationContent(o,a,m).then(function(e){return h(!0)}),p(""),h(!0)},[a,m,p,h]);Object(s.useEffect)(function(){a&&Be.a.xanadu.getAnnotations(o,a).then(function(e){O(e)})},[a,O,r]);var w={};return l&&(w.backgroundColor=l),u.a.createElement("div",null,u.a.createElement(T.g,{style:w,className:"annotation-text",onChange:j,type:"textarea",value:m}),u.a.createElement("div",{style:w,onClick:y,className:"submit-button"},"Annotate"),u.a.createElement("div",{style:w,className:"annotations"},u.a.createElement(Ln.a,{sizeUnit:"px",size:10,color:"#42f4f1",loading:r>0}),k.map(function(e){return u.a.createElement(qc,{style:w,key:e.annotationData,annotation:e})})))}),Mc=(n(2592),function(e){var t=e.annotationsView;if(!t)return u.a.createElement("div",null);var n=["ANNOTATION","TAGS","EDITS"];return u.a.createElement("div",null,u.a.createElement(Ic,{annotationsView:t,linkType:n[0],linkNumber:0},u.a.createElement(Tc,{work:t})),u.a.createElement(Ic,{annotationsView:t,linkType:n[1],linkNumber:1},u.a.createElement(Sc,{work:t})),u.a.createElement(Ic,{annotationsView:t,linkType:n[2],linkNumber:2},u.a.createElement(xc,{work:t})))}),Ic=function(e){var t=e.annotationsView,n=e.linkNumber,a=e.linkType,r=e.children,c={left:130+220*n},o=[210+250*t.workNumber,0,130+220*n,80,330+220*n,80];return console.log("points = ",o,t),u.a.createElement("div",null,u.a.createElement("svg",{className:"annotations-svg "+a,height:"80",width:"1000"},u.a.createElement("polygon",{points:o})),u.a.createElement("div",{style:c,className:"annotations-view "+a},r))},Pc=0,Rc=function(e){var t=e.hideText,n=e.searchOptions,a=e.option,r=e.onClickOption,c=e.baseClass,o=void 0===c?"search-option":c,i=e.selectedClass,s=void 0===i?"selected":i;return u.a.createElement("div",{onClick:function(){return r(a)},className:n.indexOf(a)>-1?o+" "+s:o},t?"":"Starred"===a?u.a.createElement("span",null,"\u2606"):a)},Dc=function(e){e.searchTerm;var t=e.setSearchTerm,n=e.setSearchOptions,a=e.searchOptions,r=e.setSearchTag,c=e.searchTag,o=Object(s.useState)(""),l=Object(i.a)(o,2),d=l[0],f=l[1],m=Object(s.useCallback)(function(e){var r=++Pc,c=e.target.value;setTimeout(function(){Pc===r&&(t(c),(a.includes("Starred")||a.includes("Favorited"))&&n(a.filter(function(e){return"Starred"!==e&&"Favorited"!==e})))},750),f(e.target.value)},[f,t,a,n]),b=Object(s.useCallback)(function(e){if(-1==a.indexOf(e))n("Lists"===e||"Projects"===e?[e]:[e].concat(Object(p.a)(a)));else{var t=a.filter(function(t){return t!==e});console.log("setting search options = ",t),n(t)}},[a,n]);return u.a.createElement("div",{className:"explore-search-container"},c?u.a.createElement("div",{onClick:function(){return r(void 0)},className:"search-tag"},c):"",u.a.createElement("div",{className:"heart-and-soul"},u.a.createElement(Rc,{hideText:!0,baseClass:"heart",selectedClass:"favorited",onClickOption:b,searchOptions:a,option:"Favorited"}),u.a.createElement("div",null),u.a.createElement(Rc,{baseClass:"star",selectedClass:"starred",onClickOption:b,searchOptions:a,option:"Starred"})),u.a.createElement(Rc,{onClickOption:b,searchOptions:a,option:"Lists"}),u.a.createElement(Rc,{onClickOption:b,searchOptions:a,option:"Projects"}),u.a.createElement("input",{type:"text",value:d,onChange:m,className:"explore-search",placeholder:"Type to search"}),u.a.createElement("div",{onClick:function(){t(""),f(""),r(void 0)},className:"search-clear-btn"},"x"))},Ac=n(76),Lc=function(e){return{type:3,work:e}},zc=function(e,t){return{type:8,sequenceId:e,color:t}},Hc=n(592);function Uc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}function Gc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}n(1357);var Fc=n(1490),Bc=n(950);function Wc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var Vc=function(e){Object(xe.a)(n,e);var t=Wc(n);function n(){return Object(Se.a)(this,n),t.apply(this,arguments)}return n}(function(e){return function(e){Object(xe.a)(n,e);var t=Gc(n);function n(){return Object(Se.a)(this,n),t.apply(this,arguments)}return Object(Ce.a)(n,[{key:"saveMix",value:function(){var e=Object(o.a)(c.a.mark(function e(t,n){var a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,He.a.getAccount();case 3:return e.t1=e.sent,e.t2=this.events,e.t3=this.worksLoaded,e.t4=this.initialState,a={title:e.t0,user:e.t1,events:e.t2,works:e.t3,initialState:e.t4},n=void 0===n?G.a.utils.padLeft("0x0",64):Object(Ke.c)(n),e.next=11,m.a.addJson(a);case 11:return r=e.sent,o=this.worksLoaded.map(function(e){return Object(Ke.c)(e.newSequence)}),new _e.a($e.o,"newMix",[Object(Ke.c)(r),n,t,o,0]).execute(),e.abrupt("return",a);case 15:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadMix",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("LOAD MIX CALLED!"),this.unloadAll(),this.events=t.events,this.initialState=t.initialState||{worksLoaded:t.works},this.store.dispatch(Object(d.Nb)(t)),console.log("mix loaded =",t),n=Array.from(new Set([].concat(Object(p.a)(this.initialState.worksLoaded),Object(p.a)(t.works)))),e.t0=c.a.keys(n);case 8:if((e.t1=e.t0()).done){e.next=15;break}return a=e.t1.value,console.log("loading work =",n[a]),e.next=13,this.loadWork(n[a]);case 13:e.next=8;break;case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"clearMix",value:function(){this.clearScheduledEvents(),this.initialState=void 0,this.events=[],this.store.dispatch(Object(d.Nb)(void 0))}}]),n}(e)}(function(e){Object(xe.a)(n,e);var t=Uc(n);function n(){var e;Object(Se.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).events=[],e.hasEdits=!1,e}return Object(Ce.a)(n,[{key:"isRecordingMix",get:function(){return this.state.explore.isRecordingMix}},{key:"currentTransportTime",get:function(){var e=parseFloat(ge.a.Transport.position.split(":")[2]);return"0:0:"+(e-Math.floor(e)+this.trackStep/2)}},{key:"dispatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.currentTransportTime,a=e.sequenceId&&this.getSequencerEngine(e.sequenceId);switch(e.type){case 1:this.switchToPattern(a,e.subSequenceId,e.patternNumber);break;case 2:this.playWork(e.work);break;case 3:this.loadWork(e.work);break;case 4:this.unloadWork(e.work);break;case 5:this.changeTranspose(a,e.transpose);break;case 6:this.changeVolume(a,e.volume);break;case 8:this.changeColor(a,e.color);break;case 7:this.changeBPM(e.bpm)}!t&&this.isRecordingMix&&(e=Object(A.a)({},e,{time:n}),this.events.push(e),this.hasEdits=!0)}},{key:"playWork",value:function(e){this.play(e),this.isNothingPlaying()&&this.clearScheduledEvents()}},{key:"worksLoaded",get:function(){return this.state.explore.worksLoaded}},{key:"loadWork",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("MultiMix.loadWork =",t),!this.worksLoaded.some(function(e){return e.newSequence===t.newSequence})){e.next=5;break}return n=this.getSequencerEngine(t.newSequence),this.setWorkDefaults(n),e.abrupt("return");case 5:return this.store.dispatch(Object(d.og)([].concat(Object(p.a)(this.worksLoaded),[t]))),e.next=8,this.loadTrack(t.newSequence);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"unloadWork",value:function(e){if(this.worksLoaded.some(function(t){return t.newSequence===e.newSequence})){var t=Object(p.a)(this.worksLoaded),n=t.indexOf(e);t.splice(n,1),this.store.dispatch(Object(d.og)(t)),this.unloadTrack(e.newSequence)}}},{key:"switchToPattern",value:function(e,t,n){e&&(e.switchToSubSequence(t),e.switchToPattern(n))}},{key:"changeColor",value:function(e,t){e&&(e.channelMixer.mixEffects.filter=t,this.store.dispatch(Object(d.Lc)(e.sequenceId,t)))}},{key:"changeTranspose",value:function(e,t){e&&(e.transpose=t,this.store.dispatch(Object(d.mg)(e.sequenceId,t)))}},{key:"changeVolume",value:function(e,t){e&&(e.setMasterVolume(t,.05),this.store.dispatch(Object(d.ng)(e.sequenceId,t)))}},{key:"changeBPM",value:function(e){this.updateBpm(e)}},{key:"setInitialValuesForMix",value:function(){if(this.initialState){var e=this.initialState,t=e.workVolumes,n=e.worksLoaded,a=e.workTransposes,r=e.mixColorValues,c=e.bpm;for(var o in c&&this.changeBPM(c),t){var i=this.getSequencerEngine(o);i&&this.changeVolume(i,t[o])}for(var s in a){var u=this.getSequencerEngine(s);u&&this.changeTranspose(u,a[s])}for(var l in n)this.loadWork(n[l]);for(var d in r){var f=this.getSequencerEngine(d);f&&this.changeColor(f,r[d])}}}},{key:"saveInitialValuesForMix",value:function(){var e=this.store.getState();this.initialState={worksLoaded:Object(p.a)(e.explore.worksLoaded),workTransposes:Object(A.a)({},e.explore.workTransposes),workVolumes:Object(A.a)({},e.explore.workVolumes),bpm:e.user.bpm,mixColorValues:Object(A.a)({},e.explore.mixColorValues)}}},{key:"playMix",value:function(e){var t=this;e?(this.isRecordingMix?this.saveInitialValuesForMix():this.setInitialValuesForMix(),this.eventIds=this.events.map(function(e){return ge.a.Transport.schedule(function(n){2===e.type&&(n=0),setTimeout(function(){t.dispatch(e,!0)},n)},e.time)}),this.play()):(this.clearScheduledEvents(),this.stop())}},{key:"clearScheduledEvents",value:function(){this.eventIds&&(this.eventIds.forEach(function(e){return ge.a.Transport.clear(e)}),this.eventIds=[])}},{key:"setWorkDefaults",value:function(e){this.changeTranspose(e,0),this.changeVolume(e,0)}},{key:"hasEdits",set:function(e){this.store.dispatch(Object(d.Nc)(e))}},{key:"unloadAll",value:function(){this.clearMix(),this.stop(),this.hasEdits=!1;var e=Object(p.a)(this.worksLoaded);for(var t in e)this.unloadWork(e[t])}}]),n}(function(){function e(t){Object(Se.a)(this,e),this.store=t,this.idToSequencerEngine={},this.headSequencerEngine=void 0,this.sequencerEnginesToPlay=[],this.sequenceIdQueue=[],window.sequencerEngine=this,this.initAubio()}return Object(Ce.a)(e,[{key:"getHead",value:function(){return this.idToSequencerEngine[Object.keys(this.idToSequencerEngine)[0]]}},{key:"state",get:function(){return this.store.getState()}},{key:"trackStep",get:function(){for(var e in this.idToSequencerEngine){var t=this.idToSequencerEngine[e].trackStepReal;if(t>0)return t}return 0}},{key:"initAubio",value:function(){var e=this;window.Aubio().then(function(t){e.aubio=t})}},{key:"sampleRate",set:function(e){Hc.a.setSampleRate(e)}},{key:"stop",value:function(){for(var e in this.idToSequencerEngine)this.idToSequencerEngine[e].stop();ge.a.Transport.stop()}},{key:"updateBpm",value:function(e){for(var t in this.idToSequencerEngine)this.idToSequencerEngine[t].updateBpm(e)}},{key:"getSequencerEngine",value:function(e){return void 0===e?this.idToSequencerEngine[Object.keys(this.idToSequencerEngine)[0]]:this.idToSequencerEngine[e]}},{key:"stepOneCallback",value:function(e){this.sequencerEnginesToPlay.forEach(function(t){var n=ge.a.Transport.getTicksAtTime(e),a=new ge.a.TransportTime(n,"i");t.play(a)}),this.sequencerEnginesToPlay=[]}},{key:"getSamplerPlaySequence",value:function(){return null}},{key:"isNothingPlaying",value:function(){return 0===this.getSequencesPlaying().length}},{key:"getSequencesPlaying",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.store.getState().sequencer.isPlaying;return Object.keys(this.idToSequencerEngine).filter(function(n){return!1===e&&void 0===t[n]||t[n]===e})}},{key:"unloadTrack",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.idToSequencerEngine[e];n.playing&&n.stop(),delete this.idToSequencerEngine[e];var a=this.sequenceIdQueue.indexOf(e);a>-1&&this.sequenceIdQueue.splice(a,1),this.store.dispatch(Object(d.kc)(e,void 0)),t&&setTimeout(function(){n.dispose()},500)}},{key:"loadTrack",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getSequencesPlaying(!1),this.sequenceIdQueue.length>7&&(n.length>0?this.unloadTrack(n[0]):(a=this.sequenceIdQueue.shift(),this.unloadTrack(a))),this.store.dispatch(Object(d.Bc)(t,!0)),(r=new Fc.default(this.store,!0,void 0,this.aubio)).channelMixer.connectMixEffects(),o=new Bc.a(r,!0),r.setScripting(o),r.multiSequencerEngine=this,r.loadedSequenceId=t,r.setMasterVolume(1),this.sequenceIdQueue.push(t),this.idToSequencerEngine[t]=r,this.store.dispatch(Object(d.kc)(t,!1)),e.next=15,r.loadSequence(t);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"initSamplerTrack",value:function(){}},{key:"sequenceRolling",value:function(){for(var e in this.idToSequencerEngine){if(this.idToSequencerEngine[e].isSequenceRolling)return!0}return!1}},{key:"play",value:function(e){var t=this,n=this.getSequencerEngine(e&&e.id);if(void 0!==n){n.playing&&this.getSequencesPlaying(!0).length,e&&e.playing&&this.setHeadSequencerEngine(void 0);var a=this.getSequencesPlaying(!0);0==this.getSequencesPlaying(!0).length||n.playing?(this.store.dispatch(Object(d.lc)(!0)),n.playing||0!=a.length||this.setHeadSequencerEngine(n),n.play()):this.sequencerEnginesToPlay.push(n),(a=a.map(function(e){return t.idToSequencerEngine[e]}).filter(function(e){return e!==n})).length>0&&a.every(function(e){return void 0===e.stepOneCallback})&&this.setHeadSequencerEngine(a[0])}}},{key:"setHeadSequencerEngine",value:function(e){var t=this;void 0!==e||void 0===this.headSequencerEngine?(this.headSequencerEngine=e,this.headSequencerEngine.stepOneCallback=function(e){return t.stepOneCallback(e)}):this.headSequencerEngine.stepOneCallback=void 0}}]),e}())));function Qc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var Jc=function(e){Object(xe.a)(n,e);var t=Qc(n);function n(){return Object(Se.a)(this,n),t.apply(this,arguments)}return Object(Ce.a)(n,[{key:"render",value:function(){return 0===this.props.numPending?u.a.createElement("div",null):u.a.createElement("div",{className:"pending-transactions"},"Syncing ",this.props.numPending," items",u.a.createElement(Ln.a,{sizeUnit:"px",size:8,color:"#6200ff",loading:!0}))}}]),n}(s.Component),_c=Object(f.b)(function(e,t){return{numPending:e.transactions.pendingTransactions.length}},null)(Jc),Yc=n(1350);function Zc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var Xc=function(e){Object(xe.a)(n,e);var t=Zc(n);function n(e){var a;return Object(Se.a)(this,n),(a=t.call(this,e)).state={password:"",incorrectPassword:!1,needsToSetPassword:!1,userName:void 0},a.onClickDone=a.onClickDone.bind(Object(yn.a)(a)),a.onClickCancel=a.onClickCancel.bind(Object(yn.a)(a)),a}return Object(Ce.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.show&&e.show!==this.props.show&&(this.getNeedsToSetPassword(),this.getUserName()),!0}},{key:"getUserName",value:function(){var e=Object(o.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,He.a.getUserName();case 3:e.t1=e.sent,e.t2={userName:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getNeedsToSetPassword",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be.a.encryption.getPublicKey();case 2:t=e.sent,console.log("ethereum.getPublicKey() returned = "),console.log(t),void 0===t&&this.setState({needsToSetPassword:!0});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){return e.show!==this.props.show&&(console.log("password input = "),console.log(this.input.passwordInput),this.input.passwordInput.focus()),!0}},{key:"onClickDone",value:function(){var e=Object(o.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.crypto.isCorrectPassword(this.state.password);case 2:if(e.sent){e.next=7;break}return this.setState({incorrectPassword:!0}),e.abrupt("return");case 7:this.setState({incorrectPassword:!1});case 8:this.props.setShowPasswordModal(!1),console.log("passwordModalCallback("+this.state.password+")"),this.props.passwordModalCallback(this.state.password);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickCancel",value:function(){this.props.passwordModalCallback(void 0),this.props.setShowPasswordModal(!1)}},{key:"handleChange",value:function(e){this.setState({password:e.target.value})}},{key:"onKeyDown",value:function(e){"Enter"===e.key&&this.onClickDone()}},{key:"render",value:function(){var e=this;return u.a.createElement(q.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:function(){return e.props.setShowPasswordModal(!1)}},u.a.createElement(q.a.Body,null,u.a.createElement(Ue.a,{condition:this.state.incorrectPassword},u.a.createElement("div",{className:"incorrect-password"},"Incorrect password")),u.a.createElement(Ue.a,{condition:void 0!==this.state.userName},"Password required to access",u.a.createElement("div",{className:"password-user-name"},this.state.userName)),u.a.createElement(Ue.a,{condition:this.state.needsToSetPassword},"Create a password to be used to encrypt your projects. Remember the password you choose."),u.a.createElement("div",{className:"password-container"},u.a.createElement(Sn.a,{id:"password",name:"password",placeholder:"Enter password",onKeyDown:function(t){return e.onKeyDown(t)},ref:function(t){return e.input=t},value:this.state.password,onChange:this.handleChange.bind(this)}))),u.a.createElement(q.a.Footer,null,u.a.createElement(T.b,{variant:"secondary",onClick:this.onClickDone},"Done"),u.a.createElement(T.b,{variant:"primary",onClick:this.onClickCancel},"Cancel")))}}]),n}(s.Component),Kc=Object(f.b)(function(e){return{show:e.sequencer.showPasswordModal,passwordModalCallback:e.sequencer.passwordModalCallback}},function(e){return{setShowPasswordModal:function(t){return e(Object(d.Le)(t))}}})(Xc),$c=n(902);n(2593);function eo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var to=new b.a,no=function(e){Object(xe.a)(n,e);var t=eo(n);function n(e){var a;return Object(Se.a)(this,n),(a=t.call(this,e)).state={isAuthorized:!1,toggled:!1,guilds:[]},Be.a.store=a.props.store,He.a.setStore(a.props.store),He.a.setEthereum(Be.a),He.a.checkLogin(),a.getGuilds(),a.getUserName(),a}return Object(Ce.a)(n,[{key:"componentDidMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.userToken!==e.userToken&&(this.getGuilds(),this.getUserName()),this.state.toggled,t.toggled,!0}},{key:"getUserName",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,He.a.getUserName();case 2:t=e.sent,this.setState({userName:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getGuilds",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be.a.guilds.getGuildsForUser();case 2:if(t=e.sent,n=l.a.getItem("selectedGuild"))try{(n=JSON.parse(n))&&t.some(function(e){return e.guildId===n.guildId})&&this.props.setSelectedGuild(t.find(function(e){return e.guildId===n.guildId}))}catch(a){}this.setState({guilds:t.filter(function(e){return!e.name.includes(",")})});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickLogIn",value:function(){this.props.setSigningUp(!1),this.props.setShowLogin(!0)}},{key:"onClickSignUp",value:function(){this.props.setSigningUp(!0),this.props.setShowLogin(!0)}},{key:"onClickLogout",value:function(){He.a.logout()}},{key:"onClickGuild",value:function(e){void 0!==e&&Be.a.crypto.getPassword(),this.props.setSelectedGuild(e),l.a.setItem("selectedGuild",JSON.stringify(e))}},{key:"toggle",value:function(){this.setState({toggled:!this.state.toggled})}},{key:"getSelectedGuild",value:function(){return this.props.selectedGuild?this.props.selectedGuild.name:this.state.userName}},{key:"onClickConnect",value:function(){var e=this;Object(Yc.b)().then(function(t){t||Object(Yc.a)(),e.setState({isAuthorized:t})})}},{key:"goToGuildsPage",value:function(){}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"guilds-menu"},u.a.createElement(Kc,{crypto:Be.a.crypto,show:!0}),u.a.createElement(T.c,{className:"view-dropdown guilds-dropdown",show:this.state.toggled?"true":"false",isOpen:this.state.toggled,toggle:function(){return e.toggle()}},He.a.isLoggedIn()?u.a.createElement(T.f,{size:"sm",caret:!0,color:"primary"},u.a.createElement("div",{style:this.props.selectedGuild&&{backgroundColor:to.getColorForHash(this.getSelectedGuild())},className:"not-recording-dot"}),u.a.createElement("span",{className:"guild-name"},this.getSelectedGuild())):u.a.createElement(T.f,{size:"sm",caret:!0,color:"primary"},u.a.createElement("div",{className:"not-recording-dot logged-out"}),"Log In"),u.a.createElement(T.e,null,u.a.createElement(Ue.a,{condition:!He.a.isLoggedIn()},u.a.createElement(T.d,{key:"",onClick:function(){return e.onClickLogIn()},size:"sm"},"Log In"),u.a.createElement(T.d,{key:"public",onClick:function(){return e.onClickSignUp()},size:"sm"},"Sign Up")),u.a.createElement(Ue.a,{condition:He.a.isLoggedIn()},u.a.createElement("div",{onClick:function(){return e.props.setIsManagingGuilds(!0)},className:"guilds-mgmt-btn"},"Manage Groups"),u.a.createElement(T.d,{key:"public",className:"connect-wallet-option",size:"sm"},this.state.isAuthorized?u.a.createElement("div",{className:"guild-dropdown-option connected-btn"},ao(this.state.isAuthorized)):u.a.createElement("div",{onClick:function(){return e.onClickConnect(void 0)},className:"guild-dropdown-option connect-wallet-btn"},u.a.createElement("div",null,"Connect Wallet"))),u.a.createElement(T.d,{key:"public",onClick:function(){return e.onClickGuild(void 0)},size:"sm"},u.a.createElement("div",{className:"guild-dropdown-option"},u.a.createElement("div",null,"Everything"),u.a.createElement($c.a,{className:"guilds-checkmark",condition:void 0===this.props.selectedGuild}))),u.a.createElement("div",{className:"section-header"},"Groups"),this.state.guilds.map(function(t){return u.a.createElement(T.d,{key:t.name,onClick:function(){return e.onClickGuild(t)},size:"sm"},u.a.createElement("div",{className:"guild-dropdown-option"},u.a.createElement("div",{style:{backgroundColor:to.getColorForHash(t.name)},className:"dot"}),u.a.createElement("div",null,t.name),u.a.createElement($c.a,{className:"guilds-checkmark",condition:e.props.selectedGuild===t})))}),u.a.createElement("div",{className:"user-name-item"},u.a.createElement("div",{className:"not-recording-dot"})," ",u.a.createElement("span",{className:"guild-user-name"},this.state.userName)),u.a.createElement("div",{onClick:function(){return e.onClickLogout()},className:"logout-btn"}," Log out ")))))}}]),n}(s.Component),ao=function(e){return e.length>12?e.slice(0,12)+"...":e},ro=Object(f.b)(function(e){return{selectedGuild:e.guilds.selectedGuild,userToken:e.sequencer.userToken}},function(e){return{setSelectedGuild:function(t){return e(Object(d.ae)(t))},setShowLogin:function(t){return e(Object(d.He)(t))},setSigningUp:function(t){return e(Object(d.cf)(t))},setIsManagingGuilds:function(t){return e(Object(d.jc)(t))}}})(no),co=function(e){var t=e.name,n=e.option,a=e.selected,r=e.onClick,c="option";return a&&(c+=" selected"),u.a.createElement("div",{onClick:function(){return r(n)},className:c},t)},oo=Object(f.b)(function(e){return{selectedRecord:e.discover.selectedRecord,selectedGuild:e.guilds.selectedGuild,showLogin:e.sequencer.showLogin,option:e.explore.exploreOption,userToken:e.sequencer.userToken}},function(e){return{setOption:function(t){return e(Object(d.Ob)(t))}}})(function(e){e.setSearchTerm,e.searchTerm;var t=e.store,n=e.showLogin,a=e.option,r=e.setOption,c=(e.searchOptions,e.setSearchOptions,Object(s.useState)(!1)),o=Object(i.a)(c,2),l=o[0],d=o[1],f="navigation";return He.a.isLoggedIn()||(f+=" logged-off"),u.a.createElement("div",{className:f},u.a.createElement(co,{name:"Home",option:Ac.b,selected:a===Ac.b,onClick:r}),u.a.createElement(co,{name:"Guilds",option:Ac.a,selected:a===Ac.a,onClick:r}),u.a.createElement(co,{name:"Messages",option:Ac.c,selected:a===Ac.c,onClick:r}),u.a.createElement("div",{onClick:function(){return d(!0)},className:"preferences-btn"},"Preferences"),u.a.createElement(ro,{store:t}),u.a.createElement(_c,null),u.a.createElement(Nn,{show:n}),l?u.a.createElement(lt,{hide:function(){return d(!1)},onlyAppearance:!0}):"")}),io=function(e){var t=e.person,n=e.selected,a=e.onClick,r=t.userName,c=t.id,o=n?"person selected":"person";return u.a.createElement("div",{onClick:a,className:o},u.a.createElement("div",{className:"name"},r||c))},so=(n(759),function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,uo(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),uo=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,i,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a in n=new Set,t)n.add(t[a].user);n=Array.from(new Set(n)),r=[],e.t0=c.a.keys(n);case 5:if((e.t1=e.t0()).done){e.next=14;break}return o=e.t1.value,i=n[o].trim(),e.next=10,Be.a.users.getUserName(i);case 10:s=e.sent,r.push({id:i,userName:s}),e.next=5;break;case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),lo=(Object(f.b)(function(e,t){return{personSelected:e.explore.personSelected,allSequences:e.explore.allSequences}},function(e){return{setPersonSelected:function(t){return e(Object(d.Pb)(t))}}})(function(e){var t=e.personSelected,n=e.setPersonSelected,a=e.allSequences,r=Object(s.useState)([]),c=Object(i.a)(r,2),o=c[0],l=c[1];Object(s.useEffect)(function(){so(a).then(function(e){return l(e)})},[l,a]);var d="";return t&&(d=u.a.createElement(io,{onClick:function(){return n(void 0)},selected:!0,person:t})),u.a.createElement("div",{className:"people"},d,u.a.createElement("div",{className:"people-to-choose"},o.filter(function(e){return!t||t.id!==e.id}).map(function(e){return u.a.createElement(io,{onClick:function(){return n(e)},key:e.id,person:e})})))}),function(){var e=Object(o.a)(c.a.mark(function e(t,n,a,r,o,i){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(mn.a)(a,void 0,t,n,r,!1,o,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,n,a,r,c,o){return e.apply(this,arguments)}}()),fo=n(1151),mo=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Ye.a((new fo.a).contractAddress).from(Xe.A).select("mixHash").select("previousHash").select("title").select("user"),e.next=3,t.executeQuery(!1);case 3:return n=e.sent,console.log("mix results =",n),e.abrupt("return",n.map(function(e){return Object(A.a)({},e,{type:"MIX"})}));case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function po(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return bo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bo(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function bo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var vo=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a,r,o,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fc();case 2:t=e.sent,n=[],a=po(t);try{for(a.s();!(r=a.n()).done;)o=r.value,n.push(Object(A.a)({},o,{hash:o.newContent,tags:[],type:"LIST"}))}catch(c){a.e(c)}finally{a.f()}if(i=l.a.getItem("unsavedLists")){e.next=9;break}return e.abrupt("return",n);case 9:return i=JSON.parse(i),n=n.filter(function(e){return!i.some(function(t){return t.hash===e.hash})}),e.abrupt("return",[].concat(Object(p.a)(n),Object(p.a)(i.map(function(e){return Object(A.a)({},e,{id:void 0!==e.id?e.id:Object(Ec.uuid)(),title:e.name,unsaved:!0,tags:[],blockNumber:9999999999,type:"LIST"})}))));case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),ho=(new aa.a,function(){var e=Object(o.a)(c.a.mark(function e(t,n,a,r,o,i,s){var u,l,d,f,m,b;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("person selecred == ",s),u=a.includes("Favorited"),l=a.includes("Starred"),e.next=5,lo(l,u,r,o,i,s);case 5:return d=e.sent.map(function(e){return Object(A.a)({},e,{type:"SEQUENCE"})}),e.next=8,mo();case 8:return f=e.sent,e.next=11,vo();case 11:m=e.sent,(b=[].concat(Object(p.a)(m),Object(p.a)(f),Object(p.a)(d))).sort(function(e,t){return t.blockNumber-e.blockNumber}),t(Object(p.a)(b)),n(!1);case 16:case"end":return e.stop()}},e)}));return function(t,n,a,r,c,o,i){return e.apply(this,arguments)}}()),go=Object(f.b)(function(e,t){return{exists:t.sequencerEngine.events.length>0}},null)(function(e){var t=e.sequencerEngine,n=e.exists,a=e.originalMix,r=Object(s.useState)(void 0),l=Object(i.a)(r,2),d=l[0],f=l[1],m=Object(s.useState)(""),p=Object(i.a)(m,2),b=p[0],v=p[1],h=Object(s.useState)(""),g=Object(i.a)(h,2),E=g[0],k=g[1],O=Object(s.useCallback)(function(){t.clearMix(),f(void 0)},[f]);Object(s.useEffect)(function(){a&&Be.a.users.getUserName(a.user).then(function(e){return k(e)})},[a]);var j=Object(s.useCallback)(Object(o.a)(c.a.mark(function e(){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.saveMix(a?a.title:b,a&&a.mixHash);case 2:n=e.sent,f(n);case 4:case"end":return e.stop()}},e)})),[b,f,a]);return n?a?u.a.createElement("div",{className:"recorded-mix"},u.a.createElement("div",{className:"edit-text"},"Edit of ",u.a.createElement("span",{className:"mix-title"},a.title)," by ",u.a.createElement("span",{className:"mix-author"},E)),u.a.createElement("div",{className:"buttons-container"},d?"":u.a.createElement("div",{onClick:j,className:"save-mix-button"},"Save"),u.a.createElement("div",{onClick:O,className:"clear-mix-button"},"Clear"))):u.a.createElement("div",{className:"recorded-mix"},u.a.createElement("div",{className:"mix-title"},void 0===d?u.a.createElement("input",{placeholder:"Enter mix name",className:"mix-input",type:"text",value:b,onChange:function(e){return v(e.target.value)}}):u.a.createElement("div",null,d.title)),u.a.createElement("div",{className:"buttons-container"},d?"":u.a.createElement("div",{onClick:j,className:"save-mix-button"},"Save"),u.a.createElement("div",{onClick:O,className:"clear-mix-button"},"Clear"))):[]}),Eo=Object(f.b)(function(e,t){return{bpm:e.user.bpm}},null)(function(e){var t=e.bpm,n=e.sequencerEngine;return u.a.createElement("div",{className:"bpm-container"},u.a.createElement("div",{className:"bpm-label"},"BPM: ",Math.round(t)),u.a.createElement(fe.a,{value:t,change:function(e){return n.dispatch({type:7,bpm:e.target.value})},step:1,className:"bpm-fader",max:250,min:1,orientation:"horizontal",reversed:!1}))}),ko=n(637),Oo=Object(f.b)(function(e){return{playingMap:e.sequencer.isPlaying,isRecordingMix:e.mix.isRecordingMix}},function(e){return{setRecordingExploreMix:function(t){return e(Object(d.oc)(t))}}})(function(e){var t=e.sequencerEngine,n=e.isRecordingMix,a=e.playingMap,r=e.setRecordingExploreMix,c=Object.keys(a).filter(function(e){return a[e]}).length>0,o=Object(s.useCallback)(function(){r(!n)},[n,r]),i=Object(s.useCallback)(function(e){t.playMix(!c)},[t,c]);return u.a.createElement("div",{className:"work-mix-buttons"},u.a.createElement(ko.a,{isPlaying:c,play:i}),u.a.createElement("div",{onClick:o,className:n?"recording-dot":"not-recording-dot"}))});function jo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var yo=function(e){Object(xe.a)(n,e);var t=jo(n);function n(e){var a;return Object(Se.a)(this,n),(a=t.call(this,e)).state={clockDragging:!1,clockStartDragY:void 0,clockDragY:void 0},a}return Object(Ce.a)(n,[{key:"onClockMouseLeave",value:function(e){void 0!=this.seekTimer&&(clearInterval(this.seekTimer),this.seekTimer=void 0)}},{key:"onClockMouseDown",value:function(e){var t=this;void 0!==this.props.sequencerEngine&&(this.state.clockStartDragY=e.clientY,this.seekTimer=setInterval(function(){if(void 0!==t.state.clockDragY){var e=t.state.clockStartDragY-t.state.clockDragY,n=t.props.sequencerEngine.trackStep+5*e;n<0&&(n=0),t.props.sequencerEngine.seekToTrackStep(n)}},50))}},{key:"onClockMouseUp",value:function(e){clearInterval(this.seekTimer),this.seekTimer=void 0}},{key:"onClockMouseMove",value:function(e){this.state.clockDragY=e.clientY}},{key:"onClickMetronome",value:function(){void 0!==this.props.sequencerEngine&&(this.props.sequencerEngine.metronomeOn=!this.props.sequencerEngine.metronomeOn)}},{key:"render",value:function(){var e=this,t=Math.ceil(this.props.currentGlobalStep/32);t=isNaN(t)?1:t;var n=1+Math.floor(this.props.currentGlobalStep/8)%4,a=1+Math.floor(this.props.currentGlobalStep/2)%4,r="clock ";this.props.clockTick&&(r+="percentage-"+this.props.clockTick);var c="metronome";return this.props.metronomeOn&&(this.props.currentGlobalStep/4%4>=2&&(c+=" off-beat"),c+=" on"),u.a.createElement("div",{className:r,onMouseLeave:function(t){return e.onClockMouseLeave(t)},onMouseDown:function(t){return e.onClockMouseDown(t)},onMouseUp:function(t){return e.onClockMouseUp(t)},onMouseMove:function(t){return e.onClockMouseMove(t)}},u.a.createElement("div",{className:"track-time"},t),u.a.createElement("div",{className:"divider"},"."),u.a.createElement("div",{className:"time"},n),u.a.createElement("div",{className:"divider"},"."),u.a.createElement("div",{className:"time"},a),u.a.createElement(vn.a,{element:bn.u,onClick:function(){return e.onClickMetronome()},className:c},u.a.createElement("div",{className:"dot first"}),u.a.createElement("div",{className:"dot second"})))}}]),n}(s.Component),wo=Object(f.b)(function(e,t){if(void 0===t.sequencerEngine)return{currentStep:0,currentGlobalStep:0,clockTick:0,metronomeOn:!1};var n=t.sequencerEngine.getSequenceId();return{currentStep:e.sequencer.currentStep[n]||0,currentGlobalStep:e.sequencer.currentGlobalStep[n]||0,clockTick:e.clock.clockTick,metronomeOn:t.sequencerEngine.metronomeOn}},null)(yo),So=n(904),Co=function(e){var t=e.sequencerEngine,n=e.children;return u.a.createElement("div",{className:"mixer-toolbar-container"},u.a.createElement("div",{className:"mixer-toolbar"},u.a.createElement(Eo,{sequencerEngine:t}),u.a.createElement(Oo,{sequencerEngine:t}),u.a.createElement(wo,{sequencerEngine:t.headSequencerEngine}),u.a.createElement(So.a,{sequencerEngine:t})),n)},xo=(new b.a,Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.work,n=e.showComments,a=e.setSearchTag,r=e.editTags,c=void 0===r||r;t.id=t.newSequence;var o=Object(s.useState)([t]),l=Object(i.a)(o,2),d=l[0],f=(l[1],nc({works:d}).comments),m=Object(s.useState)(!1),p=Object(i.a)(m,2),b=p[0],v=p[1],h=wc({work:t}).tags,g=Yt({track:t}),E=g.isStarred,k=g.showStar,O=g.isFavorited,j=g.onStarClicked,y=g.onFavoriteClicked,w=Object(s.useCallback)(function(e,t){e.stopPropagation(),a(t)},[a]),S="work-metadata";return b&&(S+=" showing-tags"),u.a.createElement("div",{className:S},u.a.createElement("div",{className:"metadata-inner"},u.a.createElement("div",{className:"work-tags"},c?"":h.filter(function(e){return e}).map(function(e){return u.a.createElement("div",{onClick:function(t){return w(t,e)},className:"work-tag"},e)})),b?u.a.createElement(Sc,{work:t}):"",u.a.createElement("img",{onClick:function(){return v(!b)},className:b?"show tag-icon":"tag-icon",src:"/tag.svg"}),n&&f.length>0?u.a.createElement("img",{className:"comments-icon",src:"/comments.svg"}):"",u.a.createElement(Ue.a,{condition:k},u.a.createElement("div",{onClick:j,className:E?"star starred":"star"},u.a.createElement("span",null,"\u2606"))),u.a.createElement("div",{onClick:y,className:O?"heart favorited":"heart"})))})),No=(n(1400),["A","B","C","D","E","F","G","H","I","J"]),qo=Object(f.b)(function(e,t){var n=t.sequencerEngine.engineId;t.sequencerEngine.currentSubSequence.id;return{currentSubSequence:e.sequencer.currentSubSequence[n],subSequences:e.sequencer.subSequences[n]}},null)(function(e){var t=e.sequencerEngine,n=e.currentSubSequence,a=e.subSequences;return u.a.createElement("div",{className:"sub-sequences"},a.map(function(e,a){return u.a.createElement("div",{onClick:function(){return t.switchToSubSequence(e)},className:e===n?"sub-sequence current":"sub-sequence"},No[a])}))});function To(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(qe.a)(e);if(t){var r=Object(qe.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(Ne.a)(this,n)}}var Mo=["A","B","C","D","E","F","G","H"],Io=function(e){Object(xe.a)(n,e);var t=To(n);function n(){return Object(Se.a)(this,n),t.apply(this,arguments)}return Object(Ce.a)(n,[{key:"switchPattern",value:function(e){var t,n,a=this.props.sequencerEngine;a.multiSequencerEngine.dispatch((t=a.sequenceId,n=a.currentSubSequence.id,{type:1,sequenceId:t,subSequenceId:n,patternNumber:e}))}},{key:"chooseSubSequence",value:function(e){this.props.sequencerEngine.switchToSubSequence(e)}},{key:"getSubSequencesComponent",value:function(){var e=this,t=this.props.subSequences||[];return u.a.createElement("div",{className:"sub-sequence-buttons"},t.map(function(t,n){return u.a.createElement("div",{key:Mo[n],onClick:function(){return e.chooseSubSequence(t)},className:t===e.props.currentSubSequence?"sub-sequence selected":"sub-sequence"},Mo[n])}))}},{key:"render",value:function(){var e=this;return void 0===this.props.sequencerEngine.tracks[0]?this.getSubSequencesComponent():u.a.createElement("div",null,u.a.createElement("div",{className:"pattern-buttons"},this.props.sequencerEngine.tracks[0].patterns.map(function(t,n){return u.a.createElement("div",{style:e.props.color&&e.props.currentPattern===n?{backgroundColor:e.props.color}:{},onClick:function(){return e.switchPattern(n)},className:e.props.currentPattern===n?"current pattern-button":"pattern-button"},n+1)})),this.getSubSequencesComponent())}}]),n}(s.Component),Po=Object(f.b)(function(e,t){var n=t.sequencerEngine.engineId,a=t.sequencerEngine.currentSubSequence.id;return{currentPattern:e.sequencer.currentPattern[a]||0,subSequenceId:a,subSequences:e.sequencer.subSequences[n],currentSubSequence:e.sequencer.currentSubSequence[n]}},null)(Io),Ro=-70,Do=6;var Ao=Object(f.b)(function(e,t){return{masterVolume:e.sequencer.masterVolumes[t.id]}},null)(function(e){var t=e.masterVolume,n=(e.id,e.multiSequencerEngine),a=e.sequencerEngine,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ro,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Do;return Math.pow((e-t)/(n-t),4)}(t),c=Object(s.useCallback)(function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ro,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Do,a=Math.pow(e,.25);return t+(n-t)*a}(e.target.value);n.dispatch(function(e,t){return{type:6,sequenceId:e,volume:t}}(a.sequenceId,t))},[a,n]);return u.a.createElement("div",{className:"work-volume-container"},u.a.createElement(fe.a,{value:r,change:c,step:.01,className:"work-fader",max:1,min:0,orientation:"vertical",reversed:!0}))}),Lo=n(911),zo=new b.a,Ho=Object(f.b)(function(e,t){return{value:e.explore.workTransposes[t.sequencerEngine.sequenceId]||0}},null)(function(e){var t=e.sequencerEngine,n=e.value,a=e.id,r=Object(s.useCallback)(function(e){(e=Math.round(e))!==n&&t.multiSequencerEngine.dispatch({type:5,sequenceId:t.sequenceId,transpose:e})},[t,n]),c=zo.getColorForHash(a||"what");return u.a.createElement("div",{className:"transpose-container"},u.a.createElement(Lo.Knob,{size:50,angleOffset:220,angleRange:280,value:n,initialValue:n,step:1,min:-24,max:24,onChange:r},u.a.createElement(Lo.Arc,{arcWidth:3,color:c,background:"rgb(56, 63, 72)"}),u.a.createElement(Lo.Pointer,{width:3,height:15,radius:10,type:"rect",color:c}),u.a.createElement(Lo.Value,{className:"transpose-value"})))}),Uo=new b.a;var Go=Object(f.b)(function(e,t){return{value:e.explore.mixColorValues[t.id]}},function(e,t){return{setColorValue:function(n){return e(Object(d.Lc)(t.id,n))}}})(function(e){var t=e.value,n=void 0===t?.5:t,a=(e.setColorValue,e.mixEffects,e.sequencerEngine),r=e.id,c=Object(s.useCallback)(function(e){a.multiSequencerEngine.dispatch(zc(r,e))},[]),o=Uo.getColorForHash(r||"what");return u.a.createElement("div",{className:"color-container"},u.a.createElement(Lo.Knob,{size:50,angleOffset:220,angleRange:280,value:n,min:0,max:1,onChange:function(e){return c(e)}},u.a.createElement(Lo.Arc,{arcWidth:3,color:o,background:"rgb(56, 63, 72)"}),u.a.createElement(Lo.Pointer,{width:3,height:15,radius:10,type:"rect",color:o})))}),Fo=new b.a,Bo=Object(f.b)(function(e,t){return{isLoading:e.sequencer.loadingSequence[t.work.newSequence],isPlaying:e.sequencer.isPlaying[t.work.newSequence],isAnnotationShowing:e.explore.exploreWork===t.work,worksLoaded:e.explore.worksLoaded}},function(e){return{setExploreWork:function(t){return e(Object(d.Sb)(t))},setProjectDragging:function(t){return e(Object(d.Hd)(t))}}})(function(e){var t=e.workNumber,n=e.work,a=e.sequencerEngine,r=e.isLoading,c=e.isPlaying,o=e.unloadWork,l=e.setExploreWork,d=e.isAnnotationShowing,f=e.setProjectDragging,m=Object(s.useState)(""),p=Object(i.a)(m,2),b=p[0],v=p[1],h=a.idToSequencerEngine[n.newSequence],g=Object(s.useState)(n.title),E=Object(i.a)(g,2),k=E[0],O=E[1],j=Object(s.useState)(void 0),y=Object(i.a)(j,2),w=y[0],S=y[1];Object(s.useEffect)(function(){n.guildId&&Be.a.guildSequences._decryptQueryResult(n).then(function(e){return O(e.title)})},[n,O]),Object(s.useEffect)(function(){h&&h._wallpaper&&rt(h._wallpaper).then(function(e){e&&e[0]&&S(e[0].thumbnail)})},h&&h._wallpaper),Object(s.useEffect)(function(){Be.a.users.getUserName(n.user).then(function(e){return v(e)})},[n]);if(r||!h)return u.a.createElement("div",{className:"work-mixer loading"},u.a.createElement(jn.a,{width:200,id:n.newSequence}),u.a.createElement("div",{onClick:o,className:"delete-button"},"x"));var C=Fo.getColorForHash(n.newSequence),x={backgroundColor:C};n.workNumber=t;var N={};return w&&(N.backgroundImage="url(/ipfs/"+w+")"),u.a.createElement("div",{className:"work-mixer-container"},u.a.createElement("div",{style:{},className:"work-mixer"},u.a.createElement("div",{style:N,className:"inner"},u.a.createElement(Ao,{multiSequencerEngine:a,sequencerEngine:h,id:n.newSequence}),u.a.createElement("div",{className:"work-fields"},u.a.createElement(qo,{sequencerEngine:h}),u.a.createElement(Po,{color:C,sequencerEngine:h}),u.a.createElement("div",{className:"cassette"},u.a.createElement(Ho,{id:n.newSequence,sequencerEngine:h}),u.a.createElement(Go,{mixEffects:h.channelMixer.mixEffects,sequencerEngine:h,id:n.newSequence})))),u.a.createElement("div",{draggable:!0,onDragStart:function(){return f(n)},onDragOver:function(e){return e.preventDefault()},className:"bottom"},u.a.createElement("div",{style:x,className:"play-button"},u.a.createElement(ko.a,{color:Fo.getColorForHash(n.newSequence),isPlaying:c,play:function(){var e=Object(A.a)({},n,{id:n.newSequence});a.dispatch(function(e){return{type:2,work:e,isTransport:!0}}(e))}})),u.a.createElement("div",{className:"title"},u.a.createElement("div",{className:"work-title"},k),u.a.createElement("div",{className:"author-divider"},"-"),u.a.createElement("div",{className:"work-author"},u.a.createElement("div",{className:"author-label"},"Author"),u.a.createElement("div",{className:"author-name"},b))),u.a.createElement("img",{onClick:function(){return l(d?void 0:n)},src:"/annotations.png",className:d?"annotation-button showing":"annotation-button"}),u.a.createElement("div",{style:x,onClick:function(){l(void 0),o()},className:"delete-button"},"x")),u.a.createElement(xo,{work:n})))}),Wo=function(e){var t=e.recording,n=e.setDeleting,a=e.deleting,r=e.onClickRecord,c="button-option";t&&(c+=" selected");var o="button-option";return a&&(o+=" selected"),u.a.createElement("div",{className:"sample-options"},u.a.createElement("div",{className:"buttons"},u.a.createElement("div",{onClick:r,className:c},"Rec"),u.a.createElement("div",{onMouseDown:function(){return n(!0)},onMouseUp:function(){return n(!1)},className:o},"Del")))},Vo=n(619),Qo=n(33),Jo=n(596),_o=new b.a,Yo=new v.a(32,!1),Zo=(new Qo.a,function(e){var t=e.track,n=e.setLastClicked,a=e.selected,r=e.recording,c=t.instrument,o=Object(s.useState)(void 0),l=Object(i.a)(o,2),d=l[0],f=l[1],m=Object(s.useState)(0),p=Object(i.a)(m,2),b=p[0],v=p[1],h=Object(s.useState)(0),g=Object(i.a)(h,2),E=g[0],k=g[1],O=b>E,j=c.defaultSampler&&c.defaultSampler.sample,y=Object(s.useCallback)(function(){t.sequencerEngine.state.keyboard.isCommandDown?n(t):(c.defaultSampler.loop&&O?c.triggerRelease():c.triggerAttack(),r&&f(new Jo.a(t,0,Yo,t.sequencerEngine,!0)),n(t))},[c,t,r,f,O]),w=Object(s.useCallback)(function(){t.gated&&c.triggerRelease(),r&&d&&(d.record(),f(void 0))},[c,t,r,d,f]),S=Object(s.useCallback)(function(e){e.trackNumber===t.trackNumber&&setTimeout(function(){v((new Date).getTime()+e.duration),e.duration>0&&setTimeout(C,1e3*e.duration)},e.time)},[t,v,C]),C=Object(s.useCallback)(function(e){void 0!==e&&e.trackNumber!==t.trackNumber||k((new Date).getTime())},[t,k]),x=function(){window.removeEventListener(Vo.d,S),window.removeEventListener(Vo.c,C)};Object(s.useEffect)(function(){return window.addEventListener(Vo.d,S),window.addEventListener(Vo.c,C),x},[]);var N="sampler-trigger";if(O&&(N+=" triggering"),a&&(N+=" selected"),j&&j.videoId)return u.a.createElement("img",{draggable:!1,onMouseDown:y,onMouseUp:w,onMouseLeave:w,className:N,src:j.getThumbnail()});var q={backgroundColor:_o.getColorForTrack(t)};return u.a.createElement("div",{draggable:!1,onMouseDown:y,onMouseUp:w,onMouseLeave:w,style:q,className:N})}),Xo=n(258),Ko=new b.a,$o=function(e){var t=e.lastClicked,n=e.deleteSample,a=(e.recording,e.onClickRecord,Object(s.useState)(!1)),r=Object(i.a)(a,2),c=r[0],o=r[1],l=Object(s.useState)(!1),d=Object(i.a)(l,2),f=d[0],m=d[1],p=Object(s.useState)(!1),b=Object(i.a)(p,2),v=(b[0],b[1]),h=Object(s.useState)(1),g=Object(i.a)(h,2),E=g[0],k=g[1],O=Object(s.useCallback)(function(){t.instrument.loopParameter.set(!f),m(!f)},[m,f,t]),j=Object(s.useCallback)(function(){t.gated=!c,o(!c)},[o,c,t]),y=Object(s.useCallback)(function(){var e=2*E;8===e&&(e=1),t.pattern.changeLength(32*e),k(e)},[k,E,t]);if(Object(s.useEffect)(function(){t&&(o(t.gated),m(t.instrument.loop),v(t.isWarped()),k(t.length/32))},[t,o,m,v,k]),void 0===t)return[];var w="button-option",S="button-option",C=Ko.saturate(Ko.getColorForHash(t.instrument.defaultSampler.sample.getId()),3),x={},N={},q={backgroundColor:C,color:"black"};return f&&(S+=" selected",x.backgroundColor=C,x.color="black"),c&&(w+=" selected",N.backgroundColor=C,N.color="black"),u.a.createElement("div",{className:"sample-options"},u.a.createElement("div",{className:"name"},t.instrument.defaultSampler.sample.name),u.a.createElement("div",{className:"buttons"},u.a.createElement("div",{onClick:j,style:N,className:w},"Gate"),u.a.createElement("div",{onClick:O,style:x,className:S},"Loop"),u.a.createElement("div",{onClick:y,style:q,className:"button-option length-button"},E," Bars"),u.a.createElement("div",{onClick:n,className:"delete-button"},"x")),u.a.createElement("div",{className:"knobs"},u.a.createElement(Xo.a,{min:-40,max:0,color:C,parameter:t.volumeParameter}),u.a.createElement(Xo.a,{color:C,parameter:t.instrument.defaultSampler.transposeParameter})))},ei=n(953),ti=function(e){var t=e.sequencerEngine,n=e.samplersLoaded,a=e.deleteSample,r=Object(s.useState)(!1),c=Object(i.a)(r,2),o=c[0],l=c[1],d=Object(s.useState)(!1),f=Object(i.a)(d,2),m=f[0],p=f[1],b=Object(s.useState)(void 0),v=Object(i.a)(b,2),h=v[0],g=v[1];Object(s.useEffect)(function(){n[0]&&(n[0].sequencerEngine.deleting=m)},[m,n]);var E=Object(s.useCallback)(function(){l(!o)},[o,l]);if(0===n.length)return[];var k="";if(h){var O=h.instrument;k=u.a.createElement(ei.a,{instrument:O,color:"#ffffff",sampler:O.defaultSampler,soundId:O.defaultSampler.sample.getId(),buffer:O.defaultSampler.sample.audioBuffer,width:150,height:40})}return u.a.createElement("div",{className:"sampler"},u.a.createElement("div",{className:"inner"},u.a.createElement(Ao,{multiSequencerEngine:t,sequencerEngine:n[0].sequencerEngine,id:n[0].sequencerEngine.sequenceId}),u.a.createElement("div",{className:"sampler-triggers"},n.map(function(e){return u.a.createElement(Zo,{key:e.id,recording:o,selected:h===e,setLastClicked:g,track:e})})),u.a.createElement("div",{className:"right-side"},k,u.a.createElement($o,{deleteSample:function(){g(void 0),a(h)},lastClicked:h}))),u.a.createElement(Wo,{setDeleting:p,deleting:m,recording:o,onClickRecord:E}))},ni=function(e){var t=e.work,n=e.onClick,a=e.mixMode,r=e.sequencerEngine,l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],p=d[1],b=Object(s.useState)({}),v=Object(i.a)(b,2),h=v[0],g=v[1],E=Object(s.useState)([]),k=Object(i.a)(E,2),O=k[0],j=k[1],y=Object(s.useState)({}),w=Object(i.a)(y,2),S=w[0],C=w[1];Object(s.useEffect)(function(){Be.a.users.getUserName(t.user).then(function(e){return p(e)})},[t,p]),Object(s.useEffect)(function(){t&&(t.works?(C(t),j(t.works)):m.a.getJson(t.mixHash).then(function(e){e.mixHash=t.mixHash,j(e.works),C(e)}))},[t,j,C]),Object(s.useEffect)(function(){Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={},e.t0=c.a.keys(O);case 2:if((e.t1=e.t0()).done){e.next=9;break}return n=e.t1.value,e.next=6,Be.a.users.getUserName(O[n].user);case 6:t[O[n].user]=e.sent,e.next=2;break;case 9:g(t);case 10:case"end":return e.stop()}},e)}))()},[O,g]);var x="";a&&(x=u.a.createElement("div",{onClick:function(){r.unloadAll()},className:"delete-button"},"x"));var N=t.previousHash&&""!==t.previousHash;return u.a.createElement("div",{onClick:function(){return n(S)},className:"work work-mix"},x,u.a.createElement("div",{className:"mix-info"},O.map(function(e){return[e.title+" - ",u.a.createElement("span",{className:"work-author"},h[e.user])]})),u.a.createElement("div",{className:"name"},u.a.createElement("div",{className:"work-author"},f),u.a.createElement("div",{className:"title"},t.title),u.a.createElement("div",{className:"mix-edit-info"},N?"Edit":"Original"),u.a.createElement("div",{className:"mix-background"},"MIX")))},ai=Object(f.b)(function(e,t){return{headSequencerEngine:t.sequencerEngine&&t.sequencerEngine.headSequencerEngine,mixLoaded:e.explore.mixLoaded,mixHasEdits:e.explore.mixHasEdits}},null)(function(e){var t=e.worksLoaded,n=e.sequencerEngine,a=e.unloadWork,r=e.samplersLoaded,c=e.deleteSample,o=e.mixLoaded,i=e.mixHasEdits,l=e.children,d=e.lists,f=Object(s.useCallback)(function(){n.unloadAll()},[n]);if(void 0===n)return u.a.createElement("div",null);var m="";return o&&(m=u.a.createElement(ni,{mixHasEdits:!0,sequencerEngine:n,mixMode:!0,onClick:f,work:o})),u.a.createElement("div",{className:"mixer no-select"},u.a.createElement("div",{className:"mixer-and-works"},u.a.createElement(Co,{sequencerEngine:n}),u.a.createElement("div",{className:"works-container"},t.map(function(e,t){return u.a.createElement(Bo,{workNumber:t,key:e.newSequence,unloadWork:function(){return a(e)},sequencerEngine:n,work:e})}),u.a.createElement(ti,{sequencerEngine:n,deleteSample:c,samplersLoaded:r}),o?m:"",i?u.a.createElement(go,{originalMix:o,sequencerEngine:n}):""),d),l)}),ri=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a,r,o,i,s,u,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.eth.getBlockNumber();case 2:t=e.sent,n=null,a=new Date,r=a.getDate(),o=a.getMonth(),t-=6e3*r,i=o,s={},u=0;case 11:if(!(u<12)){e.next=23;break}return e.next=14,G.a.eth.getBlock(t);case 14:n=e.sent,a=new Date(1e3*n.timestamp),l=new Date(a.getFullYear(),a.getMonth(),0).getDate(),s[i--]=t,t-=6600*l;case 20:u++,e.next=11;break;case 23:return e.abrupt("return",s);case 24:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();n(2594);function ci(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return oi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oi(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function oi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ii={0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"},si=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t,n=e.currentMonth,a=e.onClickMonth,r=e.months,c=((new Date).getMonth(),(new Date).getFullYear()),o=[],i=Object.keys(r).map(function(e){return parseInt(e)}).sort(function(e,t){return t-e}),s=ci(i=[].concat(Object(p.a)(i),Object(p.a)(i)).slice(0,12));try{for(s.s();!(t=s.n()).done;){var l=t.value;o.push({number:l,month:ii[(12+l)%12],isCurrent:l===n}),l%12===0&&o.push({number:l-1,year:--c})}}catch(d){s.e(d)}finally{s.f()}return u.a.createElement("div",{className:"months"},o.map(function(e){var t=e.month,n=e.number,r=e.isCurrent,c=e.year;return c?u.a.createElement("div",{onClick:function(){return a(n)},className:"month year"},c):u.a.createElement("div",{onClick:function(){return a(n)},className:r?"month current":"month"},t)}))}),ui=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.work,n=e.onClick,a=Object(s.useState)(void 0),r=Object(i.a)(a,2),c=r[0],o=r[1],l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],p=d[1],b=Object(s.useState)([]),v=Object(i.a)(b,2),h=v[0],g=v[1],E=Object(s.useState)(""),k=Object(i.a)(E,2),O=k[0],j=k[1];Object(s.useEffect)(function(){t.projects?(console.log("there was work.projects and work.image =",t.image),g(t.projects),j(m.a.getHashUrl(t.image)),o(Object(A.a)({},t))):m.a.getJson(t.newContent).then(function(e){o(Object(A.a)({},t,e)),j(m.a.getHashUrl(e.image)),g(e.projects)})},[t]),Object(s.useEffect)(function(){Be.a.users.getUserName(t.user).then(p)},[t,p]);var y={backgroundImage:"url("+O+")"};return u.a.createElement("div",{onClick:function(){return n(c)},style:y,className:"work list"},u.a.createElement("div",{className:"projects"},h.map(function(e){return u.a.createElement("div",{className:"project"},e.title," .")})),u.a.createElement("div",{className:"list-author"},f),u.a.createElement("div",{className:"list-title"},t.title))});n(875),new b.a;function li(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return di(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return di(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function di(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var fi=Object(s.memo)(function(e){var t=e.work,n=e.onClick,a=(e.loadSample,e.onClickMix),r=e.onClickList,l=e.setSearchTag,d=e.setProjectDragging,f=e.setPersonSelected,m=Object(s.useState)(""),p=Object(i.a)(m,2),b=p[0],v=p[1],h=Object(s.useState)(t.title),g=Object(i.a)(h,2),E=g[0],k=g[1],O=Object(s.useState)(!1),j=Object(i.a)(O,2),y=(j[0],j[1],Object(s.useState)([])),w=Object(i.a)(y,2),S=w[0],C=w[1],x=Object(s.useState)(void 0),N=Object(i.a)(x,2),q=N[0],T=N[1],M=Object(s.useState)(void 0),I=Object(i.a)(M,2),P=I[0],R=(I[1],Object(s.useState)([t])),D=Object(i.a)(R,2),A=D[0];D[1];t.id=t.newSequence,Object(s.useEffect)(function(){t.guildId&&Be.a.guildSequences._decryptQueryResult(t).then(function(e){return k(e.title)})},[t,k]);nc({works:A}).comments;if(Object(s.useEffect)(function(){"SEQUENCE"===t.type&&cn(t).then(function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.wallpaper,n=t.graphic,t.bpm,v(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},[t]),Object(s.useEffect)(function(){ln(t.blockNumber).then(T)},[t,T]),Object(s.useEffect)(function(){if(t.collaborators){var e,n=[],a=li(t.collaborators);try{for(a.s();!(e=a.n()).done;){var r=e.value;n.push(Be.a.users.getUserName(r))}}catch(c){a.e(c)}finally{a.f()}Promise.all(n).then(C)}},[t,C]),"MIX"===t.type)return u.a.createElement(ni,{work:t,onClick:a}," ");if("LIST"===t.type)return u.a.createElement(ui,{onClick:r,work:t});var L=t.previousSequence&&""!==t.previousSequence,z={};P&&(z.backgroundImage="url(/ipfs/"+P+")");var H=void 0,U=void 0;if(q){var G=(new Date).getTime()-q.getTime();U=Math.ceil(G/1e3/60),H=Math.ceil(U/60)}return u.a.createElement("div",{draggable:!0,onDragStart:function(){return d(t)},onDragOver:function(e){return e.preventDefault()},onClick:function(){return n(t)},className:"work"},u.a.createElement(xo,{setSearchTag:l,editTags:!1,showComments:!0,work:t}),u.a.createElement("div",{className:"graphic"},b),u.a.createElement("div",{className:"name"},u.a.createElement("div",{className:"work-author"},S.map(function(e,n){return u.a.createElement("div",{onClick:function(e){e.stopPropagation(),f(t.collaborators[n])},className:0===n?"collaborator origin":"collaborator"},e)})),u.a.createElement("div",{style:z,className:"work-thumb"}),u.a.createElement("div",{className:"work-title"},u.a.createElement("span",null,E))),u.a.createElement("div",{className:"work-edit-info"},L?"Edit":"Original"),u.a.createElement("div",{className:"work-date"},q?U<60?U+" min ago":H<48?H+" hours ago":un(q):""))}),mi=Object(f.b)(null,function(e){return{setProjectDragging:function(t){return e(Object(d.Hd)(t))},setPersonSelected:function(t){return e(Object(d.Pb)(t))}}})(fi),pi=Object(f.b)(function(e,t){return{personSelected:e.explore.personSelected,allSequences:e.explore.allSequences,worksLoaded:e.explore.worksLoaded}},null)(function(e){var t=e.allSequences,n=e.onClickWork,a=e.onClickMix,r=e.onClickList,c=e.loadSample,o=e.searchTerm,l=e.searchOptions,d=e.personSelected,f=e.setSearchTag,m=(e.worksLoaded,Object(s.useState)({numTracks:Math.floor(9*window.innerWidth/1e3),scrollTop:0})),b=Object(i.a)(m,2),v=b[0],h=b[1],g=(v.scrollTop,v.numTracks,function(e){var t=e.allSequences,n=e.personSelected,a=e.searchOptions,r=e.searchTerm,c=e.setState,o=Object(s.useState)(!1),u=Object(i.a)(o,2),l=u[0],d=u[1],f=t.filter(function(e){return!n||e.user===n.id}),m=a.indexOf("Samples")>-1,b=a.indexOf("Projects")>-1,v=a.indexOf("Lists")>-1;f=f.filter(function(e){return v&&"LIST"===e.type||m&&("SAMPLES"===e.type||"MIX"===e.type)||b&&"SEQUENCE"===e.type});var h=Object(p.a)(f);return Object(s.useEffect)(function(){console.log("GOING TO BEGINNING"),c({scrollTo:0,numTracks:9}),document.getElementById("works").scrollTo(0,0)},[r,a,c]),Object(s.useEffect)(function(){c({numTracks:9,scrollTop:0})},[n]),{works:h,userWorks:f,isLoading:l,setIsLoading:d}}({allSequences:t,searchTerm:o,searchOptions:l,setState:h})),E=g.userWorks,k=g.works,O=g.setIsLoading,j=g.isLoading,y=function(e){var t=e.setIsLoading,n=e.userWorks,a=e.setState,r=Object(s.useState)((new Date).getMonth()),c=Object(i.a)(r,2),o=c[0],u=c[1],l=Object(s.useState)({}),d=Object(i.a)(l,2),f=d[0],m=d[1];return Object(s.useEffect)(function(){ri().then(function(e){return m(e)})},[m]),{onClickMonth:Object(s.useCallback)(function(e){t(!0);var r=f[Math.min((new Date).getMonth(),e+1)];if(e==(new Date).getMonth())return a({numTracks:25,scrollTop:0}),u(e),void setTimeout(function(){t(!1)},500);for(var c in n)if(n[c].blockNumber<r){var o=parseInt(c);a({numTracks:o+9,skipTracks:o}),setTimeout(function(){u(e),setTimeout(function(){t(!1)},500)},50);break}},[f,n,a,u,t]),months:f,currentMonth:o,setCurrentMonth:u}}({setIsLoading:O,setState:h,userWorks:E}),w=y.months,S=y.onClickMonth,C=y.setCurrentMonth,x=y.currentMonth,N=function(e){var t=e.setIsLoading,n=e.isLoading,a=e.userWorks,r=e.setCurrentMonth,c=e.months,o=e.state,i=e.setState,u=e.works,l=e.personSelected,d=o.skipTracks,f=o.scrollTop,m=o.numTracks,p=Object(s.useCallback)(function(){if(!(m>=a.length)){var e=document.getElementById("works");if(!n){var o=e.scrollTop+e.offsetHeight,s=e.scrollHeight;if(e.scrollTop<=f-1300&&f>50)setTimeout(function(){i({numTracks:9,scrollTop:0}),e.scrollTo(0,0),r((new Date).getMonth())},200);else if(o>=s){t(!0);var u=m+6;if(!a[u])return void t(!1);var l=a[u].blockNumber;for(var p in c)if(p=parseInt(p),l<c[p]){r(p-1);break}setTimeout(function(){console.log("setting scrollTop=",e.scrollTop),i({skipTracks:d,numTracks:m+6,scrollTop:e.scrollTop}),t(!1)},200)}}}},[m,t,d,n,i,a,r,c,f]);function b(){var e=document.getElementById("works");e&&e.removeEventListener("scroll",p)}Object(s.useEffect)(function(){var e=document.getElementById("works");e&&e.scrollTo(0,0)},[d]),Object(s.useEffect)(function(){var e=document.getElementById("works");i({numTracks:9,scrollTop:0}),e&&e.scrollTo(0,0),r((new Date).getMonth())},[l,r]),Object(s.useEffect)(function(){var e=document.getElementById("works");return e&&e.addEventListener("scroll",p),b},[p,a,o,d]);var v=d;if(void 0===d){var h=Math.max(1,Math.floor((window.innerWidth-110)/420)),g=Math.floor(f/290)*h;9===m&&(g=0),g=Math.max(0,g-50)}var E=u.slice(v,m);return{onScroll:p,scrollWorks:E,toSkip:v=void 0!==d?0:v}}({works:k,setIsLoading:O,isLoading:j,state:v,setState:h,userWorks:E,setCurrentMonth:C,months:w,personSelected:d}),q=(N.onScroll,N.scrollWorks),T=N.toSkip;return u.a.createElement("div",{className:"works-and-months"},u.a.createElement("div",{id:"works"},u.a.createElement("div",{className:"works-grid"},q.map(function(e,t){return u.a.createElement(mi,{setSearchTag:f,loadSample:c,onClick:n,onClickMix:a,onClickList:r,key:t+Math.floor(T)+"-"+e.newSequence+"-"+e.blockNumber,work:e})})),u.a.createElement("div",{className:"loader-container"},u.a.createElement(Ln.a,{sizeUnit:"px",size:20,color:"#42f4f1",loading:j}))),u.a.createElement(si,{months:w,onClickMonth:S,currentMonth:x}))});n(2595),t.default=Object(f.b)(function(e,t){var n;return n={allSequences:e.explore.allSequences,personSelected:e.explore.personSelected,worksLoaded:e.explore.worksLoaded,exploreOption:e.explore.exploreOption,annotationsView:e.explore.annotationsView,wallpaper:e.sequencer.wallpaper,animateWallpaper:e.sequencer.animateWallpaper,exploreWork:e.explore.exploreWork},Object(a.a)(n,"personSelected",e.explore.personSelected),Object(a.a)(n,"guildId",e.guilds.selectedGuild?e.guilds.selectedGuild.guildId:0),n},function(e){return{setAllSequences:function(t){return e(Object(d.Mb)(t))},setCommandDown:function(t){return e(Object(d.cb)(t))},setWorksLoaded:function(t){return e(Object(d.og)(t))},setExploreUnpublished:function(t){return e(Object(d.Rb)(t))},setWallpaper:function(t){return e(Object(d.hg)(t))},setAnimateWallpaper:function(t){return e(Object(d.y)(t))},setExploreWork:function(t){return e(Object(d.Sb)(t))}}})(function(e){var t=Object(s.useState)(void 0),n=Object(i.a)(t,2),a=n[0],r=n[1],d=e.personSelected,f=e.worksLoaded,b=(e.setWorksLoaded,e.guildId),v=Object(s.useState)(void 0),h=Object(i.a)(v,2),g=(h[0],h[1]),E=Object(s.useState)([]),k=Object(i.a)(E,2),O=k[0],j=k[1],y=Object(s.useState)(""),w=Object(i.a)(y,2),C=w[0],x=w[1],N=Object(s.useState)(void 0),q=Object(i.a)(N,2),T=q[0],M=q[1],I=Object(s.useState)(["Projects"]),P=Object(i.a)(I,2),R=P[0],D=P[1],L=function(e,t){var n=Object(s.useState)(!1),a=Object(i.a)(n,2),r=a[0],c=a[1],o=Object(s.useState)([]),u=Object(i.a)(o,2),d=u[0],f=u[1],m=Object(s.useCallback)(function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0!==t){var a=l.a.getItem("unsavedLists");if(a&&(a=JSON.parse(a)),void 0===t.hash)if(n){var r=e.allSequences.filter(function(e){return e.id!==t.id});e.setAllSequences(r),a&&(a=a.filter(function(e){return e.name!==t.name}),l.a.setItem("unsavedLists",JSON.stringify(a)),e.setExploreUnpublished(a))}else e.setAllSequences([Object(A.a)({},t,{type:"LIST"})].concat(Object(p.a)(e.allSequences)));else if(n){lc(t.newContent);var o=e.allSequences.filter(function(e){return e.hash!==t.hash});e.setAllSequences(o)}c(!1)}else c(!1)},[c,t,e.allSequences]),b=Object(s.useCallback)(function(e){if(d.indexOf(e)>-1){var t=Object(p.a)(d);t.splice(d.indexOf(e),1),f(t)}else f([].concat(Object(p.a)(d),[e]))},[f,d]);return{lists:d,onListChanged:m,onClickList:b,creatingNewList:r,setCreatingNewList:c}}(e,a),z=L.lists,H=L.onListChanged,U=L.onClickList,G=L.creatingNewList,F=L.setCreatingNewList,B=Object(s.useState)(!0),W=Object(i.a)(B,2),V=W[0],Q=W[1];Object(s.useEffect)(function(){var t=function(e){He.a.setEthereum(Be.a),Be.a.store=e,Be.a.crypto.store=e,Be.a.guilds.initGuilds(),He.a.setStore(e),Hc.a.setSampleRate(Pe.d);var t=new Vc(e);return window.multiMix=!0,window.sequencerEngine=t,t.ethereum=Be.a,t}(e.store);window.explore=!0,r(t),ee(),window.addEventListener("keydown",J),window.addEventListener("keyup",_)},[]),Object(s.useEffect)(function(){e.setAllSequences([]),Q(!0),ho(e.setAllSequences,Q,R,C,T,b,d).then(function(e){return Q(!1)})},[d,R,Q,C,T,b]),Object(s.useEffect)(function(){if(a){var t=e.match&&void 0!=e.match.params.sequenceId?e.match.params.sequenceId:null;t&&Be.a.getSequence(t).then(function(n){n||(n={newSequence:t,title:"Unpublished work"}),a.dispatch(Lc(n)),e.setExploreWork(n)})}},[a]);var J=Object(s.useCallback)(function(t){"Meta"===t.key&&e.setCommandDown(!0)},[]),_=Object(s.useCallback)(function(t){"Meta"===t.key&&e.setCommandDown(!1)},[]),Y=Object(s.useCallback)(function(e){a.dispatch(function(e){return{type:4,work:e}}(e))},[a]),Z=Object(s.useCallback)(function(e){a.dispatch(Lc(e))},[a]),X=Object(s.useCallback)(function(e){a.loadMix(e)},[a]),K=function(e,t,n){return Object(s.useCallback)(function(){var n=Object(o.a)(c.a.mark(function n(a){var r,o;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.samplerTrack.addSampledInstrumentTrack(),o=new yt.a(a),n.next=4,o.load();case 4:return n.next=6,r.instrument.newSample(0,o);case 6:r.instrument.monophonic=!0,t(Object(p.a)(e.samplerTrack.tracks));case 8:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),[t,n,e])}(a,j),$=function(e,t,n){return Object(s.useCallback)(function(t){n.samplerTrack.deleteTrack(t.trackNumber),e(Object(p.a)(n.samplerTrack.tracks))},[e,t,n])}(j,O,a),ee=function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be.a.getUser();case 2:t=e.sent,g(t);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)(function(){fa.isMobile&&f&&f.length>0&&e.setExploreWork(f[0])},[f]);var te="explore-2",ne={};return e.wallpaper?ne.backgroundImage="url("+m.a.getHashUrl(e.wallpaper)+")":te+=" no-wallpaper",e.animateWallpaper&&(te+=" animate"),Object(s.useEffect)(function(){var t=l.a.getItem("wallpaper");t?e.setWallpaper(t):e.setWallpaper("QmUh2FeN3bw2VdcRVksDctr1ihjDwHpNhE6o9mkBhF2huB"),void 0!==(t=l.a.getItem("animateWallpaper"))&&e.setAnimateWallpaper("true"===t)},[]),f&&f.length>0&&(te+=" work-loaded"),e.exploreWork&&(te+=" exploring"),u.a.createElement("div",{className:te,style:ne},u.a.createElement(Ue.a,{condition:e.exploreOption===Ac.a},u.a.createElement(ua,{store:e.store})),u.a.createElement(Ue.a,{condition:e.exploreOption===Ac.b},u.a.createElement(Mc,{annotationsView:e.annotationsView}),u.a.createElement(ai,{unloadWork:Y,sequencerEngine:a,samplersLoaded:O,lists:u.a.createElement(jc,{loadWork:Z,removeList:U,onListChanged:H,creatingNewList:G,hide:function(){return F(!1)},lists:z}),deleteSample:$,worksLoaded:f},a?u.a.createElement("div",{className:"login-and-comments"},u.a.createElement(oo,{store:a.store,setSearchOptions:D,searchOptions:R,setSearchTerm:x,searchTerm:C}),u.a.createElement(rc,{sequencerEngine:a})):""),u.a.createElement(yc,{onNewList:function(){return F(!0)}},u.a.createElement(Dc,{searchTag:T,setSearchTag:M,setSearchOptions:D,searchOptions:R,setSearchTerm:x,searchTerm:C})),V?u.a.createElement(S.a,{className:"world-fetcher",text:"Fetching the world"}):"",e.exploreWork?u.a.createElement(Xr,{work:e.exploreWork,sequencerEngine:a}):u.a.createElement(pi,{onClickMix:X,onClickList:U,loadSample:K,onClickWork:Z,setSearchTag:M,searchOptions:R,searchTerm:C}),u.a.createElement("div",{color:"radial-gradient(75.29% 75.29% at 64.96% 24.36%, #F0DFA7 0.52%, #FDBDAA 18.75%, #FEA186 34.38%, #F09277 49.48%, #D27584 74.48%, #6B7B8A 100%)",className:"coke-machine-glow"})))})}}]);