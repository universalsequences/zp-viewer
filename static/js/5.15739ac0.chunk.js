(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1329:function(e,t,n){},1331:function(e,t,n){},2077:function(e,t,n){},2089:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return f}),n.d(t,"b",function(){return m});var a=n(42),r=n.n(a),c=n(56),o=n(121),s=(n(122),n(141),n(1090)),i=n(158),u=n(168),l=n(160);new s.a;var f=function(){var t=Object(c.a)(r.a.mark(function t(n,a,c,s,f){var m,p,d,h,b,v,g,E;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return m=f.creatorShare,p=f.ownerShare,d=f.minterShare,console.log("JSON = ",n),t.next=4,o.a.addJson(n);case 4:return h=t.sent,b="https://zequencer.io/ipfs/"+h,v=JSON.stringify({description:c,mimeType:"text/json",image:"https://zequencer.io/ipfs/"+s,name:a}),t.next=9,o.a.addBuffer(e.from(v));case 9:g=t.sent,E=[a,b,g,Object(i.c)(h),[m,p,d]],console.log(E),new u.a(l.q,"createPlugin",E).execute();case 14:case"end":return t.stop()}},t)}));return function(e,n,a,r,c){return t.apply(this,arguments)}}(),m=function(){var t=Object(c.a)(r.a.mark(function t(n,a,c,s,f){var m,p,d,h;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.addJson(n);case 2:return m=t.sent,p="https://zequencer.io/ipfs/"+m,d=JSON.stringify({description:c,mimeType:"text/json",image:"https://zequencer.io/ipfs/"+s,name:a}),t.next=7,o.a.addBuffer(e.from(d));case 7:h=t.sent,new u.a(l.q,"updatePlugin",[f,p,h,Object(i.c)(m)]).execute();case 10:case"end":return t.stop()}},t)}));return function(e,n,a,r,c){return t.apply(this,arguments)}}()}).call(this,n(112).Buffer)},2099:function(e,t,n){},2107:function(e,t,n){},2108:function(e,t,n){"use strict";(function(e){n(42),n(56),n(725),n(140),n(158),n(168),n(160),n(23),n(118),n(1117),n(121)}).call(this,n(112).Buffer)},2109:function(e,t,n){},2247:function(e,t,n){},2248:function(e,t,n){},2250:function(e,t,n){},2251:function(e,t,n){},2379:function(e,t,n){},2388:function(e,t,n){},2393:function(e,t,n){},2394:function(e,t,n){},2431:function(e,t,n){},2432:function(e,t,n){},2433:function(e,t,n){},2434:function(e,t,n){},2435:function(e,t,n){},2436:function(e,t,n){},2437:function(e,t,n){},2438:function(e,t,n){},2439:function(e,t,n){},2440:function(e,t,n){},2441:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return useDropScaleFile});var _Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(42),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(56),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);function _createForOfIteratorHelper(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"===typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var useDropScaleFile=function useDropScaleFile(_ref){var ref=_ref.ref,effect=_ref.effect,setAnnotation=_ref.setAnnotation,setScale=_ref.setScale;Object(react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(function(){ref.current.addEventListener("dragenter",function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.effectAllowed="none",e.dataTransfer.dropEffect="none"},!1),ref.current.addEventListener("dragover",function(e){return e.stopPropagation(),e.preventDefault(),e.dataTransfer.effectAllowed="none",!1}),ref.current.addEventListener("drop",function(){var _ref2=Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee2(ev){var i;return _Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(console.log("DROPPING"),ev.preventDefault(),ev.stopPropagation(),ev.dataTransfer.effectAllowed="none",ev.dataTransfer.dropEffect="none",ev.dataTransfer.items)for(i=0;i<ev.dataTransfer.items.length;i++)"file"===ev.dataTransfer.items[i].kind&&function(){var file=ev.dataTransfer.items[i].getAsFile(),reader=new FileReader;reader.readAsText(file),reader.onloadend=Object(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(_Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee(){var text,lines,comments,numbers,_iterator,_step,line,number;return _Users_alecresende_code_visual_sampler_sequencer_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:text=reader.result,lines=text.split("\n"),comments=lines.filter(function(e){return e.startsWith("!")}).map(function(e){return e.slice(1).trim()}).join("\n"),console.log("FILE = ",text,comments),numbers=[],_iterator=_createForOfIteratorHelper(lines);try{for(_iterator.s();!(_step=_iterator.n()).done;){line=_step.value;try{number=eval(line),"number"===typeof number&&numbers.push(line)}catch(e){}}}catch(err){_iterator.e(err)}finally{_iterator.f()}console.log("NUMBERS =",numbers),numbers[0]=1,effect.scale=numbers,setScale(numbers),setAnnotation(comments);case 12:case"end":return _context.stop()}},_callee)}))}();return _context2.abrupt("return",!1);case 7:case"end":return _context2.stop()}},_callee2)}));return function(e){return _ref2.apply(this,arguments)}}())},[setAnnotation,setScale,effect,ref])}},2442:function(e,t,n){},2443:function(e,t,n){},2444:function(e,t,n){},2445:function(e,t,n){},2446:function(e,t,n){},2447:function(e,t,n){},2448:function(e,t,n){},2449:function(e,t,n){},2450:function(e,t,n){},2451:function(e,t,n){},2452:function(e,t,n){},2453:function(e,t,n){},2454:function(e,t,n){},2455:function(e,t,n){},2638:function(e,t,n){"use strict";n.r(t);var a=n(32),r=n(42),c=n.n(r),o=n(56),s=n(110),i=n(3),u=n.n(i),l=n(187),f=n(23),m=n(55),p=n(121),d=n(11),h=n(114),b=n(21);function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}new h.a;var E=function(e,t){return(e%t+t)%t},O=Object(m.b)(function(e,t){return{step:t.sequencerEngine&&t.sequencerEngine.trackStep}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.row,a=e.part,r=e.step,c=void 0===r?0:r,o=Object(i.useCallback)(function(){var e=new b.a(Math.pow(2,2+Math.floor(a/2)),a%2===1);t.resolution=e,t.sequenceRolling=!0,t.trackRolling=!0},[t,a]),s=Object(i.useCallback)(function(){t.sequenceRolling=!1,t.trackRolling=!1},[t,a]),l=Object(i.useRef)(!1),f=Object(i.useRef)(void 0),m=new Set,p={},h=a===4*Math.floor(c/4)%32/32*8;if(t){var g,O=v(t.subSequences);try{for(O.s();!(g=O.n()).done;){var y,k=v(g.value.tracks);try{for(k.s();!(y=k.n()).done;){var j=y.value,C=j.notesTriggered||{};for(var S in C)S=E(S,12),m.add(S),p[S]||(p[S]=[]),p[S].push(j)}}catch(R){k.e(R)}finally{k.f()}}}catch(R){O.e(R)}finally{O.f()}}var w=2*n,P=2*n+1,N="triangle";if(m.has(w)||m.has(P)){var x=p[w]||[],q=p[P]||[],T=[].concat(Object(d.a)(x),Object(d.a)(q)).map(function(e){return"white"});h&&(l.current=!0,f.current=T[a%T.length],N+=" triggered")}else h&&c%4===0&&(l.current=!1);var M={};return l.current&&(N+=" old-trigger",void 0!==f.current?M.borderBottomColor=f.current:N+=" track-0"),u.a.createElement("div",{onMouseDown:o,onMouseUp:s,style:M,className:N})}),y=function(e){var t=e.sequencerEngine,n=e.row;return u.a.createElement("div",{className:"row"},[0,1,2,3,4,5,6,7].map(function(e){return u.a.createElement(O,{sequencerEngine:t,row:n,part:e})}))},k=n(732),j=(n(2077),[k.a,k.b]),C=Object(m.b)(function(e,t){return{screenshots:e.nft.screenshots,editionSize:t.sequencerEngine.erc721EditionSize}},function(e){return{}})(function(e){var t=e.text,n=e.editionSize,a=void 0===n?10:n,r=e.screenshots,c=void 0===r?[]:r;console.log("editionSize=%s screenshots=",a,c);var o=new Array(Math.max(0,a-c.length)).fill(0);return u.a.createElement("div",{className:"modal-backdrop prep"},u.a.createElement("div",{className:"preparing-nft flex-col flex"},j.map(function(e){return u.a.createElement("div",{className:t===e?"step selected":"step"},e)}),u.a.createElement("div",{className:"screenshots flex flex-wrap max-w-full flex flex-1 overflow-auto"},c.map(function(e){return u.a.createElement("img",{className:"w-16 h-16 border border-solid m-1",src:p.a.getHashUrl(e)})}),o.map(function(e){return u.a.createElement("div",{className:"w-16 h-16 border border-solid m-1"})}))))}),S=n(260),w=n(406),P=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.set,n=e.get,a=e.name,r=e.isTextArea,c=e.units,o=Object(i.useState)(!1),l=Object(s.a)(o,2),f=l[0],m=l[1],p="zora-field ";return(f||""!==n)&&(p+=" focused"),r&&(p+=" text-area"),u.a.createElement("div",{className:p},u.a.createElement("div",{className:"field-name"},a),r?u.a.createElement("textarea",{onFocus:function(e){return m(!0)},onBlur:function(e){return m(!1)},value:n,onChange:function(e){return t(e.target.value)},type:"text"}):u.a.createElement("input",{onFocus:function(e){return m(!0)},onBlur:function(e){return m(!1)},value:n,onChange:function(e){return t(e.target.value)},type:"text"}),u.a.createElement("div",{className:"units"},c))}),N=n(2089),x=n(218),q=n(145),T=Object(m.b)(function(e,t){return{mintingProgress:e.nft.mintingProgress,newZoraTokenId:e.nft.newZoraTokenId}},function(e){return{setPluginToSave:function(t){return e(Object(f.Ad)(t))}}})(function(e){var t=e.zobject,n=e.setPluginToSave;console.log("zobject.plugin=",t.plugin,t);var a=Object(i.useState)(t.plugin?t.plugin.name:""),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(""),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useState)(""),h=Object(s.a)(d,2),b=h[0],v=h[1],g=Object(i.useCallback)(function(){var e=t.getPresetJson();t.plugin?Object(N.b)(e,c,m,b,t.plugin.tokenId):Object(N.a)(e,c,m,b,{creatorShare:4,ownerShare:4,minterShare:92})},[t,c,m,b]);return u.a.createElement(x.a,{dialogClassName:"zora-modal preset-modal",show:!0,onHide:function(){n(void 0)}},u.a.createElement(x.a.Body,null,u.a.createElement("div",{className:"zora-configuration"},u.a.createElement(P,{set:o,get:c,name:"name"}),u.a.createElement(P,{set:p,get:m,name:"description",isTextArea:!0}),u.a.createElement(w.a,{placeholder:"Drop the thumbnail image for your work, here",imageHash:b,setImageHash:v}))),u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{variant:"primary",onClick:g},t.plugin?"Update Plugin":"Mint Plugin")))}),M=n(155),R=n(116),D=n.n(R),I=n(297),A=(n(407),Object(m.b)(function(e){return{}},function(e){return{setTrackToConvert:function(t){return e(Object(f.Kf)(t))}}})(function(e){var t=e.onClickDone,n=e.onClickCancel,a=e.show,r=e.track,c=e.setTrackToConvert,o=Object(i.useState)(!1),l=Object(s.a)(o,2),f=l[0],m=l[1];return u.a.createElement(x.a,{dialogClassName:"rack-modal",show:a,onHide:n||function(){return c(void 0)}},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,"Convert Track Type")),r.getTrackType()===M.f?u.a.createElement(x.a.Body,null,u.a.createElement("div",null,"Confirm to convert of track to a:"),u.a.createElement("div",{className:"convert-options"},u.a.createElement("div",{onClick:function(){return m(!1)},className:f?"convert-option":"convert-option selected"},"Sampled Instrument"))):u.a.createElement(x.a.Body,null,"Confirm to convert to instrument rack"),u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{variant:"secondary",onClick:t?function(){return t(f)}:function(){c(void 0),f?r.convertToInstrumentRack():r.convertToSampledInstrument()}},"Confirm"),u.a.createElement(q.b,{variant:"primary",onClick:n||function(){return c(void 0)}},"Cancel")))})),L=n(472),F=(n(2099),Object(m.b)(function(e,t){return{}},function(e){return{setShowFreezeModal:function(t){return e(Object(f.Ce)(t))}}})(function(e){var t=e.sequencerEngine,n=e.setShowFreezeModal,a=Object(i.useState)("pad"),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useCallback)(function(){"pad"===c?t.state.spatial.showPadSequencer.zObject.executeAction("Freeze Pads"):Object(L.a)(t.getSelectedTrack()),n(!1)},[c,t]);return u.a.createElement(x.a,{dialogClassName:"freeze-modal",show:!0,onHide:function(){return n(!1)}},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,"Freeze",u.a.createElement("img",{src:"/freeze-icon.svg"}))),u.a.createElement(x.a.Body,null,u.a.createElement("div",{className:"freeze-options"},u.a.createElement("div",{onClick:function(e){return o("pad")},className:"pad"===c?"selected freeze-option":"freeze-option"},"Pad ",u.a.createElement("img",{src:"/zpad-light.svg"})),u.a.createElement("div",{onClick:function(e){return o("track")},className:"track"===c?"selected freeze-option":"freeze-option"},"Track"),u.a.createElement("div",{className:"freeze-description"},"pad"===c?"Bounce audio from all tracks into a single frozen stem.":"Bounce audio from the selected track into a frozen stem."))),u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{onClick:l,className:"pushable",variant:"secondary"},"Start Freezing")))})),z=Object(m.b)(function(e,t){return{}},function(e){return{setHicDialog:function(t){return e(Object(f.cc)(t))}}})(function(e){var t=e.setHicDialog,n=e.hicDialog,a="https://zequencer.io/ipfs/"+n.page,r=Object(i.useCallback)(function(){window.open("https://zequencer.io/ipfs/"+n.zip)},[n]);return u.a.createElement(x.a,{dialogClassName:"hic-modal preset-modal",show:!0,onHide:function(){return t(void 0)}},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,"Hicetnunc Assets")),u.a.createElement(x.a.Body,null,"Check this url to see if your NFT is showing correctly",u.a.createElement("div",{className:"ipfs-url"},u.a.createElement("a",{href:a,target:"_blank"},a))),u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{variant:"secondary",onClick:r},"Download Zip")))}),B=n(1),_=n(229),H=function(e,t){console.log("triggering refresh=",t,e,"/"),fetch("/refreshContract/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({contractAddress:t,transactionHash:e})})},U="0xf8333542541C1ECbee62392798157dfc357Da394",G=[{inputs:[{internalType:"address",name:"creatorAddress",type:"address"},{internalType:"address",name:"metadataRendererAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"creator",type:"address"},{indexed:!0,internalType:"address",name:"contractAddress",type:"address"},{indexed:!0,internalType:"uint64",name:"editionSize",type:"uint64"},{indexed:!1,internalType:"uint104",name:"publicSalePrice",type:"uint104"},{indexed:!1,internalType:"string",name:"name",type:"string"},{indexed:!1,internalType:"string",name:"collectionImage",type:"string"}],name:"ZequencerDropCreated",type:"event"},{inputs:[{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"symbol",type:"string"},{internalType:"string",name:"description",type:"string"},{internalType:"uint104",name:"publicSalePrice",type:"uint104"},{internalType:"uint64",name:"editionSize",type:"uint64"},{internalType:"uint16",name:"royaltyBPS",type:"uint16"},{internalType:"string",name:"baseAppURI",type:"string"},{internalType:"string",name:"baseImageURI",type:"string"},{internalType:"string",name:"collectionImage",type:"string"},{internalType:"bytes32[]",name:"traitTypes",type:"bytes32[]"},{internalType:"bytes32[]",name:"traitValues",type:"bytes32[]"}],name:"newDrop",outputs:[],stateMutability:"payable",type:"function"}],W=n(167);function V(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var K=function(){var e=Object(o.a)(c.a.mark(function e(t,n,a,r,o,s,i,u,l,f){var m,p,h,b,v,g,E,O,y,k,j,C,S=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(m=S.length>10&&void 0!==S[10]?S[10]:{},console.log("new Drop =",m),p=[],m[1]&&(p=m[1].map(function(e){return e.trait_type})),h=[],b=1;b<=s;b++)if(v=m[b],console.log("attr %s",b,v),v){g=V(v);try{for(g.s();!(E=g.n()).done;)O=E.value,y=O.value,h.push(y.toString())}catch(c){g.e(c)}finally{g.f()}v.length<p.length&&h.push("")}else h=[].concat(Object(d.a)(h),Object(d.a)(new Array(p.length).fill("")));return k=[n,a,r,o,s,i,u,l,f,p.map(function(e){return W.a.utils.padRight(W.a.utils.fromAscii(e),64)}),h.map(function(e){return W.a.utils.padRight(W.a.utils.fromAscii(e),64)})],console.log("args=",k),j=new _.a.Contract(U,G,t),e.next=11,j.newDrop.apply(j,k.concat([{value:0}]));case 11:return C=e.sent,C.hash,e.abrupt("return",C);case 14:case"end":return e.stop()}},e)}));return function(t,n,a,r,c,o,s,i,u,l){return e.apply(this,arguments)}}(),Q=n(247),Y=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){for(var t=e.imageManifest,n=e.screenshotsCount,a=[],r=0;r<n;r++)a.push(r+1);return u.a.createElement("div",{className:"gallery-preview"},a.map(function(e){return u.a.createElement("div",{className:"preview-container"},u.a.createElement("img",{className:"preview-image",src:"https://arweave.net/"+t+"/"+e}),u.a.createElement("div",{className:"drop-label"},"Drop #",e))}))}),J=n(518),Z=(n(14),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.thumbnails,n=e.selected,a=e.setThumbnail;return u.a.createElement("div",{className:"alternate-thumbnails"},t.map(function(e){return u.a.createElement("img",{onClick:function(){return a(e)},src:"/ipfs/"+e,className:n===e?"pushable alternate-thumbnail selected":"pushable alternate-thumbnail"})}))})),$=n(299),ee=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.royalties;return u.a.createElement("div",{className:"royalties zora-field focused"},u.a.createElement("div",{className:"field-name"},"your royalties %"),t&&u.a.createElement($.a,{units:"%",width:200,parameter:t}))}),te=(n(2107),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.name,n=e.description,a=e.royalties,r=e.thumbnail,c=e.setName,o=e.setDescription,s=e.setThumbnail,i=e.alternateThumbnails;return u.a.createElement("div",{className:"zora-configuration"},u.a.createElement(P,{set:c,get:t,name:"name"}),u.a.createElement(P,{set:o,get:n,name:"description",isTextArea:!0}),u.a.createElement(Z,{selected:r,setThumbnail:s,thumbnails:i}),u.a.createElement(w.a,{placeholder:"Drop the thumbnail image for your work, here",imageHash:r,setImageHash:s}),u.a.createElement(ee,{royalties:a}))}),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){e.metadata;var t=e.contentURI;return u.a.createElement("iframe",{height:"519",width:"100%",src:t,className:"zora-mediaObject css-hnzuw7 zora-mediaObject--mediaLoaded zora-mediaObject--isFullPage",style:{border:0}})}));n(2108),n(2109);var ne=Object(m.b)(function(e,t){return{mintingProgress:e.nft.mintingProgress,newZoraTokenId:e.nft.newZoraTokenId}},function(e){return{setNewZoraTokenId:function(t){return e(Object(f.Tc)(t))},setZoraDialog:function(t){return e(Object(f.Ag)(t))},setMintingProgress:function(t){return e(Object(f.Kc)(t))}}})(function(e){var t=e.setZoraDialog,n=e.data,a=e.sequencerEngine,r=(e.setMintingProgress,e.mintingProgress,e.newZoraTokenId,e.setNewZoraTokenId,Object(Q.k)()),l=r.data,f=(r.isError,r.isLoading,Object(i.useState)()),m=Object(s.a)(f,2),p=m[0],d=m[1],h=Object(i.useState)({name:"",symbol:"",description:"",editionSize:a.erc721EditionSize||10,publicSalePrice:"0.01"}),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useCallback)(Object(o.a)(c.a.mark(function e(){var t,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=_.a.utils.parseEther(v.publicSalePrice),d("Waiting for you to confirm in wallet"),e.next=5,K(l,v.name,v.symbol,v.description,t,parseInt(v.editionSize),500,"https://arweave.net/"+n.appManifest+"/?tokenId=","https://arweave.net/"+n.imageManifest+"/","https://arweave.net/"+n.imageManifest+"/1",a.erc721Attributes);case 5:return r=e.sent,o=r.hash,H(o,U),d("Waiting for block to be mined"),e.next=11,r.wait();case 11:d("Completed!"),console.log("tx =",r);case 13:case"end":return e.stop()}},e)})),[v,n,l,d]);return u.a.createElement("div",{className:"z-modal-backdrop"},u.a.createElement("div",{className:"z-modal-body zora-dialog-modal mint-dialog"},u.a.createElement("div",{className:"zora-dialog-inner"},p&&u.a.createElement("div",{className:"progress-text"},p),u.a.createElement(te,{contentURI:"https://arweave.net/"+n.appManifest}),u.a.createElement("div",null,u.a.createElement(Y,{screenshotsCount:a.erc721EditionSize||v.editionSize,imageManifest:n.imageManifest}),u.a.createElement("div",{className:"configuration"},u.a.createElement(P,{set:function(e){return g(Object(B.a)({},v,{name:e}))},get:v.name,name:"Name"}),u.a.createElement(P,{set:function(e){return g(Object(B.a)({},v,{symbol:e}))},get:v.symbol,name:"Symbol"}),u.a.createElement(P,{set:function(e){return g(Object(B.a)({},v,{description:e}))},get:v.description,name:"Description",isTextArea:!0}),u.a.createElement(P,{set:function(e){return g(Object(B.a)({},v,{editionSize:e}))},get:v.editionSize,name:"Edition Size"}),u.a.createElement(P,{set:function(e){return g(Object(B.a)({},v,{publicSalePrice:e}))},get:v.publicSalePrice,units:"eth",name:"Public Sale Price"}),u.a.createElement("div",{className:"connect-button-container"},u.a.createElement(J.a,{accountStatus:"address",showBalance:{smallScreen:!1,largeScreen:!1},label:"Connect Wallet"}))))),u.a.createElement("div",{className:"z-footer"},u.a.createElement("div",{className:"buttons"},u.a.createElement(q.b,{variant:"secondary",onClick:function(){return t(void 0)}},"Cancel"),u.a.createElement(q.b,{variant:"primary",onClick:E},"Mint on Zora (test-net)")))))}),ae=n(1379),re=n(1126),ce=(n(2140),n(170)),oe=n(232),se=n(2605),ie=n(2606),ue=Object(ce.b)([oe.b.mainnet,oe.b.goerli],[Object(se.a)({infuraId:"2f3dce2af1044e88b4851c3d73c3d00c"}),Object(ie.a)()]),le=ue.chains,fe=ue.provider,me=Object(ae.a)({appName:"Spore Players",chains:le}).connectors,pe=Object(Q.b)({autoConnect:!0,connectors:me,provider:fe}),de=function(e){return u.a.createElement(Q.a,{client:pe},u.a.createElement(J.d,{chains:le,theme:Object(re.a)({accentColor:"black",accentColorForeground:"white",borderRadius:"small"})},u.a.createElement(ne,e)))},he=n(175),be=n.n(he),ve=Object(m.b)(function(e,t){return{loops:e.freeze.loops}},function(e){return{setLoopsToFreeze:function(t){return e(Object(f.Dc)(t))}}})(function(e){var t=e.loops,n=e.setLoopsToFreeze;return u.a.createElement("div",null,u.a.createElement("div",{className:"parameter-label"},"Loops To Freeze: ",t),u.a.createElement(be.a,{value:Math.log2(t),change:function(e){return n(Math.pow(2,e.target.value))},step:1,max:6,min:0,orientation:"horizontal",reversed:!1}))}),ge=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.input,n=e.midiEngine,a=e.syncedInput,r=e.setSyncedInput,c=Object(i.useState)(n.isInputTracked(t)),o=Object(s.a)(c,2),l=o[0],f=o[1],m=a===t,p=Object(i.useCallback)(function(){n.isInputSynced(t)?(n.unsyncInput(t),r(void 0)):(n.syncInput(t),r(t))},[r]),d=Object(i.useCallback)(function(e){n.isInputTracked(t)?n.untrackInput(t):n.trackInput(t),f(!l)},[f,l]);return u.a.createElement("div",{className:"midi-input"},u.a.createElement("div",{className:"midi-name"},t.name),u.a.createElement("div",{className:"midi-options"},u.a.createElement("div",{onClick:d,className:l?"midi-option enabled":"midi-option"},"TRACK"),u.a.createElement("div",{onClick:p,className:m?"midi-option enabled":"midi-option"},"SYNC")))}),Ee=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.output,n=e.midiEngine,a=e.syncedOutput,r=e.setSyncedOutput,c=Object(i.useState)(n.isOutputTracked(t)),o=Object(s.a)(c,2),l=o[0],f=o[1],m=a===t,p=Object(i.useCallback)(function(){n.isOutputSynced(t)?(n.unsyncOutput(t),r(void 0)):(n.syncOutput(t),r(t))},[r]),d=Object(i.useCallback)(function(e){n.isOutputTracked(t)?n.untrackOutput(t):n.trackOutput(t),f(!l)},[f,l]);return u.a.createElement("div",{className:"midi-input"},u.a.createElement("div",{className:"midi-name"},t.name),u.a.createElement("div",{className:"midi-options"},u.a.createElement("div",{onClick:d,className:l?"midi-option enabled":"midi-option"},"TRACK"),u.a.createElement("div",{onClick:p,className:m?"midi-option enabled":"midi-option"},"SYNC")))}),Oe=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine.midi,n=Object(i.useState)(t.systemInput),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useState)(t.systemOutput),l=Object(s.a)(o,2),f=l[0],m=l[1],p=t.getInputs(),d=t.getOutputs();return u.a.createElement("div",{className:"midi-settings"},u.a.createElement("div",{className:"midi-header"},"Input:"),p.map(function(e){return u.a.createElement(ge,{midiEngine:t,syncedInput:r,setSyncedInput:c,input:e})}),u.a.createElement("div",{className:"midi-header"},"Output:"),d.map(function(e){return u.a.createElement(Ee,{midiEngine:t,syncedOutput:f,setSyncedInput:m,output:e})}))}),ye=n(6),ke=n.n(ye),je="interactive",Ce=[je,"balanced","playback"].map(function(e){return{label:e,value:e}}),Se=function(e){return{label:e,value:e}},we=Object(m.b)(function(e,t){return{latencyHint:t.sequencerEngine.latencyHint}},function(e){return{}})(function(e){var t=Object(i.useState)(e.latencyHint||je),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useState)(!1),o=Object(s.a)(c,2),f=o[0],m=o[1],p=Object(i.useCallback)(function(t){t=t.value,l.a.setItem("latencyHint",t),r(t),e.sequencerEngine.save("Test","PUBLIC",!1),m(!0)},[r,f]);return u.a.createElement("div",{className:"sample-rate-chooser"},u.a.createElement("div",{className:"dropdown-title"},"Latency Hint:"),u.a.createElement(D.a,{className:"audio-input-chooser-dropdown",controlClassName:"audio-input-chooser-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:Ce,onChange:p,value:Se(a),placeholder:"Audio Input"}),f?u.a.createElement("div",{className:"needs-reload"},"Reload page to use new latency hint"):"")}),Pe=n(4),Ne=n(5),xe=n(7),qe=n(8),Te=n(2);function Me(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Re=function(e){Object(xe.a)(n,e);var t=Me(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={options:[]},a.getOptions(),a}return Object(Ne.a)(n,[{key:"getOptions",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==navigator.mediaDevices){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,navigator.mediaDevices.enumerateDevices();case 4:t=e.sent,n=t.filter(function(e){return"audioinput"===e.kind}).map(function(e){return{label:e.label,value:e.deviceId}}),void 0!==this.props.deviceId||(a=this.props.defaultInput||"default",(r=t.filter(function(e){return e.label.includes(a)})).length>0&&void 0===this.props.audioInputSource&&this.onChangeInput(r[0].deviceId)),this.setState({options:n});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getOption",value:function(e){return void 0===e&&(e="default"),this.state.options.filter(function(t){return t.value===e})[0]}},{key:"onChangeInput",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:{deviceId:t,echoCancellation:!1}});case 2:n=e.sent,l.a.setItem("deviceId",t),console.log("choosing stream=",n,t),this.props.onChooseAudio(n,t);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.defaultClassName||"audio-input-chooser";return u.a.createElement("div",{className:t},u.a.createElement("div",{className:"dropdown-title"},"Input Device:"),u.a.createElement(D.a,{className:"audio-input-chooser-dropdown",controlClassName:"audio-input-chooser-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.state.options,onChange:function(t){return e.onChangeInput(t.value)},value:this.getOption(this.props.deviceId),placeholder:"Audio Input"}))}}]),n}(i.Component),De=Object(m.b)(function(e){return{audioInputSource:e.sequencer.audioInputSource}},function(e){return{}})(Re),Ie=n(741),Ae=[Ie.c,Ie.b,Ie.d,Ie.e,Ie.a].map(function(e){return{label:e,value:e}}),Le=function(e){return{label:e,value:e}},Fe=Object(m.b)(function(e,t){return{sampleRate:t.sequencerEngine.context.sampleRate}},function(e){return{}})(function(e){var t=Object(i.useState)(e.sampleRate),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useState)(!1),o=Object(s.a)(c,2),f=o[0],m=o[1],p=Object(i.useCallback)(function(t){t=t.value,l.a.setItem("sampleRate",t),r(t),e.sequencerEngine.save("Test","PUBLIC",!1),m(!0)},[r,f]);return u.a.createElement("div",{className:"sample-rate-chooser"},u.a.createElement("div",{className:"dropdown-title"},"SampleRate:"),u.a.createElement(D.a,{className:"audio-input-chooser-dropdown",controlClassName:"audio-input-chooser-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:Ae,onChange:p,value:Le(a),placeholder:"Audio Input"}),f?u.a.createElement("div",{className:"needs-reload"},"Reload page to use new sample rate"):"")}),ze=function(e){return u.a.createElement("div",{onClick:function(){return e.onClick(!e.isMultiChannelOutput)},className:"audio-outputs-option"},e.isMultiChannelOutput?"MULTI CHANNEL OUTPUT ":"SINGLE OUTPUT ","(",e.numberOfChannels," channels)")},Be=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=Object(i.useState)(void 0),a=Object(s.a)(n,2),r=(a[0],a[1]),c=Object(i.useState)(!t.channelMixer.stereoConnected),o=Object(s.a)(c,2),l=o[0],f=o[1],m=Object(i.useCallback)(function(e,n){t.audioInputManager.newInputSource(e,n),r(n)},[r]),p=Object(i.useCallback)(function(e){t.channelMixer.switchOutputs(e),f(e)},[f]);return u.a.createElement("div",{className:"audio"},u.a.createElement(Fe,{sequencerEngine:t}),u.a.createElement(we,{sequencerEngine:t}),u.a.createElement(De,{deviceId:t.audioInputManager.deviceId,defaultClassName:"preferences-audio-chooser",onChooseAudio:m}),u.a.createElement(ze,{isMultiChannelOutput:l,numberOfChannels:t.channelMixer.numberOfChannels(),onClick:p}))}),_e=n(140),He=n(127),Ue=n(69),Ge=n(75),We=n(118),Ve=n(83),Xe=function(){var e=Object(o.a)(c.a.mark(function e(t,n,a){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("getClockASks for userId=",n),fetch("/getClockAsks/"+n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(){var e=Object(o.a)(c.a.mark(function e(r){var o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.json();case 2:if(0===(o=e.sent)||"0"===o){e.next=7;break}t(o),e.next=12;break;case 7:if(!a.current){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,Object(Ve.a)(1e3);case 11:Xe(t,n,a);case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}();Ue.a,Ue.c;var Ke=Object(m.b)(function(e){return{clockType:e.sequencer.clockType,availableUsers:e.sequencer.clockType===Ue.a?[]:e.clock.availableUsers,connectedUserName:e.clock.connectedUserName,connectionStatus:e.clock.connectionStatus}},function(e){return{}})(function(e){var t=Object(i.useState)(void 0),n=Object(s.a)(t,2),a=n[0],r=n[1],l=Object(i.useState)(void 0),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useRef)(!1);Object(i.useEffect)(function(){a&&We.a.users.getUserName(a).then(p)},[a,p]),Object(i.useEffect)(function(){return _e.a.getAccount().then(function(e){return Xe(r,e,d)}),function(){return d.current=!0}},[]),Object(i.useEffect)(function(){e.sequencerEngine.clockSync.startListening()},[]);var h=Object(i.useCallback)(function(){var t=Object(o.a)(c.a.mark(function t(n){var a;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.connectionStatus!==Ge.c){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,We.a.users.getUserId(n);case 4:a=t.sent,e.sequencerEngine.clockSync.askToConnect(a);case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),[e.connectionStatus]),b=Object(i.useCallback)(function(){a&&(e.sequencerEngine.clockSync.setClockType(Ue.c),e.sequencerEngine.clockSync.syncToUser(a))},[a]),v=Object(i.useCallback)(function(t){return t===e.connectedUserName?"available-user selected":"available-user"},[e.connectedUserName,a]);return e.connectionStatus===Ge.c?u.a.createElement("div",{className:"clock-type-container"},u.a.createElement("div",{className:"sub-header"},"Clock Syncing"),"Connected with ",u.a.createElement("span",{className:"clock-user"},e.connectedUserName)):e.connectionStatus===Ge.d?u.a.createElement("div",{className:"clock-type-container"},u.a.createElement("div",{className:"sub-header"},"Clock Syncing"),"Waiting to connect..."):m?u.a.createElement("div",{className:"clock-type-container"},u.a.createElement("div",{className:"sub-header"},"Clock Syncing"),u.a.createElement("div",{className:"ask-text"},u.a.createElement("span",{className:"clock-user"},m)," wants to sync clocks with you."),u.a.createElement("div",{className:"ask-buttons"},u.a.createElement("div",{onClick:b,className:"ok-btn"},"Connect"),u.a.createElement("div",{className:"cancel-btn"},"Cancel"))):u.a.createElement("div",{className:"clock-type-container"},u.a.createElement("div",{className:"sub-header"},"Clock Syncing"),u.a.createElement("div",{className:"available-users"},"People available to connect:",e.availableUsers.map(function(t){return u.a.createElement("div",{onClick:function(){return h(t)},className:v(t)},t,u.a.createElement(He.a,{condition:e.connectionStatus===Ge.c},u.a.createElement("div",{className:"user-status"},"CONNECTED")))})))}),Qe=n(380),Ye=n(168),Je=n(141),Ze=n(1086),$e=n(122),et=n(158),tt=n(160);function nt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return at(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var rt=(new Ze.a).contractAddress,ct=function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,st(t);case 2:return n=e.sent,console.log("thumb = ",n),e.next=6,new Ye.a(tt.v,"newWallpaper",[Object(et.c)(t),Object(et.c)(n)]).execute();case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ot=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,s,i,u,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Je.a(rt).from($e.O).select("wallpaperHash").select("thumbnailHash"),t&&n.where("wallpaperHash",t),e.next=4,n.executeQuery();case 4:a=e.sent,r={},o=nt(a);try{for(o.s();!(s=o.n()).done;)i=s.value,r[i.thumbnailHash]=i.wallpaperHash}catch(c){o.e(c)}finally{o.f()}for(l in u=[],r)u.push({wallpaper:r[l],thumbnail:l});return e.abrupt("return",u);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),st=function(e){return new Promise(function(t){var n=new Image,a=document.createElement("canvas"),r=a.getContext("2d");n.onload=function(){a.width=300,a.height=300,r.drawImage(n,0,0,300,300);var e=function(e){for(var t=atob(e.split(",")[1]),n=(e.split(",")[0].split(":")[1].split(";")[0],new ArrayBuffer(t.length)),a=new Uint8Array(n),r=0;r<t.length;r++)a[r]=t.charCodeAt(r);return n}(a.toDataURL());p.a.addArrayBuffer(e).then(t)},n.src=p.a.getHashUrl(e)})};var it=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0,o=(arguments.length>6&&arguments[6],arguments.length>7?arguments[7]:void 0),u=(arguments.length>8&&arguments[8],Object(i.useState)(t)),l=Object(s.a)(u,2),f=l[0],m=l[1],p=Object(i.useRef)(0);Object(i.useEffect)(function(){e.current&&e.current.scrollTo(0,0),m(t)},[r,a,m,c,t]),Object(i.useEffect)(function(){o+5>f&&m(o+20)},[o,f]),Object(i.useEffect)(function(){if(n&&e.current)return e.current.addEventListener("scroll",d),function(){return e.current&&e.current.removeEventListener("scroll",d)}},[m,f,n,e.current,e.initialSize]);var d=Object(i.useCallback)(function(n){var a=e.current;a&&(p.current=a.scrollTop,a.scrollTop+a.offsetHeight>=a.scrollHeight-3&&m(f+t))},[m,f,e,t]);return{size:f,scrollPosition:p}},ut=Object(m.b)(function(e,t){return{theme:e.sequencer.theme,wallpaper:e.sequencer.wallpaper,animateWallpaper:e.sequencer.animateWallpaper,backgroundColor:e.sequencer.backgroundColor,showThemeGrid:e.sequencer.showThemeGrid}},function(e){return{setShowThemeGrid:function(t){return e(Object(f.Te)(t))},setTheme:function(t){return e(Object(f.pf)(t))},setWallpaper:function(t){return e(Object(f.fg)(t))},setBackgroundColor:function(t){return e(Object(f.O)(t))},setAnimateWallpaper:function(t){return e(Object(f.y)(t))}}})(function(e){var t=Object(i.useRef)(void 0),n=Object(i.useState)(e.wallpaper),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useState)(void 0),f=Object(s.a)(o,2),m=f[0],d=f[1],h=Object(i.useState)(!1),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useState)({hex:e.backgroundColor}),O=Object(s.a)(E,2),y=O[0],k=O[1];Object(i.useEffect)(function(){e.backgroundColor!==y.hex&&(e.setBackgroundColor(y.hex),window.localStorage.setItem("backgroundColor",y.hex))},[y,e.backgroundColor]);var j=it(t,9,!0).size;Object(i.useEffect)(function(){r&&(l.a.setItem("wallpaper",r),m&&!m.map(function(e){return e.wallpaper}).includes(r)&&ct(r),e.setWallpaper(r))},[r,m]),Object(i.useEffect)(function(){ot().then(d)},[d]);var C=m||[];return u.a.createElement("div",{className:"appearance"},u.a.createElement("div",{className:"wallpaper-toolbar"},"Color Theme:",u.a.createElement("div",{style:{backgroundColor:y.hex},onClick:function(){return g(!v)},className:"color-btn"}),v&&u.a.createElement(Qe.a,{color:y,onChange:k}),e.wallpaper&&u.a.createElement("div",{onClick:function(){e.setWallpaper(void 0),window.localStorage.removeItem("wallpaper")},className:"pushable clear-wallpaper"},"Clear Wallpaper")),u.a.createElement(w.a,{placeholder:"Drag new wallpaper here",imageHash:r,setImageHash:c}),u.a.createElement("div",{ref:t,className:"gallery"},C.slice(0,j).map(function(e){var t=e.wallpaper,n=e.thumbnail;return u.a.createElement("img",{key:t,onClick:function(){return c(t)},src:p.a.getHashUrl(n),className:"wallpaper-choice"})})))}),lt=(n(2247),function(e){var t=e.option,n=e.setOption,a=e.selectedOption,r="settings-option";return t===a&&(r+=" selected"),u.a.createElement("div",{onClick:function(){return n(t)},className:r},t)}),ft=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=Object(i.useState)("Appearance"),n=Object(s.a)(t,2),a=n[0],r=n[1];return u.a.createElement("div",{className:"settings"},u.a.createElement("div",{className:"settings-sidebar"},u.a.createElement(lt,{option:"Appearance",selectedOption:a,setOption:r}),e.onlyAppearance?"":u.a.createElement(lt,{option:"MIDI",selectedOption:a,setOption:r}),e.onlyAppearance?"":u.a.createElement(lt,{option:"Audio",selectedOption:a,setOption:r}),e.onlyAppearance?"":u.a.createElement(lt,{option:"Freeze",selectedOption:a,setOption:r}),e.onlyAppearance?"":u.a.createElement(lt,{option:"Clock",selectedOption:a,setOption:r})),u.a.createElement("div",{className:"settings-content"},"Appearance"===a?u.a.createElement(ut,{sequencerEngine:e.sequencerEngine}):"","MIDI"===a?u.a.createElement(Oe,{sequencerEngine:e.sequencerEngine}):"","Audio"===a?u.a.createElement(Be,{sequencerEngine:e.sequencerEngine}):"","Freeze"===a?u.a.createElement(ve,{sequencerEngine:e.sequencerEngine}):"","Clock"===a?u.a.createElement(Ke,{sequencerEngine:e.sequencerEngine}):""))}),mt=Object(m.b)(function(e,t){return{}},function(e){return{setShowSettings:function(t){return e(Object(f.Re)(t))}}})(function(e){var t=Object(i.useCallback)(function(){e.setShowSettings(!1),e.hide&&e.hide()},[]);return u.a.createElement(x.a,{dialogClassName:"preset-modal",show:!0,onHide:t},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,"Settings")),u.a.createElement(x.a.Body,null,u.a.createElement(ft,{onlyAppearance:e.onlyAppearance,sequencerEngine:e.sequencerEngine})),u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{variant:"secondary",onClick:t},"Done")))}),pt=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){e.favorited;var t=e.setViewMode,n=e.viewMode,a=(e.setFavorited,e.starred,e.setStarred,e.setFilterMine),r=e.filterMine,c=(e.setOld,e.old,e.setSongs),o=e.songs;return u.a.createElement("div",{className:"search-options"},u.a.createElement("div",{onClick:function(){return a(!0)},className:r?"selected search-option":"search-option"},"My Projects"),u.a.createElement("div",{onClick:function(){return a(!1)},className:r?"search-option":"selected search-option"},"All Projects"),u.a.createElement("div",{onClick:function(){return c(!o)},className:o?"selected music-icon search-option":"music-icon search-option"},u.a.createElement("img",{src:"/musical-note.svg"})),!1,u.a.createElement("div",{className:"view-modes"},u.a.createElement("div",{onClick:function(){return t("LIST")},className:"LIST"===n?"selected view-mode":"view-mode"},u.a.createElement("img",{src:"/list-icon.svg"})),u.a.createElement("div",{onClick:function(){return t("GRID")},className:"GRID"===n?"selected view-mode":"view-mode"},u.a.createElement("img",{src:"/grid-icon.svg"}))))}),dt=n(44),ht=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.color,a=e.patternNumber,r=t.patterns[a];if(!r)return[];var c=new Array(Math.min(16,r.size/2)).fill(0);return u.a.createElement("div",{className:"track-steps"},c.map(function(e,t){return u.a.createElement("div",{style:r[2*t]?{backgroundColor:n}:{},className:"track-step"})}))}),bt=function(e){var t=e.pattern,n=e.isCurrent,a=e.setPatternNumber,r="mini-pattern-btn";return n&&(r+=" current"),u.a.createElement("div",{className:r,onClick:function(){return a(t)}},t+1)},vt=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.patternNumber,n=e.setPatternNumber,a=e.patterns,r=new Array(a).fill(0);return u.a.createElement("div",{className:"pattern-numbers"},r.map(function(e,a){return u.a.createElement(bt,{pattern:a,isCurrent:t===a,setPatternNumber:n})}))}),gt=["A","B","C","D","E","F","G","H"],Et=function(e){var t=e.subSequence,n=e.isCurrent,a=e.setSubSequence,r="mini-subsequence-btn";return n&&(r+=" current"),u.a.createElement("div",{className:r,onClick:function(){return a(t)}},gt[t])},Ot=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.subSequence,n=e.setSubSequence,a=e.subSequences,r=new Array(a).fill(0);return u.a.createElement("div",{className:"subsequence-buttons"},r.map(function(e,a){return u.a.createElement(Et,{subSequence:a,isCurrent:t===a,setSubSequence:n})}))}),yt=(new h.a,Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.color,a=e.onClick,r=e.isSelected,c={backgroundColor:n};if(t.sample){var o=t.sample.getThumbnail();o&&""!==o&&(console.log("url = ",o),c.backgroundImage="url("+o+")")}return u.a.createElement("div",{onClick:a,style:c,className:r?"mini-thumbnail selected":"mini-thumbnail"})})),kt=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.a.guildSequences.getGuildSequence(t);case 2:if(void 0!==(n=e.sent)||!_e.a.isLoggedIn()){e.next=8;break}return e.next=6,We.a.encryption.getSequencesSharedWithUser(t);case 6:n=(n=e.sent)[0];case 8:if(void 0===n){e.next=15;break}return e.next=11,We.a.crypto.fetchAndDecrypt(t,n);case 11:return a=e.sent,e.abrupt("return",JSON.parse(a));case 15:return e.next=17,We.a.encryption.getEncryptedSequenceIfAny(t);case 17:if(void 0===(r=e.sent)){e.next=24;break}return e.t0=JSON,e.next=22,We.a.crypto.fetchAndDecrypt(t,r);case 22:return e.t1=e.sent,e.abrupt("return",e.t0.parse.call(e.t0,e.t1));case 24:return e.abrupt("return",p.a.getJson(t));case 25:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),jt=(n(644),n(159)),Ct=n(138);function St(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Pt=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,s,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kt(t);case 2:n=e.sent,a=[],r=St(n.subSequences),e.prev=5,r.s();case 7:if((o=r.n()).done){e.next=15;break}return s=o.value,e.next=11,Nt(s);case 11:i=e.sent,a.push(i);case 13:e.next=7;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),r.e(e.t0);case 20:return e.prev=20,r.f(),e.finish(20);case 23:return e.abrupt("return",a);case 24:case"end":return e.stop()}},e,null,[[5,17,20,23]])}));return function(t){return e.apply(this,arguments)}}(),Nt=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,s,i,u,l,f,m,p,d;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=0,r=St(t.tracksData),e.prev=3,r.s();case 5:if((o=r.n()).done){e.next=30;break}if(s=o.value,i=s.type,u=s.instrumentType,l=s.presetName,f=s.samplers,m=Object.keys(f),p={type:i,instrumentType:u,name:l||jt.d[u]},i===M.e&&(p.name="Multi Freeze"),!(m.length>0)){e.next=17;break}return d=new Ct.a(m[0]),e.next=15,d.fetchMetadata();case 15:p.name=d.name,p.sample=d;case 17:p.patterns=t.tracks[a],p.patternParameters=t.tracksPatterns[a],p.trackEffects=t.tracksEffectsChains[a][0],p.trackMidiEffects=t.tracksMidiEffects[a],p.trackLiveEffects=t.tracksLiveEffects[a],p.parameters=t.tracksParameters[a],p.trackData=t.tracksData[a],p.envelopes=t.envelopes,p.lfos=t.lfos,n.push(p),a++;case 28:e.next=5;break;case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(3),r.e(e.t0);case 35:return e.prev=35,r.f(),e.finish(35);case 38:return e.abrupt("return",n);case 39:case"end":return e.stop()}},e,null,[[3,32,35,38]])}));return function(t){return e.apply(this,arguments)}}(),xt=new h.a,qt=["A","B","C","D","E","F","G","H"],Tt=function(e){e.loadModule;var t=e.sub,n=(e.moduleName,e.patternNumber),a=e.onClickTrack,r=e.selectedTracks,c=e.sequencerEngine;Object(i.useCallback)(function(){c.operationManager.dispatch(Object(dt.l)(r.length>0?r:t,n))},[r,n,t]);return u.a.createElement("div",{className:"sub"},t.map(function(e){return u.a.createElement(Mt,{onClick:function(){return a(e)},isSelected:r.includes(e),patternNumber:n,track:e})}))},Mt=function(e){var t=e.track,n=e.patternNumber,a=e.onClick,r=e.isSelected,c=t.sample?t.sample.getId():t.name,o=c?xt.getColorForHash(c):"red";return u.a.createElement("div",{className:"mini-track"},u.a.createElement(yt,{isSelected:r,onClick:a,color:o,track:t}),u.a.createElement("div",{className:"track-name"},Rt(t.name)),u.a.createElement(ht,{color:o,track:t,patternNumber:n}))},Rt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return e&&e.length>t?e.slice(0,t)+"...":e},Dt=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.project,a=Object(i.useState)(0),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(0),f=Object(s.a)(l,2),m=f[0],p=f[1],h=Object(i.useState)(void 0),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useState)([]),O=Object(s.a)(E,2),y=O[0],k=O[1],j=Object(i.useCallback)(function(e){void 0===e?t.loadSequence(n.newSequence):t.loadSequence(n.newSequence,parseInt(e))},[n]);Object(i.useEffect)(function(){Pt(n.newSequence).then(g)},[g]);var C=Object(i.useCallback)(function(e){y.includes(e)?k(y.filter(function(t){return t!==e})):k([].concat(Object(d.a)(y),[e]))},[y,k]);return v&&0!==v.length?u.a.createElement("div",{className:"expanded-project"},u.a.createElement("div",{className:"expanded-toolbar"},v[0]&&v[0][0]&&u.a.createElement(vt,{patterns:v[0][0].patterns.length,patternNumber:c,setPatternNumber:o}),u.a.createElement(Ot,{subSequences:v.length,subSequence:m,setSubSequence:p}),u.a.createElement("div",{onClick:function(){return j()},className:"load-project-btn"},"Load Entire Project")),u.a.createElement(Tt,{loadModule:function(){return j(m)},sequencerEngine:t,onClickTrack:C,selectedTracks:y,patternNumber:c,moduleName:qt[m],sub:v[m]})):[]}),It=n(755);function At(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ft={},zt=function(e,t){return new Promise(function(){var n=Object(o.a)(c.a.mark(function n(a){return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t in Ft)){n.next=3;break}if(Ft[t].lenggth!==e.length){n.next=3;break}return n.abrupt("return",a(Object(d.a)(Ft[t])));case 3:return n.t0=fetch,n.t1=JSON,n.next=7,_e.a.getAccount();case 7:n.t2=n.sent,n.t3=0===e.length,n.t4=e,n.t5={user:n.t2,all:n.t3,ids:n.t4},n.t6=n.t1.stringify.call(n.t1,n.t5),n.t7={Accept:"application/json","Content-Type":"appliction/json"},n.t8={method:"POST",body:n.t6,headers:n.t7},(0,n.t0)("/querySample/",n.t8).then(function(e){return e.json()}).then(function(e){var n=[];if(!e||!Array.isArray(e))return Ft[t]=n,a(n);var r,c=At(e);try{for(c.s();!(r=c.n()).done;){var o=r.value,s=new Ct.a(o.id);s.name=o.title,s.packs=o.packs,s.videoId=o.videoId,s.favorited=5===o.rating,s.blockNumber=o.blockNumber,s.sampledByUser=o.user,s.artistName=o.artistName,s.releaseName=o.releaseName,s.guildId=o.guildId,s.year=o.year,s.discogsId=o.discogsId,s.coverArtHash=""===o.coverArtHash?void 0:o.coverArtHash,s.tags=Array.from(new Set(o.tags||[])),n.push(s)}}catch(i){c.e(i)}finally{c.f()}Ft[t]=n,a(n)});case 15:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}())};window.getBulkSampleInfo=zt;n(2248);function Bt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return _t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _t(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ht=new h.a,Ut=We.a.presets,Gt=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={},a=Bt(t),e.prev=2,a.s();case 4:if((r=a.n()).done){e.next=11;break}return o=r.value,e.next=8,Ut.getPresetTitle(o);case 8:n[o]=e.sent;case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),a.e(e.t0);case 16:return e.prev=16,a.f(),e.finish(16);case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}},e,null,[[2,13,16,19]])}));return function(t){return e.apply(this,arguments)}}(),Wt=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.projectHash,n=e.metadata,a=n&&n.thumbnailHash?p.a.getHashUrl(n.thumbnailHash):void 0,r=Object(i.useState)({}),c=Object(s.a)(r,2),o=c[0],l=c[1],f=Object(i.useState)([]),m=Object(s.a)(f,2),d=m[0],h=m[1];return Object(i.useEffect)(function(){n&&n.presets&&Gt(n.presets).then(l)},[n,l]),Object(i.useEffect)(function(){n&&n.samples&&0!==n.samples.length&&zt(n.samples,t).then(function(e){return h(e.filter(function(e){return e.name}))})},[n,h,t]),n?(console.log("we had metadata=",a),u.a.createElement("div",{className:"project-metadata"},a&&u.a.createElement("img",{src:a,className:"project-thumbnail"}),Object.keys(o).length>0&&u.a.createElement("div",{className:"presets"},Object.keys(o).map(function(e){return u.a.createElement("div",{className:"preset-name"},u.a.createElement("div",{className:"dot",style:{backgroundColor:Ht.getColorForHash(e)}}),o[e])})),d.length>0&&u.a.createElement("div",{className:"samples"},d.map(function(e){return u.a.createElement("div",{className:"sample-name"},Object(It.a)(e.tags[0]||e.name))})))):""}),Vt=tt.y.SEQUENCE_METADATA.options.address,Xt={},Kt={},Qt=new(function(){function e(){Object(Pe.a)(this,e)}return Object(Ne.a)(e,[{key:"tagSequence",value:function(){var e=Object(o.a)(c.a.mark(function e(t,n){var a,r=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>2&&void 0!==r[2]?r[2]:0,e.abrupt("return",new Ye.a(tt.u,"tagSequence",[Object(et.c)(t),Object(et.b)(n),a]).execute());case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"starSequence",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,e.abrupt("return",new Ye.a(tt.u,"starSequence",[Object(et.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"favoriteSequence",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,e.abrupt("return",new Ye.a(tt.u,"favoriteSequence",[Object(et.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"unstarSequence",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,e.abrupt("return",new Ye.a(tt.u,"unstarSequence",[Object(et.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"unfavoriteSequence",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,e.abrupt("return",new Ye.a(tt.u,"unfavoriteSequence",[Object(et.c)(t),n]).execute());case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"isSequenceFavorited",value:function(){var e=Object(o.a)(c.a.mark(function e(t,n){var a,r,o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=n.toLowerCase(),!((a=t+n)in Xt)){e.next=4;break}return e.abrupt("return",Xt[a]);case 4:return e.next=6,new Je.a(Vt).from($e.nb).select("ipfsHash").where("ipfsHash",t).where("user",n).executeQuery();case 6:return r=e.sent,e.next=9,new Je.a(Vt).from($e.qb).select("ipfsHash").where("ipfsHash",t).where("user",n).executeQuery();case 9:return o=e.sent,s=r.length-o.length,Xt[a]=s>0,e.abrupt("return",Xt[a]);case 13:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"isSequenceStarred",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in Kt)){e.next=2;break}return e.abrupt("return",Kt[t]);case 2:return e.next=4,new Je.a(Vt).from($e.ob).select("ipfsHash").where("ipfsHash",t).executeQuery();case 4:return n=e.sent,e.next=7,new Je.a(Vt).from($e.rb).select("ipfsHash").where("ipfsHash",t).executeQuery();case 7:return a=e.sent,Kt[t]=n.length-a.length>0,e.abrupt("return",Kt[t]);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTags",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Je.a(Vt).from($e.pb).select("tag").where("ipfsHash",t).executeQuery();case 2:return n=e.sent,e.abrupt("return",n.map(function(e){return e.tag}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getStarredSequences",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a,r,o,s,i,u=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u.length>0&&void 0!==u[0]?u[0]:0,e.next=3,new Je.a(Vt).from($e.ob).select("ipfsHash").where("guildId",0).executeQuery();case 3:return t=e.sent,e.next=6,new Je.a(Vt).from($e.rb).select("ipfsHash").where("guildId",0).executeQuery();case 6:for(r in n=e.sent,a={},t)(o=t[r]).ipfsHash in a||(a[o.ipfsHash]=0),a[o.ipfsHash]++;for(s in n)(i=n[s]).ipfsHash in a||(a[i.ipfsHash]=0),a[i.ipfsHash]--;return e.abrupt("return",Object.keys(a).filter(function(e){return a[e]>0}));case 11:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getFavoritedSequences",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,s,i,u,l,f=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>1&&void 0!==f[1]?f[1]:0,t=t.toLowerCase(),e.next=4,new Je.a(Vt).from($e.nb).select("ipfsHash").where("user",t).where("guildId",n).executeQuery();case 4:return a=e.sent,e.next=7,new Je.a(Vt).from($e.qb).select("ipfsHash").where("user",t).executeQuery();case 7:for(s in r=e.sent,o={},a)(i=a[s]).ipfsHash in o||(o[i.ipfsHash]=0),o[i.ipfsHash]++;for(u in r)(l=r[u]).ipfsHash in o||(o[l.ipfsHash]=0),o[l.ipfsHash]--;return e.abrupt("return",Object.keys(o).filter(function(e){return o[e]>0}));case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getFavorites",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,s,i,u,l,f,m,p,d;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Je.a(Vt).from($e.nb).select("ipfsHash").select("user").where("ipfsHash",t).executeQuery();case 2:return n=e.sent,e.next=5,new Je.a(Vt).from($e.qb).select("ipfsHash").select("user").where("ipfsHash",t).executeQuery();case 5:for(s in a=e.sent,r={},o={},n)i=n[s],(u=n[s].user)in r||(r[u]=0,o[u]=[]),r[u]++,o[u].push(i);for(l in a)a[l],(f=a[l].user)in r||(r[f]=0),r[f]--;m=[],e.t0=c.a.keys(r);case 12:if((e.t1=e.t0()).done){e.next=20;break}if(p=e.t1.value,!(r[p]<=0)){e.next=16;break}return e.abrupt("continue",12);case 16:d=o[p],m.push(d[d.length-1]),e.next=12;break;case 20:return e.abrupt("return",m);case 21:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),e}()),Yt=function(e){var t=e.track,n=e.guildId,a=void 0===n?0:n,r=Object(i.useState)(!1),u=Object(s.a)(r,2),l=u[0],f=u[1],m=Object(i.useState)(!1),p=Object(s.a)(m,2),d=p[0],h=p[1],b=Object(i.useState)(!1),v=Object(s.a)(b,2),g=v[0],E=v[1];function O(){return(O=Object(o.a)(c.a.mark(function e(n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.stopPropagation(),_e.a.isLoggedIn()){e.next=3;break}return e.abrupt("return");case 3:l?(Qt.unfavoriteSequence(t.id,a),f(!1)):(Qt.favoriteSequence(t.id,a),f(!0));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y(){return(y=Object(o.a)(c.a.mark(function e(n){var r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.stopPropagation(),e.next=3,_e.a.getAccount();case 3:if(r=e.sent,$t(r,t.user)){e.next=6;break}return e.abrupt("return");case 6:d?(Qt.unstarSequence(t.id,a),h(!1)):(Qt.starSequence(t.id,a),h(!0),E(!0));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(i.useEffect)(function(){!function(e,t){Zt.apply(this,arguments)}(t.id,f),function(e,t,n){Jt.apply(this,arguments)}(t,E,h)},[t.blockNumber,h,E,t]),{showStar:g,isStarred:d,isFavorited:l,onStarClicked:function(e){return y.apply(this,arguments)},onFavoriteClicked:function(e){return O.apply(this,arguments)}}};function Jt(){return(Jt=Object(o.a)(c.a.mark(function e(t,n,a){var r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.getAccount();case 2:return r=e.sent,e.next=5,Qt.isSequenceStarred(t.id);case 5:((o=e.sent)||$t(r,t.user))&&n(!0),a(o);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Zt(){return(Zt=Object(o.a)(c.a.mark(function e(t,n){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.getAccount();case 2:if(void 0!==(a=e.sent)){e.next=5;break}return e.abrupt("return");case 5:return e.t0=n,e.next=8,Qt.isSequenceFavorited(t,a);case 8:e.t1=e.sent,(0,e.t0)(e.t1);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var $t=function(e,t){return void 0!==e&&void 0!==t&&e.toLowerCase()===t.toLowerCase()},en=n(313),tn=n(466),nn=n(43);function an(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return rn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rn(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function rn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var cn=new h.a,on=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,s,i,l,f=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>1&&void 0!==f[1]?f[1]:8,a={},e.prev=2,e.next=5,window.sequencerEngine.encryptedIpfs.getJson(t.newSequence,t.guildId,5e3);case 5:if("object"===typeof(a=e.sent)){e.next=8;break}return e.abrupt("return","");case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(2),console.log("ERROR = ",e.t0),e.abrupt("return","");case 14:return e.next=16,un(Object(tn.a)(a));case 16:for(i in r=e.sent,o=[],s=[],a.subSequences)o=[].concat(Object(d.a)(o),Object(d.a)(a.subSequences[i].tracks.map(function(e){return e.map(function(e){return Object.keys(e).filter(function(e){return Object(nn.a)(e)}).map(parseFloat).filter(function(e){return e<32})})}))),s=[].concat(Object(d.a)(s),Object(d.a)(a.subSequences[i].tracksData.map(function(e){return sn("SAMPLER"===e.type?e.samplers:e.presetName||e.type)})));return l=r.filter(function(e){return e.getThumbnail()}),e.abrupt("return",{graphic:[u.a.createElement("div",{className:"bpm"},a.bpm)].concat(Object(d.a)(o.map(function(e,t){return u.a.createElement("div",{key:"track-"+t,className:"track-graphic"},e[0].map(function(e,a){return u.a.createElement("div",{key:t+"-"+e+"-step",style:{left:e*n,backgroundColor:s[t]},className:"step-graphic"})}))})),[l.length>0?u.a.createElement("div",{className:"work-sounds"},l.map(function(e){return u.a.createElement(en.a,{sample:e})})):""]),bpm:a.bpm,wallpaper:a.wallpaper});case 22:case"end":return e.stop()}},e,null,[[2,10]])}));return function(t){return e.apply(this,arguments)}}(),sn=function(e){if("object"===typeof e&&(e=Object.keys(e)[0]),void 0!==e)return cn.saturate(cn.getColorForHash(e),3)},un=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=an(t),e.prev=2,a.s();case 4:if((r=a.n()).done){e.next=12;break}return o=r.value,s=new Ct.a(o),e.next=9,s.load(!1);case 9:n.push(s);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),a.e(e.t0);case 17:return e.prev=17,a.f(),e.finish(17);case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}},e,null,[[2,14,17,20]])}));return function(t){return e.apply(this,arguments)}}();function ln(e){return e.getMonth()+1+"/"+e.getDate()}var fn=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=l.a).getItem("blockDate."+t)){e.next=3;break}return e.abrupt("return",new Date(1e3*n.getItem("blockDate."+t)));case 3:if(void 0!==t){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.next=7,W.a.eth.getBlock(t);case 7:if(null!==(a=e.sent)){e.next=10;break}return e.abrupt("return",new Date);case 10:return r=new Date(1e3*a.timestamp),n.setItem("blockDate."+t,a.timestamp),e.abrupt("return",r);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),mn=(n(2250),new h.a),pn=Object(m.b)(function(e,t){return{}},function(e){return{setShowProjectsModal:function(t){return e(Object(f.Ne)(t))}}})(function e(t){var n=t.project,a=t.sequencerEngine,r=t.expanded,l=t.odd,f=t.setExpandedProject,m=t.setShowProjectsModal,d=t.viewMode,h=Object(i.useState)(void 0),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useState)(void 0),O=Object(s.a)(E,2),y=O[0],k=O[1],j=Object(i.useState)(""),C=Object(s.a)(j,2),S=C[0],w=C[1],P=Object(i.useState)([]),N=Object(s.a)(P,2),x=N[0],q=N[1],T=Object(i.useState)(void 0),M=Object(s.a)(T,2),R=M[0],D=M[1],I=Object(i.useState)(void 0),A=Object(s.a)(I,2),L=(A[0],A[1],Object(i.useState)("")),F=Object(s.a)(L,2),z=F[0],B=F[1];n.id=n.newSequence;var _=Yt({track:n}),H=_.isFavorited,U=_.isStarred;Object(i.useEffect)(function(){n.guildId?We.a.guildSequences._decryptQueryResult(n).then(function(e){return B(e.title)}):B(n.title)},[n,B]),Object(i.useEffect)(function(){y?function(e){return new Promise(function(){var t=Object(o.a)(c.a.mark(function t(n,a){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("getting edits for project=",e),r={project:e},fetch("/projectEdits/",{method:"POST",body:JSON.stringify(r),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){n(e)});case 3:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}(n.newSequence).then(function(e){console.log("edits for project = ",n.title,e),q(e)}):q([])},[y,n]),Object(i.useEffect)(function(){We.a.users.getUserName(n.user).then(function(e){return w(e||n.user)}),fn(n.blockNumber).then(function(e){return g(e)}),n.guildId?We.a.guilds.getGuildName(n.guildId).then(D):D(void 0)},[n,w,g]);var G=Object(i.useCallback)(function(){r?(m(!1),a.loadSequence(n.newSequence)):f(n)},[f,n,r]),W={color:S?mn.getColorForHash(S):""},V=(S&&mn.getColorForHash(S),{});R&&(V.color=mn.getColorForHash(R));var X="project-option";r&&(X+=" expanded"),n.metadata&&(X+=" has-metadata");var K=u.a.createElement("div",{className:X},u.a.createElement("div",{className:"project-name"},z),u.a.createElement("div",{style:W,className:"project-author"},S),n.edits>0?u.a.createElement("div",{onClick:function(){return k(!y)},className:y?"edits-btn showing":"edits-btn"},n.edits," Edits"):"",H?u.a.createElement("div",{className:"heart favorited"}):"",U?u.a.createElement("div",{className:"star starred"},u.a.createElement("span",null,"\u2606")):"",u.a.createElement("div",{className:"p-metadata"},n.Metadata.patternsCount>0&&u.a.createElement("div",{className:"project-bpm"},u.a.createElement("div",{style:{width:60*Math.min(1,n.bpm/200)},className:"bpm-slider"}),u.a.createElement("div",{className:"bpm-text"},"BPM: ",n.Metadata.BPM)),n.Metadata.patternsCount>0?u.a.createElement("div",{className:"project-patterns"},u.a.createElement("div",{className:"bpm-text"},n.Metadata.patternsCount," ",u.a.createElement("span",{className:"patterns"},"patterns"))):"",""!==n.Metadata.thumbnailHash?u.a.createElement("div",{className:"project-visual"},u.a.createElement("img",{className:"visual-thumbnail",src:p.a.getHashUrl(n.Metadata.thumbnailHash)})):""),u.a.createElement("div",{className:"project-date"},v?ln(v):""),n.contentKey?u.a.createElement("div",{className:"private-project"},"Private"):"",R?u.a.createElement("div",{style:V,className:"project-guild"},R):"",n.isLocal?u.a.createElement("div",{className:"local-only"},"Not Synced"):"");if(y)return u.a.createElement("div",{className:"expanded-project"},K,u.a.createElement("div",{className:"project-edits"},x.map(function(t){return u.a.createElement(e,{setExpandedProject:f,expanded:r,project:t,sequencerEngine:a})})));var Q=n.Metadata?"project-option-wrapper has-metadata":"project-option-wrapper";return l&&(Q+=" odd"),"GRID"===d&&(Q+=" pushable"),u.a.createElement("div",{onClick:G,className:Q},K,u.a.createElement(Wt,{projectHash:n.newSequence,metadata:n.Metadata}))}),dn=n(757),hn=Object(m.b)(function(e,t){return{guildId:e.guilds.selectedGuild?e.guilds.selectedGuild.guildId:0}},function(e){return{}})(function(e){var t=e.guildId,n=e.viewMode,a=e.sequencerEngine,r=e.searchTerm,c=e.filterMine,o=e.setExpandedProject,l=e.expandedProject,f=e.starred,m=e.favorited,p=e.old,d=e.songs,h=Object(i.useState)([]),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useState)(!1),O=Object(s.a)(E,2),y=O[0],k=O[1],j=Object(i.useRef)(void 0),C=it(j,24,!0,r,l).size;Object(i.useEffect)(function(){l||(k(!0),Object(dn.a)(r,c,f,m,void 0,void 0,t,void 0,p).then(function(e){k(!1),"GRID"===n&&(e=e.filter(function(e){return e.Metadata&&e.Metadata.thumbnailHash})),d&&(e=e.filter(function(e){return e.Metadata&&e.Metadata.patternsCount>0})),g(e)}))},[d,n,r,p,g,c,k,l,f,m,t]);var w={height:window.innerHeight-216},P=l?"has-expanded-project sequences-list":"sequences-list";return"GRID"===n&&(P+=" grid-mode"),u.a.createElement("div",{ref:j,style:w,className:P},y?u.a.createElement(S.a,{text:"Loading Projects"}):l?u.a.createElement("div",{className:"project-and-back"},u.a.createElement("div",{onClick:function(){return o(void 0)},className:"selector-back-button"}),u.a.createElement(pn,{setExpandedProject:o,viewMode:n,sequencerEngine:a,project:l,expanded:!0})):v.slice(0,C).map(function(e,t){return u.a.createElement(pn,{viewMode:n,odd:t%2===1,key:t+"-"+e.newSequence,setExpandedProject:o,sequencerEngine:a,project:e})}),l?u.a.createElement(Dt,{project:l,sequencerEngine:a}):"")});n(1012);var bn=n(119),vn=n(164),gn=[{value:"day",label:"Day"},{value:"tag",label:"Tag"}],En=0,On=Object(m.b)(function(e,t){return{}},function(e){return{setContextualHelp:function(t,n){return e(Object(f.hb)(t,n))}}})(function(e){var t=e.setContextualHelp,n=e.onChange,a=e.displayOption,r=e.setDisplayOption,c=e.quickAddSearchText,o=e.groupBy,l=e.setGroupBy,f=e.hideFilter,m=e.setFilterFavorites,d=e.filterFavorites,h=e.sourceToSearch,b=e.children,v=Object(i.useRef)(void 0),g=Object(i.useState)(c),E=Object(s.a)(g,2),O=E[0],y=E[1],k=Object(i.useState)(void 0),j=Object(s.a)(k,2),C=j[0],S=j[1];Object(i.useEffect)(function(){return window.addEventListener("keydown",w),function(){return window.removeEventListener("keydown",w)}},[]);var w=Object(i.useCallback)(function(e){"/"===e.key&&(e.ctrlKey||e.metaKey)||"ArrowDown"!==e.key&&"ArrowUp"!==e.key||(e.preventDefault(),v.current.blur())},[]);Object(i.useEffect)(function(){v.current.focus()},[]),Object(i.useEffect)(function(){if(h){var e=h.videoId,t=h.releaseId;t?We.a.getCoverArtForDiscogs(t).then(function(e){var t=e.coverArtHash;return S(p.a.getHashUrl(t))}):S(function(e){return""===e||void 0===e?"":"https://img.youtube.com/vi/"+e+"/1.jpg"}(e))}else S(void 0)},[h,S]);var P=Object(i.useCallback)(function(e){var t=++En,a=e.target.value;y(a),setTimeout(function(){t===En&&n(a)},600)},[y,n]);return Object(i.useEffect)(function(){c&&y(c)},[c,y]),u.a.createElement(vn.a,{element:bn.X,className:"entire-search-container"},b,u.a.createElement("div",{className:"search-rest"},u.a.createElement("div",{className:"search-container"},u.a.createElement("input",{ref:v,placeholder:"Type to search",autoComplete:"off",type:"text",value:O,onKeyDown:w,onChange:P,id:"sample-search-input"}),C?u.a.createElement("img",{src:C,className:"source-to-search"}):"",u.a.createElement("div",{onClick:function(){return P({target:{value:""}})},className:"search-clear-button"},"x"),void 0!==r?u.a.createElement("img",{onMouseOver:function(e){e.stopPropagation(),t(bn.U)},onMouseLeave:function(){return t(void 0)},onClick:function(){return r("GRID")},className:"GRID"===a?"selected":"",src:"/grid-icon.png"}):"",void 0!==r?u.a.createElement("img",{onMouseOver:function(e){e.stopPropagation(),t(bn.V)},onMouseLeave:function(){return t(void 0)},onClick:function(){return r("LIST")},className:"LIST"===a?"selected":""!==O||d?"":"disabled",src:"/list-icon.png"}):""),f?"":u.a.createElement("div",{className:"filter-options"},u.a.createElement("div",{className:d?"favorited heart":"heart",onClick:function(){return m(!d)}}),u.a.createElement(D.a,{onChange:function(e){return l(e.value)},value:gn.find(function(e){return e.value===o}),options:gn}))))}),yn=Object(m.b)(function(e,t){return{expandedProject:e.selector.expandedProject}},function(e){return{setExpandedProject:function(t){return e(Object(f.Mb)(t))}}})(function(e){var t=Object(i.useState)(""),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useState)(_e.a.isLoggedIn()),o=Object(s.a)(c,2),l=o[0],f=o[1],m=Object(i.useState)(!1),p=Object(s.a)(m,2),d=p[0],h=p[1],b=Object(i.useState)("LIST"),v=Object(s.a)(b,2),g=v[0],E=v[1],O=Object(i.useState)(!1),y=Object(s.a)(O,2),k=y[0],j=y[1],C=Object(i.useState)(!1),S=Object(s.a)(C,2),w=S[0],P=S[1],N=Object(i.useState)(!1),x=Object(s.a)(N,2),q=x[0],T=x[1],M=e.setExpandedProject,R=e.expandedProject,D=Object(i.useCallback)(function(e){r(e)},[r]);return u.a.createElement("div",{className:"new-selector sequences"},u.a.createElement("div",{className:"search-and-back"},u.a.createElement(On,{onChange:D,hideFilter:!0})),R?"":u.a.createElement(pt,{songs:q,setSongs:T,viewMode:g,setViewMode:E,favorited:d,old:k,setOld:j,starred:w,setFavorited:h,setStarred:P,setFilterMine:f,filterMine:l}),u.a.createElement(hn,{expandedProject:R,viewMode:g,setExpandedProject:M,songs:q,sequencerEngine:e.sequencerEngine,old:k,favorited:d,starred:w,searchTerm:a,filterMine:l}))}),kn=(n(2251),Object(m.b)(function(e,t){return{}},function(e){return{setShowProjectsModal:function(t){return e(Object(f.Ne)(t))}}})(function(e){var t=Object(i.useCallback)(function(){e.setShowProjectsModal(!1)},[]);return u.a.createElement(x.a,{dialogClassName:"projects-modal",show:!0,onHide:t},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,"Projects")),u.a.createElement(x.a.Body,null,u.a.createElement(yn,{sequencerEngine:e.sequencerEngine})))})),jn=n(758),Cn=n(31),Sn=n(1148),wn=n.n(Sn);function Pn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Nn=function(e){Object(xe.a)(n,e);var t=Pn(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={username:"",password:"",loginFailed:!1},a.onClickDone=a.onClickDone.bind(Object(Cn.a)(a)),a.onClickCancel=a.onClickCancel.bind(Object(Cn.a)(a)),a}return Object(Ne.a)(n,[{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"onClickDone",value:function(){var e=Object(o.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.signingUp){e.next=4;break}_e.a.signUp(this.state.userName,this.state.password),e.next=12;break;case 4:return e.next=6,_e.a.login(this.state.userName,this.state.password);case 6:if(e.sent){e.next=10;break}return this.setState({loginFailed:!0}),e.abrupt("return");case 10:this.props.transactionUponLogin&&(this.props.transactionUponLogin.execute(),this.props.clearTransactions()),We.a.guilds.acceptAnyNewRequests();case 12:this.setState({loginFailed:!1}),this.props.hide();case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickCancel",value:function(){this.props.setSigningUp(!1),this.props.hide()}},{key:"render",value:function(){var e=this;return u.a.createElement(x.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,this.props.signingUp?"Sign Up":"Log In")),u.a.createElement(x.a.Body,null,u.a.createElement(He.a,{condition:this.state.loginFailed},"The username/password you entered was incorrect. Please try again."),u.a.createElement(He.a,{condition:this.props.transactionUponLogin},"Need to login again to save your transaction with us."),u.a.createElement(q.h,null,u.a.createElement(q.g,{onChange:function(t){return e.setState({userName:t.target.value})},value:this.state.userName,placeholder:"Enter your username",className:"email-address-input"})),u.a.createElement(wn.a,{id:"password",name:"password",placeholder:"Enter password",value:this.state.password,onChange:this.handlePasswordChange.bind(this)}),!this.props.signingUp&&u.a.createElement("div",{className:"sign-up-text"},"No account yet? Chill, you can sign up ",u.a.createElement("span",{onClick:function(){return e.props.setSigningUp(!0)},className:"sign-up-here pushable"},"here"),".")),u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{variant:"secondary",onClick:this.onClickDone},"Done"),u.a.createElement(q.b,{variant:"primary",onClick:this.onClickCancel},"Cancel")))}}]),n}(i.Component),xn=Object(m.b)(function(e){return{transactionUponLogin:e.transactions.transactionUponLogin,signingUp:e.sequencer.signingUp}},function(e){return{setSigningUp:function(t){return e(Object(f.af)(t))},hide:function(t){return e(Object(f.Ge)(!1))},clearTransactions:function(){return e(Object(f.Sf)(void 0))}}})(Nn),qn=n(759),Tn=n(196);function Mn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Rn=function(e){Object(xe.a)(n,e);var t=Mn(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this;if(0===this.props.guildOptions.length&&!this.props.showPublic)return u.a.createElement("div",{className:"guild-options-container"},"You are not a part of any guilds yet. To create one, go ",u.a.createElement("a",{href:"/guilds"},"here"),".");return u.a.createElement("div",{className:"guild-options-container"},"Only members of selected guild will have access",u.a.createElement("div",{className:"guild-options"},u.a.createElement(He.a,{condition:this.props.showPublic},u.a.createElement(Dn,{guild:{guildId:0,name:"Public"},onClick:function(){return e.props.onSelectGuild(void 0)},isSelected:void 0===this.props.selectedGuild})),this.props.guildOptions.map(function(t){return u.a.createElement(Dn,{guild:t,onClick:function(){return e.props.onSelectGuild(t)},isSelected:e.isSelected(t)})})))}},{key:"isSelected",value:function(e){return void 0===this.props.selectedGuild?0===e.id:this.props.selectedGuild.guildId===e.guildId}}]),n}(i.Component),Dn=function(e){Object(xe.a)(n,e);var t=Mn(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e="guild-option";return this.props.isSelected&&(e+=" selected"),u.a.createElement("div",{onClick:this.props.onClick,className:e},this.props.guild.name)}}]),n}(i.Component),In=Rn;function An(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component;var Ln=n(205),Fn=n.n(Ln);function zn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component,n(293);function Bn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component;var _n=n(399);function Hn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Un=function(e){Object(xe.a)(n,e);var t=Hn(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={nameValue:"",isEffects:!1,guildOptions:[],saveOption:_n.c,selectedGuild:void 0,guildIds:[]},a.input=void 0,a.onClickDone=a.onClickDone.bind(Object(Cn.a)(a)),a.onClickCancel=a.onClickCancel.bind(Object(Cn.a)(a)),console.log("PRESET CONS"),a}return Object(Ne.a)(n,[{key:"getPresetGuilds",value:function(){var e=Object(o.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getGuilds(),this.input&&this.input.focus(),this.getPresetGuilds()}},{key:"getGuilds",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.a.guilds.getGuildsForUser();case 2:t=e.sent,void 0!==this.props.selectedGuild&&this.setState({saveOption:_n.a}),this.setState({selectedGuild:this.props.selectedGuild,guildOptions:t.filter(function(e){return e.name.split(",").length<2})});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onSelectGuild",value:function(e){this.setState({selectedGuild:e})}},{key:"selectedZObject",get:function(){var e=this.props.sequencerEngine.state.zobject.selectedZObject,t=this.props.sequencerEngine.state.zobject.viewableSubPatches,n=e||t&&t[0]&&t[0].zObject;return n.getObjectType()!==Tn.e&&n.getObjectType()!==Tn.a&&(n=void 0),n}},{key:"isZObject",value:function(){return void 0!==this.selectedZObject}},{key:"onClickDone",value:function(){var e=this.selectedZObject;e?e.getObjectType()===Tn.a?Object(qn.b)(e.getJson(!0),this.state.nameValue):this.props.sequencerEngine.saveZObjectPreset(e,this.state.nameValue):this.props.sequencerEngine.saveTrackPreset(this.props.track.trackNumber,this.state.nameValue,this.state.isEffects,void 0===this.state.selectedGuild?0:this.state.selectedGuild.guildId),this.props.onHide()}},{key:"onClickCancel",value:function(){this.props.onHide()}},{key:"onInputType",value:function(e){this.setState({nameValue:e})}},{key:"handleCheckboxChange",value:function(e){this.setState({isEffects:"track"!==e.target.name})}},{key:"login",value:function(){this.props.setShowLogin(!0)}},{key:"render",value:function(){var e=this;if(!this.props.userToken)return u.a.createElement(x.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,"Save Preset")),u.a.createElement(x.a.Body,null,u.a.createElement("span",{onClick:function(){return e.login()},className:"login-btn"},"Login")," to save preset"));var t=this.selectedZObject;return u.a.createElement(x.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,t?"Save Object Preset ("+t.name+")":"Save Preset")),u.a.createElement(x.a.Body,null,u.a.createElement("input",{value:this.state.nameValue,onChange:function(t){return e.onInputType(t.target.value)},ref:function(t){e.input=t},placeholder:"Type name of preset",className:"tag-input"}),!t&&u.a.createElement("form",null,u.a.createElement("input",{name:"track",type:"checkbox",checked:!this.state.isEffects,onChange:function(t){return e.handleCheckboxChange(t)}}),u.a.createElement("label",null,"Track"),u.a.createElement("input",{name:"effects",type:"checkbox",checked:this.state.isEffects,onChange:function(t){return e.handleCheckboxChange(t)}}),u.a.createElement("label",null,"Effects"))),u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{variant:"secondary",onClick:this.onClickDone},"Save"),u.a.createElement(q.b,{variant:"primary",onClick:this.onClickCancel},"Cancel")))}}]),n}(i.Component),Gn=Object(m.b)(function(e){var t=e.presets.trackPresetSaving;return{userToken:e.sequencer.userToken,selectedGuild:e.guilds.selectedGuild,track:t,show:t}},function(e){return{setContextualHelp:function(t){return e(Object(f.hb)(t))},setShowLogin:function(t){return e(Object(f.Ge)(t))},onHide:function(){return e(Object(f.Gf)(void 0))}}})(Un);function Wn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component;function Vn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component;var Xn=function(e){Object(xe.a)(n,e);var t=Vn(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={date:""},a.fetchDate(),a}return Object(Ne.a)(n,[{key:"fetchDate",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.ethereum.web3.eth.getBlock(this.props.blockNumber);case 2:t=e.sent,n=new Date(1e3*t.timestamp).toLocaleString(),this.setState({date:n});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"accept",value:function(){this.props.ethereum.guilds.acceptRequestToAddToGuild(this.props.guildId),this.props.onAccept()}},{key:"reject",value:function(){this.props.ethereum.guilds.rejectRequestToAddToGuild(this.props.guildId),this.props.onReject()}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"new-member-request"},u.a.createElement("div",{className:"user-field"},u.a.createElement("a",{className:"user-hyperlink",href:"/user/"+this.props.userName},this.props.userName)),u.a.createElement("div",{className:"action-description"},"requested to add you to ",this.props.guildName),u.a.createElement("span",{className:"action-date"},this.state.date),u.a.createElement("div",{className:"action-btns"},u.a.createElement("div",{onClick:function(){return e.accept()},className:"common-button pink-button"},"ACCEPT"),u.a.createElement("div",{onClick:function(){return e.reject()},className:"common-button pink-button"},"REJECT")))}}]),n}(i.Component),Kn=Object(m.b)(function(e){return{toast:e.explore.toast}},function(e){return{setExploreToast:function(t){return e(Object(f.Rb)(t))}}})(function(e){var t=e.toast,n=e.setExploreToast;return t?u.a.createElement("div",{className:"toast-box"},u.a.createElement("div",{onClick:function(){return n(void 0)},className:"delete-button"},"x"),t):u.a.createElement("div",null)}),Qn=function(e){var t=Object(i.useState)([]),n=Object(s.a)(t,2),a=n[0],r=n[1];Object(i.useEffect)(function(){We.a.guilds.getNewMemberRequests().then(function(e){r(e)})},[r]);var c=Object(i.useCallback)(function(e){We.a.guilds.acceptRequestToAddToGuild(e.guildId);var t=Object(d.a)(a),n=a.indexOf(e);t.splice(n,1),r(t)},[r,a]);return 0===a.length?u.a.createElement("div",null):u.a.createElement("div",{className:"guild-requests"},a.map(function(e){return u.a.createElement(Yn,{accept:function(){return c(e)},request:e})}))},Yn=function(e){var t=e.request,n=e.accept;return u.a.createElement("div",{className:"guild-request"},"You've been invited to join",u.a.createElement("span",{className:"guild-name"},t.guildName),u.a.createElement("span",{onClick:n,className:"accept-button"},"Accept"))};function Jn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Zn=function(e){Object(xe.a)(n,e);var t=Jn(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this;return u.a.createElement("div",null,u.a.createElement("div",{className:"passphrase-label"},"Name of new guild:"),u.a.createElement(q.h,{className:"guild-name-input-group"},u.a.createElement(q.g,{autoComplete:"off",onChange:function(t){return e.props.onNameChange(t.target.value)},value:this.props.name,placeholder:"Type name for guild",id:"guild-name-input"})),u.a.createElement("div",{className:"passphrase-label"},"Encrypted with passphrase:"),u.a.createElement(q.h,{className:"guild-name-input-group"},u.a.createElement(q.g,{autoComplete:"off",onChange:function(t){return e.props.onPassphraseChange(t.target.value)},value:this.props.passphrase,placeholder:"Type passphrase for guild",id:"passphrase-input"})))}}]),n}(i.Component),$n=function(e){var t=Object(i.useState)(""),n=Object(s.a)(t,2),a=n[0],r=n[1],l=Object(i.useState)(""),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useCallback)(Object(o.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,We.a.guilds.newGuild(a,m);case 2:e.done();case 3:case"end":return t.stop()}},t)})),[a,m]);return u.a.createElement("div",{className:"create-new-guild"},u.a.createElement(Zn,{name:a,passphrase:m,onNameChange:r,onPassphraseChange:p}),u.a.createElement("div",{className:"toolbar"},u.a.createElement("div",{onClick:d,className:"done-button"},"Create"),u.a.createElement("div",{onClick:e.cancel,className:"cancel-button"},"Cancel")))};function ea(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ta(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ta(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function ta(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var na=function(e){var t=e.guild,n=Object(i.useState)([]),a=Object(s.a)(n,2),r=a[0],l=a[1];return Object(i.useEffect)(function(){t&&We.a.guilds.getNewMemberRequestsFromGuild(t.guildId).then(function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=ea(t),e.prev=2,a.s();case 4:if((r=a.n()).done){e.next=13;break}return o=r.value,e.t0=n,e.next=9,We.a.users.getUserName(o.newMember);case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t2=e.catch(2),a.e(e.t2);case 18:return e.prev=18,a.f(),e.finish(18);case 21:l(Array.from(new Set(n)));case 22:case"end":return e.stop()}},e,null,[[2,15,18,21]])}));return function(t){return e.apply(this,arguments)}}())},[t,l]),0===r.length?u.a.createElement("div",null):(console.log("requests = ",r),u.a.createElement("div",{className:"outbound-requests"},u.a.createElement("div",{className:"requests-header"},"Pending Invites"),r.map(function(e){return u.a.createElement("div",null,e)})))},aa=function(e){var t=e.user,n=e.inviteUser;return u.a.createElement("div",{onClick:function(){return n(t)},className:"potential-user"},t)},ra=n(295),ca=n(722);function oa(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return sa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sa(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function sa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ia=Object(m.b)(null,function(e){return{setExploreToast:function(t){return e(Object(f.Rb)(t))}}})(function(e){var t=e.guild,n=e.setExploreToast,a=(e.numPending,e.onHide),r=e.onLeftGuild,l=Object(i.useState)(0),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useState)(0),h=Object(s.a)(d,2),b=h[0],v=h[1],g=Object(i.useState)(!1),E=Object(s.a)(g,2),O=E[0],y=E[1],k=Object(i.useState)([]),j=Object(s.a)(k,2),C=j[0],S=j[1];Object(i.useEffect)(function(){We.a.encryption.getPotentialUsers().then(function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=oa(t),e.prev=2,a.s();case 4:if((r=a.n()).done){e.next=13;break}return o=r.value,e.t0=n,e.next=9,We.a.users.getUserName(o);case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t2=e.catch(2),a.e(e.t2);case 18:return e.prev=18,a.f(),e.finish(18);case 21:S(n.filter(function(e){return e&&""!==e}));case 22:case"end":return e.stop()}},e,null,[[2,15,18,21]])}));return function(t){return e.apply(this,arguments)}}())},[S]),Object(i.useEffect)(function(){if(void 0!==t){var e=new Je.a((new ra.a).contractAddress).from($e.cb).select("ipfsHash").where("guildId",t.guildId);e.executeQuery().then(function(e){return p(new Set(e.map(function(e){return e.ipfsHash})).size)}),(e=new Je.a((new ca.a).contractAddress).from($e.w).select("contentHash").where("guildId",t.guildId)).executeQuery().then(function(e){return v(new Set(e.map(function(e){return e.contentHash})).size)}),y(!1)}},[t,p,v,y]);var w=Object(i.useCallback)(function(e){console.log("invite user =",e),We.a.users.getUserId(e).then(function(a){We.a.guilds.requestToAddMember(t.guildId,a),n("Invited "+e+" to "+t.name)})},[t]),P=Object(i.useCallback)(function(){We.a.guilds.leaveGuild(t.guildId),r(t),a()},[t,a]);if(void 0===t)return u.a.createElement("div",null);var N=t.members.map(function(e){return e.userName});return u.a.createElement("div",{className:"guild-details"},u.a.createElement(He.a,{condition:O},u.a.createElement("div",{className:"guild-members inviting"},u.a.createElement("div",{className:"invite-header"},"Invite"),u.a.createElement("div",{className:"people-container"},C.filter(function(e){return-1===N.indexOf(e)}).map(function(e){return u.a.createElement(aa,{inviteUser:w,user:e})})),u.a.createElement("div",{onClick:function(){return y(!1)},className:"cancel-button"},"Cancel"))),u.a.createElement(He.a,{condition:!O},u.a.createElement("div",{className:"guild-members"},u.a.createElement("div",{className:"members-header"},"Members"),u.a.createElement("div",{className:"people-container"},t.members.map(function(e){return u.a.createElement("div",{className:"member"},e.userName)})),u.a.createElement("div",{onClick:function(){return y(!0)},className:"invite-button"},"Invite"))),u.a.createElement("div",{className:"guild-stats"},u.a.createElement("div",{className:"samples-count"},m," samples"),u.a.createElement("div",{className:"samples-count"},b," sequences"),u.a.createElement(na,{guild:t}),u.a.createElement("div",{onClick:P,className:"leave-guild-btn"},"Leave Group")))}),ua=function(e){var t="guild-option";return e.selected&&(t+=" selected"),u.a.createElement("div",{onClick:e.onClick,className:t},e.guild.name)},la=Object(m.b)(function(e,t){return{numPending:e.transactions.pendingTransactions.length}},null)(function(e){var t=e.numPending,n=Object(i.useState)(void 0),a=Object(s.a)(n,2),r=a[0],l=a[1],f=Object(i.useState)(!1),m=Object(s.a)(f,2),p=m[0],h=m[1],b=Object(i.useState)(!1),v=Object(s.a)(b,2),g=v[0],E=v[1],O=Object(i.useState)([]),y=Object(s.a)(O,2),k=y[0],j=y[1],C=Object(i.useCallback)(function(){S(),h(!1)},[j,h]);We.a.guilds.newGuildCallback=C;var S=Object(i.useCallback)(function(){We.a.guilds.getGuildsForUser().then(function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],e.t0=c.a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=14;break}if(a=e.t1.value,!((r=t[a]).name.split(",").length>=2)){e.next=7;break}return e.abrupt("continue",2);case 7:return e.next=9,We.a.guilds.getUsersInGuild(r.guildId);case 9:o=e.sent,r.members=o,n.push(r),e.next=2;break;case 14:j(n);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},[j,t]);Object(i.useEffect)(function(){S()},[j]);var w=Object(i.useCallback)(function(e){var t=k.indexOf(e),n=Object(d.a)(k);n.splice(t,1),j(n)},[k,j]);return g?u.a.createElement("div",{className:"explore-guilds"},u.a.createElement($n,{done:function(){E(!1),h(!0)},cancel:function(){return E(!1)}})):u.a.createElement("div",{className:"explore-guilds"},u.a.createElement("div",{className:"top-bar"},u.a.createElement("div",{onClick:function(){return E(!0)},className:"create-guild-button"},"Create New Group"),u.a.createElement(Kn,null),u.a.createElement(Qn,null)),u.a.createElement(He.a,{condition:p},"Syncing guild changes",u.a.createElement(Fn.a,{sizeUnit:"px",size:10,color:"#42f4f1",loading:!0})),u.a.createElement("div",{className:"guilds-content"},u.a.createElement("div",{className:"guilds-chooser"},k.map(function(e){return u.a.createElement(ua,{selected:e===r,onClick:function(){return l(e)},guild:e})})),u.a.createElement(ia,{onLeftGuild:w,onHide:function(){return l(void 0)},guild:r})))}),fa=Object(m.b)(function(e,t){return{isManaging:e.guilds.isManaging}},function(e){return{setIsManagingGuilds:function(t){return e(Object(f.jc)(t))}}})(function(e){var t=e.isManaging,n=e.setIsManagingGuilds;return t?(console.log("MANAGING"),u.a.createElement(x.a,{dialogClassName:"preset-modal guilds-modal",show:!0,onHide:function(){return n(!1)}},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,"Groups")),u.a.createElement(x.a.Body,null,u.a.createElement(la,null)),u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{variant:"secondary",onClick:function(){return n(!1)}},"Done")))):[]}),ma=(Object(m.b)(function(e,t){return{trackPresetSaving:e.presets.trackPresetSaving,showLogin:e.sequencer.showLogin,transcribing:e.sequencer.isTranscribing,loadingText:e.sequencer.loadingText,loadingSequence:e.sequencer.loadingSequence,uploadingFile:e.sequencer.uploadingFile,showSettings:e.sequencer.showSettings,hicDialog:e.nft.hicDialog,zoraDialog:e.nft.zoraDialog,isPreparingNFT:e.nft.isPreparingNFT,showProjectsModal:e.spatial.showProjectsModal,trackToConvert:e.tracks.trackToConvert,pluginToSave:e.plugins.pluginToSave,showFreezeModal:e.freeze.showFreezeModal}},function(e){return{}})(function(e){var t=Object.keys(e.loadingSequence).some(function(t){return e.loadingSequence[t]});return u.a.createElement("div",{className:"modals-container"},u.a.createElement(He.a,{condition:e.showLogin},u.a.createElement(xn,{show:e.showLogin})),e.hicDialog&&u.a.createElement(z,{hicDialog:e.hicDialog}),e.zoraDialog&&u.a.createElement(de,{data:e.zoraDialog,sequencerEngine:e.sequencerEngine}),t?u.a.createElement(jn.a,{sequencerEngine:e.sequencerEngine}):"",e.isPreparingNFT&&u.a.createElement(C,{sequencerEngine:e.sequencerEngine,text:e.isPreparingNFT}),e.loadingText?u.a.createElement(S.a,{text:e.loadingText,sequencerEngine:e.sequencerEngine}):"",e.transcribing?u.a.createElement(S.a,{text:"Transcribing",sequencerEngine:e.sequencerEngine}):"",u.a.createElement(fa,null),e.uploadingFile?u.a.createElement(S.a,{text:"Uploading File",sequencerEngine:e.sequencerEngine}):"",e.showSettings?u.a.createElement(mt,{sequencerEngine:e.sequencerEngine}):"",e.trackPresetSaving?u.a.createElement(Gn,{sequencerEngine:e.sequencerEngine}):"",e.showProjectsModal?u.a.createElement(kn,{sequencerEngine:e.sequencerEngine}):"",e.trackToConvert?u.a.createElement(A,{show:!0,track:e.trackToConvert,sequencerEngine:e.sequencerEngine}):"",e.showFreezeModal&&u.a.createElement(F,{sequencerEngine:e.sequencerEngine}),e.pluginToSave&&u.a.createElement(T,{zobject:e.pluginToSave}))}),Object(m.b)(function(e,t){return{step:t.sequencerEngine.trackStep,isSequenceRolling:t.sequencerEngine.isSequenceRolling}},function(e){return{}})(function(e){var t=e.step,n=void 0===t?0:t,a=e.isSequenceRolling,r=e.sequencerEngine,c=void 0,o=void 0,s="";if(a){var i=r.tracks[0];if(i){var l=i.getFactoredResolution().getNumberOfStepsAtBaseResolution();i.patternRollStepNumber,i.pattern.stepBuckets.length,c=l,o=i.patternRollStepNumber}c=c;var f=o,m={left:4*Math.floor(f/4)%32*96/32+"vw",width:4*Math.floor(c/4)%32*96/32+"vw"};s=u.a.createElement("div",{className:"playhead roll-visualizer",style:m})}var p={left:4*Math.floor(n/4)%32*100/32+"vw"};return[s,u.a.createElement("div",{style:p,className:"playhead"})]})),pa=(n(1383),n(2379),Object(m.b)(function(e,t){return{wallpaper:e.sequencer.wallpaper}},function(e){return{setIsPlayingMix:function(t){return e(Object(f.lc)(t))}}})(function(e){var t=e.sequencerEngine;e.wallpaper;return u.a.createElement("div",{className:"exhibit"},t?u.a.createElement(ma,{sequencerEngine:t}):"",u.a.createElement(y,{sequencerEngine:t,row:0}),u.a.createElement(y,{sequencerEngine:t,row:1}),u.a.createElement(y,{sequencerEngine:t,row:2}),u.a.createElement(y,{sequencerEngine:t,row:3}),u.a.createElement(y,{sequencerEngine:t,row:4}),u.a.createElement(y,{sequencerEngine:t,row:5}))}),n(166)),da=n(148),ha=n(360),ba=n(896),va=n(16),ga=n(183),Ea=function(e){var t=[],n=Object(s.a)(e[0],2),a=n[0],r=n[1];t.push([Oa(a,va.c),Oa(r,va.a,-1)]);for(var c=1;c<e.length;c++){for(var o=[],i=0;i<e[c].length;i++){var u=i%2===0?va.c:va.a,l=i%2===0?1:-1;o.push(Oa(e[c][i],u,l))}t.push(o)}return t},Oa=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:va.c;return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)*(e/t*2-1)},ya=(Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){e.blur,e.setMacroToShow;var t=e.macroToShow,n=e.parameters,a=(e.selection,e.startDragging,e.coords),r=e.effect,c=(e.setEffectParameterValues,Object(da.a)(e,["blur","setMacroToShow","macroToShow","parameters","selection","startDragging","coords","effect","setEffectParameterValues"])),o=Object(i.useRef)(void 0),l=Object(i.useRef)(void 0),f=Object(i.useRef)(void 0),m=Object(i.useRef)(void 0),p=Object(i.useRef)(void 0),d=Object(i.useRef)(void 0),h=Object(i.useRef)(void 0),b=Object(i.useRef)(void 0),v=Object(i.useRef)(!1);Object(i.useEffect)(function(){l.current=new ga.T,m.current=new ga.K(-1,1,1,-1,1,1e3),f.current=new ga.kb,f.current.setSize(300,200),f.current.setPixelRatio(window.devicePixelRatio),g(),o.current.appendChild(f.current.domElement)},[]),Object(i.useEffect)(function(){l.current&&g()},[c.selectedColor,a,n,t,c.filteredParameters,c.isRegionMode]);var g=Object(i.useCallback)(function(){p.current=new ga.X;var e=r.macros[0],t=e.getGeometry(),n=t.x,a=t.y,c=(t.diameter,Ea(e.getBlob(n,a,16,!0))),o=Object(s.a)(c[0],2),i=o[0],u=o[1];p.current.moveTo(i,u);for(var g=1;g<c.length;g++){var E=Object(s.a)(c[g],6),O=E[0],y=E[1],k=E[2],j=E[3],C=E[4],S=E[5];p.current.bezierCurveTo(O,y,k,j,C,S)}if(b.current){var w=p.current.makeGeometry();b.current.attributes=w.attributes}else b.current=new ga.Y(p.current);h.current=h.current||new ga.D({color:65280}),d.current?d.current.geometry=b.current:d.current=d.current||new ga.C(b.current,h.current),v.current||(l.current.add(d.current),v.current=!0),m.current.position.z=window.zpos||1,f.current.render(l.current,m.current)},[c.selectedColor,a,n,t,c.filteredParameters,c.isRegionMode]);return u.a.createElement("div",{ref:o,className:"threejs-canvas-holder"})}),n(1295),n(1296),n(1385),n(1297),n(483)),ka=n(173),ja=new h.a,Ca=Object(i.memo)(function(e){var t=e.debug,n=e.setMacroToShow,a=e.isShowing,r=e.startDragging,c=e.isSelected,o=e.macro,s=(e.coordinates,o.getGeometry()),l=s.x,f=s.y,m=(s.diameter,Object(i.useRef)((new Date).getTime())),p=Object(i.useCallback)(function(){var e=(new Date).getTime();e-m.current<=300&&n(o),m.current=e},[n]),d=o.getBlob(l,f,t),h=ja.getColorForHash(o.id),b="macro";return c&&(b+=" selected"),a&&(b+=" showing"),u.a.createElement(ka.c,null,u.a.createElement(ka.f,{perfectDrawEnabled:!1,hitStrokeWidth:0,shadowForStrokeEnabled:!1,dash:c&&[3,2],onClick:p,onMouseDown:function(e){return r(e.evt,o)},fill:ja.transparent(ja.saturate(h,2),c?.2:.5),strokeWidth:1,data:d,className:b,stroke:a||c?"white":"transparent"}))});Object(m.b)(function(e,t){var n={};return t.effect._parameters.filter(function(e){return e.planeMacro===t.macro}).map(function(t){return n[t.id]=e.effects.effectParameters[t.id]}),t.effect._parameters.filter(function(e){return e.planeMacro===t.macro}).map(function(e){return n[e.id+"depth"]=e.depth}),n},null)(Ca);function Sa(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return wa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wa(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function wa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Pa=Object(i.memo)(function(e){var t=e.drawnPath;e.currentPosition;if(!t||t.length<2)return[];var n="M "+(t=Na(t)).map(function(e){return e.x+" "+e.y}).join(" ");return u.a.createElement("path",{d:n,className:"drawn-path"})}),Na=function(e){var t,n=[],a=0,r=void 0,c=Sa(e);try{for(c.s();!(t=c.n()).done;){var o=t.value;r&&r.x===o.x&&r.y===o.y?a++:(a%3!==0&&a!==e.length-1||(n.push(o),r=o),a++)}}catch(s){c.e(s)}finally{c.f()}return n},xa=Object(m.b)(null,null)(Pa);function qa(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ta(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ta(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Ta(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ma=function(e){var t=e.isBest,n=e.isSelected,a=(e.group,e.variation,e.i),r=e.onClick,c="variation";return t&&(c+=" best"),n&&(c+=" selected"),u.a.createElement("div",{onClick:r,className:c},a+1)},Ra=Object(m.b)(function(e,t){return{}},function(e){return{setSelectedZObject:function(t){return e(Object(f.ne)(t))}}})(function(e){var t=e.group,n=e.setSelectedZObject,a=Object(i.useState)(t.generation),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(t.selectedVariation),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useCallback)(function(){n(t)},[t]),h=Object(i.useCallback)(function(){t.reproduce(),o(t.generation)},[o,t]),b=Object(i.useCallback)(function(){t.unsupervised(64),o(t.generation)},[o,t]),v=Object(i.useCallback)(function(){t.clearGenetic(),o(t.generation)},[o,t]);Object(i.useEffect)(function(){p(void 0)},[c,p]),Object(i.useEffect)(function(){void 0!==m&&t.selectVariation(m)},[m]);var g=Object(i.useCallback)(function(e){t.selectBest(e),p(m===e?void 0:e)},[p,m]);Object(i.useEffect)(function(){return window.addEventListener("keydown",E),function(){return window.removeEventListener("keydown",E)}},[t,p,m]);var E=Object(i.useCallback)(function(e){0!==t.generation&&"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&("ArrowLeft"===e.key?(e.preventDefault(),p(void 0!==m?0===m?15:m-1:0),d()):"ArrowRight"===e.key?(e.preventDefault(),p(void 0!==m?(m+1)%16:0),d()):"Enter"===e.key&&(e.preventDefault(),e.ctrlKey?h():O(),d()))},[t,p,m]),O=Object(i.useCallback)(function(){void 0!==m&&(t.selectBest(m),p(void 0),p(m))},[m,p]);if(0===c)return u.a.createElement("div",{className:"genetic-btns"},u.a.createElement("div",{className:"genetic-label"},"Genetic:"),u.a.createElement("img",{src:"/generate-random.svg",onClick:h,className:"genetic-btn"}),u.a.createElement("img",{src:"/generate-from-snapshots.svg",onClick:b,className:"snapshot genetic-btn"}));var y=function(e){return e.map(function(e,n){return u.a.createElement(Ma,{onClick:function(){return g(t.variations.indexOf(e))},isSelected:m===t.variations.indexOf(e),isBest:t._bestSolutions.includes(t.variations.indexOf(e)),key:n,variation:e,i:t.variations.indexOf(e),group:t})})},k=t.variations;return u.a.createElement("div",{className:"genetic-algo"},u.a.createElement("div",{className:"generation"},u.a.createElement("div",{className:"generation-label"},"Generation: ",c),u.a.createElement("img",{src:"/generate-random.svg",onClick:h,className:"genetic-btn"}),u.a.createElement("div",{onClick:v,className:"breed-done genetic-btn"},u.a.createElement("div",{className:"inner-btn"}))),t.categories?u.a.createElement("div",{className:"variations"},u.a.createElement("div",{className:"elite"},u.a.createElement("div",{className:"label"},"Elite"),y(t.categories.elite)),u.a.createElement("div",{className:"children"},u.a.createElement("div",{className:"label"},"Children"),y(t.categories.children)),u.a.createElement("div",{className:"mutations"},u.a.createElement("div",{className:"label"},"Mutations"),y(t.categories.mutations))):u.a.createElement("div",{className:"variations"},k.map(function(e,n){return u.a.createElement(Ma,{onClick:function(){return g(n)},isSelected:m===n,isBest:t._bestSolutions.includes(n),key:n,variation:e,i:n,group:t})})))}),Da=n(234),Ia=n(833),Aa=n(435),La=n(222),Fa=n(113),za=function(e){var t=e.step,n=e.hasState,a=(e.group,e.onClick),r=e.isCurrent,c=e.isSelected,o="sequencer-step";return n&&(o+=" on"),r&&(o+=" current"),c&&(o+=" selected"),u.a.createElement("div",{onClick:function(e){return a(e,t,!n)},className:o},t+1)},Ba=(Object(m.b)(function(e,t){return{trackStep:t.sequencerEngine.trackStep}},function(e){return{}})(function(e){var t=e.group,n=e.trackStep,a=Object(i.useState)(t.stepToState),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(void 0),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useState)(t.sequencerEnabled),h=Object(s.a)(d,2),b=h[0],v=h[1];Object(i.useEffect)(function(){o(t.stepToState)},[t.stepToState,o]),Object(i.useEffect)(function(){return function(){return t.unselectStep()}},[t]);var g=Object(i.useCallback)(function(){t.sequencerEnabled=!b,v(!b)},[t,v,b]),E=Object(i.useCallback)(function(e,n,a){if(e.metaKey)return t.selectStep(n),void p(n);a?t.recordStateAtStep(n):t.deleteStateAtStep(n),o(Object(B.a)({},t.stepToState)),p(void 0)},[o,t,p]),O=new Array(16).fill(0),y=Math.floor(n/2)%16;return u.a.createElement("div",{className:"group-sequencer"},u.a.createElement("div",{className:"sequencer-toolbar"},u.a.createElement("div",{className:"sequencer-label"},"Sequencer"),u.a.createElement("div",{onClick:g,className:b?"s-stop":"s-play"})),u.a.createElement("div",{className:b?"sequencer-steps":"sequencer-steps disabled"},O.map(function(e,n){return u.a.createElement(za,{isSelected:m===n,isCurrent:b&&n===y,onClick:E,step:n,hasState:c[n],group:t})})))}),[{label:"None",value:ha.e},{label:"Fluid",value:ha.d},{label:"Script",value:ha.g},{label:"Bounce 1",value:ha.a},{label:"Bounce 2",value:ha.b},{label:"Life",value:ha.c},{label:"Rotate",value:ha.f},{label:"Spiral",value:ha.h},{label:"Swap",value:ha.i}]),_a=Object(m.b)(function(e,t){var n=t.selected,a=n&&n[0]&&n[0].hasGroup||t.effect.groups[0];return{algo:a&&a.algorithm}},function(e){return{}})(function(e){var t=e.isDraggable,n=e.selected,a=e.effect,r=e.setExpanded,c=e.expanded,o=Object(i.useRef)(void 0);if(Object(Da.a)(o),(!n[0]||!n[0].hasGroup)&&!c)return u.a.createElement("div",null);var s=n[0]&&n[0].hasGroup?n[0].hasGroup:a.groups[0];return s?u.a.createElement("div",{ref:o,className:"plane-group-config"},u.a.createElement("div",{className:"plane-algo"},u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:Ba,onChange:function(e){return s.algorithmParameter.set(e.value)},value:Ba.find(function(e){return e.value===s.algorithm}),placeholder:"Algorithm"}),u.a.createElement(Fa.a,{name:"Speed",parameter:s.speedParameter,isParameter:!0,sequencerEngine:a.track.sequencerEngine,lfoEnabled:!0,root:3,step:.01,min:.01,max:30})),c||s.algorithm!=ha.g?"":u.a.createElement(Aa.a,{isDraggable:t,scriptType:Ia.a,setExpanded:r,doc:La.a,sequencerEngine:s.track.sequencerEngine,effect:s})):""}),Ha=n(608),Ua=n(324),Ga=Object(m.b)(function(e,t){return{_snapshots:t.effect.snapshots,currentSnapshotIndex:t.effect.currentSnapshotParameter.get()}},function(e){return{}})(function(e){var t=e.isDraggable,n=void 0===t||t,a=e.effect,r=(e.currentSnapshot,e.currentSnapshotIndex),c=e._snapshots,o=Object(i.useState)(a.snapshots),l=Object(s.a)(o,2),f=l[0],m=l[1],p=Object(i.useState)(a.currentSnapshot),h=Object(s.a)(p,2),b=h[0],v=h[1];Object(i.useEffect)(function(){v(f[a.currentSnapshotParameter.get()])},[r,v]),Object(i.useEffect)(function(){c&&m(Object(d.a)(c))},[c]);var g=Object(i.useCallback)(function(){a.deleteAllSnapshots(),m([]),v(void 0)},[]),E=Object(i.useCallback)(function(){a.takeSnapshot(),m(Object(d.a)(a.snapshots)),v(a.currentSnapshot)},[m,a,v]),O=Object(i.useCallback)(function(e){var t=f.indexOf(e);a.currentSnapshotParameter.get()===t?a.currentSnapshotParameter.set(-1):a.currentSnapshotParameter.set(f.indexOf(e),!1)},[a,v,f]),y=Object(i.useCallback)(function(){a.deleteSnapshot(b),m(Object(d.a)(a.snapshots)),v(void 0)},[a,b,v,m]);return u.a.createElement(Ha.a,{isDraggable:n,effect:a,instrument:a.snapshotComponent,type:Ua.f,className:"snapshots-container"},u.a.createElement("div",{className:"snapshot-toolbar"},u.a.createElement(Fa.a,{parameter:a.currentSnapshotParameter,hideSlider:!0,name:"Snapshots"}),u.a.createElement("div",{onClick:E,className:"plane-snapshot-btn"},"+"),b?u.a.createElement("div",{onClick:y,className:"delete-snapshot plane-snapshot-btn"},"-"):"",u.a.createElement("div",{onClick:g,className:"delete-all"},"x")),u.a.createElement("div",{className:"snapshots-list"},f.map(function(e,t){return u.a.createElement("div",{key:t,onClick:function(){return O(e)},className:e===b?"snapshot current":"snapshot"},t+1)})))}),Wa=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setSelected,n=e.isRegionMode,a=e.effect,r=e.isDraggable,c=e.setExpanded,o=e.expanded,s=e.setIsRegionMode,l=e.unmap,f=e.selected,m=e.mergeGroups,p=e.group,d=e.grouped,h=e.setDrawMode,b=e.drawMode,v=e.children,g=Object(i.useCallback)(function(e){a.scriptExpanded=e,c(e)},[a,c]),E=Object(i.useCallback)(function(){a.createMacro(f)},[a,f]),O=Object(i.useCallback)(function(){var e=f[0].parameters;a.freeMacro(f[0]),t(e)},[a,f,t]),y=new Set;f.forEach(function(e){return y.add(e.hasGroup)});var k=y.size>=2,j=f.length>0,C=f[0]&&f[0].isPlaneMacro;return u.a.createElement("div",{className:"plane-toolbar"},u.a.createElement("div",{className:"plane-toolbar-inner"},u.a.createElement("div",{className:"inner-part-1"},u.a.createElement("div",{className:"plane-group-buttons"},u.a.createElement("div",{onClick:function(){return l()},className:f.length>0?"plane-btn":"plane-btn disabled"},"unmap"),k?u.a.createElement("div",{onClick:m,className:"plane-btn"},"merge"):"",u.a.createElement("div",{onClick:function(){return p(!d)},className:f.length>0?"plane-btn":"plane-btn disabled"},d?"ungroup":"group"),u.a.createElement("div",{className:n?"plane-btn selected":f.length>0?"plane-btn":"plane-btn disabled",onClick:function(){return s(!n)}},"bounds"),u.a.createElement("div",{onClick:C?O:E,className:j?"plane-btn":"plane-btn disabled"},C?"free macro":"macro"),u.a.createElement("img",{onClick:function(){return h(!b)},src:"/pencil.svg",className:b?"pencil-icon enabled":"pencil-icon"}),u.a.createElement("img",{onClick:function(){return a.resetValues()},src:"/reset.svg",className:"reset-icon"})),u.a.createElement(Ga,{isDraggable:!0,effect:a}),u.a.createElement(Ra,{group:a}),u.a.createElement(_a,{isDraggable:r,setExpanded:g,expanded:o,selected:f,effect:a})),v),"")});n(1304);function Va(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Xa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xa(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Xa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}Object(m.b)(function(e,t){return{parameterMinMax:e.effects.parameterMinMax}},function(e){return{}})(function(e){e.effect;var t=e.selected,n=e.width,a=e.height;return t.flatMap(function(e){return e.isPlaneMacro?e.parameters:e}).map(function(e){var t=e.min,r=e.max,c=e.originalMin,o=e.originalMax,s=e.depthParameter;return u.a.createElement(ka.g,{strokeShadowEnabled:!1,perfectDrawing:!1,stroke:"#00a4ff",fill:"#23757b4f",dash:[3],x:n*(t-c)/(o-c),y:s?a*(s.min-s.originalMin)/(s.originalMax-s.originalMin):0,height:s?a*(s.max-s.min)/(s.originalMax-s.originalMin):a,width:n*(r-t)/(o-c)})})}),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.parameter,n=e.history,a=n.slice(Math.max(0,n.length-10)).map(function(e){return e[t.id]}),r=a[0];if(!r)return[];var c="M "+r.x+","+r.y+" C"+a.slice(1).map(function(e){return e.x+","+e.y}).join(",");return u.a.createElement("path",{className:"history-path",d:c,stroke:"white",strokeWidth:2})});var Ka=new h.a;Object(m.b)(function(e,t){var n={macros:e.plane.macros[t.group.effect.id]};return t.group._parameters.map(function(e){return n[e.id]=e.get(!0)}),t.group._parameters.map(function(e){return n[e.id+"depth"]=e.depth}),n},function(e){return{}})(function(e){var t=e.group,n=t._parameters.filter(function(e){return!e.planeMacro}),a=Array.from(new Set(t._parameters.filter(function(e){return e.planeMacro}).map(function(e){return e.planeMacro}))),r=n.map(function(e){return e.getCoordinates()}),c="M "+(r=[].concat(Object(d.a)(r),Object(d.a)(a.map(function(e){return e.coordinates})))).map(function(e){return e.x+" "+e.y}).join(", ");return u.a.createElement(ka.f,{dash:[1],stroke:Ka.getColorForHash(t.id),strokeWidth:1,data:c,className:"group-path"})});function Qa(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ya(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ya(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Ya(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ja=0,Za=function(e,t,n,a,r,c){var o=e+(e-r)*c,s=t+(t-r)*c,i=Math.max(n,o),u=Math.min(a,s);return i<u?{min:i,max:u}:{min:e,max:t}},$a=function(e){if(!e)return{};var t={};return t[e.id]=e.value,t},er=(n(1382),n(898)),tr=(n(2388),new h.a),nr=(Object(i.memo)(function(e){var t=e.bpm,n=e.parameter,a=e.isSelected,r=e.startDragging,c=e.x,o=e.y,s=tr.getColorForHash(n.name),i=s;a&&(s="black");var l=t/85,f={};return window.isNFT&&(f.filter="blur("+l+"px)"),a?u.a.createElement(ka.a,{perfectDrawEnabled:!1,shadowForStrokeEnabled:!1,hitStrokeWidth:0,style:f,onMouseDown:function(e){return r(e.evt,n)},opacity:n.locked2D?.3:1,className:a?"star selected":"selected",x:Math.round(c),y:Math.round(o),radius:7,fill:s,stroke:i}):u.a.createElement(ka.a,{shadowForStrokeEnabled:!1,hitStrokeWidth:0,perfectDrawEnabled:!1,style:f,opacity:n.locked2D?.3:1,onMouseDown:function(e){return r(e.evt,n)},className:a?"star selected":"selected",x:Math.round(c),y:Math.round(o),radius:7,fill:s})}),Object(m.b)(function(e,t){var n={};return t.effect._parameters.map(function(t){return n[t.id]=e.effects.effectParameters[t.id]}),t.effect._parameters.map(function(e){return n[e.id+"depth"]=e.depth}),Object(B.a)({},n,{macros:e.plane.macros[t.effect.id],parameterSelected:e.effects.accumulatorParameterSelected,bpm:t.effect.track.sequencerEngine.bpm,blur:t.effect.blurParameter.get(),selected:e.plane.selectedParameters[t.effect.id],filteredParameters:e.plane.filteredParameters[t.effect.id],macroToShow:e.plane.macroToShow[t.effect.id],isRegionMode:e.plane.regionMode[t.effect.id]})},function(e,t){return{setIsRegionMode:function(n){return e(Object(f.vd)(t.effect.id,n))},setMacroToShow:function(n){return e(Object(f.ud)(t.effect.id,n))},setSelected:function(n){return e(Object(f.he)(t.effect.id,n))},setFilteredParameters:function(n){return e(Object(f.Ub)(t.effect.id,n))},setEffectParameterValues:function(t){return e(Object(f.Eb)(t))},setParameterMinMax:function(t){return e(Object(f.jd)(t))}}})(function(e){var t=e.setParameterMinMax,n=e.effect,a=e.parameterSelected,r=e.setEffectParameterValues,c=e.sequencerEngine,o=e.macros,l=void 0===o?[]:o,m=e.filteredParameters,p=e.setFilteredParameters,h=e.selected,b=void 0===h?[]:h,v=e.setSelected,g=e.macroToShow,E=e.setMacroToShow,O=e.isRegionMode,y=e.setIsRegionMode,k=e.hideUI,j=Object(da.a)(e,["setParameterMinMax","effect","parameterSelected","setEffectParameterValues","sequencerEngine","macros","filteredParameters","setFilteredParameters","selected","setSelected","macroToShow","setMacroToShow","isRegionMode","setIsRegionMode","hideUI"]),C=Object(i.useState)(void 0),S=Object(s.a)(C,2),w=S[0],P=(S[1],Object(i.useRef)(void 0)),N=Object(i.useState)(!0),x=Object(s.a)(N,2),q=x[0],T=x[1],M=function(e){var t=Object(i.useState)(!1),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useState)(e.regions),o=Object(s.a)(c,2),u=o[0],l=o[1],f=Object(i.useState)(void 0),m=Object(s.a)(f,2),p=m[0],d=m[1],h=Object(i.useCallback)(function(e,t){a&&(e.stopPropagation(),d(t))},[d,a]);return Object(i.useEffect)(function(){d(void 0)},[d,a]),{setIsDensitiesMode:r,isDensitiesMode:a,densities:u,setDensities:l,selectedDensity:p,onClickDensity:h,setSelectedDensity:d}}(n),R=M.isDensitiesMode,D=(M.setIsDensitiesMode,M.onClickDensity,M.setSelectedDensity),I=M.selectedDensity,A=(M.densities,M.setDensities),L=Object(er.a)({ref:P,setSelectedDensity:D,selected:b,setSelected:v,setDensities:A,effect:n,setEffectParameterValues:r,filteredParameters:m,isRegionMode:O,isDensitiesMode:R,macroToShow:g}),F=L.setDrawMode,z=L.drawMode,_=L.selection,H=L.startDragging,U=L.onMouseDown,G=L.onMouseMove,W=L.onMouseUp;Object(i.useEffect)(function(){b&&!m&&(0==b.length?E(void 0):g&&b[0].isPlaneMacro&&b[0]!==g&&E(b[0]))},[b,E,m,g]),Object(i.useEffect)(function(){if(m){var e=m.find(function(e){return e.planeMacro});e&&E(e.planeMacro)}},[m,E]);var V=function(e){var t=e.setIsRegionMode,n=e.parameterSelected,a=e.effect,r=e.selected,c=e.setSelected,o=Object(i.useCallback)(function(e){r.forEach(function(t){return t.locked2D=e}),c([])},[r]),s=Object(i.useCallback)(function(){var e=new Set;r.forEach(function(t){return e.add(t.hasGroup)});var t,n=void 0,o=qa(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s&&(void 0===n?n=s:n._parameters.length<s._parameters.length&&(n=s))}}catch(i){o.e(i)}finally{o.f()}a.mergeIntoGroup(n,r),c(Object(d.a)(n._parameters))},[r,c]);return Object(i.useEffect)(function(){n&&a._parameters.includes(n)&&(r.includes(n)||c([n]))},[n,c,r]),Object(i.useEffect)(function(){0===r.length&&t(!1)},[r,t]),{mergeGroups:s,lock:o,locked:r.some(function(e){return e.locked2D}),grouped:r.some(function(e){return e.hasGroup})}}({effect:n,selected:b,setSelected:v,parameterSelected:a,setIsRegionMode:y}),X=V.mergeGroups,K=(V.lock,V.locked,V.grouped),Q=function(e){return{onDropPreset:Object(i.useCallback)(function(t){t.stopPropagation();var n=e.track.sequencerEngine.state.presets.presetDragging;n&&e.dropPreset(n)},[e])}}(n).onDropPreset,Y=function(e){var t=e.selectedDensity,n=e.setDensities,a=e.effect,r=e.isRegionMode,c=e.filteredParameters,o=e.setSelected,s=e.selected,u=e.setFilteredParameters,l=e.sequencerEngine,m=e.setEffectParameterValues,p=e.setParameterMinMax;Object(i.useEffect)(function(){return window.addEventListener("keydown",h),function(){return window.removeEventListener("keydown",h)}},[o,r,s,c,a,t,n]);var h=Object(i.useCallback)(function(e){"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&a.id===a.track.sequencerEngine.state.effects.selectedEffect&&a===a.track.sequencerEngine.state.zobject.selectedZObject&&(Object(nn.a)(""+e.key)?v(parseInt(e.key)):"a"===e.key&&(e.metaKey||e.ctrlKey)?(E(),l.dispatch(Object(f.ne)(a))):"Backspace"===e.key?(t?g():O(),l.dispatch(Object(f.ne)(a))):"s"===e.key&&(e.metaKey||e.ctrlKey)?(e.preventDefault(),a.takeSnapshot(!0),l.dispatch(Object(f.ne)(a))):"g"===e.key&&(e.metaKey||e.ctrlKey)?(y(),l.dispatch(Object(f.ne)(a))):"ArrowLeft"===e.key?(e.preventDefault(),b("LEFT"),l.dispatch(Object(f.ne)(a))):"ArrowRight"===e.key?(e.preventDefault(),b("RIGHT"),l.dispatch(Object(f.ne)(a))):"ArrowUp"===e.key?(e.preventDefault(),b("UP"),l.dispatch(Object(f.ne)(a))):"ArrowDown"===e.key&&(e.preventDefault(),b("DOWNW"),l.dispatch(Object(f.ne)(a))))},[o,r,s,c,a,t]),b=Object(i.useCallback)(function(e){if(!(a.groups.some(function(e){return e.variations&&e.variations.length>0})||a.variations&&a.variations.length>0)){var t="LEFT"===e?-1:"RIGHT"===e?1:0,n="UP"===e?-1:"DOWNW"===e?1:0;if(r){t*=4,n*=4;var c,o={},i={},u=Va(s);try{for(u.s();!(c=u.n()).done;){var l=c.value,f=(l.max-l.min)/va.c;if(l.min=Math.max(Math.min(l.min+f*t,l.originalMax),l.originalMin),l.max=Math.max(Math.min(l.max+f*t,l.originalMax),l.originalMin),o[l.id]={min:l.min,max:l.max},l.depthParameter){var d=l.depthParameter;f=(d.max-d.min)/va.c,d.min=Math.max(Math.min(d.min+f*t,d.originalMax),d.originalMin),d.max=Math.max(Math.min(d.max+f*t,d.originalMax),d.originalMin),o[d.id]={min:d.min,max:d.max}}i[l.id]=l.get(!0)}}catch(k){u.e(k)}finally{u.f()}p(o),m(o)}else{var h,b={},v=Va(s);try{for(v.s();!(h=v.n()).done;){var g=h.value;if(!g.subMacros){var E=g.moveCoordinates(2*t,2*n),O=E.id,y=E.value;b[O]=y}}}catch(k){v.e(k)}finally{v.f()}m(b)}}},[r,s]),v=Object(i.useCallback)(function(e){t&&(t.viscosity=e,n(Object(d.a)(a.regions)))},[t,n]),g=Object(i.useCallback)(function(e){t&&(a.deleteDensity(t),n(Object(d.a)(a.regions)))},[t,n]),E=Object(i.useCallback)(function(){s&&s.length>0?o([]):o(c?Object(d.a)(c):Object(d.a)(a._parameters))},[o,s,c,a,u]),O=Object(i.useCallback)(function(){l.operationManager.dispatch(Object(dt.u)(a,s)),c&&u(c.filter(function(e){return!s.includes(e)})),o([])},[s,o,u,c,a]),y=Object(i.useCallback)(function(e){if(void 0===e&&(e=!s.some(function(e){return e.hasGroup})),e)a.groupParameters(s);else{var t=s.find(function(e){return e.hasGroup}).hasGroup;s.every(function(e){return e.group===e})?a.ungroup(t):a.ungroupParameters(s)}o(Object(d.a)(s))},[s,a,o]);return{unmap:O,group:y}}({selectedDensity:I,setDensities:A,effect:n,setSelected:v,selected:b,filteredParameters:m,setFilteredParameters:p,sequencerEngine:c,expanded:q,setEffectParameterValues:r,setParameterMinMax:t,isRegionMode:O}),J=Y.unmap,Z=Y.group;!function(e){var t=e.ref,n=e.effect,a=e.setEffectParameterValues,r=e.selected,c=e.isRegionMode,o=e.setSelected,s=e.selectedDensity,u=e.setDensities;Object(i.useEffect)(function(){return t.current.addEventListener("wheel",l,{passive:!1}),function(){t.current&&t.current.removeEventListener("wheel",l,{passive:!1})}},[r,c,o,n,u]);var l=Object(i.useCallback)(function(e){var t=e.wheelDelta;if(!(Math.abs(e.deltaX)>=.5)&&e.deltaY-Math.floor(e.deltaY)!==0&&Math.abs(t)>=50){if(console.log("preventing usewheel"),e.preventDefault(),e.stopPropagation(),Ja++%2!==0)return!1;if(c){var o=r.flatMap(function(e){return e.isPlaneMacro?e.parameters:e});return void f(o,t<0?-.1:.1)}s&&(t<0?n.expandDensitySize(s,.9):n.expandDensitySize(s,1.1),u(n.regions));var i={},l={};r.forEach(function(e){if(e.isPlaneMacro){var t,n=Qa(e.parameters);try{for(n.s();!(t=n.n()).done;){var a=t.value;l[a.id]=a,i[a.id]=a.getCoordinates()}}catch(r){n.e(r)}finally{n.f()}}else l[e.id]=e,i[e.id]=e.getCoordinates()});var m={};if(m=t<0?Object(ha.j)(i,-.1):Object(ha.j)(i,.1),0===Object.keys(m).length)return!1;var p=r[0]&&r[0].isRecording,d=Object.keys(m).map(function(e){return l[e].setCoordinates(m[e].x,m[e].y,void 0,void 0,p)}).reduce(function(e,t){return Object(B.a)({},$a(t),e)},{});return a(d),!1}},[r,c,o,n,u]),f=Object(i.useCallback)(function(e,t){var r,c={},s=Qa(e);try{var i=function(){var e=r.value,a=e.min,o=e.max,s=e.originalMin,i=e.originalMax,u=Za(a,o,s,i,e.get(!0),t);if(e.min=u.min,e.max=u.max,n.currentSnapshot){var l=n.currentSnapshot.find(function(t){return t.parameter.id===e.id});l&&(l.min=u.min,l.max=u.max)}if(c[e.id]=e.get(!0),e.depthParameter){var f=e.depthParameter,m=f.min,p=f.max,d=f.originalMin,h=f.originalMax;u=Za(m,p,d,h,f.get(!0),t),f.min=u.min,f.max=u.max}};for(s.s();!(r=s.n()).done;)i()}catch(u){s.e(u)}finally{s.f()}a(c),o(Object(d.a)(e))},[o,r])}({ref:P,effect:n,setDensities:A,selectedDensity:I,setEffectParameterValues:r,selected:b,setSelected:v,isRegionMode:O});_&&Math.abs(_.y2-_.y1),_&&Math.abs(_.x2-_.x1);var $=m||n._parameters.filter(function(e){return g&&g===e.planeMacro||!e.planeMacro}),ee={};Object(ya.a)($).forEach(function(e,t){return ee[$[t].id]=e});var te="plane-inner";return q&&(te+=" expanded"),u.a.createElement("div",{onDrop:Q,className:te},u.a.createElement("div",{className:"vertical-pane"},u.a.createElement("div",{className:"plane-container"},u.a.createElement("div",{draggable:!0,ref:P,onDragStart:function(e){return e.preventDefault()},onDragOver:function(e){return e.preventDefault()},onMouseDown:U,onMouseUp:W,onMouseMove:G,className:"plane-view"},u.a.createElement("div",{className:"y-axis"},"Modulation"),u.a.createElement("div",{className:"x-axis"},"Parameter Value"),u.a.createElement("svg",{className:"drawn-svg",height:va.a,width:va.c},!window.isNFT&&u.a.createElement(xa,{drawnPath:n.currentPath,effect:n})),u.a.createElement(ba.a,Object.assign({blur:j.blur,selectedColor:w,setMacroToShow:E,startDragging:H,coords:ee,filteredParameters:m,parameters:$,macroToShow:g,setParameterMinMax:t,effect:n,parameterSelected:a,setEffectParameterValues:r,containerRef:P,selected:b,selection:_,sequencerEngine:c,isRegionMode:O,macros:l},j)))),u.a.createElement(Wa,{setSelected:v,isDraggable:j.isDraggable,drawMode:z,setDrawMode:F,isRegionMode:O,effect:n,setExpanded:T,expanded:q,setIsRegionMode:y,unmap:J,selected:b,mergeGroups:X,group:Z,grouped:K},j.children)),!k&&q&&n.groups[0]&&n.groups[0].algorithm===ha.g?u.a.createElement(Aa.a,{isDraggable:j.isDraggable,scriptType:Ia.a,expanded:!0,setExpanded:function(){n.scriptExpanded=void 0,T(void 0)},doc:La.a,sequencerEngine:c,effect:n.groups[0]}):"")})),ar=n(887),rr=function(e){var t=e.setToggled,n=e.toggled,a=e.url,r=void 0===a?"/zequencer-logo-hiero.svg":a;return u.a.createElement("img",{onClick:function(){return t(!n)},className:n?"logo-hiero toggled":"logo-hiero",src:r})},cr=n(193),or=n(1306),sr=n(1307),ir=n(835),ur=n(176),lr=n(521),fr=n(48);function mr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var pr=new h.a,dr=function(e){Object(xe.a)(n,e);var t=mr(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"hasAutomationSet",value:function(){return void 0!==this.props.automation&&void 0!==this.props.automation.get(this.props.parameter)}},{key:"deleteAutomation",value:function(){this.props.automation.delete(this.props.parameter)}},{key:"getMacroOverlayIfNeeded",value:function(){var e=this,t=this.props,n=t.isMacroMapping,a=t.parameter,r=t.isParameterToMap;if(n&&a){var c="macro-overlay";r&&(c+=" parameter-to-map"),a.hasMacro&&(c+=" mapped");var o={};this.props.parameter.hasMacro&&(o={backgroundColor:pr.getColorForHash(a.hasMacro.id)});var s=a.hasMacro&&a.hasMacro.name;return u.a.createElement("div",{onClick:function(){return e.props.setParameterToMap(e.props.parameter)},className:c},u.a.createElement("div",{className:"overlay-main"}),u.a.createElement("div",{className:"overlay-detail",style:o},s))}return""}},{key:"render",value:function(){var e=this;br(this.props.value);return u.a.createElement(vn.a,{element:this.props.parameter,onClick:function(){return e.props.setParameterToMap(e.props.parameter)},className:"lfo-rate-dropdown"},this.getMacroOverlayIfNeeded(),this.props.hideLabel?"":u.a.createElement("div",{className:"lfo-rate-label"},"Rate:"),u.a.createElement(D.a,{className:"osc-type-dropdown float-left",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:hr,onChange:function(t){return e.props.onChange(t.value)},value:br(this.props.value),placeholder:"Rate"}),u.a.createElement(He.a,{condition:this.hasAutomationSet()},u.a.createElement("div",{onClick:function(){return e.deleteAutomation()},className:"automation-label float-right"},"AUTOMATION")),u.a.createElement("div",{className:"clear-fix"}))}}]),n}(i.Component),hr=[{value:new b.a(4,!1),label:"1/4"},{value:new b.a(4,!0),label:"1/4t"},{value:new b.a(8,!1),label:"1/8"},{value:new b.a(8,!0),label:"1/8t"},{value:new b.a(16,!1),label:"1/16"},{value:new b.a(16,!0),label:"1/16t"},{value:new b.a(32,!1),label:"1/32"},{value:new b.a(32,!0),label:"1/32t"}];function br(e){for(var t=0;t<hr.length;t++)if(hr[t].value.resolution==e.resolution&&hr[t].value.isTriplet==e.isTriplet)return hr[t];return null}var vr=Object(m.b)(function(e,t){return{value:void 0===t.automation||void 0===t.automation.get(t.parameter)?t.parameter.get():t.automation.get(t.parameter).value,isMacroMapping:e.effects.isMacroMapping,isParameterToMap:t.parameter&&e.effects.parameterToMap===t.parameter}},function(e){return{setParameterToMap:function(t){return e(Object(f.md)(t))}}})(dr),gr=n(580);function Er(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Or=function(e){Object(xe.a)(n,e);var t=Er(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"handleOptionChange",value:function(e){this.setState(this.state)}},{key:"handleParameterChange",value:function(e,t){if(this.props.automation){var n=this.props.automation.get(e);void 0===n?this.props.automation.set(this.props.parameter,new fr.a(this.props.effectNumber,e,t)):n.value=t}else this.props.sequencerEngine.operationManager.dispatch(Object(dt.v)(e,t))}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"getParameter",value:function(e){var t=e.get();if(this.props.automation){var n=this.props.automation.get(e);if(void 0!==n)return n.value}return t}},{key:"render",value:function(){var e,t=this;return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(vr,{automation:this.props.automation,onChange:function(e){return t.handleParameterChange(t.state.effect.arpRateParameter,e)},parameter:this.state.effect.arpRateParameter}),u.a.createElement("div",{className:"lfo-rate-dropdown"},u.a.createElement("div",{className:"lfo-rate-label"},"Direction:"),u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:yr,onChange:function(e){return t.handleParameterChange(t.state.effect.arpDirectionParameter,e.value)},value:(e=this.getParameter(this.state.effect.arpDirectionParameter),yr.filter(function(t){return t.value===e})[0]),placeholder:"Direction"}),u.a.createElement("div",{className:"clear-fix"})),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Octaves",parameter:this.state.effect.arpOctavesParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:6}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Repeats",parameter:this.state.effect.arpRepeatParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:8}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Duration Factor",parameter:this.state.effect.arpDurationFactorParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.1,min:.1,max:8})):"")}}]),n}(i.Component),yr=[{value:gr.a,label:"Down"},{value:gr.b,label:"Up"}];var kr=Object(m.b)(function(e,t){return{arpDirection:t.effect.arpDirectionParameter.get(),isMacroMapping:e.effects.isMacroMapping}},null)(Or),jr=n(424),Cr=n(192),Sr=n(639),wr=[{value:null,label:"None"}].concat(Object(d.a)(["duration","transpose","velocity","chop","start"].map(function(e){return{label:e,value:e}}))),Pr=Object(m.b)(function(e,t){return{value:t.parameter.get()}},function(e){return{}})(function(e){var t=e.value,n=e.parameter;return u.a.createElement(D.a,{options:wr,value:t?{value:t,label:t}:{value:null,label:"None"},onChange:function(e){return n.set(e.value)}})}),Nr=n(585);n(2393);function xr(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return qr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qr(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function qr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Tr=[{label:"Forward",value:Nr.b},{label:"Forward/Reverse",value:Nr.c},{label:"Forward/Stay",value:Nr.d}],Mr=(Nr.a,Nr.e,Object(m.b)(function(e,t){return{mode:t.effect.modeParameter.get()}},function(e){return{}})(function(e){var t=e.effect,n=e.isDraggable,a=e.sequencerEngine,r=e.mode,c=(e.operation,Object(i.useState)(t._parameters)),o=Object(s.a)(c,2),l=o[0];o[1];if(!t.isEnabled())return u.a.createElement("div",null);var f,m=1,p=0,d=xr(l);try{for(d.s();!(f=d.n()).done;){var h=f.value;h&&(h.min<p&&(p=h.min),h.max>m&&(m=h.max))}}catch(b){d.e(b)}finally{d.f()}return u.a.createElement("div",{className:"accumulator"},u.a.createElement("div",{className:"acc-column"},u.a.createElement(vn.a,{element:t.modeParameter,className:"synced-parameter"},u.a.createElement("span",null,"Limit Mode: "),u.a.createElement(D.a,{placeholder:"Limit Mode",options:Tr,value:Tr.find(function(e){return e.value===r}),onChange:function(e){return t.modeParameter.set(e.value)}})),u.a.createElement(Fa.a,{name:"Accumulator",parameter:t.accumulatorValueParameter,isParameter:!0,sequencerEngine:a,lfoEnabled:!0,step:.001,min:p,max:m}),u.a.createElement(Fa.a,{name:"Limit",parameter:t.limitParameter,isParameter:!0,sequencerEngine:a,lfoEnabled:!0,step:.001,min:0,max:m-p}),u.a.createElement(Fa.a,{name:"Ramp Time",parameter:t.rampTimeParameter,isParameter:!0,sequencerEngine:a,lfoEnabled:!0,unit:"ms",step:1,min:1,max:3e3}),u.a.createElement(Pr,{parameter:t.syncedParameter}),u.a.createElement(Cr.a,{name:"Reset on step 1",parameter:t.resetAtZeroParameter})),u.a.createElement(jr.a,{isDraggable:n,effect:t}))})),Rr=function(e){var t=e.effect,n=e.item,a=e.i,r=(e.key,e.isCurrent),c=Object(i.useState)(void 0===n?"":void 0),o=Object(s.a)(c,2),l=o[0],f=o[1];Object(i.useEffect)(function(){f(void 0===n?"":void 0)},[n,f]);var m=Object(i.useCallback)(function(e){if("Enter"===e.key){var n=parseFloat(l);if(isNaN(n))return;var r=t.valueList;void 0===a?t.valueList=[].concat(Object(d.a)(r),[n]):(r[a]=n,t.valueList=r),f(void 0)}},[f,l,t,a]),p=Object(i.useCallback)(function(e){e.stopPropagation();var n=Object(d.a)(t.valueList);n.splice(a,a),t.valueList=n},[t,a]);return void 0!==l?u.a.createElement("div",{className:"value-list-item"},u.a.createElement("input",{placeholder:"Enter value",value:l,onChange:function(e){return f(e.target.value)},onKeyDown:m})):u.a.createElement("div",{onClick:function(){return f(n)},className:r?"value-list-item current":"value-list-item"},u.a.createElement("div",null,n),u.a.createElement("div",{onClick:p,className:"delete-btn"},"x"))},Dr=Object(m.b)(function(e,t){var n=t.effect.listParameter.get();return{valueList:n,len:n.length,index:t.effect.counter}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.effect,a=e.valueList,r=(e.len,e.index),c=e.isDraggable,o=Array.isArray(a)?[].concat(Object(d.a)(a),[void 0]):[void 0];return r%=a.length,u.a.createElement("div",{className:"control-parameters accumulator"},u.a.createElement("div",{className:"acc-column"},o.map(function(e,t){return u.a.createElement(Rr,{isCurrent:t===r,effect:n,key:t,item:e,i:t})})),u.a.createElement(jr.a,{isDraggable:c,effect:n},u.a.createElement(Fa.a,{name:"Ramp Time",parameter:n.rampTimeParameter,isParameter:!0,sequencerEngine:t,lfoEnabled:!0,unit:"ms",step:1,min:1,max:3e3}),u.a.createElement(Cr.a,{name:"Reset on step 1",parameter:n.resetAtZeroParameter})))}),Ir=Object(m.b)(function(e,t){return{color:e.plane.gradientColors[t.effect.id]}},function(e){return{setPlanarGradientColor:function(t,n){return e(Object(f.td)(t,n))}}})(function(e){var t=e.effect,n=e.color,a=e.setPlanarGradientColor;n=n||"#ffffff";var r=Object(i.useState)(n),c=Object(s.a)(r,2),o=c[0],l=c[1],f=Object(i.useState)(!1),m=Object(s.a)(f,2),p=m[0],d=m[1],h=Object(i.useCallback)(function(e){a(t.id,e.hex),l(e)},[l,t]);return u.a.createElement("div",{className:"gradient-color"},"Gradient Color: ",u.a.createElement("div",{onClick:function(){return d(!p)},style:{backgroundColor:n},className:"color-dot"}),p&&u.a.createElement(Qe.a,{color:o,onChange:h}))}),Ar=[{label:"240x160",value:{width:240,height:160}},{label:"300x200",value:{width:300,height:200}},{label:"600x400",value:{width:600,height:400}},{label:"900x600",value:{width:900,height:600}}],Lr=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,a=Object(i.useState)(va.c),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(va.a),f=Object(s.a)(l,2),m=(f[0],f[1]),p=Object(i.useCallback)(function(e){var n=e.value,a=n.width,r=n.height;o(a),m(r),Object(va.d)(a,r),t.stop()},[o,m]);return u.a.createElement("div",{className:"look-config"},u.a.createElement(D.a,{className:"osc-type-dropdown",options:Ar,onChange:p,value:Ar.find(function(e){return e.value.width===c})}),u.a.createElement(Fa.a,{name:"Blur",unit:"px",parameter:t.blurParameter,min:0,max:40,step:1,lfoEnabled:!0,isParameter:!0,sequencerEngine:n}),u.a.createElement(Fa.a,{name:"Tension",parameter:t.splineTensionParameter,root:3,min:.5,max:400,step:.01,lfoEnabled:!0,isParameter:!0,sequencerEngine:n}),u.a.createElement(Ir,{effect:t}))}),Fr=function(e){var t=e.hideUI,n=e.setHideUI,a="hide-ui-toggle";return t&&(a+=" hiding"),u.a.createElement("div",{onClick:function(){return n(!t)},className:a},t&&u.a.createElement("div",{className:"circle-button"}),t?"No UI":"UI",!t&&u.a.createElement("div",{className:"circle-button"}))},zr=function(e){var t=e.effect,n=e.sequencerEngine;return u.a.createElement("div",{className:"config-parameters"},u.a.createElement(Fa.a,{name:"Ramp Time",unit:"ms",parameter:t.rampTimeParameter,min:1,max:2e3,step:1,lfoEnabled:!0,isParameter:!0,sequencerEngine:n}),u.a.createElement(Fa.a,{name:"# Parameters per iter",unit:"ms",parameter:t.maxParametersParameter,min:16,max:64,step:1,lfoEnabled:!0,isParameter:!0,sequencerEngine:n}),u.a.createElement(Fa.a,{name:"Update Rate",unit:"",parameter:t.updateRateParameter,min:0,max:8,step:1,lfoEnabled:!0,isParameter:!0,sequencerEngine:n}))},Br=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,a=e.hideUI,r=e.setHideUI,c=Object(i.useState)("MAIN"),o=Object(s.a)(c,2),l=o[0];o[1];return u.a.createElement("div",{className:"plane-config"},"MAIN"===l&&u.a.createElement(zr,{effect:t,sequencerEngine:n}),"LOOK"===l&&u.a.createElement(Lr,{effect:t,sequencerEngine:n}),u.a.createElement("div",{className:"tab-options"},u.a.createElement(Fr,{hideUI:a,setHideUI:r})))}),_r=Object(m.b)(function(e,t){return{playing:t.effect.playing}},function(e){return{}})(function(e){var t=e.playing,n=e.effect,a=Object(i.useCallback)(function(){n.playingParameter.set(!t)},[t,n]),r="plane-play";return r+=t?" pause-btn":" play-btn",u.a.createElement("div",{onClick:a,className:r})}),Hr=Object(m.b)(function(e,t){return{planeMapping:e.effects.planeMapping}},function(e){return{setPlaneMapping:function(t){return e(Object(f.xd)(t))}}})(function(e){var t=e.isDraggable,n=e.sequencerEngine,a=e.effect,r=e.planeMapping,c=e.setPlaneMapping,o=Object(i.useState)(12),l=Object(s.a)(o,2),f=l[0],m=(l[1],Object(i.useState)(a.hideUI)),p=Object(s.a)(m,2),d=p[0],h=p[1],b="control-parameters plane-parameters";return d&&(b+=" hide-ui"),Object(i.useEffect)(function(){a.hideUI=d},[d]),u.a.createElement("div",{className:b},u.a.createElement("div",{className:"acc-column"},u.a.createElement(nr,{debug:f,hideUI:d,isDraggable:t,sequencerEngine:n,effect:a},u.a.createElement("div",{className:"control-toolbar"},u.a.createElement("div",{className:"row-powa"},u.a.createElement("div",{onClick:function(e){e.stopPropagation(),c(r?void 0:a)},className:r?"mappy-btn mapping":"mappy-btn"},"map devices"),u.a.createElement(Sr.a,{onMapped:function(){return[]},effect:a,skipSelected:!0,label:"map params"}),u.a.createElement(_r,{effect:a})),u.a.createElement(Br,{setHideUI:h,hideUI:d,sequencerEngine:n,effect:a})))))}),Ur=n(836);function Gr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Wr=function(e){Object(xe.a)(n,e);var t=Gr(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"handleResolutionChange",value:function(e){this.props.effect.resolution=e.value,this.setState(this.state)}},{key:"render",value:function(){var e,t=this;return u.a.createElement("div",null,u.a.createElement(He.a,{condition:this.isEnabled()},u.a.createElement("div",{className:"lfo-rate-dropdown"},u.a.createElement("div",{className:"lfo-rate-label"},"Resolution:"),u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:Vr,onChange:function(e){return t.handleResolutionChange(e)},value:(e=this.props.effect.resolution,Vr.filter(function(t){return t.value===e})[0]),placeholder:"Rate"}),u.a.createElement("div",{className:"clear-fix"})),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,root:2,name:"Odd Timing Offset",parameter:this.props.effect.evenOffsetParameter,onParameterChanged:this.props.onParameterChanged,automation:this.props.automation,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:-.5,max:4}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Even Timing Offset",root:2,parameter:this.props.effect.oddOffsetParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:-.5,max:4}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Probability",parameter:this.props.effect.probabilityParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:100})))}}]),n}(i.Component),Vr=[{value:32,label:"1"},{value:16,label:"1/2"},{value:8,label:"1/4"},{value:4,label:"1/8"},{value:2,label:"1/16"},{value:1,label:"1/32"}];var Xr=Wr;function Kr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Qr=function(e){Object(xe.a)(n,e);var t=Kr(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"render",value:function(){return u.a.createElement("div",null,u.a.createElement(He.a,{condition:this.isEnabled()},u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,contextualHelp:bn.F,name:"Limit",parameter:this.props.effect.limitParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:16})))}}]),n}(i.Component),Yr=Object(m.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(Qr);function Jr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Zr=function(e){Object(xe.a)(n,e);var t=Jr(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"onChangeResolution",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(dt.v)(this.props.effect.resolutionParameter,e))}},{key:"onChangeSliceRetrigger",value:function(e){document.activeElement.blur(),this.props.effect.sliceRetrigger=!this.props.effect.sliceRetrigger,this.setState(this.state)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",null,u.a.createElement(He.a,{condition:this.isEnabled()},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(vr,{automation:this.props.automation,parameter:this.props.effect.resolutionParameter,onChange:function(t){return e.onChangeResolution(t)}}),u.a.createElement(He.a,{condition:!window.installation},u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Warp Speed",parameter:this.props.effect.warpLengthParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:.01,max:4}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Warp Factor",parameter:this.props.effect.warpFactorParameter,onParameterChanged:this.props.onParameterChanged,automation:this.props.automation,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.5,min:1,max:8})),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Loop Length",automation:this.props.automation,parameter:this.props.effect.loopLengthParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,unit:"%",step:.1,min:.1,max:100}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Grain Size",automation:this.props.automation,parameter:this.props.effect.durationFactorParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:.01,max:2}),u.a.createElement(He.a,{condition:!window.installation},u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Smoothness",parameter:this.props.effect.smoothnessParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.1,min:.1,max:20})),u.a.createElement("div",{className:"refined-checkbox-preferences"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:"reversed",checked:this.props.effect.sliceRetrigger,onChange:function(t){return e.onChangeSliceRetrigger(t.target.value)}}),"Slice Retrigger"))))}}]),n}(i.Component),$r=Object(m.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(Zr),ec=n(1310),tc=Object(m.b)(function(e,t){return{linkingEffects:e.effects.linkingEffects}},function(e){return{setLinkingEffects:function(t,n){return e(Object(f.Ac)(t,n))}}})(function(e){var t=e.setLinkingEffects,n=e.sequencerEngine,a=e.effect,r=e.effectNumber,c=e.linkingEffects,o=Object(i.useCallback)(function(e){c?t(void 0):t(a,"Tidal")},[c,a]);return u.a.createElement("div",null,u.a.createElement("div",{onClick:o,className:c?"map-button mapping":"map-button"},a.linkedEffect?"Unmap Linked Tidal":"Map Tidal Effect"),u.a.createElement(Fa.a,{effectNumber:r,name:"Cycle Factor",parameter:a.cycleFactorParameter,isParameter:!0,sequencerEngine:n,lfoEnabled:!0,step:.25,min:.25,max:16}))}),nc=n(329);function ac(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var rc=function(e){Object(xe.a)(n,e);var t=ac(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"getParameterOptions",value:function(){return this.props.sequencerEngine.tracks.map(function(e){return{label:e.trackNumber+1,value:e}})}},{key:"getParameterOption",value:function(e){if(void 0!==e){e=this.props.sequencerEngine.tracks[e];var t=this.getParameterOptions().filter(function(t){return t.value===e});return t.length>0?t[0]:void 0}}},{key:"onSelectTrack",value:function(e){this.props.effect.trackOutput=null===e?void 0:e.trackNumber,this.setState(this.state)}},{key:"track",get:function(){return this.props.sequencerEngine.tracks[this.props.effect.trackOutput]}},{key:"render",value:function(){var e=this;return u.a.createElement("div",null,u.a.createElement(He.a,{condition:this.isEnabled()},u.a.createElement(nc.a,{track:this.track,onSelectTrack:function(t){return e.onSelectTrack(t)},sequencerEngine:this.props.sequencerEngine}),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Probability",parameter:this.props.effect.probabilityParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:100})))}}]),n}(i.Component);function cc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var oc=function(e){Object(xe.a)(n,e);var t=cc(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"render",value:function(){var e=this.props.effect.ccParameters;return u.a.createElement("div",null,u.a.createElement("div",{className:"external-instrument-name"},this.props.effect.midiOutput.name),u.a.createElement("div",{className:"midi-interface-effect"},u.a.createElement(He.a,{condition:this.isEnabled()},e.map(function(e){return u.a.createElement("div",{className:"instrument-section"},Object.keys(e).map(function(t){return u.a.createElement(sc,{section:e[t],sectionName:t})}))}))))}}]),n}(i.Component),sc=function(e){Object(xe.a)(n,e);var t=cc(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"external-instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},this.props.sectionName),u.a.createElement("div",{className:"clear-fix"}),Object.keys(this.props.section).map(function(t){return u.a.createElement(Fa.a,{effectNumber:e.props.effectNumber,name:t,parameter:e.props.section[t],onParameterChanged:e.props.onParameterChanged,isParameter:!0,step:1,min:0,max:127})}))}}]),n}(i.Component),ic=oc;function uc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var lc=function(e){Object(xe.a)(n,e);var t=uc(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"getParameterOptions",value:function(){return this.props.effect.getAvailableParameters().map(function(e){return{label:e.name,value:e}})}},{key:"getParameterOption",value:function(e){if(void 0!==e){var t=this.getParameterOptions().filter(function(t){return t.value===e});return t.length>0?t[0]:void 0}}},{key:"handleParameterChange",value:function(e){this.props.effect.parameter=e.value,this.setState(this.state)}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"render",value:function(){return u.a.createElement("div",null,u.a.createElement(He.a,{condition:this.isEnabled()},u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,contextualHelp:bn.F,name:"Pitch",parameter:this.props.effect.pitchParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.1,min:-32,max:32}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,contextualHelp:bn.F,name:"Velocity",parameter:this.props.effect.velocityParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:0,max:1}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,contextualHelp:bn.F,name:"Timing Offset",parameter:this.props.effect.timingOffsetParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:0,max:4}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Probability",contextualHelp:bn.M,parameter:this.props.effect.probabilityParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:100})))}}]),n}(i.Component),fc=Object(m.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(lc);function mc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var pc=function(e){Object(xe.a)(n,e);var t=mc(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"render",value:function(){var e=this;return u.a.createElement("div",null,u.a.createElement(He.a,{condition:this.isEnabled()},[0,1,2,3,4,5,6,7,8,9,10,11].map(function(t){return u.a.createElement(dc,{isLastNote:e.props.lastNotePlayed===t,input:t,effect:e.props.effect})})))}}]),n}(i.Component),dc=function(e){Object(xe.a)(n,e);var t=mc(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={value:a.getOutput()},a}return Object(Ne.a)(n,[{key:"getOutput",value:function(){return this.props.effect.tuningMappings[this.props.input]}},{key:"onUpdateOutput",value:function(e){if(""===e)this.props.effect.tuningMappings[this.props.input]=0,this.setState({value:""});else if("-"===e)this.props.effect.tuningMappings[this.props.input]=0,this.setState({value:"-"});else if("."===e)this.props.effect.tuningMappings[this.props.input]=0,this.setState({value:"."});else if(!Object(nn.a)(e))return;try{var t=parseFloat(e);this.props.effect.tuningMappings[this.props.input]=t}catch(n){}this.setState({value:e})}},{key:"render",value:function(){var e=this,t=this.props.isLastNote?"note-mapping highlighted":"note-mapping";return u.a.createElement("div",{className:t},u.a.createElement("label",{className:"input-note"},this.props.input,":"),u.a.createElement(q.g,{value:this.state.value,onChange:function(t){return e.onUpdateOutput(t.target.value)},placeholder:"Output Note",className:"note-mapping-output"}))}}]),n}(i.Component),hc=Object(m.b)(function(e,t){return{lastNotePlayed:e.keyboard.lastNotePlayed}},function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(pc),bc=n(186);function vc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var gc=function(e){Object(xe.a)(n,e);var t=vc(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"render",value:function(){return u.a.createElement("div",null,u.a.createElement(He.a,{condition:this.isEnabled()},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Steps Delay",parameter:this.props.effect.delayTimeParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:64}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Repeats",parameter:this.props.effect.repeatsParameter,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:32}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})))}}]),n}(i.Component),Ec=(n(2394),Object(m.b)(function(e,t){return{currentStep:t.sequencerEngine.lastTrackStep,every:t.effect.every,offset:t.effect.offset}},function(e){return{}})(function(e){for(var t=e.effect,n=(e.sequencerEngine,e.currentStep,e.every),a=e.offset,r=[],c=0;c<n;c++)r.push(c);var o=t.counter%n-1;return t.counter%n===0&&(o=n-1),u.a.createElement("div",{className:"every-visualizer"},r.map(function(e){return u.a.createElement("div",{className:e===o&&e===a?"step current offset":e===o?"step current":e===a?"step offset":"step"})}))}));function Oc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var yc=function(e){Object(xe.a)(n,e);var t=Oc(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"addParameter",value:function(){this.props.effect.newParameter(),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"getParameterOptions",value:function(){return this.props.effect.getAvailableParameters().map(function(e){return{label:e.name,value:e}})}},{key:"getParameterOption",value:function(e){if(void 0!==e){var t=this.getParameterOptions().filter(function(t){return t.value===e});return t.length>0?t[0]:void 0}}},{key:"handleParameterChange",value:function(e){this.props.effect.parameter=e.value,this.setState(this.state)}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"deleteParameterizer",value:function(e){this.props.effect.deleteParameterizer(e),this.setState(this.state)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",null,u.a.createElement(He.a,{condition:this.isEnabled()},u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Every",contextualHelp:bn.M,unit:"th trigger",automation:this.props.automation,parameter:this.props.effect.everyParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:16}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Trigger Offset",contextualHelp:bn.M,unit:"th trigger",automation:this.props.automation,parameter:this.props.effect.offsetParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:0,max:8}),u.a.createElement(Ec,{effect:this.props.effect,sequencerEngine:this.props.sequencerEngine}),this.props.effect.parameterEffects.map(function(t){return u.a.createElement(Ur.a,{isSimple:!0,deleteParameterizer:function(t){return e.deleteParameterizer(t)},effect:t,sequencerEngine:e.props.sequencerEngine})}),u.a.createElement("div",{onClick:function(){return e.addParameter()},className:"add-parameterizer-button"},"Add Parameter")))}}]),n}(i.Component),kc=Object(m.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(yc);function jc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Cc=function(e){Object(xe.a)(n,e);var t=jc(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"render",value:function(){return u.a.createElement("div",null,u.a.createElement(He.a,{condition:this.isEnabled()},u.a.createElement("div",{className:"midi-row"},u.a.createElement("div",{className:"midi-col"},u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Duration Factor",parameter:this.props.effect.durationFactorParameter,onParameterChanged:this.props.onParameterChanged,automation:this.props.automation,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:.1,max:2}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Even Delay Time",automation:this.props.automation,parameter:this.props.effect.oddDelayTimeParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:.01,max:16}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Odd Delay Time",automation:this.props.automation,parameter:this.props.effect.evenDelayTimeParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:.01,max:16})),u.a.createElement("div",{className:"midi-col"},u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Repeats",automation:this.props.automation,parameter:this.props.effect.repeatsParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:1,min:1,max:8}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Velocity Spread",automation:this.props.automation,parameter:this.props.effect.velocitySpreadParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.01,min:1,max:100}),u.a.createElement(Cr.a,{name:"Synced",parameter:this.props.effect.syncedParameter})))))}}]),n}(i.Component),Sc=Object(m.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(Cc);function wc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Pc=function(e){Object(xe.a)(n,e);var t=wc(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"render",value:function(){return u.a.createElement("div",null,u.a.createElement(He.a,{condition:this.isEnabled()},u.a.createElement("div",{className:"clear-fix"})))}}]),n}(i.Component),Nc=Object(m.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(Pc),xc=n(20),qc=n(248),Tc=n(59),Mc=n(477);function Rc(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Dc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dc(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Dc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ic=function(e){var t=e.rack,n=e.selectedEdge,a=e.selectedNodes,r=e.setEdges,c=e.setEffects,o=e.selectedNode,s=e.connectEdge,u=e.setCopiedNodes,l=e.copiedNodes,m=e.setSelectedNodes,p=e.setLfoEdges,h=e.setEnvelopeEdges,b=e.getLastNode,v=e.setMacros,g=e.setMacroEdges,E=Object(da.a)(e,["rack","selectedEdge","selectedNodes","setEdges","setEffects","selectedNode","connectEdge","setCopiedNodes","copiedNodes","setSelectedNodes","setLfoEdges","setEnvelopeEdges","getLastNode","setMacros","setMacroEdges"]);Object(i.useEffect)(function(){return window.addEventListener("keydown",O),function(){return window.removeEventListener("keydown",O)}},[n,m,o,r,c,E.isSelected]);var O=Object(i.useCallback)(function(e){if(t.getEffectType()!==Tc.d||"Backspace"===e.key)if(console.log("ON KEY DOWN=",e.key),"INPUT"===e.target.tagName.toUpperCase()||t.getEffectType()!==Tc.d&&"Rules Rack"!==t.name&&"Chords Rack"!==t.name&&E.isSelected,E.isSelected||console.log("is selected..."),e.stopPropagation(),"Backspace"===e.key){if(console.log("back space edge=",n),n){if(t.getEffectType()===Tc.d&&void 0===n.modulator)return void console.log("returning");console.log("deleting edge=",n),t.deleteEdge(n),r(Object(B.a)({},t.adjacencyLists)),p(Object(B.a)({},t.lfoAdjacencyLists)),h(Object(B.a)({},t.envelopeAdjacencyLists))}else if(a.length>0){if(t.getEffectType()===Tc.d)return;console.log("selected nodes=",a);var i,l=Rc(a);try{for(l.s();!(i=l.n()).done;){var O=i.value;t.isMacro(O)?(t.deleteMacro(O),v(Object(d.a)(t.macros)),g(Object(B.a)({},t.macroAdjacencyLists))):(console.log("deleting selected rack node=",O),t.deleteEffect(O))}}catch(w){l.e(w)}finally{l.f()}E.setContextualHelp(void 0),m([]),p(Object(B.a)({},t.lfoAdjacencyLists)),h(Object(B.a)({},t.envelopeAdjacencyLists)),r(Object(B.a)({},t.adjacencyLists)),c(Object(d.a)(t.effects))}}else if("l"===e.key&&(e.metaKey||e.ctrlKey)){var y=b(a);y&&a[0]&&(t.connectNodes(y,a[0]),r(Object(B.a)({},t.adjacencyLists)))}else{if("d"===e.key&&(e.metaKey||e.ctrlKey)){if(e.preventDefault(),e.stopPropagation(),o&&void 0===o.getType){var k=o.getEffectCopy();k.id=Object(xc.uuid)(),t.addEffect(k);var j=Object(Mc.a)(o.x,o.y,t),C=j.x,S=j.y;k.x=C,k.y=S,c(Object(d.a)(t.effects))}return!1}if("c"===e.key&&(e.metaKey||e.ctrlKey))return e.stopPropagation(),e.preventDefault(),u(Object(d.a)(a)),!1;if("v"===e.key&&(e.metaKey||e.ctrlKey))return e.stopPropagation(),e.preventDefault(),t.pasteNodes(E.sequencerEngine.state.effects.copiedNodesForRack),c(Object(d.a)(t.effects)),r(Object(B.a)({},t.adjacencyLists)),!1;if("o"===e.key&&(e.metaKey||e.ctrlKey))return e.stopPropagation(),e.preventDefault(),a.forEach(function(e){return s(e,qc.h,{mode:qc.b,node:t.outputNode})}),!1;if("i"===e.key&&(e.metaKey||e.ctrlKey))return e.stopPropagation(),e.preventDefault(),a.forEach(function(e){return s(e,qc.b,{mode:qc.h,node:t.inputNode})}),!1;"-"===e.key?(e.stopPropagation(),a.length>0&&(a.forEach(function(e){return e.value=-e.value}),E.sequencerEngine.dispatch(Object(f.Eb)({})))):Object(nn.a)(e.key)&&(e.stopPropagation(),a.length>0&&(a.forEach(function(t){return t.value=parseInt(e.key)}),E.sequencerEngine.dispatch(Object(f.Eb)({}))))}},[s,E.isSelected,u,l,n,m,a,r,c,p,h])},Ac=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.mouseSelection;return void 0===t?[]:u.a.createElement("rect",{className:"mouse-selection",x:t.x1,y:t.y1,width:t.x2-t.x1,fill:"red",opacity:.5,height:Math.abs(t.y2-t.y1)})}),Lc=n(154);function Fc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var zc=function(e){Object(xe.a)(n,e);var t=Fc(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props.oscillator,t=e.partials;return t?u.a.createElement("div",{className:"harmonics-editor"},"Harmonics Editor",t.slice(0,64).map(function(t,n){return u.a.createElement(Bc,{oscillator:e,i:n})})):u.a.createElement("div",null)}}]),n}(i.Component),Bc=function(e){Object(xe.a)(n,e);var t=Fc(n);function n(e){var a;Object(Pe.a)(this,n);var r=(a=t.call(this,e)).props.oscillator.partials[a.props.i];return a.state={value:r},a}return Object(Ne.a)(n,[{key:"onChange",value:function(e){var t=Object(d.a)(this.props.oscillator.partials);t[this.props.i]=e,this.props.oscillator.partials=t,this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.props.oscillator.partials[this.props.i];return u.a.createElement("div",{className:"partial-editor"},u.a.createElement("div",{className:"partial-number"},this.props.i+1),u.a.createElement(be.a,{value:t,change:function(t){return e.onChange(t.target.value)},step:.01,max:8,min:0,orientation:"horizontal",reversed:!1}))}}]),n}(i.Component),_c=zc;function Hc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Uc=function(e){Object(xe.a)(n,e);var t=Hc(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={showHarmonics:!1},a}return Object(Ne.a)(n,[{key:"showHarmonics",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({showHarmonics:e})}},{key:"getSelectedOscillatorType",value:function(){return this.props.oscillator.oscillatorType}},{key:"onSelectOscillatorType",value:function(e){var t="none"===e.value?void 0:e.value;this.props.sequencerEngine.operationManager.dispatch(Object(dt.v)(this.props.oscillator.oscillatorTypeParameter,t)),this.setState(this.state)}},{key:"render",value:function(){var e,t=this,n=this.props.oscillator,a=this.props.instrument;return n.isInitialized()?this.state.showHarmonics&&"custom"===n.oscillatorType?u.a.createElement("div",{className:"oscillator-component"},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(_c,{oscillator:n}),u.a.createElement("div",{onClick:function(){return t.showHarmonics(!1)},className:"harmonics-button"},"Done Editing")):u.a.createElement("div",{className:"oscillator-component"},u.a.createElement("div",{className:"osc-type-dropdown-container"},u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:Gc,onChange:function(e){return t.onSelectOscillatorType(e)},value:(e=this.getSelectedOscillatorType(),Gc.filter(function(t){return t.value===e})[0]),placeholder:"Osc. Type"})),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{automation:this.props.automation,name:"Volume",parameter:n.oscillatorLevelParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,isParameter:!0,min:0,max:1,step:.01}),u.a.createElement(Fa.a,{automation:this.props.automation,name:"Frequency",sequencerEngine:this.props.sequencerEngine,parameter:n.oscillatorFrequencyParameter,onParameterChanged:function(){return a.releaseAll()},displayFunction:function(e){return Lc.a.fromTranspose(e).toString()},isParameter:!0,min:-32,max:32,step:1}),u.a.createElement(Fa.a,{automation:this.props.automation,name:"Detune",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:n.detuneParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}),u.a.createElement(He.a,{condition:"custom"===n.oscillatorType},u.a.createElement("div",{onClick:function(){return t.showHarmonics()},className:"harmonics-button"},"Edit Harmonics"))):u.a.createElement("div",null)}}]),n}(i.Component),Gc=[{value:"square",label:"Square"},{value:"sine",label:"Sine"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"},{value:"pwm",label:"PWM"},{value:"pulse",label:"Pulse"},{value:"custom",label:"Custom"}];var Wc=Object(m.b)(function(e,t){return{type:t.oscillator.oscillatorType}},null)(Uc),Vc=n(368);function Xc(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Kc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kc(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Kc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Qc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Yc=function(e){Object(xe.a)(n,e);var t=Qc(n);function n(e){var a;Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a.options=[].concat(Jc);var r,c=Xc(Vc.a);try{for(c.s();!(r=c.n()).done;){var o=r.value;a.options.push({label:o,value:o})}}catch(s){c.e(s)}finally{c.f()}return a.options.push({label:"Custom",value:"custom"}),a}return Object(Ne.a)(n,[{key:"getOscillatorOption",value:function(e){return this.options.find(function(t){return t.value===e})}},{key:"getSelectedOscillatorType",value:function(){return this.props.oscillator.customOscillatorType||this.props.oscillator.oscillatorType}},{key:"onSelectOscillatorType",value:function(e){var t="none"===e.value?void 0:e.value,n=this.props.oscillator.oscillatorTypeParameter;Vc.a.indexOf(t)>-1&&(n=this.props.oscillator.customOscillatorTypeParameter),"custom"===t?this.props.oscillator.oscillatorType="custom":this.props.sequencerEngine.operationManager.dispatch(Object(dt.v)(n,t,!0)),this.setState(this.state)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",null,u.a.createElement("div",{className:"osc-type-dropdown-container"},u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.options,onChange:function(t){return e.onSelectOscillatorType(t)},value:this.getOscillatorOption(this.getSelectedOscillatorType()),placeholder:"Osc. Type"})))}}]),n}(i.Component),Jc=[{value:"square",label:"Square"},{value:"sine",label:"Sine"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"},{value:"pwm",label:"PWM"},{value:"pulse",label:"Pulse"},{value:"fatsquare",label:"Fat Square"},{value:"fatsine",label:"Fat Sine"},{value:"fattriangle",label:"Fat Triangle"},{value:"fatsawtooth",label:"Fat Sawtooth"},{value:"fmsquare",label:"FM Square"},{value:"fmsine",label:"FM Sine"},{value:"fmtriangle",label:"FM Triangle"},{value:"fmsawtooth",label:"FM Sawtooth"}],Zc=Object(m.b)(function(e,t){return{type:t.oscillator.oscillatorType,customType:t.oscillator.customOscillatorType}},null)(Yc),$c=n(884),eo=new h.a,to=function(e){return e.oscillatorNodes.map(function(t){return e.adjacencyLists[t.id].filter(function(e){return["C","B1","B2","A"].includes(e.effect.name)}).length>0?1:.1})},no=(Object(m.b)(function(e,t){var n=t.instrument.oscillatorNodes;if(!n)return{};var a=n[0],r=n[1],c=n[2],o=n[3],s=e.effects.effectParameters;return{h1:s[a.harmonicityParameter.id],h2:s[r.harmonicityParameter.id],h3:s[c.harmonicityParameter.id],h4:s[o.harmonicityParameter.id],m1:s[a.modulationIndexParameter.id],m2:s[r.modulationIndexParameter.id],m3:s[c.modulationIndexParameter.id],m4:s[o.modulationIndexParameter.id],hd1:a.harmonicityParameter.depth,hd2:r.harmonicityParameter.depth,hd3:c.harmonicityParameter.depth,hd4:o.harmonicityParameter.depth,md1:a.modulationIndexParameter.depth,md2:r.modulationIndexParameter.depth,md3:c.modulationIndexParameter.depth,md4:o.modulationIndexParameter.depth,algo:t.instrument.algorithmParameter.get(!0)}},function(e){return{setSelectedZObject:function(t){return e(Object(f.ne)(t))}}})(function(e){var t=e.hd1,n=e.hd2,a=e.hd3,r=e.hd4,l=e.md1,f=e.md2,m=e.md3,p=e.md4,d=e.algo,h=e.color,b=e.instrument,v=e.h1,g=e.h2,E=e.h3,O=e.h4,y=e.m1,k=e.m2,j=e.m3,C=e.m4,S=(e.setSelectedZObject,e.selectedOscillator),w=Object(i.useState)(void 0),P=Object(s.a)(w,2),N=P[0],x=P[1];return Object(i.useEffect)(function(){!b.fmShader||N?b.track.subSequence.loadSubPatch("fm-harmonicity-mod-22").then(function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("LOADED SUB PATCH=",t),console.log(t),t.hide(),b.fmShader=t,t.doNotSave=!0,n=b.track;case 6:if(!(t.effect.inletObjects.length<4)){e.next=11;break}return e.next=9,Object(Ve.a)(20);case 9:e.next=6;break;case 11:a=eo.getColorForHash(n.presetName||n.id),console.log("COLOR FOR HASH=",a),t.effect.inletObjects[0].execute(a),t.effect.inletObjects[3].execute(to(b)),x(t);case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()):x(b.fmShader)},[x]),Object(i.useEffect)(function(){N&&(N.width=244,N.height=140)},[N]),Object(i.useEffect)(function(){N&&N.effect.inletObjects[3].execute(to(b))},[N,d]),Object(i.useEffect)(function(){if(N){for(var e=[l,f,m,p],c=[],o=0;o<4;o++){var s=e[o];b.oscillatorNodes[o].modulationIndexParameter.isConnectedToAnyModulator()?c.push(s):c.push(0)}for(var i=[t,n,a,r],u=[],d=0;d<4;d++){var h=i[d];b.oscillatorNodes[d].harmonicityParameter.isConnectedToAnyModulator()?u.push(h):u.push(0)}N.effect.inletObjects[5].execute(u),N.effect.inletObjects[6].execute(c)}},[N,l,f,m,p,t,n,a,r]),Object(i.useEffect)(function(){N&&N.effect.inletObjects[4].execute(S+1)},[N,S]),Object(i.useEffect)(function(){if(N){var e=[v,g,E,O],t=[y,k,j,C];N.effect.inletObjects[1].execute(e),N.effect.inletObjects[2].execute(t)}},[y,k,j,C,v,g,E,O,N]),Object(i.useEffect)(function(){if(N){var e=b.track,t=eo.getColorForHash(e.presetName||e.id);N.effect.inletObjects[0].execute(t)}},[N,h]),N?u.a.createElement($c.a,{zobject:N,forceShow:!0}):""}),Object(m.b)(function(e,t){return{algorithm:t.instrument.algorithmParameter.get()}},function(e){return{}})(function(e){var t=e.instrument,n=e.algorithm,a=(e.onChange,Object(i.useCallback)(function(e){var n=e.value;t.algorithmParameter.set(n)},[])),r=[1,2,3,4,5,6,7,8,9].map(function(e){return{label:e,value:e}});return u.a.createElement(vn.a,{element:t.algorithmParameter,className:"algo-container"},u.a.createElement("div",{className:"algo-label"},"Algorithm:"),u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:r,onChange:function(e){return a(e)},value:{label:n,value:n},placeholder:"Algorithm"}))}));new h.a;window.fmColor="#0c3545",window.fmGuideColor="#66d6ff",window.selectedFMColor="#46aaff";var ao=Object(i.memo)(function(e){var t=Object(i.useRef)(void 0),n=e.innerHeight||136,a=e.height||140,r=Object(i.useCallback)(function(t){return e.harmonicity/20*242},[e.harmonicity]),c=Object(i.useCallback)(function(t){return a=e.modulation,n-Math.sqrt(a)/15*n;var a},[e.modulation]),o=(Object(i.useCallback)(function(){e.oscillator;return e.oscillator,e.osc,[]},[e.harmonicity,e.modulation,e.osc,e.oscillator]),e.oscillator);if(void 0===e.instrument.oscillators)return[];var s=e.osc,l=r(s),f=c(s);return Object(i.useEffect)(function(){t.current.setAttribute("transform","translate(".concat(l,", ").concat(f,")"))},[l,f]),u.a.createElement("g",{className:o===s?"selected fm-group":"fm-group",ref:t},u.a.createElement(ro,{selected:o===s,osc:s,height:a,color:e.color,setDraggingOsc:function(t){e.setDraggingOsc(t),t?e.setParameterSliderDown([e.osc.harmonicityParameter,e.osc.modulationIndexParameter]):(e.setParameterSliderDown([]),e.osc.harmonicityParameter.automation.isRecording&&(e.osc.harmonicityParameter.automation.smoothen(),e.osc.modulationIndexParameter.automation.smoothen()))}}))}),ro=Object(i.memo)(function(e){var t=e.osc,n=e.setDraggingOsc,a=e.color,r=e.height,c=e.selected;return[c?u.a.createElement("line",{className:"operator-line",key:1,x1:0,y1:-r,x2:0,y2:r,strokeWidth:1,stroke:window.fmGuideColor}):"",c?u.a.createElement("line",{className:"operator-line",key:2,x1:-242,y1:0,x2:242,y2:0,strokeWidth:1,stroke:window.fmGuideColor}):"",u.a.createElement("circle",{key:3,onMouseDown:function(e){return n(t)},onMouseUp:function(e){n(void 0)},cx:0,cy:0,className:c?"selected fm-circle":"fm-circle",r:t.instrument.adjacencyLists[t.id].filter(function(e){return["C","B1","B2","A"].includes(e.effect.name)}).length>0?13:10,fill:a,strokeWidth:1}),u.a.createElement("text",{key:4,onMouseDown:function(e){return n(t)},className:c?"selected fm-text":"fm-text",onMouseUp:function(e){n(void 0)},fontSize:10,fontFamily:"Arial",x:1===t.name.length?-3:-6,y:4},t.name)]}),co=Object(m.b)(function(e,t){if(void 0===t.instrument.oscillators)return{};var n=e.effects.effectParameters;return{harmonicity:n[t.osc.harmonicityParameter.id],modulation:n[t.osc.modulationIndexParameter.id],algorithm:t.instrument.algorithmParameter.get(!0)}},function(e){return{setParameterSliderDown:function(t){return e(Object(f.ld)(t))},setContextualHelp:function(t,n){return e(Object(f.hb)(t,n))}}})(ao);function oo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}window.fmColor="#0c3545",window.fmGuideColor="#66d6ff",window.selectedFMColor="#86fcf7";var so=140,io=136,uo=[2,4,6,8,10,12,14,16,18],lo=[1,10,20,60,120,240,480,800,900],fo=function(e){Object(xe.a)(n,e);var t=oo(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={dragging:!1},a.ref=u.a.createRef(),a.innerHeight=a.props.innerHeight||io,a.height=a.props.innerHeight||so,a}return Object(Ne.a)(n,[{key:"draggingOsc",set:function(e){this.dragging=e,e&&this.props.setSelectedOsc(e)}},{key:"updateParameter",value:function(e,t){this.props.sequencerEngine.operationManager.dispatch(Object(dt.v)(e,t))}},{key:"harmonicity",get:function(){return this.props.harmonicity},set:function(e){var t=this.props.oscillator;t&&t.harmonicityParameter.get(!0)!==e&&this.updateParameter(t.harmonicityParameter,e)}},{key:"modulationIndex",get:function(){return this.props.modulationIndex},set:function(e){var t=this.props.oscillator;t&&t.modulationIndexParameter.get(!0)!==e&&this.updateParameter(t.modulationIndexParameter,e)}},{key:"getHarmonicityXPosition",value:function(e){return e/20*242}},{key:"getHarmonicityX",value:function(e){return this.getHarmonicityXPosition(e.harmonicityParameter.get())}},{key:"getModulationIndexYPosition",value:function(e){return this.innerHeight-Math.sqrt(e)/15*this.innerHeight}},{key:"getModulationIndexY",value:function(e){return this.getModulationIndexYPosition(e.modulationIndexParameter.get())}},{key:"getHelperLines",value:function(){var e=this.props.oscillator;return this.props.oscillator?[u.a.createElement("line",{x1:this.getHarmonicityX(e),y1:0,x2:this.getHarmonicityX(e),y2:this.innerHeight,strokeWidth:1,stroke:window.fmGuideColor}),u.a.createElement("line",{x1:0,y1:this.getModulationIndexY(e),x2:242,y2:this.getModulationIndexY(e),strokeWidth:1,stroke:window.fmGuideColor})]:[]}},{key:"getHarmonicityLines",value:function(){var e=this;return uo.map(function(t,n){return u.a.createElement("line",{key:n,className:"fm-guide-line",x1:e.getHarmonicityXPosition(t),y1:0,x2:e.getHarmonicityXPosition(t),y2:e.innerHeight,strokeWidth:1,stroke:window.fmColor})})}},{key:"getModulationIndexLines",value:function(){var e=this;return lo.map(function(t,n){return u.a.createElement("line",{key:n,className:"fm-guide-line",x1:0,y1:e.getModulationIndexYPosition(t),x2:242,y2:e.getModulationIndexYPosition(t),strokeWidth:1,stroke:window.fmColor})})}},{key:"convertXY",value:function(e,t){var n=this.ref.current.getBoundingClientRect();return[e-n.left,t-n.top]}},{key:"onMouseMove",value:function(e){if(this.dragging){var t=this.convertXY(e.clientX,e.clientY),n=Object(s.a)(t,2),a=n[0],r=n[1];this.setXAndY(a,r)}}},{key:"setXAndY",value:function(e,t){var n=Math.floor(20*e/242*1e3)/1e3;this.harmonicity=Math.round(4*n)/4,this.modulationIndex=Math.pow(Math.max(0,Math.floor(15e3*(this.innerHeight-t)/this.innerHeight)/1e3),2)}},{key:"render",value:function(){var e=this,t=this.props.oscillator,n=this.props.instrument.oscillatorNodes;if(void 0===n)return[];t&&(n=[].concat(Object(d.a)(n.filter(function(e){return e!==t})),[t]));this.props.instrument.oscillatorNodes.indexOf(t);return u.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()}},u.a.createElement(no,{onChange:this.props.onChangeAlgorithm,instrument:this.props.instrument}),u.a.createElement("div",{draggable:"true",onDragStart:function(e){return e.preventDefault()}},u.a.createElement("svg",{ref:this.ref,id:"harmonicity-mod-"+this.props.instrument.id,className:"harmonicity-mod",onMouseMove:function(t){return e.onMouseMove(t)},onClick:function(t){return e.setXAndY.apply(e,Object(d.a)(e.convertXY(t.clientX,t.clientY)))},onMouseLeave:function(t){return e.draggingOsc=void 0},width:242,height:this.innerHeight},n.map(function(t,n){return u.a.createElement(co,{key:t.name,color:e.props.color,height:e.height,innerHeight:e.innerHeight,osc:t,setDraggingOsc:function(t){return e.draggingOsc=t},dragging:e.dragging,setSelectedOsc:e.props.setSelectedOsc,instrument:e.props.instrument,oscillator:e.props.oscillator})}))))}}]),n}(i.Component),mo=Object(m.b)(null,function(e){return{setParameterSliderDown:function(t){return e(Object(f.ld)(t))}}})(fo),po=(new h.a,Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.setSelectedNode,n=e.oscillator,a=e.sequencerEngine,r=e.instrument,c=e.color;return u.a.createElement("div",{className:"fm-operator-component"},u.a.createElement(mo,{color:c,setSelectedOsc:t,oscillator:n,sequencerEngine:a,instrument:r}))})),ho=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){return u.a.createElement("div",{className:"text-xl p-5 text-center"},"Zen")}),bo=n(265),vo=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine;return console.log(t.faustParameters),console.log("FREEVERB"),u.a.createElement("div",null,"fuck",t.faustParameters.map(function(e){return u.a.createElement(Fa.a,{name:"Fold",sequencerEngine:n,root:4,lfoEnabled:!0,parameter:e,isParameter:!0,step:.01,max:e.max,min:e.min})}))}),go=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.effect;return u.a.createElement("div",null,u.a.createElement(Fa.a,{name:"Fold",sequencerEngine:t,root:4,lfoEnabled:!0,parameter:n.foldParameter,isParameter:!0,step:.01,max:1,min:0}),u.a.createElement(Fa.a,{name:"Offset",sequencerEngine:t,root:4,lfoEnabled:!0,parameter:n.offsetParameter,isParameter:!0,step:.01,max:1,min:0}),u.a.createElement(Fa.a,{name:"Low Pass",sequencerEngine:t,root:4,lfoEnabled:!0,parameter:n.lowpassParameter,isParameter:!0,step:.01,max:1,min:0}))}),Eo=n(1314),Oo=n(285),yo=n(204),ko=n(903),jo=n(258),Co=Object(m.b)(function(e,t){return{pendingTransactions:e.transactions.pendingTransactions}},function(e){return{}})(function(e){var t=e.content,n=e.pendingTransactions,a=e.setTagSelected,r=e.onTag,c=e.tagSelected,o=Object(i.useRef)(void 0),l=Object(i.useState)(""),f=Object(s.a)(l,2),m=f[0],p=f[1],h=Object(i.useState)(t.tags),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useCallback)(function(e){p(e.target.value)},[p]);Object(i.useEffect)(function(){g(t.tags)},[g,t.ipfsHash,n]),Object(i.useEffect)(function(){a||o.current.focus()},[]);var O=Object(i.useCallback)(function(){""!==m.trim()&&(t.newTag(m),g([].concat(Object(d.a)(v),[m])),p(""),r&&r(m))},[t.ipfsHash,m,v,g,p,r]),y=Object(i.useCallback)(function(e){"Enter"===e.key?O():"ArrowDown"!==e.key&&"ArrowUp"!==e.key||o.current.blur()},[O,r]);return u.a.createElement("div",{className:"tags-info"},u.a.createElement("div",{className:"tags-container"},v.map(function(e){return u.a.createElement("div",{onClick:function(){return a?a(e===c?void 0:e):""},className:e===c?"sample-tag selected":c?"sample-tag disabled":"sample-tag"},e)}),u.a.createElement(Fn.a,{sizeUnit:"px",size:10,color:"#42f4f1",loading:n>0})),u.a.createElement("div",{className:"tagger-container"},u.a.createElement("input",{ref:o,onKeyDown:y,placeholder:"Type new tag",onChange:E,value:m,type:"text",className:"sample-tagger"}),u.a.createElement("div",{onClick:O,className:"tag-button"},"Tag")))}),So=n(259),wo=function(e){var t=e.type,n=e.contentHash,a=e.disabled,r=Object(i.useState)(void 0),c=Object(s.a)(r,2),o=c[0],u=c[1],l=Object(i.useCallback)(function(e){e.stopPropagation(),We.a.xanadu.rateSound(n,o?0:5,t),u(!o)},[u,n,o,t]);return Object(i.useEffect)(function(){if(!a){var e=!1;return _e.a.getAccount().then(function(a){return a&&We.a.xanadu.getSoundRating(n,t,a).then(function(t){e||u(5===t)})}),function(){return e=!0}}},[u,n,t,a]),{toggleFavorite:l,isFavorited:o}},Po=n(844),No=new h.a,xo=Object(m.b)(function(e,t){return{}},function(e){return{setCreatingNewPack:function(t){return e(Object(f.jb)(t))}}})(function(e){var t=e.setPackToSearch,n=e.setCreatingNewPack,a=e.dropdownPos,r=e.setDropdownPos,c=e.type,o=void 0===c?So.f:c,l=e.isUnsourced,f=e.setIsSourcing,m=e.setIsTagging,h=e.content,b=e.contentHash,v=e.createNewTrack,g=wo({type:o,contentHash:b,disabled:!a}),E=g.toggleFavorite,O=g.isFavorited,y=Object(i.useState)([]),k=Object(s.a)(y,2),j=k[0],C=k[1],S=function(e,t,n,a){var r=Object(i.useState)([]),c=Object(s.a)(r,2),o=c[0],u=c[1],l=Object(i.useCallback)(function(){},[e]);return Object(i.useEffect)(function(){t&&Object(ko.b)(e).then(u)},[e,t]),{createNewPack:l,addToPack:Object(i.useCallback)(function(e){var t=e.packHash,r=e.title;n&&n.packs.push(r),p.a.getJson(t).then(function(r){var c=r.samples||[],o=r.presets||[];n&&(c=[].concat(Object(d.a)(c),[n.getId()])),a&&(o=[].concat(Object(d.a)(o),[a.contentHash])),Object(ko.c)(e.title,r.description,c,o,t)})},[n,a]),packsIncludedIn:o}}(b,a,o===So.f?h:void 0,(So.b,h)),w=(S.createNewPack,S.addToPack),P=S.packsIncludedIn;Object(i.useEffect)(function(){a?window.addEventListener("mousedown",N):window.removeEventListener("mousedown",N)},[r,a]);var N=Object(i.useCallback)(function(){r(void 0)},[r]);if(Object(i.useEffect)(function(){a&&Object(ko.a)().then(C)},[a,C]),!a)return[];var x=j.filter(function(e){return P.some(function(t){return t.packHash===e.packHash})}),q=j.filter(function(e){return!P.some(function(t){return t.packHash===e.packHash})}),T=[].concat(Object(d.a)(x),Object(d.a)(q)),M=[];T.forEach(function(e){M.some(function(t){return t.title===e.title})||M.push(e)}),T=M;var R=o===So.f?" sample":" preset";return u.a.createElement("div",{onClick:function(e){return e.stopPropagation()},style:{left:a.x,top:a.y},className:"sample-dropdown"},u.a.createElement("div",{onMouseDown:E,className:"menu-item"},O?"Unfavorite"+R:"Favorite"+R," ",u.a.createElement("div",{className:O?"heart favorited":"heart"})),u.a.createElement("div",{onMouseDown:function(){return m(!0)},className:"menu-item"},"Tag ",R),l?u.a.createElement("div",{onMouseDown:function(){return f(!0)},className:"menu-item"},"Edit Source"):"",u.a.createElement("div",{onMouseDown:v,className:"menu-item"},"Create New Track"),u.a.createElement("div",{className:"menu-item"},"Add to pack ",u.a.createElement("div",{className:"arrow-right"}),u.a.createElement("div",{className:"packs sample-dropdown"},u.a.createElement("div",{onClick:function(e){return e.stopPropagation()},onMouseDown:function(e){n(h)},className:"menu-item new-pack"},"+ New Pack"),T.map(function(e){return u.a.createElement("div",{onClick:function(e){return e.stopPropagation()},onMouseDown:function(t){P.some(function(t){return t.packHash===e.packHash})||w(e),r(void 0)},className:"menu-item"},u.a.createElement("div",{style:{backgroundColor:No.getColorForHash(e.title)},className:"pack-thumb"}),u.a.createElement("div",{className:"pack-title"},e.title),u.a.createElement(Po.a,{className:"guilds-checkmark",condition:P.some(function(t){return t.packHash===e.packHash})}))}))),x.length>0?u.a.createElement("div",{className:"packs-included-in"},x.map(function(e){return u.a.createElement("div",{onClick:function(e){return e.stopPropagation()},onMouseDown:function(){t(e)},className:"menu-item"},u.a.createElement("div",{style:{backgroundColor:No.getColorForHash(e.title)},className:"pack-thumb"}),u.a.createElement("div",{className:"pack-title"},e.title),u.a.createElement(Po.a,{className:"guilds-checkmark",condition:P.some(function(t){return t.packHash===e.packHash})}))})):"")}),qo=["pad","Synth","piano","string","guitar","organ","harm","clap","tom","rim","flute","snare","bass","perc","bazz","hi-hat","kick","lead","key","rhodes","poly","koto","pluck"];function To(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Mo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mo(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Mo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ro=new h.a,Do=function(e){var t,n=e.preset,a=n.title.toLowerCase(),r=n.tags,c=void 0,o=To(qo);try{var s=function(){var e=t.value;a.includes(e)?c=e:r.some(function(t){return t.includes(e)})&&(c=e)};for(o.s();!(t=o.n()).done;)s()}catch(l){o.e(l)}finally{o.f()}!c&&r.length>0&&(c=r[0]);var i=c?Ro.getColorForHash(c):"gray";return u.a.createElement("div",{style:{borderBottomColor:i},className:"preset-type"})},Io=(Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.contentHash,n=e.type,a=e.hideIfUnfavorited,r=void 0!==a&&a,c=wo({contentHash:t,type:n}),o=c.toggleFavorite,s=c.isFavorited;return r&&!s||!t?[]:u.a.createElement("div",{onClick:function(e){e.stopPropagation(),o(e)},className:s?"favorite-button heart favorited":"favorite-button heart"})}),new h.a),Ao=["koto","perc","hi-hat","kick","snare","clap","poly","mellotron","clavinet","arp","bass","bells","drums","flute","guitar","keys","lead","organ","pad","piano","pluck","stab","strings","rhodes","electric-piano"],Lo=function(e){return e=e.toLowerCase(),Ao.filter(function(t){return e.includes(t)})},Fo=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.scrollRef,n=e.currentPreset,a=e.preset,r=e.setPresetDragging,c=e._auditionPreset,o=e.type,l=(void 0===o&&So.b,e.isPianoRoll),f=Object(i.useState)(void 0),m=Object(s.a)(f,2),p=m[0],h=m[1],b=a.packs,v=Object(i.useState)(!1),g=Object(s.a)(v,2),E=g[0],O=g[1],y=Object(i.useRef)(void 0);!function(e){var t=e.subtractContainer,n=e.mouseDown,a=e.scrollRef,r=e.isCurrent,c=e.ref,o=e.expanded,s=e.topOffset,u=void 0===s?180:s,l=e.skipBottom,f=void 0!==l&&l;Object(i.useEffect)(function(){if((!n||!n.current)&&r&&a&&a.current&&c.current){var e=a.current.scrollTop,o=a.current.offsetHeight,s=c.current.offsetTop+80;t&&(s-=a.current.getBoundingClientRect().top);var i=c.current.offsetHeight,l=i>o?s+(o-150):s+i;s<e+u?a.current.scrollTop-=e+u-s:!f&&l>e+o&&(a.current.scrollTop+=l-(e+o))}},[r,o])}({isCurrent:n&&a.contentHash===n.contentHash,ref:y,scrollRef:t,subtractContainer:!0,topOffset:20});var k=Object(i.useCallback)(function(e){e.stopPropagation();var t=e.clientX-y.current.getBoundingClientRect().left,n=e.clientY-y.current.getBoundingClientRect().top;t>200&&(t-=200),l&&(t=e.clientX,n=e.clientY),t=Math.max(0,t),h({x:t,y:n}),e.preventDefault()},[h,l]),j=a.contentHash===n.contentHash?"preset-option selected":"preset-option";p&&(j+=" showing-dropdown");var C=[].concat(Object(d.a)(a.tags),Object(d.a)(Lo(a.title)));return u.a.createElement("div",{onContextMenu:k,ref:y},u.a.createElement(vn.a,{element:bn.c,draggable:!0,onDragStart:function(){return r(a)},onClick:function(e){e.ctrlKey||c(a)},className:j},u.a.createElement(xo,{setIsTagging:O,dropdownPos:p,setDropdownPos:h,type:So.b,content:a,setPackToSearch:function(){return[]},contentHash:a&&a.contentHash}),u.a.createElement(Do,{preset:a}),u.a.createElement("span",{className:"preset-name"},a.title&&a.title.trim()," "),Array.from(new Set(b)).map(function(e){return u.a.createElement("div",{style:{color:"red",backgroundColor:Io.getColorForHash(e)},className:"pack-thumb"})}),u.a.createElement("span",{className:"preset-tags"},C.map(function(e,t){return u.a.createElement("span",{key:t,className:"preset-tag"},e)})),a.favorited?u.a.createElement("div",{className:"favorited heart"}):""),E?u.a.createElement(Co,{content:(new jo.a).fromJson(a,!1),onTag:function(e){a.tags.push(e),O(!1)}}):"")}),zo=n(334),Bo=new h.a,_o=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.isPianoRoll,n=e.pack,a=e.instrumentType,r=e.filterFavorites,c=e.guildId,o=e.scrollRef,l=e.content,f=e._auditionPreset,m=e.setPresetDragging,p=e.searchTerm,d=Object(i.useState)(!1),h=Object(s.a)(d,2),b=h[0],v=h[1],g=Object(i.useState)([]),E=Object(s.a)(g,2),O=E[0],y=E[1];Object(i.useEffect)(function(){v(!(!p||""===p))},[p,v]),Object(i.useEffect)(function(){b&&Object(zo.b)(void 0,a,[],c,void 0,r,n.matchingContent).then(function(e){y(e)})},[b,y,n]);var k=Bo.getColorForHash(n.title),j={};return j.backgroundColor=k,u.a.createElement("div",{className:"pack-presets"},u.a.createElement("div",{onClick:function(){return v(!b)},className:"pack-header"},u.a.createElement("div",{style:j,className:"pack-thumb"}),u.a.createElement("div",{className:"pack-name"},n.title)),b?O.map(function(e,n){return u.a.createElement(Fo,{key:n,isPianoRoll:t,preset:e,scrollRef:o,currentPreset:l,setPresetDragging:m,_auditionPreset:f})}):"")});function Ho(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Uo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uo(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Go=0,Wo=function(e){var t=e.type,n=e.guildId,a=e.filterFavorites,r=e.track,c=e.searchTerm,o=e.groupByPacks,u=e.setGroupByPacks,l=Object(i.useState)(void 0),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useState)([]),h=Object(s.a)(d,2),b=h[0],v=h[1],g=Object(i.useState)([]),E=Object(s.a)(g,2),O=E[0],y=E[1],k=Object(i.useState)([]),j=Object(s.a)(k,2),C=j[0],S=j[1],w=Object(i.useState)(t),P=Object(s.a)(w,2),N=P[0],x=P[1];return N&&(N.startsWith("zobject")||"formants"===N)&&(o=!1),Object(i.useEffect)(function(){(t.startsWith("zobject")||"formants"===t||"SAMPLER"===t)&&u(!1)},[t]),Object(i.useEffect)(function(){if(t===jt.f){S(["bass","bells","drums","flute","guitar","keys","lead","organ","pad","piano","pluck","stab","strings"])}else{S(["bass","flute","korg","keys","moog","pad","prophet","piano","vibraphone"])}},[S,t]),Object(i.useEffect)(function(){if(o){var e=++Go;setTimeout(function(){e===Go&&function(e,t,n){return new Promise(function(a){fetch("/packSearch/",{method:"POST",body:JSON.stringify({searchTerm:e,includeContent:t,contentType:n}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){a(e)})})}(c,!0,"PRESET").then(function(t){if(e===Go){p(c);var n,a={},r=Ho(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;a[o.title]=o}}catch(s){r.e(s)}finally{r.f()}v(Object.keys(a).map(function(e){return a[e]}))}})},200)}},[c,p,v,o,y,N,a,n]),Object(i.useEffect)(function(){var e=!1;return o||Object(zo.b)(void 0,N,[],n,N===jt.f?8359897:9055421,a).then(function(t){e||(r&&(r.browsedPresets=t),y(t))}),function(){return e=!0}},[a,N,y,n,o]),Object(i.useEffect)(function(){x(t)},[t,x]),{presetsByPack:b,presets:O,instrumentType:N,tags:C,setInstrumentType:x,searchTermExecuted:m}},Vo=n(838),Xo=n(425),Ko=(jt.h,M.c,jt.f,Object(m.b)(function(e,t){return{}},function(e){return{setSearchText:function(t){return e(Object(f.Kd)(t))}}})(function(e){var t=e.interpolation,n=e.type,a=(e.instrumentType,e.setInstrumentType,e.tags),r=e.setSearchTerm,c=e.setPresetsToShow,o=(e.searchTerm,e.onChange),s=(e.setSearchText,e.filterFavorites),l=e.setFilterFavorites,f=e.setGroupByPacks,m=e.groupByPacks;a.map(function(e){return{label:e,value:e}}),Object(i.useCallback)(function(e){console.log("_onChange=",e.value),o(void 0,e.value)},[o,r,c]);return u.a.createElement("div",{className:"presets-toolbar"},u.a.createElement("div",{onClick:function(){return l(!s)},className:s?"heart favorited":"heart"}),"SAMPLER"!==n&&u.a.createElement("div",{onClick:function(){return f(!m)},className:m?"packs-btn selected":"packs-btn"}),m&&u.a.createElement("div",{className:"packs-text"},"Packs"),"SAMPLER"!==n&&t&&u.a.createElement(Xo.a,{znumber:t,skipSelect:!0,unit:"%"}))})),Qo=(new(n(558).a),Object(m.b)(function(e,t){return{guildId:e.guilds.selectedGuild?e.guilds.selectedGuild.guildId:0,sampleExplorerSelected:e.selector.sampleExplorerSelected,isLoading:t.track&&t.track.trackIsLoading,explorerMaximized:e.selector.explorerMaximized,groupByPacks:e.presets.groupByPacks}},function(e){return{setGroupByPacks:function(t){return e(Object(f.Zb)(t))},setPresetDragging:function(t){return e(Object(f.Ed)(t))},setSampleExplorerSelected:function(t){return e(Object(f.Rd)(t))}}})(function(e){var t=e.track,n=e.content,a=e.isLoading,r=e.oscillator,l=e.setGroupByPacks,f=e.groupByPacks,m=e.explorerMaximized,p=e.children,d=e.type,h=void 0===d?jt.f:d,b=e.hideTags,v=void 0!==b&&b,g=(e.searchText,e.setPresetDragging),E=e.guildId,O=e.setSampleExplorerSelected,y=e.zobject,k=e.sampleExplorerSelected,j=e.initialSize,C=void 0===j?30:j,S=e.isPianoRoll,w=Object(i.useRef)(void 0),P=Object(i.useState)(!0),N=Object(s.a)(P,2),x=N[0],q=N[1],T=Object(i.useState)([]),M=Object(s.a)(T,2),R=M[0],D=M[1],I=Object(i.useState)(C),A=Object(s.a)(I,2),L=A[0],F=A[1],z=Object(i.useState)(""),B=Object(s.a)(z,2),_=B[0],H=B[1],U=it(w,L,!0,_).size,G=Object(i.useState)(!0),W=Object(s.a)(G,2),V=W[0],X=(W[1],Object(i.useState)(!1)),K=Object(s.a)(X,2),Q=K[0],Y=(K[1],Object(i.useState)(!1)),J=Object(s.a)(Y,2),Z=J[0],$=J[1],ee=Object(i.useState)(t&&t.subSequence&&function(e,t){var n=new Oo.a(e,yo.c);return n.round=!0,n._text=t,n.storedMessage=t,n}(t.subSequence,100)),te=Object(s.a)(ee,2),ne=te[0],ae=(te[1],Object(i.useState)(void 0)),re=Object(s.a)(ae,2),ce=re[0],oe=re[1],se=Object(i.useState)(void 0),ie=Object(s.a)(se,2),ue=ie[0],le=ie[1],fe=Wo({guildId:E,setGroupByPacks:l,filterFavorites:Z,type:h,track:t,searchTerm:_,groupByPacks:f}),me=fe.searchTermExecuted,pe=fe.presets,de=fe.tags,he=fe.instrumentType,be=fe.setInstrumentType,ve=fe.presetsByPack;Object(i.useEffect)(function(){Z&&l(!1)},[Z,l]),Object(i.useEffect)(function(){""!==_&&l(!1)},[_,l]),Object(i.useEffect)(function(){setTimeout(function(){if(w.current){var e=w.current.offsetHeight/15;F(e)}},100)},[w.current&&w.current.offsetHeight,F,m]),Object(i.useEffect)(function(){q(!a)},[a,q]),Object(Vo.a)({clear:function(){return O(!1)},selected:k}),Object(i.useEffect)(function(){return function(){return O(!1)}},[]);var ge=Object(i.useCallback)(function(){var e=Object(o.a)(c.a.mark(function e(n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(q(!1),!r){e.next=5;break}r.loadFormantsPreset(n),e.next=11;break;case 5:if(!t){e.next=10;break}return e.next=8,t.sequencerEngine.operationManager.dispatch(Object(dt.d)(n,t,V,!!t.sample||Q,ne._text));case 8:e.next=11;break;case 10:y&&le(n);case 11:q(!0);case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[r,le,y,t,Q,V,q]);Object(i.useEffect)(function(){ce&&(console.log("resolved dependencies =",ce),y.loadPreset(ce.preset,ce),le(!1))},[ce,le]),Object(i.useEffect)(function(){D(pe)},[pe,D]),Object(i.useEffect)(function(){t&&(t.browsedPresets=R)},[t,R]),Object(i.useEffect)(function(){if(!f){var e=_.toLowerCase();if(e.trim(),""===e)return void D(pe);D(pe.filter(function(t){return t.title.toLowerCase().includes(e)||t.tags.some(function(t){return t.toLowerCase().includes(e)})}))}},[f,_,D,pe]);var Ee=Object(i.useCallback)(function(e,t){var n=void 0===t&&e?e.target.value:t;H(n)},[H,D,pe]),Oe=Object(i.useCallback)(function(){H(""),D(pe)},[H,D,pe]),ye="sample-explorer";x||(ye+=" loading-bull-shit-fuck"),k&&(ye+=" selected");var ke=R.length;if(f&&(""!==_?ke=ve.reduce(function(e,t){return t.matchingContent.length+e},0):ke=ve.length),y&&""===_&&0===ke)return"";var je=R.slice(0,Math.floor(U));return u.a.createElement("div",{onMouseDown:function(e){O(!0)},className:y?"zobject-presets presets-explorer-container":"presets-explorer-container"},ue&&u.a.createElement(Eo.a,{hide:function(){return le(void 0)},zobject:y,preset:ue,setResolvedDependencies:oe}),u.a.createElement("div",{className:ye},p,u.a.createElement("div",{className:"explorer-top"},u.a.createElement("div",{className:"explorer-row"},u.a.createElement(Ko,{type:h,groupByPacks:f,setGroupByPacks:l,setFilterFavorites:$,filterFavorites:Z,setInstrumentType:be,interpolation:ne,instrumentType:he,setSearchTerm:H,setPresetsToShow:D,searchTerm:_,tags:de,onChange:Ee})),u.a.createElement("div",{className:"presets-search-container"},u.a.createElement("input",{value:_,type:"text",onChange:Ee,placeholder:y?"Search for presets":"Search for synths"}),u.a.createElement("div",{onClick:Oe,className:"search-clear-button"},"x"))),u.a.createElement("div",{ref:w,className:"presets-list"},f?ve.map(function(e,t){return u.a.createElement(_o,{searchTerm:me,guildId:E,content:n,setPresetDragging:g,scrollRef:w,_auditionPreset:ge,isPianoRoll:S,filterFavorites:Z,instrumentType:he,pack:e,key:e.packHash})}):je.map(function(e,t){return u.a.createElement(Fo,{key:t,isPianoRoll:S,preset:e,scrollRef:w,currentPreset:n,setPresetDragging:g,_auditionPreset:ge})}))),v?u.a.createElement("div",{className:"preset-tags-chooser"},de.map(function(e){return u.a.createElement(vn.a,{element:bn.o,arg:e,onClick:function(){return Ee(void 0,e===_?"":e)},className:_===e?"preset-tag selected ":"preset-tag"},e)})):"")})),Yo=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,a=e.track,r=e.onChange,c=e.onDelete,o=e.noSelect,s="";t&&(s=u.a.createElement(bp,{sequencerEngine:n,noSelect:o,track:a,compact:!0,instrument:!0,hideIOs:!0,onDeleteEffect:c,effect:t,send:void 0}));var l=Object(i.useCallback)(function(e){var t=Object(cr.b)(e.value,n);t.enable(!0),t.wetParameter&&t.wetParameter.set(1),r(t)},[r,n]);return u.a.createElement("div",null,u.a.createElement(D.a,{className:"send-effects-dropdown",options:Object(cr.a)(),onChange:l,option:t&&Object(cr.a)().find(function(e){return e.label===t.name}),placeholder:"Audio FX"}),s)}),Jo=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.formant,n=e.sequencerEngine,a=e.track,r=Object(i.useRef)(),c=Object(i.useState)(t.effect),o=Object(s.a)(c,2),l=o[0],f=o[1];Object(Da.a)(r),Object(i.useEffect)(function(){t&&f(t.effect)},[t]);var m=Object(i.useCallback)(function(e){t.useEffect(e),f(e)},[f,t]),p=Object(i.useCallback)(function(){f(void 0),t.bypassEffect()},[l,f,t]);return u.a.createElement("div",{onDragStart:function(e){e.stopPropagation(),e.preventDefault()},ref:r,className:"formant-effect"},u.a.createElement("div",{className:"sub-header"},"Formant ",t.number+1," FX"),u.a.createElement(Yo,{track:a,sequencerEngine:n,onDelete:p,noSelect:!0,effect:l,onChange:m}))}),Zo=n(613),$o=n(842);function es(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ts(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ts(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function ts(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ns=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.oscillator,n=e.width,a=e.height,r=Object(i.useRef)(),c=Object(i.useRef)();Object(i.useEffect)(function(){c.current=r.current.getContext("2d")},[]);var o=Object(i.useState)([]),l=Object(s.a)(o,2),f=l[0],m=l[1],p=Object(i.useCallback)(function(){for(var e=[],r=Array.from(t.formantsManager.analyser.getValue()),c=0;c<r.length;c++){var o=r[c],s=Object(Zo.a)(o,-160,0,1,a),i=44100*c/256,u=44100*(c+1)/246,l=Math.pow(i/44100,.5)*n,f=Math.pow(u/44100,.5)*n-l;l<n&&e.push({x:l,y:a-s,width:f,height:s})}m(e)},[m,n,a,t]);Object(i.useEffect)(function(){c.current&&window.requestAnimationFrame(d)},[f,n,a]);var d=Object(i.useCallback)(function(){var e=c.current;if(e&&r.current){e.clearRect(0,0,r.current.width,r.current.height);var t,n=es(f);try{for(n.s();!(t=n.n()).done;){var a=t.value,o=a.x,s=a.y,i=a.width,u=a.height;e.beginPath(),e.rect(o,s,i,u),e.fillStyle="#383838",e.fill()}}catch(l){n.e(l)}finally{n.f()}}},[f,n,a]);return Object($o.a)(p,100),u.a.createElement("canvas",{className:"formant-analyser",ref:r,width:n,height:a,style:{width:n,height:a}})}),as=[80,120,220,380,550,750,1e3,1200,1400,1800,2e3,2400,3e3,4e3,5e3,6e3,7e3,8e3,1e4,14e3,18e3],rs=[.25,.5,1,1.5,2,2.5,3,3,5],cs=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.width,n=e.height,a=function(e){return Math.sqrt(e/2e4)*t},r=function(e){var a=n-e/4*n;return 300===n&&(a-=t/200*10,a-=40),a};return u.a.createElement("svg",{className:"formants-helper",width:t,height:n},rs.map(function(e){return u.a.createElement("line",{className:"gain-helper",y1:r(e),x1:0,y2:r(e),x2:t})}),as.map(function(e){return u.a.createElement("line",{x1:a(e),y1:0,x2:a(e),y2:n})}))}),os=Object(i.memo)(function(e){var t=e.curve,n=e.width,a=e.height;return u.a.createElement("svg",{height:a,width:n},u.a.createElement("path",{d:t,className:"bandwidth-visualizer"}))}),ss=Object(m.b)(function(e,t){var n=t.formant.enabledParameter.get();return n?{enabled:n,currentStep:t.sequencerEngine.trackStep,frequency:t.formant.formantFrequencyParameter.get(!0),q:t.formant.formantQParameter.get(!0),gain:t.formant.formantGainParameter.get(!0)}:{enabled:n}},function(e){return{}})(function(e){var t=e.enabled,n=e.height,a=e.width,r=e.formant,c=Object(i.useRef)(void 0),o=r.formantFrequencyParameter.get(),s=r.formantQParameter.get(),l=r.formantGainParameter.get(),f=Math.sqrt(o/2e4)*a,m=n-l/4*n;r.enabledParameter.get();var p=o/(.5*s),d=Math.sqrt(p/2e4)*a/2,h=a/200*100,b=d/h,v=n,g=h-h/2,E=h+h/2,O=2*h,y=n,k="M ".concat(h-h," ").concat(v," C ").concat(g," ").concat(-10,", ").concat(E," ").concat(-10,", ").concat(O," ").concat(y);return Object(i.useEffect)(function(){if(c.current){var e=f-h;c.current.setAttribute("style","transform: translate(".concat(e,"px, ").concat(m,"px) scale(").concat(b,", 1)"))}},[f,m,b]),t&&r.isConnectedToAnyModulator()?u.a.createElement("div",{ref:c},u.a.createElement(os,{width:a,height:n,curve:k})):[]}),is=Object(m.b)(function(e,t){var n=t.formant.formantFrequencyParameter.id;return{frequency:Math.round(e.effects.effectParameters[n])}},function(e){return{}})(function(e){var t=e.height,n=(e.formant,e.frequency);return u.a.createElement("div",{style:{height:t.current||20},className:"dragging-formant-info"},n," hz")}),us=[{value:-12,label:"-12db"},{value:-24,label:"-24db"},{value:-48,label:"-48db"}],ls=Object(m.b)(function(e,t){return{rolloff:t.formant.rolloff}},function(e){return{}})(function(e){var t=e.formant,n=e.rolloff,a=Object(i.useCallback)(function(e){t.formantRolloffParameter.set(e.value)},[t]);return u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:us,onChange:a,value:us.find(function(e){return e.value===n}),placeholder:"Rate"})}),fs=[{value:"bandpass",label:"Bandpass"},{value:"lowpass",label:"Lowpass"},{value:"highpass",label:"Highpass"}],ms=Object(m.b)(function(e,t){return{type:t.formant.formantTypeParameter.get()}},function(e){return{}})(function(e){var t=e.formant,n=e.type,a=Object(i.useCallback)(function(e){t.formantTypeParameter.set(e.value)},[t]);return u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:fs,onChange:a,value:fs.find(function(e){return e.value===n}),placeholder:"Rate"})}),ps=Object(m.b)(function(e,t){return{showFormantEffect:e.instruments.showFormantEffect}},function(e,t){return{setShowFormantEffect:function(t){return e(Object(f.Ae)(t))}}})(function(e){var t=e.height,n=e.formant,a=e.setShowFormantEffect,r=e.showFormantEffect,c=Object(i.useRef)();return Object(i.useEffect)(function(){var e=n.sequencerEngine.state.instruments.showFormantEffect;n!==e&&e&&a(n)},[n]),Object(i.useEffect)(function(){t.current=c.current.offsetHeight},[n]),Object(i.useEffect)(function(){},[]),u.a.createElement("div",{ref:c,className:"formant-parameters"},u.a.createElement("div",{className:"inner"},u.a.createElement(Fa.a,{sequencerEngine:n.oscillator.sequencerEngine,name:"Frequency",parameter:n.formantFrequencyParameter,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,root:2,min:0,max:2e4,step:1}),u.a.createElement(Fa.a,{sequencerEngine:n.oscillator.sequencerEngine,name:"Q",parameter:n.formantQParameter,root:2,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,min:.1,max:50,step:.01})),u.a.createElement("div",{className:"inner"},u.a.createElement(Fa.a,{sequencerEngine:n.oscillator.sequencerEngine,name:"Gain",parameter:n.formantGainParameter,root:2,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,min:0,max:3.9,step:.01}),u.a.createElement(ls,{formant:n}),u.a.createElement(ms,{formant:n})),u.a.createElement("div",{onClick:function(){return a(r?void 0:n)},className:r?"fx-button show":"fx-button"},u.a.createElement("span",null,"FX")," ",n.effect?u.a.createElement("span",{className:"fx-name"},n.effect.name):""))}),ds=Object(i.memo)(function(e){var t=e.formant,n=e.width,a=e.height,r=e.setDraggingFormant,c=e.isSelected,o=e.frequency,s=e.q,l=e.gain,f=e.enabled,m=Object(i.useRef)(void 0),p=Object(i.useRef)(void 0),d=(Object(i.useRef)(void 0),Object(i.useRef)(0)),h="formant";f&&(h+=" enabled"),c&&(h+=" selected");var b=Object(i.useCallback)(function(){var e=(new Date).getTime();if(e-d.current<=400){var n=!t.enabledParameter.get();t.enabledParameter.set(n)}d.current=e,t.enabledParameter.get()&&r(t)},[t,r]),v=Object(i.useCallback)(function(){r(void 0)},[r]),g=o/(.5*s),E=Math.sqrt(g/2e4)*n/2,O=n/200*100,y=E/O,k=a+60,j=O-E/2,C=O+E/2,S=O+E,w=a+60,P="M ".concat(O-E," ").concat(k," C ").concat(j," ").concat(-10,", ").concat(C," ").concat(-10,", ").concat(S," ").concat(w);Object(i.useEffect)(function(){var e=Math.sqrt(o/2e4)*n,t=a-l/4*a;if(p.current){var r=e-8,c=t-8;p.current.style.transform="translate(".concat(r,"px, ").concat(c,"px)")}if(m.current){var s=e-O;300===a&&(t-=n/200*10,t-=40),m.current.style.transform="translate(".concat(s,"px, ").concat(t,"px)")}},[o,l,y,E,n,a]);var N="band-wrap";return c&&(N+=" selected"),f||(N+=" disabled"),[u.a.createElement("div",{key:1,className:N,ref:m},u.a.createElement(hs,{enabled:!0,width:n,height:a,curve:P,isSelected:c})),u.a.createElement("div",{className:c?"circle-wrap selected":"circle-wrap",key:2,ref:p},u.a.createElement(bs,{className:h,isSelected:c&&f,formant:t,onMouseDown:b,onMouseUp:v}))]}),hs=Object(i.memo)(function(e){var t=e.isSelected,n=e.curve,a=e.bandRef,r=e.width,c=e.height,o="bandwidth-svg";return e.enabled||(o+=" enabled"),u.a.createElement("svg",{className:o,height:c+60,width:r,ref:a},u.a.createElement("path",{d:n,className:t?"bandwidth selected":"bandwidth"}))}),bs=Object(i.memo)(function(e){var t=e.onMouseDown,n=e.onMouseUp,a=e.formant,r=(e.curve,e.isSelected),c=e.className;return u.a.createElement("svg",{className:r?"circle-svg selected":"circle-svg",width:16,height:16},u.a.createElement("circle",{onMouseDown:t,onMouseUp:n,className:c,cx:8,cy:8,r:8,strokeWidth:1,key:2}),u.a.createElement("text",{key:3,onMouseDown:t,onMouseUp:n,x:5,y:12}," ",a.number+1))}),vs=Object(m.b)(function(e,t){return{enabled:t.formant.enabledParameter.get(),frequency:t.formant.formantFrequencyParameter.get(!0,void 0,!0),q:t.formant.formantQParameter.get(!0,void 0,!0),gain:t.formant.formantGainParameter.get(!0,void 0,!0)}},function(e){return{}})(ds),gs=(n(2431),Object(m.b)(function(e,t){return{selectedParameter:e.effects.accumulatorParameterSelected,selectedFMFormant:e.instruments.selectedFMFormant,showFormantPresets:e.instruments.showFormantPresets}},function(e){return{setShowFormantEffect:function(t){return e(Object(f.Ae)(t))},setShowFormantPresets:function(t){return e(Object(f.Be)(t))},setShowingFormants:function(t){return e(Object(f.Xe)(t))},setEffectParameterValues:function(t){return e(Object(f.Eb)(t))}}})(function(e){var t=e.oscillator,n=e.selectedParameter,a=e.setShowingFormants,r=e.setShowFormantPresets,c=e.setShowFormantEffect,o=e.showFormantPresets,l=e.setEffectParameterValues,f=e.formantsExpanded,m=e.setFormantsExpanded,p=e.selectedFMFormant,d=e.width,h=void 0===d?f?470:200:d,b=e.height,v=void 0===b?f?300:100:b,g=Object(i.useRef)(void 0),E=Object(i.useRef)(void 0),O=t.formants,y=Object(i.useState)(void 0),k=Object(s.a)(y,2),j=k[0],C=k[1],S=Object(i.useState)(void 0!==P?t.formants[P]:void 0),w=Object(s.a)(S,2),P=w[0],N=w[1];Object(i.useEffect)(function(){if(void 0!==p){var e=t.formants[p];N(e),c(e)}},[p,N,t]),Object(i.useEffect)(function(){return a(!0),function(){a(!1),c(void 0)}},[]),Object(i.useEffect)(function(){return window.addEventListener("keydown",q),function(){return window.removeEventListener("keydown",q)}},[N,P,q]),Object(i.useEffect)(function(){return g.current.addEventListener("mousewheel",x,{passive:!1}),function(){g.current&&g.current.removeEventListener("mousewheel",x)}},[P]);var x=Object(i.useCallback)(function(e){if(e.preventDefault(),P){var t=e.deltaX,n=e.deltaY,a=(e.wheelDeltaX,e.wheelDeltaY),r={};if(Math.abs(t)>5){var c=P.formantFrequencyParameter.moveCoordinates(t/-10,0),o=c.id,s=c.value;r[o]=s}if(Math.abs(n)>5){var i=P.formantGainParameter.moveCoordinates(n/10,0),u=i.id,f=i.value;r[u]=f}else if(Math.abs(a)>4){var m=P.formantQParameter.moveCoordinates(a/-28,0),p=m.id,d=m.value;r[p]=d}Object.keys(r).length>0&&l(r)}},[P]),q=Object(i.useCallback)(function(e){if("Tab"===e.key&&P){var t=O.filter(function(e){return e.enabledParameter.get()}),n=t.indexOf(P);N(t[(n+1)%t.length])}},[N,P]);Object(i.useEffect)(function(){j&&P!==j&&(console.log("dragging formant=",j),N(j),c(j))},[j,N]),Object(i.useEffect)(function(){P&&t&&!t.formants.includes(P)&&(console.log("OSC CHANGED SO CLEARING FORMANT =",P),N(void 0))},[P,N,t]),Object(i.useEffect)(function(){n&&n.context&&n.context.formant&&N(n.context.formant)},[n,N]);var T=Object(i.useCallback)(function(e){if(j){var t=h,n=v,a=g.current.getBoundingClientRect(),r=e.clientX-a.left,c=e.clientY-a.top,o=2e4*Math.pow(r/t,2),s=j.formantGainParameter.originalMax*(n-c)/n;j.formantFrequencyParameter.set(o,!1),j.formantGainParameter.set(s,!1)}},[j,f,h,v]);return u.a.createElement("div",{className:"formants-editor"},u.a.createElement("div",{ref:g,onMouseDown:function(e){return e.stopPropagation()},style:{width:h,height:v},draggable:!0,onDragStart:function(e){return e.preventDefault()},onMouseMove:T,className:"formants-wrapper"},u.a.createElement("img",{onClick:function(e){return r(!o)},src:"/floppy-disk.svg",className:"pushable formant-presets-icon"}),u.a.createElement("img",{onClick:function(e){return m(!f)},src:"/expand-icon.svg",className:"pushable expand-formants-icon"}),u.a.createElement(cs,{width:h,height:v}),u.a.createElement(ns,{width:h,height:v,oscillator:t}),O.map(function(e,n){return u.a.createElement(ss,{key:n,isSelected:P===e,setDraggingFormant:C,sequencerEngine:t.track.sequencerEngine,width:h,height:v,formant:e})}),O.map(function(e,t){return u.a.createElement(vs,{key:t,isSelected:P===e,setDraggingFormant:C,width:h,height:v,formant:e})})),P&&!j?u.a.createElement(ps,{height:E,formant:P}):j?u.a.createElement(is,{height:E,formant:j}):"")})),Es=(n(2432),Object(m.b)(function(e,t){return{formant:e.instruments.showFormantEffect,showPresets:e.instruments.showFormantPresets}},function(e){return{}})(function(e){var t=e.showPresets,n=e.formant,a=e.effect,r=e.sequencerEngine,c=t?u.a.createElement(Qo,{isPianoRoll:!1,initialSize:10,oscillator:a,track:a,content:a.preset,searchText:"",type:"formants"}):n&&u.a.createElement(Jo,{sequencerEngine:a.sequencerEngine,formant:n});return u.a.createElement("div",{className:"multi-filter"},u.a.createElement("div",{className:"multi-inner"},u.a.createElement(gs,{width:300,height:150,oscillator:a}),c),u.a.createElement(Fa.a,{name:"Gain",sequencerEngine:r,lfoEnabled:!0,parameter:a.gainParameter,isParameter:!0,step:.1,max:6,min:.1}),u.a.createElement(bc.a,{sequencerEngine:r,effect:a}))})),Os=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){return u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:e.effectNumber,automation:e.automation,name:"Amount",selectedParameter:e.selectedParameter,sequencerEngine:e.sequencerEngine,lfoEnabled:!0,parameter:e.effect.amountParameter,isParameter:!0,onParameterChanged:e.onParameterChanged,step:.01,max:4,min:.01}))}),ys=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine;return u.a.createElement("div",null,u.a.createElement(Fa.a,{name:"Gain",sequencerEngine:n,lfoEnabled:!0,parameter:t.gainParameter,isParameter:!0,step:.1,max:6,min:.1}))}),ks=100,js=200;function Cs(e){var t=Object(i.useState)([]),n=Object(s.a)(t,2),a=n[0],r=n[1],c=void 0!==e.automation||e.effect.isEnabled();void 0!==e.automation||e.effect.isEnabled();if(Object($o.a)(function(){c&&r(Array.from(e.effect.getValue()))},100),!c)return u.a.createElement("div",null);return u.a.createElement("div",null,u.a.createElement(ka.h,{width:js,height:ks},u.a.createElement(ka.b,null,a.map(function(t,n){return function(t,n){t*=2;var a=Math.floor(js*n/e.effect.size),r=void 0,c=void 0;return t<0?(r=ks/2,c=Math.abs(t)*ks/2):(r=ks/2-t*ks/2,c=t*ks/2),{x:a,y:r,height:c,width:3}}(t,n)}).map(function(e,t){return u.a.createElement(ka.g,{perfectDrawEnabled:!1,key:t,x:e.x,y:e.y,width:e.width,height:e.height,fill:"red"})}))))}function Ss(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var ws=function(e){Object(xe.a)(n,e);var t=Ss(n);function n(e){return Object(Pe.a)(this,n),t.call(this,e)}return Object(Ne.a)(n,[{key:"handleOptionChange",value:function(e){this.props.effect.setSideChainedTrack(this.props.tracks[e],e)}},{key:"getSideChainedTrack",value:function(){var e=this.props.effect.connectedTrack;return void 0===e?0:this.props.tracks.indexOf(e)+1}},{key:"getOptions",value:function(){return this.props.sequencerEngine.tracks.map(function(e){return{label:"Track "+(e.trackNumber+1),value:e.trackNumber}})}},{key:"getOption",value:function(e){if(void 0!==e)return this.getOptions().filter(function(t){return t.value===e.trackNumber})[0]}},{key:"render",value:function(){var e=this;void 0!==this.props.automation||this.props.effect.isEnabled();return u.a.createElement("div",null,this.props.effect.isEnabled()?u.a.createElement("div",null,u.a.createElement("div",{className:"sidechain-container"},u.a.createElement("div",{className:"parameter-label"},"Sidechain: "),u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.getOptions(),onChange:function(t){return e.handleOptionChange(t.value)},value:this.getOption(this.props.effect.connectedTrack),placeholder:"None"})),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Smoothing",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.smoothingParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1e-4,max:2,min:1e-5}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Threshold",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.thresholdParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:6,min:-120})):"")}}]),n}(i.Component),Ps=n(255),Ns=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=(e.scrollContainer,e.sequencerEngine),a=e.effectNumber;return u.a.createElement("div",null,u.a.createElement(Cr.a,{parameter:t.overSampleParameter,name:"Oversample"}),u.a.createElement(Fa.a,{effectNumber:a,name:"Drive",sequencerEngine:n,lfoEnabled:!0,parameter:t.driveParameter,isParameter:!0,step:.01,max:32,min:.01}),u.a.createElement(Ra,{group:t}))});function xs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var qs=function(e){Object(xe.a)(n,e);var t=xs(n);function n(e){return Object(Pe.a)(this,n),t.call(this,e)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this,t=void 0!==this.automation?"enabled effect effect-automation":"effect enabled";return u.a.createElement("div",{className:t},u.a.createElement("div",{className:"effect-name"},"Pan"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"parameter-box"},u.a.createElement(be.a,{value:this.props.panning,change:function(t){return e.props.onChangePanning(t.target.value)},step:.01,max:1,min:-1,orientation:"horizontal",reversed:!1})))}}]),n}(i.Component);var Ts=Object(m.b)(function(e,t){return{value:t.effect.type}},null)(function(e){var t=e.effect,n=e.value,a=[{label:"Lowpass",value:"lowpass"},{label:"Highpass",value:"highpass"},{label:"Bandpass",value:"bandpass"},{label:"Allpass",value:"allpass"},{label:"Notch",value:"notch"},{label:"Peaking",value:"peaking"}],r=Object(i.useCallback)(function(e){t.type=e},[]);return u.a.createElement("div",{className:"filter-dropdown-container"},u.a.createElement("div",{className:"dropdown-label"},"Type: "),u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:a,onChange:function(e){return r(e.value)},value:function(e){return a.find(function(t){return t.value===e})}(n),placeholder:"Type"}))});function Ms(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Rs=function(e){Object(xe.a)(n,e);var t=Ms(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={filterEffect:e.filterEffect,refined:!1},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.filterEffect=e.filterEffect,!0}},{key:"handleOptionChange",value:function(e){document.activeElement.blur(),"lowpass"===e.target.value?this.state.filterEffect.lowpass():this.state.filterEffect.hipass(),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.filterEffect.isEnabled()}},{key:"onChangeRefined",value:function(e){this.setState({refined:"refined"===e})}},{key:"render",value:function(){var e=this,t=(this.state.filterEffect.type,void 0!==this.props.automation||this.state.filterEffect.isEnabled(),this.state.refined?400:1e4);return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Ts,{effect:this.props.filterEffect}),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{customClassName:"wider-slider",effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Cutoff",lfoEnabled:!0,root:2,sequencerEngine:this.props.sequencerEngine,unit:"HZ",parameter:this.state.filterEffect.cutoffParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1,max:t,min:20}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,root:2,name:"Q",lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,parameter:this.state.filterEffect.qParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:10,min:0}),u.a.createElement("div",{className:""},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:this.state.refined?"unrefined":"refined",checked:this.state.refined,onChange:function(t){return e.onChangeRefined(t.target.value)}}),"Refine"))):"")}}]),n}(i.Component);function Ds(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Is=function(e){Object(xe.a)(n,e);var t=Ds(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={filterEffect:e.filterEffect,frequency:e.filterEffect.getStoredLFOTime()},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.filterEffect=e.filterEffect,!0}},{key:"handleOptionChange",value:function(e){"lowpass"===e.target.value?this.state.filterEffect.lowpass():this.state.filterEffect.hipass(),this.setState(this.state)}},{key:"handleLFOTimeChange",value:function(e){this.state.frequency=e,this.state.filterEffect.setLFOTime(e()),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.filterEffect.isEnabled()}},{key:"render",value:function(){var e=this,t=this.state.filterEffect.getFilterType();this.state.filterEffect.getLFOTime(),void 0!==this.props.automation||this.state.filterEffect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement("form",null,u.a.createElement("div",{className:"radio"},u.a.createElement("label",null,u.a.createElement("input",{className:"filter-radio",type:"radio",value:"lowpass",checked:"lowpass"===t,onChange:function(t){return e.handleOptionChange(t)}}),"Lowpass"),u.a.createElement("label",null,u.a.createElement("input",{className:"filter-radio",type:"radio",value:"hipass",checked:"highpass"===t,onChange:function(t){return e.handleOptionChange(t)}}),"Hipass"),u.a.createElement(D.a,{className:"delay-time-dropdown",options:As,onChange:function(t){return e.handleLFOTimeChange(t.value)},value:Ls(this.state.frequency),placeholder:"Delay Time"}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Cutoff",unit:"HZ",parameter:this.state.filterEffect.effectNode.baseFrequency,onParameterChanged:this.props.onParameterChanged,updateFunction:function(t){return e.state.filterEffect.effectNode.baseFrequency=t},getValue:function(){return e.state.filterEffect.effectNode.baseFrequency},step:5,max:1e4,min:10}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Octaves",parameter:this.state.filterEffect.effectNode.octaves,updateFunction:function(t){return e.state.filterEffect.effectNode.octaves=t},onParameterChanged:this.props.onParameterChanged,getValue:function(){return e.state.filterEffect.effectNode.octaves},step:.1,max:10,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Q",parameter:this.state.filterEffect.qParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1,max:10,min:0})))):"")}}]),n}(i.Component),As=[{value:function(){return.03125*new ke.a.Time("1m")},label:"4"},{value:function(){return.125*new ke.a.Time("1m")},label:"2"},{value:function(){return.25*new ke.a.Time("1m")},label:"1"},{value:function(){return.5*new ke.a.Time("1m")},label:"1/2"},{value:function(){return.5*new ke.a.Time("2m")},label:"1/4"},{value:function(){return 2*new ke.a.Time("1m")},label:"1/8"},{value:function(){return 3*new ke.a.Time("1m")},label:"1/8t"},{value:function(){return 4*new ke.a.Time("1m")},label:"1/16"},{value:function(){return 6*new ke.a.Time("1m")},label:"1/16t"},{value:function(){return 8*new ke.a.Time("1m")},label:"1/32"}];function Ls(e){e="function"===typeof e?e():e;var t=As.filter(function(t){return t.value()===e});return 0==t.length?As[0]:t[0]}var Fs=Is;function zs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Bs=function(e){Object(xe.a)(n,e);var t=zs(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={reverbEffect:e.reverbEffect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.reverbEffect=e.reverbEffect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.reverbEffect.isEnabled()}},{key:"render",value:function(){Math.round(10*this.state.reverbEffect.getRoomSize()),this.state.reverbEffect.getDampening(),this.state.reverbEffect.getWet(),void 0!==this.props.automation||this.state.reverbEffect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Room Size",parameter:this.state.reverbEffect.roomSizeParameter,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:1,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Dampening",lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,parameter:this.state.reverbEffect.dampeningParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:100,max:8e3,min:0}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.reverbEffect})):"")}}]),n}(i.Component),_s=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine;return u.a.createElement("div",null,u.a.createElement(Fa.a,{parameter:t.frequencyParameter,min:1,lfoEnabled:!0,max:240,name:"Frequency",sequencerEngine:n,isParameter:!0}))}),Hs=n(818);function Us(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Gs=function(e){Object(xe.a)(n,e);var t=Us(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){return u.a.createElement(ka.g,{x:this.props.start,y:0,width:this.props.end-this.props.start,height:this.props.height,fill:"yellow"})}}]),n}(i.Component),Ws=Object(m.b)(function(e,t){return void 0===e.selector.waveformSelection?{}:e.selector.waveformSelection.id!==t.sampleId?{}:{start:e.selector.waveformSelection.start,end:e.selector.waveformSelection.end}},null)(Gs);function Vs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Xs=function(e){Object(xe.a)(n,e);var t=Vs(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={isPlaying:!1,x:0},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.isPlaying!==this.state.isPlaying&&(this.state.isPlaying=e.isPlaying,e.isPlaying?this.startTicker():clearInterval(this.timer)),!0}},{key:"startTicker",value:function(){var e=this;this.timer=setInterval(function(){var t=new Date,n=(1e3*e.props.startOffsetTime+(t-e.props.startTime))%(1e3*e.props.duration);e.setState({x:e.props.width*n/(1e3*e.props.duration)/2})},50)}},{key:"render",value:function(){return this.props.isPlaying?u.a.createElement(ka.e,{x:this.state.x,y:0,points:[this.state.x,0,this.state.x,this.props.height],strokeWidth:1,stroke:"red",fill:"red"}):u.a.createElement(ka.e,null)}}]),n}(i.Component),Ks=function(e,t){var n=[];for(var a in e)n.push(e[a].x),n.push(e[a][t]);return n},Qs=n(279),Ys=n(603);function Js(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}window.waveformFillColor="#130e2e9c";var Zs=new h.a,$s=new Ys.a(325,50),ei=function(e){Object(xe.a)(n,e);var t=Js(n);function n(e){var a;Object(Pe.a)(this,n),(a=t.call(this,e)).state={audioUnit:e.audioUnit,buffer:e.audioUnit.buffer,x:0,isPlaying:!1,pts:[],coloredPoints:[]},a.dragging=!1,a.width=e.width||325,a.height=e.height||50,a.width===$s.width&&a.height===$s.height||($s=new Ys.a(a.width,a.height)),a.state.pts=[];Object(Cn.a)(a);return a.computeWaveformInChunks(),a.convertSpaceToSeconds.bind(Object(Cn.a)(a)),a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){if(this.props.buffer!==e.buffer||this.props.id!==e.id){this.state.buffer=e.buffer;return this.computeWaveformInChunks(),!0}return this.dragging||this.state.isPlaying||this.state.pts!==t.pts||this.state.coloredPoints!==t.coloredPoints||this.props.slices!==e.slices}},{key:"computeWaveformInChunks",value:function(e){var t=this;if(void 0===this.state.buffer)return[];this.state.buffer.duration<3?$s.getBasicWaveform(this.props.sample.getId(),this.state.buffer,!1).then(function(e){e=Ks(e,"rmsY"),t.setState({pts:e,coloredPoints:[]})}):$s.getWaveform(this.props.sample.getId(),this.state.buffer,!1).then(function(e){t.setState({pts:[],coloredPoints:e})})}},{key:"stopSound",value:function(){this.state.audioUnit.stopSound(),this.setState({isPlaying:!1})}},{key:"playSound",value:function(e,t){var n=e.state.audioUnit;if(e.state.isPlaying)e.stopSound();else{e.setState(e.state),e.state.isPlaying=!0;var a=e.convertSpaceToSeconds(t);n.playSound(a);var r=new Date;this.setState({startOffsetTime:a,startTime:r})}}},{key:"convertSpaceToSeconds",value:function(e){return this.state.audioUnit.buffer.duration*e/this.width}},{key:"convertSecondsToSpace",value:function(e){return e/this.state.audioUnit.buffer.duration*this.width}},{key:"startDrag",value:function(e,t){if(document.activeElement.blur(),t=t.evt,e.draggin)e.dragging=!1;else{if(e.playSound(e,t.offsetX),void 0!==e.props.sample){var n={start:t.offsetX,end:t.offsetX,id:e.props.id||e.props.sample.getId()};e.props.setWaveformSelection(n)}e.dragging=!0}if(void 0!==this.props.slices){var a=this.getSliceFromCoordinate(t.offsetX);this.props.onSelectSlice(a)}}},{key:"getSliceFromCoordinate",value:function(e){var t=this.convertSpaceToSeconds(e),n=this.props.slices.filter(function(e){return e.startTime<=t&&e.endTime>=t});return 0==n.length?void 0:n[0]}},{key:"moveDrag",value:function(e,t){if(e.dragging){if(e.props.setWaveformSelectionEnd(t.evt.layerX),void 0===this.props.sequencerEngine)return;var n=this.props.sequencerEngine.store.getState(),a=this.convertSpaceToSeconds(n.selector.waveformSelection.start),r=this.convertSpaceToSeconds(t.evt.layerX);void 0!==this.props.onChooseSlice&&a<r&&this.props.onChooseSlice({startTime:a,endTime:r})}}},{key:"endDrag",value:function(e){this.dragging=!1,this.stopSound()}},{key:"isCurrentChord",value:function(e){var t=this.props.selectedChordSample;return void 0!==this.props.sample&&void 0!==t&&(this.props.sample.ipfsHash===t.sampleHash&&e.startTime===t.startTime&&e.endTime===t.endTime)}},{key:"render",value:function(){var e=this,t=this.state.pts;void 0===this.props.slices||this.props.slices;if(void 0===this.props.audioUnit)return u.a.createElement("div",null,"Fetching sample...");var n=Zs.getColorForHash(this.props.sample.getId());return u.a.createElement("div",null,u.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(bn.W)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:"sound-waveform details-view"},u.a.createElement(ka.h,{onMouseDown:function(t){return e.startDrag(e,t)},onMouseUp:function(t){return e.endDrag(e,t)},onMouseMove:function(t){return e.moveDrag(e,t)},width:isNaN(this.width)?1:this.width,height:this.height},u.a.createElement(m.a,{store:this.props.store||this.props.sequencerEngine.store},u.a.createElement(ka.d,null,u.a.createElement(ka.g,{x:0,y:0,width:isNaN(this.width)?1:this.width,height:this.height,fill:window.waveformFillColor}),u.a.createElement(Ws,{height:this.height,sampleId:this.props.id||(void 0!==this.props.sample?this.props.sample.getId():0)})),u.a.createElement(ka.d,null,this.state.coloredPoints.length>0?this.state.coloredPoints.map(function(e,t){return u.a.createElement(ka.g,{key:"point-"+t,x:e.x,y:e.y,width:e.width,height:e.height,fill:"rgb("+e.rgb[0]+","+e.rgb[1]+","+e.rgb[2]+")"})}):u.a.createElement(ka.e,{bezier:!0,points:t,stroke:n,strokeWidth:2})),u.a.createElement(ka.d,null,u.a.createElement(Xs,{startTime:this.state.startTime,isPlaying:this.state.isPlaying,duration:this.state.audioUnit.buffer&&this.state.audioUnit.buffer.duration,startOffsetTime:this.state.startOffsetTime,width:isNaN(this.width)?1:this.width,height:this.height}))))))}}]),n}(i.Component),ti=Object(m.b)(function(e,t){return{selectedChordSample:e.selector.selectedChordSample}},function(e){return{dragSample:function(t){return e(Object(f.i)(t))},setWaveformSelection:function(t){return e(Object(f.gg)(t))},setWaveformSelectionEnd:function(t){return e(Object(f.hg)(t))},setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(ei);Object(m.b)(function(e,t){return{convolverSample:t.effect.convolverSample,buffer:t.effect.effectNode.buffer,pitch:t.effect.pitch,attack:t.effect.attack,duration:t.effect.duration}},function(e){return{}})(function(e){var t=e.effect,n=e.convolverSample,a=e.pitch,r=e.duration,c=e.attack,o=Object(i.useRef)(0),l=Object(i.useState)(n+a+r+c),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useState)(new Hs.a),h=Object(s.a)(d,2),b=h[0];h[1];Object(i.useEffect)(function(){o.current=o.current+1;var e=o.current;setTimeout(function(){console.log("c = %s counter=%s",e,o.current),e===o.current&&t.effectNode.buffer&&(console.log("setting buffer =",t.effectNode.buffer._buffer),p(n+r+a+c+e))},100)},[n,p,t.effectNode.buffer,a,r,c]),b.setBuffer(t.effectNode.buffer._buffer);var v=new Ct.a(m);return u.a.createElement(ti,{audioUnit:b,sequencerEngine:t.sequencerEngine,buffer:t.effectNode.buffer,id:m,sample:v,width:180,height:30})});function ni(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var ai=function(e){Object(xe.a)(n,e);var t=ni(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={reverbEffect:e.reverbEffect},a.getConvolverType(),a.getConvolverThumbnail(),a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return e.reverbEffect!==this.props.reverbEffect&&(this.state.reverbEffect=e.reverbEffect,this.getConvolverType(),this.getConvolverThumbnail()),e.sample!==this.props.sample&&(this.getConvolverType(),this.getConvolverThumbnail()),!0}},{key:"handleConvolverTypeChange",value:function(e){this.state.reverbEffect.setConvolverType(e),this.getConvolverType(),this.getConvolverThumbnail(),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.isEnabled}},{key:"getConvolverThumbnail",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.reverbEffect).convolverSample){e.next=10;break}return n=new Ct.a(t.convolverSample),e.next=5,n.load(!1);case 5:if(void 0!==(a=n.getThumbnail())&&""!==a){e.next=9;break}return this.setState({thumbnail:void 0}),e.abrupt("return");case 9:this.setState({thumbnail:a});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getConvolverType",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.reverbEffect).convolverSample){e.next=9;break}return e.next=4,We.a.getTitleForSound(t.convolverSample);case 4:n=e.sent,this.state.convolverType={label:n,value:t.convolverSample},this.setState(this.state),e.next=13;break;case 9:a=ri.filter(function(e){return e.value===t.convolverType}),this.state.convolverType=a[0],this.state.thumbnail=void 0,this.setState(this.state);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"upload",value:function(e){var t=this,n=new FileReader;e.name.includes(".wav")||e.name.includes(".flac")||e.name.includes(".mp3")?(n.readAsArrayBuffer(e),n.onloadend=Object(o.a)(c.a.mark(function e(){var a,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.result,e.next=3,p.a.addArrayBuffer(a);case 3:return r=e.sent,console.log("CONVOLVER HASH = ",r),e.next=7,t.props.reverbEffect.setConvolverSample(r);case 7:return e.next=9,t.getConvolverType();case 9:return e.next=11,t.getConvolverThumbnail();case 11:case"end":return e.stop()}},e)}))):window.alert("Only accepts .wav, .mp3, & .flac files for now")}},{key:"onDrop",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),t.preventDefault(),t.dataTransfer.effectAllowed="none",t.dataTransfer.dropEffect="none",t.dataTransfer.items)for(t.dataTransfer.items.length,n=0;n<t.dataTransfer.items.length;n++)"file"===t.dataTransfer.items[n].kind&&this.upload(t.dataTransfer.items[n].getAsFile());if(!this.props.sampleDragging){e.next=14;break}return t.stopPropagation(),e.next=9,this.props.reverbEffect.setConvolverSample(this.props.sampleDragging.getId());case 9:return e.next=11,this.getConvolverType();case 11:return e.next=13,this.getConvolverThumbnail();case 13:this.props.setSampleDragging(void 0);case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;this.state.reverbEffect.getWet(),void 0!==this.props.automation||this.state.reverbEffect.isEnabled();return u.a.createElement("div",{onDrop:function(t){return e.onDrop(t)}},this.isEnabled()?u.a.createElement("div",null,u.a.createElement("div",{className:"convolver-type"},this.state.convolverType?this.state.convolverType.label:""),u.a.createElement(He.a,{condition:this.state.thumbnail},u.a.createElement("img",{className:"convolver-thumbnail",src:this.state.thumbnail})),u.a.createElement("div",{className:"convolver-row"},u.a.createElement(Ps.a,{scrollContainer:this.props.scrollContainer,min:-24,max:24,name:"Pitch",parameter:this.state.reverbEffect.pitchParameter}),u.a.createElement(Ps.a,{scrollContainer:this.props.scrollContainer,min:0,max:100,name:"Start",parameter:this.state.reverbEffect.startParameter}),u.a.createElement(Ps.a,{scrollContainer:this.props.scrollContainer,min:0,max:100,name:"Attack",parameter:this.state.reverbEffect.attackParameter}),u.a.createElement(Ps.a,{scrollContainer:this.props.scrollContainer,min:.5,max:100,name:"Release",parameter:this.state.reverbEffect.durationParameter})),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.reverbEffect})):"")}}]),n}(i.Component),ri=[{value:"Giant Cave",label:"Giant Cave"},{value:"Hangar",label:"Airport Hangar"},{value:"Airport Terminal",label:"Airport Terminal"},{value:"Outdoor Blastoff",label:"Outdoor Blastoff"},{value:"Outdoor Stadium",label:"Outdoor Stadium"},{value:"Plate Large",label:"Plate Large"},{value:"Plate Medium",label:"Plate Medium"},{value:"Plate Small",label:"Plate Small"},{value:"Plate Super Dry",label:"Plate Super Dry"},{value:"Prime Long",label:"Prime Long"},{value:"Prime Medium",label:"Prime Medium"},{value:"Prime Short",label:"Prime Short"},{value:"Prime Extra Long",label:"Prime Extra Long"},{value:"Room Concert Hall",label:"Room Concert Hall"},{value:"Room Huge",label:"Room Huge"},{value:"Room Large",label:"Room Large"},{value:"Room Medium",label:"Room Medium"},{value:"Room Pool",label:"Room Pool"}],ci=Object(m.b)(function(e,t){return{sampleDragging:e.selector.sampleDragging,isEnabled:t.reverbEffect.enabledParameter.get(),sample:t.reverbEffect.convolverSample,preset:t.reverbEffect.preset}},function(e,t){return{setSampleDragging:function(t){return e(Object(f.Qd)(t))}}})(ai);function oi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var si=function(e){Object(xe.a)(n,e);var t=oi(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={chorusEffect:e.chorusEffect},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.chorusEffect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.chorusEffect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Rate",selectedParameter:this.props.selectedParameter,parameter:this.state.chorusEffect.rateParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,isParameter:!0,step:.01,max:12,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Depth",selectedParameter:this.props.selectedParameter,parameter:this.state.chorusEffect.depthParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,isParameter:!0,step:.1,max:3,min:0}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.chorusEffect})):"")}}]),n}(i.Component);function ii(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var ui=function(e){Object(xe.a)(n,e);var t=ii(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={tremoloEffect:e.tremoloEffect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.tremoloEffect=e.tremoloEffect,!0}},{key:"handleDepthChange",value:function(e){this.state.tremoloEffect.setDepth(e),this.setState(this.state)}},{key:"handleRateChange",value:function(e){this.state.tremoloEffect.setRate(e),this.setState(this.state)}},{key:"handleWetChange",value:function(e){this.state.tremoloEffect.setWet(e),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.tremoloEffect.isEnabled()}},{key:"render",value:function(){var e=this;Math.round(10*this.state.tremoloEffect.getRate()),this.state.tremoloEffect.getDepth(),this.state.tremoloEffect.getWet(),void 0!==this.props.automation||this.state.tremoloEffect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Rate",selectedParameter:this.props.selectedParameter,displayFunction:function(t){return Math.round(10*e.state.tremoloEffect.getRate())/10},lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,onParameterChanged:this.props.onParameterChanged,parameter:this.state.tremoloEffect.rateParameter,isParameter:!0,step:.1,max:16,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Depth",selectedParameter:this.props.selectedParameter,parameter:this.state.tremoloEffect.depthParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,isParameter:!0,step:.1,max:1,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Spread",selectedParameter:this.props.selectedParameter,parameter:this.state.tremoloEffect.spreadParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,isParameter:!0,step:1,max:360,min:0}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,onParameterChanged:this.props.onParameterChanged,effect:this.state.tremoloEffect})):"")}}]),n}(i.Component),li=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect;e.sequencerEngine;return u.a.createElement("div",null,u.a.createElement(Fa.a,{name:"Attack",parameter:t.attackParameter,isParameter:!0,step:.01,max:4,min:-4}),u.a.createElement(Fa.a,{name:"Sustain",parameter:t.sustainParameter,isParameter:!0,step:.01,max:.5,min:0}),u.a.createElement(Fa.a,{name:"Output Gain",parameter:t.outputGainParameter,isParameter:!0,step:.01,max:2,min:0}))}),fi=n(611),mi=n(381),pi=(n(2433),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.instrument,a=n.getParametersByGroup(!1),r=[n.ampEnvelope,n.filterEnvelope];return console.log("groups",a),console.log("envs",r),u.a.createElement("div",{className:"flex w-96 flex-wrap rnbo-instrument"},u.a.createElement("div",{className:"flex "},r.filter(function(e){return e}).map(function(e){return u.a.createElement(mi.a,{name:e.name,hasRelease:!0,showLevel:!0,hasLevel:e.hasLevel,sequencerEngine:t,envelope:e})})),Object.keys(a).map(function(e){return u.a.createElement("div",{className:"parameter-group"},u.a.createElement("div",{className:"group-name"},e),u.a.createElement("div",{className:"group-parameters"},a[e].map(function(e){return u.a.createElement(Fa.a,{name:e.name,sequencerEngine:t,lfoEnabled:!0,parameter:e,isParameter:!0,step:.001,max:e.max,min:e.min})})))}))})),di=40;function hi(e,t,n,a,r,c){var o=c.current.getBoundingClientRect(),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,a=arguments.length>3?arguments[3]:void 0,r=(e=Math.min(Math.max(0,e),a))/a,c=Math.pow(r,.5);return t+(n-t)*c}(e.clientX-o.left,n,a,r);return isNaN(s)?-100:s}function bi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,a=arguments.length>3?arguments[3]:void 0,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;return(e-t)/(n-t)}(e,t,n,a);return a*Math.pow(r,2)+4}var vi=Object(m.b)(function(e,t){return void 0===t.track?{}:{volume:t.track.volumeParameter.get()}},null)(function(e){var t=e.track,n=e.rackTrack,a=e.volume,r=e.id,c=e.onVolumeChange,o=e.min,l=void 0===o?-40:o,f=e.max,m=void 0===f?4:f,p=e.width,d=void 0===p?di:p,h=e.display,b=(e.onVolumeChange2,Object(i.useState)(!1)),v=Object(s.a)(b,2),g=v[0],E=v[1],O=Object(i.useRef)(void 0),y={width:bi(a,l,m,d)},k=function(){return r||"volume-"+n.trackNumber+"-"+t.trackNumber},j=Object(i.useCallback)(function(e){e.stopPropagation();var n=hi(e,k(),l,m,d,O);c?c(n):t.volumeParameter.set(n,!0),E(!0)},[t,E]),C=Object(i.useCallback)(function(e){if(e.stopPropagation(),g){var n=hi(e,k(),l,m,d,O);c?c(n):t.volumeParameter.set(n)}},[t,g]),S=function(e){return Math.round(10*e)/10};return u.a.createElement("div",{ref:O,style:{width:d+6},id:k(),onClick:function(e){return e.stopPropagation()},onMouseUp:function(e){e.stopPropagation(),E(!1)},onMouseLeave:function(e){e.stopPropagation(),E(!1)},onMouseMove:C,onMouseDown:j,className:"volume-box"},u.a.createElement("div",{style:y,className:"volume-indicator"}),u.a.createElement("span",{className:"value"},S(h?h(a):a)," db"))}),gi=new h.a,Ei=Object(m.b)(function(e,t){var n=t.track.track;return{id:void 0!==n.sample&&void 0!==n.sample.getId()?n.sample.getId():n.presetName||n.getName()}},null)(function(e){e.showMods;var t=e.name,n=e.rackTrack,a=e.track,r=e.onSelect,c=e.isSelected,o=e.onDelete,s=(e.id,"track-slot"),i={};return c&&(s+=" selected",i.backgroundColor=gi.getColorForTrack(a.track)),t.length>16&&(t=t.substring(0,16)+"..."),u.a.createElement("div",{onClick:r,className:s,style:i},u.a.createElement("div",{className:"sub-instrument-name"},t),u.a.createElement(vi,{rackTrack:n,track:a}),u.a.createElement(He.a,{condition:c},u.a.createElement("div",{onClick:o,className:"delete-button"},"x")))}),Oi=(n(2434),n(592)),yi=function(e){return e===Oi.a?"Mix":"Sends Only"},ki=Object(m.b)(function(e,t){return{outputType:t.track.outputTypeParameter&&t.track.outputTypeParameter.get()}},null)(function(e){var t=e.track,n=e.outputType,a=e.className,r=Object(i.useCallback)(function(e){var n=e.value;t.outputTypeParameter.set(n)},[]),c=[{value:Oi.a,label:"Mix"},{value:Oi.b,label:"Sends Only"}],o={value:n,label:yi(n)};return u.a.createElement("div",{className:"track-output-type"},u.a.createElement("div",{className:"track-output-type-label"},"Audio To"),u.a.createElement(D.a,{className:a||"osc-type-dropdown float-left",controlClassName:a||"osc-type-control-dropdown",arrowClassName:a||"osc-type-arrow-dropdown",options:c,onChange:r,value:o,placeholder:"Audio To"}))});n(68);function ji(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Ci=function(e){Object(xe.a)(n,e);var t=ji(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"handleSendVolumeChange",value:function(e){this.props.setParameterSliderDown(this.parameter),this.props.track.setSendVolume(this.props.sendNumber,e,!1)}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"parameter",get:function(){return this.props.track.sendNodeVolumeParameters[this.props.sendNumber]}},{key:"onMouseUp",value:function(e){this.props.isMacroMapping&&(e.stopPropagation(),this.parameter.isMapped||this.props.setParameterToMap(this.parameter)),this.props.setParameterSliderDown(void 0),this.parameter.automation.smoothen(),this.parameter.mixAutomation.smoothen()}},{key:"render",value:function(){var e=this,t=0===this.props.sendNumber?bn.gb:bn.hb,n="enabled effect track-send";return this.props.isMacroMapping&&(n+=" plane-mapping"),this.props.send?u.a.createElement("div",{onMouseUp:function(t){return e.onMouseUp(t)},onMouseOver:function(n){return e.setContextualHelp(n,t)},onMouseLeave:function(){e.props.setContextualHelp(void 0)},className:n},u.a.createElement("div",{className:"effect-name"},this.props.send.getName()),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"parameter-box"},u.a.createElement(be.a,{value:this.props.volume,change:function(t){return e.handleSendVolumeChange(t.target.value)},slideStop:this.mouseDown,step:.1,max:3,min:-70,orientation:"horizontal",reversed:!1}))):""}}]),n}(i.Component),Si=Object(m.b)(function(e,t){var n=t.track;return{volume:void 0!==n?n.sendNodeVolumeParameters[t.sendNumber].get():0,isRecordingMix:e.mix.isRecordingMix,isRecording:e.sequencer.isRecording,isMacroMapping:e.effects.isMacroMapping}},function(e){return{setContextualHelp:function(t){return e(Object(f.hb)(t))},setParameterSliderDown:function(t){return e(Object(f.ld)(t))},setParameterToMap:function(t){return e(Object(f.md)(t))},setTrackSendVolume:function(t,n,a){return e(Object(f.If)(t,n,a))}}})(Ci),wi=n(1241);n(128);var Pi=Object(m.b)(function(e,t){var n=0;return t.track&&(n=t.track.chainNumber),{chainNumber:n}},function(e,t){return{setEffectsChainToShow:function(t,n,a){return e(Object(f.Ib)(t,n,a))}}})(function(e){if(void 0===e.track)return u.a.createElement("div",null);var t=e.track.effectsChains;return u.a.createElement("div",{className:"effects-chain-chooser"},t.map(function(t,n){return u.a.createElement("div",{onClick:function(){return function(t){e.setEffectsChainToShow(e.track.subSequence.id,e.track.trackNumber,t)}(n)},className:e.chainNumber===n?"effects-chain-btn selected":"effects-chain-btn"},n+1)}),u.a.createElement("div",{className:"new-effects-chain-btn",onClick:function(){e.track.newEffectsChain()}},"+"),u.a.createElement(He.a,{condition:e.track&&e.track.effectsChains.length>1},u.a.createElement("div",{className:"new-effects-chain-btn",onClick:function(){e.track.deleteEffectsChain()}},"-")))}),Ni=(n(765),n(576),n(414),n(899),n(318),n(767),n(415),n(335),n(766),n(770),n(771),n(769),n(774),n(789),n(775),n(776),n(772),n(773),n(768),n(579),n(581),n(790),n(583),n(584),n(788),n(586),n(786),n(587),n(590)),xi=n(802),qi=n(492),Ti=(n(486),n(900),n(382),n(207));function Mi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Ri=[{value:Ti.c,label:"Macro"},{value:Ti.e,label:"Playhead"},{value:Ti.f,label:"Roll"}],Di=function(e){Object(xe.a)(n,e);var t=Mi(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={showOptions:!0},console.log("ADD EFFECT"),a}return Object(Ne.a)(n,[{key:"handleChooseLiveEffect",value:function(e){var t=this,n=null;e===Ti.f?n=new Ni.a(this.props.track):e===Ti.c?n=new wi.a(this.props.track):e===Ti.d?n=new xi.a(this.props.track):e===Ti.e&&(n=new qi.a(this.props.track)),this.props.handleChooseLiveEffect(n),this.setState({value:0}),setTimeout(function(){t.setState({value:void 0})},50)}},{key:"handleChooseMidiEffect",value:function(e){var t=this;this.props.handleChooseMidiEffect(Object(cr.c)(e,this.props.track)),this.setState({value:0}),setTimeout(function(){t.setState({value:void 0})},50)}},{key:"handleChooseEffect",value:function(e){var t=this,n=(this.props.send,"string"===typeof e?Object(cr.b)(e,this.props.sequencerEngine):Object(cr.b)(e.name,this.props.sequencerEngine,e.graph));this.props.handleChooseEffect(n),this.setState({value:e}),setTimeout(function(){t.setState({value:void 0})},50)}},{key:"onClickShowOptions",value:function(){this.state.showOptions=!0,this.setState(this.state)}},{key:"setContextualHelp",value:function(e,t){e.stopPropagation(),this.props.setContextualHelp(t)}},{key:"render",value:function(){var e=this;if(this.state.showOptions)return u.a.createElement("div",{className:"enabled effect choose-effects"},u.a.createElement("div",{className:"add-effect-type"},u.a.createElement(D.a,{className:"delay-time-dropdown",options:Object(cr.a)(this.props.sequencerEngine),value:this.state.value,onChange:function(t){return e.handleChooseEffect(t.value)},placeholder:"Audio FX"})),u.a.createElement(He.a,{condition:void 0!==this.props.track},u.a.createElement("div",{className:"add-effect-type"},u.a.createElement(D.a,{className:"delay-time-dropdown",options:cr.e,onChange:function(t){return e.handleChooseMidiEffect(t.value)},value:this.state.value,placeholder:"MIDI FX"})),u.a.createElement(He.a,{condition:!window.installation},u.a.createElement("div",{className:"add-effect-type"},u.a.createElement(D.a,{className:"delay-time-dropdown",value:this.state.value,options:Ri,onChange:function(t){return e.handleChooseLiveEffect(t.value)},placeholder:"Live FX"})))));void 0===this.props.track||this.props.track.effectsChains;return u.a.createElement("div",{className:"effects-chooser-container"},u.a.createElement("div",{onMouseOver:function(t){return e.setContextualHelp(t,bn.a)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.onClickShowOptions()},className:this.props.addClassName},"+"),u.a.createElement(He.a,{condition:!window.installation},u.a.createElement(Pi,{track:this.props.track})))}}]),n}(i.Component),Ii=Object(m.b)(function(e,t){var n=0;return t.track&&(n=t.track.chainNumber),{chainNumber:n}},function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))},setEffectsChainToShow:function(t,n,a){return e(Object(f.Ib)(t,n,a))}}})(Di),Ai=n(519),Li=Object(m.b)(function(e,t){return{isFrozen:t.track.isFrozen,effectsLen:t.track.effects&&t.track.effects.length,midiEffectsLen:t.track.midiEffects.effects&&t.track.midiEffects.effects.length,liveEffects:t.track.liveEffects.effects&&t.track.liveEffects.effects.length,_audioFx:t.track.effects,_midiFx:t.track.midiEffects,_liveFx:t.track.liveEffects,panning:e.tracks.trackPannings[t.track.trackNumber]||0,pulledEffects:e.effects.pulledEffects}},function(e){return{setSelectedSteps:function(t){return e(Object(f.ge)(t))}}})(function(e){e.isFrozen;var t=e.sends,n=e.track,a=e.scrollContainer,r=e.sequencerEngine,c=e.panning,o=(e.hideLock,e._liveFx,e._audioFx,e._midiFx,e.isRack),l=e.pulledEffects,f=e.setSelectedSteps,m=Object(i.useRef)(void 0),p=Object(i.useState)(n.effects),h=Object(s.a)(p,2),b=h[0],v=h[1],g=Object(i.useState)(n.midiEffects.effects),E=Object(s.a)(g,2),O=E[0],y=E[1],k=Object(i.useState)(n.liveEffects.effects),j=Object(s.a)(k,2),C=j[0],S=j[1],w=n.getSendNodes(),P=Object(i.useCallback)(function(e){r.operationManager.dispatch(Object(dt.b)(e,n)),y(Object(d.a)(n.midiEffects.effects))},[n,y]),N=Object(i.useCallback)(function(e){n.liveEffects.addEffect(e),S(Object(d.a)(n.liveEffects.effects))},[n,S]),x=Object(i.useCallback)(function(e){e.enable(!0),r.operationManager.dispatch(Object(dt.b)(e,n)),v(Object(d.a)(n.effects))},[n,v]),q=Object(i.useCallback)(function(e){n.setPanning(e)},[n]),T=Object(i.useCallback)(function(){v(Object(d.a)(n.effects)),y(Object(d.a)(n.midiEffects.effects)),S(Object(d.a)(n.liveEffects.effects))},[n,v,y,S]);if(Object(i.useEffect)(function(){f([])},[]),void 0===b||void 0===C||void 0===O)return u.a.createElement("div",null);var M=r.tracks,R=function(){},D="effects-view";o&&(D+=" effects-view-instrument-rack");var I=n&&n.liveEffects&&n.liveEffects.effects||[],A=n&&n.midiEffects&&n.midiEffects.effects||[],L=n&&n.effects||[];return u.a.createElement("div",{ref:m,className:D},I.map(function(e,t){return u.a.createElement(Ai.a,{key:t,scrollContainer:[a,m],sequencerEngine:r,onDeleteEffect:T,isPulled:l.includes(e),effect:e,track:n,tracks:M,onEffectsChange:R})}),"",A.map(function(e,t){return u.a.createElement(Vd,{key:t,sequencerEngine:r,isPulled:l.includes(e),scrollContainer:[a,m],onDeleteEffect:T,effect:e,track:n,tracks:M,onEffectsChange:R})}),L.map(function(e,t){return u.a.createElement(bp,{sequencerEngine:r,isPulled:l.includes(e),scrollContainer:[a,m],key:t,onDeleteEffect:T,effect:e,track:n,tracks:M,onEffectsChange:R})}),u.a.createElement(Ii,{track:n,sequencerEngine:r,addClassName:"add-track-effects-button",handleChooseMidiEffect:P,handleChooseLiveEffect:N,handleChooseEffect:x,store:r.store}),u.a.createElement("div",{className:"sends-and-options-container"},u.a.createElement("div",{className:"sends-container"},w.map(function(e,a){return u.a.createElement(Si,{key:"track-send-"+a,track:n,sequencerEngine:r,sendNumber:a,send:t.getSends()[a],sendNode:e})}),u.a.createElement(qs,{panning:c,onChangePanning:q})),n?u.a.createElement(ki,{track:n}):""))});var Fi=n(314),zi=n(572),Bi=function(e,t,n,a){Object(zi.a)(e).then(function(){var e=Object(o.a)(c.a.mark(function e(r){var o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=new Ct.a(r[0]),e.next=3,o.load();case 3:(s=new Fi.a(o,t.sequencerEngine)).sounds=r.slice(1),a(o,s),n(void 0),s.initBuffers();case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())};var _i=Object(m.b)(function(e,t){return{instrumentTypeDragging:e.instruments.instrumentTypeDragging,presetDragging:e.presets.presetDragging,sampleDragging:e.selector.sampleDragging,sampleTagDragging:e.selector.sampleTagDragging}},function(e,t){return{setInstrumentTypeDragging:function(t){return e(Object(f.gc)(t))},setPresetDragging:function(t){return e(Object(f.Ed)(t))},setSampleDragging:function(t){return e(Object(f.Qd)(t))},setSampleTagDragging:function(t){return e(Object(f.Td)(t))}}})(function(e){var t=Object(i.useCallback)(function(t){t.stopPropagation(),e.instrumentTypeDragging?(e.newInstrument(e.instrumentTypeDragging),e.setInstrumentTypeDragging(void 0)):e.presetDragging?(e.newPreset(e.presetDragging),e.setPresetDragging(void 0)):e.sampleDragging?(e.newSample(e.sampleDragging),e.setSampleDragging(void 0)):e.sampleTagDragging&&Bi(e.sampleTagDragging,e.track,e.setSampleTagDragging,e.newSample)},[e.instrumentTypeDragging,e.newInstrument,e.newPreset,e.newSample,e.presetDragging,e.sampleDragging,e.sampleTagDragging]);return u.a.createElement("div",{onDragOver:function(e){return e.preventDefault()},onDrop:t,className:"drop-here"},u.a.createElement("span",null,"Drop inst, preset or sample here"))}),Hi=new h.a,Ui=Object(i.memo)(function(e){var t=e.name,n=e.setParameterToMap,a=e.parameter,r=e.value,c=e.onClick,o=e.isMacroMapping,s=e.isParameterToMap,i="parameter-button";e.isSelected&&(i+=" selected");var l;return u.a.createElement("div",{onClick:function(){return c(a)},className:i},function(){var e=a.parameter;if(o&&e){var t="macro-overlay";s&&(t+=" parameter-to-map"),e.hasMacro&&(t+=" mapped");var r={};e.hasMacro&&(r={backgroundColor:Hi.getColorForHash(e.hasMacro.id)});var c=e.hasMacro&&e.hasMacro.name;return u.a.createElement("div",{onClick:function(){return n(e)},className:t},u.a.createElement("div",{className:"overlay-main"}),u.a.createElement("div",{className:"overlay-detail",style:r},c))}return""}(),u.a.createElement("div",{className:"parameter-name"},t),u.a.createElement("div",{className:"parameter-value"},(l=r,Math.floor(100*l)/100)))}),Gi=Object(m.b)(function(e,t){return void 0===t.parameter?{value:0}:{value:e.effects.effectParameters[t.parameter.parameter.id],isMacroMapping:e.effects.isMacroMapping,isParameterToMap:t.parameter&&e.effects.parameterToMap===t.parameter.parameter,hasMacro:t.parameter.parameter.hasMacro}},function(e){return{setParameterToMap:function(t){return e(Object(f.md)(t))}}})(Ui),Wi=Object(m.b)(function(e,t){return void 0===t.parameter?{value:0}:{value:t.parameter.parameter.get()}},null)(function(e){var t=e.parameter.parameter,n=t.min,a=t.max,r=t.value;return r=Math.cbrt(r),void 0!==e.parameter.min&&(n=e.parameter.min),void 0!==e.parameter.max&&(a=e.parameter.max),u.a.createElement("div",{className:"simple-parameter-slider"},u.a.createElement(be.a,{value:r,change:function(t){return e.onChange(t)},step:.01,max:Math.cbrt(a),min:Math.cbrt(n),orientation:"horizontal",reversed:!1}))}),Vi=n(764),Xi=n(1152),Ki=Object(m.b)(function(e,t){return{connected:t.parameter.isConnectedToAnyModulator()}},void 0)(function(e){var t=e.sequencerEngine.lfosTrack.lfos.map(function(e){return e.lfo}),n=e.sequencerEngine.envelopes;return u.a.createElement("div",{className:"flex flex-col w-full"},u.a.createElement("div",{className:"parameter-modulators flex"},u.a.createElement("div",{className:"lfo-buttons flex"},t.map(function(n){return u.a.createElement(Vi.a,{lfo:n,lfos:t,parameter:e.parameter})})),u.a.createElement("div",{className:"envelope-buttons  flex"},n.map(function(t,a){return u.a.createElement(Xi.a,{parameter:e.parameter,envelope:t,envelopes:n})}))),e.showDepth&&e.parameter&&e.parameter.depthParameter&&e.parameter.isConnectedToAnyModulator()&&u.a.createElement($.a,{display:function(e){return Math.round(100*e)+"%"},min:0,max:1,width:70,label:"Amount",name:"",parameter:e.parameter.depthParameter}))});function Qi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component;var Yi=Object(m.b)(function(e,t){return{selectedInstrument:e.tracks.selectedRackSubTrack[t.track.id],tracks:t.track.tracks}},function(e,t){return{setSelectedInstrument:function(n){return e(Object(f.je)(t.track.id,n))}}})(function(e){var t=e.track,n=e.selectedInstrument,a=e.setSelectedInstrument,r=e.scrollContainer,l=Object(i.useState)(t.tracks),f=Object(s.a)(l,2),m=f[0],p=f[1],h=Object(i.useState)(!1),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useCallback)(function(e){var n=t.addInstrumentType(e);p(Object(d.a)(t.tracks)),a(n)},[t,p,a]);Object(i.useEffect)(function(){p(t.tracks)},[t.tracks,p]);var O=Object(i.useCallback)(function(){var e=Object(o.a)(c.a.mark(function e(n){var r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.addPreset(n);case 2:r=e.sent,p(Object(d.a)(t.tracks)),a(r);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[t,p,a]),y=Object(i.useCallback)(function(){var e=Object(o.a)(c.a.mark(function e(n,r){var o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.addSample(n,r);case 2:o=e.sent,p(Object(d.a)(t.tracks)),a(o);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),[t,p,a]),k=Object(i.useCallback)(function(){t.deleteInstrument(n),a(void 0),p(Object(d.a)(t.tracks))},[t,p,a,n]),j=t.tracks.indexOf(n)>-1?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.sequencerEngine;return u.a.createElement(Li,{scrollContainer:t,hideLock:!0,isRack:n,store:a.store,sequencerEngine:a,onParameterChanged:function(e){return[]},onEffectsChange:function(){return e.updateEffects()},panning:0,onChangePanning:function(e){return console.log("panning changed = "+e)},sends:a.sends,tracks:[],track:e,send:void 0,group:void 0})}(n.track,r,!0):"",C=(Object(i.useCallback)(function(){var e=Object(o.a)(c.a.mark(function e(n){var r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getCopy();case 2:r=e.sent,t.addInstrument(r),a(void 0),p(Object(d.a)(t.tracks));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[p]),"instrument-rack-controller");return v&&(C+=" show-mods"),u.a.createElement("div",{className:"instrument instrument-rack"},u.a.createElement("div",{className:C},m.map(function(e){return u.a.createElement(Ei,{name:e.presetName||e.getName(),key:e.presetName||e.getName(),rackTrack:t,isSelected:n===e,onDelete:function(){return k()},onSelect:function(){return a(e===n?void 0:e)},track:e})}),v&&n?u.a.createElement(I.a,{parameters:n.getAllParameters(),setShowMods:g,showMods:v}):"",u.a.createElement(_i,{newInstrument:E,newPreset:O,newSample:y,track:t})),j)}),Ji=Object(m.b)(function(e,t){return{}},function(e){return{setShowFormantPresets:function(t){return e(Object(f.Be)(t))}}})(function(e){var t=e.oscillator,n=e.setShowFormantPresets,a=Object(i.useState)(!1),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(""),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useCallback)(function(){t.saveFormantsAsPreset(m),p(""),o(!1)},[m,t,p,o]);return c?u.a.createElement("div",{className:"save-formants-flow"},u.a.createElement("input",{onChange:function(e){return p(e.target.value)},value:m,type:"text",placeholder:"Name your Multi-Filter"}),u.a.createElement("div",{onClick:d,className:"confirm-formants-btn pushable"},"Complete Save")):u.a.createElement("div",{className:"save-formants-flow"},u.a.createElement("div",{onClick:function(){return o(!0)},className:"pushable save-formants-btn"},"Save Multi-Filter Settings"),u.a.createElement("div",{onClick:function(){return n(!1)},className:"pushable save-formants-btn done-formants-btn"},"Done"))}),Zi=n(235),$i=n(224),eu=n(236),tu=n(589);function nu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var au=function(e){Object(xe.a)(n,e);var t=nu(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"onSelectTrack",value:function(e){for(var t in this.tracks)this.tracks[t].isConnectedToEnvelope(this.props.envelope)&&this.tracks[t].disconnectFromEnvelope(this.props.envelope);e.value.connectToEnvelope(this.props.envelope),this.setState(this.state)}},{key:"getTruncatedName",value:function(e){var t=e.getName();return void 0===t?"":t.length>=16?t.slice(0,16)+"...":t}},{key:"getOptions",value:function(){var e=this;return this.props.sequencerEngine.tracks.map(function(t){return{label:t.trackNumber+1+". "+e.getTruncatedName(t),value:t}})}},{key:"getSelectedOption",value:function(){var e=this;return this.getOptions().filter(function(t){return t.value.isConnectedToEnvelope(e.props.envelope)})[0]}},{key:"render",value:function(){var e=this,t=this.props.isSelected&&void 0===this.getSelectedOption()?"envelope-dropdown osc-type-dropdown-container selected":"envelope-dropdown osc-type-dropdown-container";return u.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(bn.n)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:t},u.a.createElement(D.a,{controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.getOptions(),onChange:function(t){return e.onSelectTrack(t)},value:this.getSelectedOption(),placeholder:"Track"}),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"pre-post-options"},u.a.createElement("div",{onClick:function(){return e.onClickMode(tu.b)},className:this.preFXClassName},"Pre-FX"),u.a.createElement("div",{onClick:function(){return e.onClickMode(tu.a)},className:this.postFXClassName},"Post-FX")))}},{key:"onClickMode",value:function(e){var t=this.connectedTrack;void 0!==t&&(t.setEnvelopeMode(this.props.envelope,e),this.setState(this.state))}},{key:"tracks",get:function(){return this.props.sequencerEngine.tracks}},{key:"connectedTrack",get:function(){var e=this;return this.tracks.filter(function(t){return t.isConnectedToEnvelope(e.props.envelope)})[0]}},{key:"mode",get:function(){var e=this.connectedTrack;if(void 0!==e)return e.getEnvelopeMode(this.props.envelope)}},{key:"preFXClassName",get:function(){return void 0!==this.mode&&this.mode!==tu.a?"pre-post-option selected":"pre-post-option"}},{key:"postFXClassName",get:function(){return void 0!==this.mode&&this.mode!==tu.b?"pre-post-option selected":"pre-post-option"}}]),n}(i.Component),ru=Object(m.b)(function(e){return{tracks:e.tracks.trackSteps}},function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(au);function cu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var ou=function(e){Object(xe.a)(n,e);var t=cu(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={showEnvelopeModal:!1,value:0},a}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){e.setState({value:e.props.envelopeTrack.envelope.envelope.value})},100)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"showEnvelopeModal",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({showEnvelopeModal:e})}},{key:"isSelected",value:function(){return!this.props.hideSelection&&this.props.selectedEnvelope===this.props.envelopeTrack.number}},{key:"render",value:function(){var e=this,t="instrument-subsection-name lfo-subsection-name lfo-track-foreground-"+this.props.envelopeTrack.number,n=this.props.envelopeTrack.envelope,a=this.isSelected(),r=a?"envelope-component selected":"envelope-component",c=this.props.envelopeTrack.number;r+=" modulator-"+c;var o={width:100*this.state.value+"%"};return u.a.createElement("div",{onClick:function(){return e.props.setSelectedEnvelope(e.props.envelopeTrack.number)},onMouseOver:function(){return e.props.setContextualHelp(bn.l)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},className:r},u.a.createElement("div",{className:t},this.props.envelopeTrack.name),u.a.createElement(ru,{isSelected:a,sequencerEngine:this.props.sequencerEngine,envelope:n}),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"knobs"},u.a.createElement(mi.a,{name:"Env "+c,envelope:n,width:200,hasRelease:!0,hasLevel:!1,sequencerEngine:this.props.sequencerEngine})),u.a.createElement("div",{className:"envelope-value-container"},u.a.createElement("div",{className:"envelope-value",style:o})))}}]),n}(i.Component),su=Object(m.b)(function(e){return{selectedEnvelope:e.sequencer.selectedEnvelope}},function(e){return{setSelectedEnvelope:function(t){return e(Object(f.Yd)(t))},setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(ou),iu=[{value:function(){return"128m"},label:"128"},{value:function(){return"64m"},label:"64"},{value:function(){return"32m"},label:"32"},{value:function(){return"16m"},label:"16"},{value:function(){return"8m"},label:"8"},{value:function(){return"4m"},label:"4"},{value:function(){return"2m"},label:"2"},{value:function(){return"1m"},label:"1"},{value:function(){return"2n"},label:"1/2"},{value:function(){return"4n"},label:"1/4"},{value:function(){return"4n."},label:"1/4."},{value:function(){return"4t"},label:"1/4t"},{value:function(){return"8n"},label:"1/8"},{value:function(){return"8n."},label:"1/8."},{value:function(){return"8t"},label:"1/8t"},{value:function(){return"16n"},label:"1/16"},{value:function(){return"16t"},label:"1/16t"},{value:function(){return"32n"},label:"1/32"}];function uu(e){e="function"===typeof e?e():e;var t=iu.filter(function(t){return t.value()===e});return 0==t.length?iu[0]:t[0]}var lu=Object(m.b)(function(e,t){return{rate:t.lfo.lfoRate}},function(e){return{}})(function(e){return u.a.createElement("div",{className:"lfo-rate-dropdown"},u.a.createElement("div",{className:"lfo-rate-label"},"Rate:"),u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:iu,onChange:function(t){e.lfo.lfoRate=t.value()},value:uu(e.lfo.lfoRate),placeholder:"LFO"}),u.a.createElement("div",{className:"clear-fix"}))}),fu=[{value:"square",label:"Square"},{value:"sine",label:"Sine"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"}];function mu(e){for(var t=0;t<fu.length;t++)if(fu[t].value===e)return fu[t];return null}var pu=Object(m.b)(function(e,t){return{lfoType:t.lfo.lfoType}},function(e){return{}})(function(e){return u.a.createElement("div",{className:"osc-type-dropdown-container"},u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:fu,onChange:function(t){e.lfo.lfoType=t.value},value:mu(e.lfo.lfoType),placeholder:"LFO"}),u.a.createElement("div",{className:"clear-fix"}))});n(426);function du(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component;function hu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var bu=function(e){Object(xe.a)(n,e);var t=hu(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={showMods:!1,waveformData:[]},a}return Object(Ne.a)(n,[{key:"onChangeSynced",value:function(e){document.activeElement.blur(),this.props.lfo.lfo.isSynced="unsynced"===e,console.log("isSynced is now = "+this.props.lfo.lfo.isSynced),this.setState(this.state)}},{key:"onClickModsButton",value:function(){this.setState({showMods:!this.state.showMods})}},{key:"meter",get:function(){return this.props.lfo.lfo.meter}},{key:"isSelected",value:function(){return!this.props.hideSelection&&this.props.lfo.lfo.number===this.props.selectedLFO}},{key:"onClick",value:function(){this.props.setSelectedLFO(this.props.lfo.lfo.number),this.props.planeMapping&&this.props.planeMapping.randomlyMapParameters(this.props.lfo.lfo)}},{key:"render",value:function(){var e=this,t=this.props.lfo.lfo,n=this.isSelected()?"lfo-component selected":"lfo-component";return this.props.planeMapping&&(n+=" plane-mapping"),this.state.showMods&&(n+=" showing-mods"),u.a.createElement(Ha.a,{instrument:this.props.lfo,effect:this.props.lfo,id:this.props.lfo.lfo.id,isDraggable:void 0===this.props.isDraggable||this.props.isDraggable,type:Ua.d,onMouseOver:function(){return e.props.setContextualHelp(bn.q)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.onClick()},className:n},!this.props.hideName&&u.a.createElement("div",{className:"instrument-subsection-name lfo-subsection-name lfo-track-foreground-"+this.props.lfo.number},this.props.lfo.getName()),u.a.createElement(He.a,{condition:this.state.showMods},u.a.createElement(I.a,{parameters:this.props.lfo.lfo.parameters})),u.a.createElement(He.a,{condition:!this.state.showMods},u.a.createElement(pu,{lfo:t}),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"refined-checkbox-preferences lfo-synced-checkbox"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:t.isSynced?"synced":"unsynced",checked:t.isSynced,onChange:function(t){return e.onChangeSynced(t.target.value)}}),"Synced")),t.isSynced?u.a.createElement(lu,{lfo:t}):u.a.createElement(Fa.a,{effectNumber:0,name:"Rate",parameter:t.lfoRateParameter,onParameterChanged:function(){return[]},isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,step:.1,min:0,max:32}),u.a.createElement("div",{className:"two-parameters"},u.a.createElement(Fa.a,{effectNumber:0,name:"Amount",parameter:t.lfoAmpParameter,contextualHelp:bn.r,sequencerEngine:this.props.sequencerEngine,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,min:0,max:1,step:.01}),u.a.createElement(Fa.a,{effectNumber:0,name:"Phase",sequencerEngine:this.props.sequencerEngine,parameter:t.lfoPhaseParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:360,step:1}))),u.a.createElement("div",{className:"mods-button",onClick:function(){return e.onClickModsButton()}},this.state.showMods?"BACK":"MODS"))}}]),n}(i.Component),vu=Object(m.b)(function(e){return{selectedLFO:e.sequencer.selectedLFO,planeMapping:e.effects.planeMapping}},function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))},setSelectedLFO:function(t){return e(Object(f.be)(t))}}})(bu),gu=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){e.isDraggable;var t=e.setSelectedOscillator,n=e.instrument,a=e.color,r=e.osc,c=Object(da.a)(e,["isDraggable","setSelectedOscillator","instrument","color","osc"]),o=Object(i.useState)(void 0===r?n.oscillators[0]:r),l=Object(s.a)(o,2),f=l[0],m=l[1];Object(i.useEffect)(function(){r&&m(r)},[r,m]);var p=f||n.oscillators[0];return u.a.createElement(Ha.a,{isDraggable:!1,instrument:n,id:n.fmParameters.id,type:Ua.a,className:"instrument-section"},u.a.createElement(nd,{color:a,track:c.track,scrollContainer:c.scrollContainer,setSelectedOscillator:function(e){t?t(Math.max(0,n.oscillatorNodes.indexOf(e))):m(e)},sequencerEngine:c.sequencerEngine,effect:n}),u.a.createElement("div",{className:"fm-parameters"},u.a.createElement("div",{className:"osc-name"},p.name),u.a.createElement("div",{className:"fm-parameters-container"},u.a.createElement(Fa.a,{automation:c.automation,name:"Harmonicity",sequencerEngine:c.sequencerEngine,lfoEnabled:!0,parameter:p.harmonicityParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:20,step:.01}),u.a.createElement(Fa.a,{automation:c.automation,name:"Modulation",sequencerEngine:c.sequencerEngine,parameter:p.modulationIndexParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:125,step:.01}))))}),Eu=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.oscillator,n=e.formantsExpanded,a=e.setFormantsExpanded;return u.a.createElement("div",{className:"operator-details"},!n&&u.a.createElement("div",{className:"volume-and-detune"},u.a.createElement(Fa.a,{sequencerEngine:t.sequencerEngine,name:"Volume",parameter:t.oscillatorLevelParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:0,max:1,step:.01}),u.a.createElement(Fa.a,{name:"Detune",sequencerEngine:t.sequencerEngine,lfoEnabled:!0,parameter:t.detuneParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}),u.a.createElement(Fa.a,{sequencerEngine:t.sequencerEngine,name:"Octave",parameter:t.oscillatorOctaveParameter,convertToRoot:2,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:-8,max:4,step:1})),!n&&u.a.createElement("div",{className:"volume-and-detune"},u.a.createElement(He.a,{condition:t.oscillatorTypeParameter.get()&&t.oscillatorTypeParameter.get().includes("fat")},u.a.createElement(Fa.a,{sequencerEngine:t.sequencerEngine,name:"Count",parameter:t.countParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:3,max:9,step:1}),u.a.createElement(Fa.a,{sequencerEngine:t.sequencerEngine,name:"Spread",parameter:t.spreadParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:1,max:200,step:.01})),u.a.createElement(He.a,{condition:"pulse"===t.oscillatorTypeParameter.get()},u.a.createElement(Fa.a,{sequencerEngine:t.sequencerEngine,name:"Pulse",parameter:t.pulseWidthParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:0,max:1,step:.01}))),u.a.createElement(gs,{formantsExpanded:n,setFormantsExpanded:a,oscillator:t}))}),Ou={BASIC:["sine","triangle","square","sawtooth","pulse"],FAT:["fatsquare","fatsine","fattriangle","fatsawtooth"],CUSTOM:Vc.a},yu=function(e){var t=e.type,n=e.name,a=e.setType,r=e.selectedType,c="type-option";return t===r&&(c+=" selected"),u.a.createElement("div",{onMouseDown:function(e){e.stopPropagation(),a(t)},className:c},n)},ku=Object(m.b)(function(e,t){return{oscillatorType:t.oscillator.oscillatorType,customOscillatorType:t.oscillator.customOscillatorType}},function(e){return{}})(function(e){var t=e.oscillator,n=e.oscillatorType,a=e.customOscillatorType,r=e.hide,c=Object(i.useState)("BASIC"),o=Object(s.a)(c,2),l=o[0],f=o[1];Object(i.useEffect)(function(){a&&f("CUSTOM")},[a]),Object(i.useEffect)(function(){n&&(Ou.BASIC.includes(n)?f("BASIC"):f("FAT"))},[n]);var m=Object(i.useCallback)(function(e){"CUSTOM"===l?t.customOscillatorTypeParameter.set(e):t.oscillatorTypeParameter.set(e)},[t,l]);return Object(i.useEffect)(function(){return window.addEventListener("mousedown",r),function(){return window.removeEventListener("mousedown",r)}},[r]),u.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"waveform-selector"},t.customOscillatorType?u.a.createElement(Fa.a,{name:"Harmonics",sequencerEngine:t.sequencerEngine,isParameter:!0,parameter:t.harmonicsParameter,step:.001,min:-1,max:1}):u.a.createElement(Fa.a,{name:"Partials",sequencerEngine:t.sequencerEngine,isParameter:!0,parameter:t.partialCountParameter,step:1,min:0,max:64}),u.a.createElement("div",{className:"inner"},u.a.createElement("div",{className:"types"},u.a.createElement(yu,{type:"BASIC",name:"Basic",setType:f,selectedType:l}),u.a.createElement(yu,{type:"FAT",name:"Fat",setType:f,selectedType:l}),u.a.createElement(yu,{type:"CUSTOM",name:"Custom",setType:f,selectedType:l})),u.a.createElement("div",{className:"waveforms"},Ou[l].map(function(e){return u.a.createElement("div",{key:e,onClick:function(){return m(e)},className:a===e||!a&&n===e?"osc-type selected":"osc-type"},e)}))))}),ju=Object(m.b)(function(e,t){return{sampleDragging:e.selector.sampleDragging,oscillatorType:t.oscillator.customOscillatorType||t.oscillator.oscillatorType}},function(e){return{}})(function(e){var t=e.oscillatorType,n=e.oscillator,a=e.oscWaveforms,r=e.setOscWaveforms,c=e.sampleDragging,o=a===n,s="oscillator-waveform  ";s+=o?" showing":" pushable";var l=Object(i.useCallback)(function(e){e.stopPropagation(),n.setOscillatorSample(c)},[c]),f=Object(i.useCallback)(function(e){e.stopPropagation(),console.log("toggle wave"),r(o?void 0:n)},[o,n]);return"sine"===t?t=u.a.createElement("img",{src:"/sine-icon.svg",className:"osc-type-icon sine mx-auto"}):"triangle"===t?t=u.a.createElement("img",{src:"/triangle-icon.svg",className:"osc-type-icon triangle mx-auto"}):"sawtooth"===t?t=u.a.createElement("img",{src:"/sawtooth-icon.svg",className:"osc-type-icon sawtooth mx-auto"}):"square"===t?t=u.a.createElement("img",{src:"/square-icon.svg",className:"osc-type-icon square mx-auto"}):"pulse"===t&&(t=u.a.createElement("img",{src:"/pulse-icon.svg",className:"osc-type-icon pulse mx-auto"})),u.a.createElement("div",{onDrop:l,onMouseDown:f,className:s},u.a.createElement("div",{className:"waveform-type"},t),o?u.a.createElement(ku,{hide:function(){return r(void 0)},oscillator:n}):"")}),Cu=n(834),Su=Object(m.b)(function(e,t){var n=t.oscillator.oscillatorLevelParameter;return{value:e.effects.effectParameters[n.id]}},function(e){return{}})(function(e){var t=e.oscWaveforms,n=e.setOscWaveforms,a=e.color,r=e.value,c=e.oscillator,o=e.height,l=void 0===o?75:o,f=e.setOscillatorDetails,m=e.oscillatorDetails,p=e.oscDragging,d=e.setOscDragging,h=Object(i.useRef)(void 0),b=Object(i.useRef)(0),v={height:Object(Cu.a)(r,0,1,l,1),backgroundColor:a},g=function(e){var t=e.parameter,n=e.min,a=e.max,r=e.height,c=e.root,o=void 0===c?1:c,u=e.ref,l=Object(i.useState)(!1),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useCallback)(function(e){e.stopPropagation();var c=Object(Cu.b)(e,"a",n,a,r,o,u.current);t.set(c,!1),p(!0)},[t,p]);return{onMouseMove:Object(i.useCallback)(function(e){if(e.stopPropagation(),m){var c=Object(Cu.b)(e,"a",n,a,r,o,u.current);t.set(c,!1)}},[t,m]),onMouseDown:d,onMouseClear:Object(i.useCallback)(function(e){p(!1)},[p])}}({height:l,parameter:c.oscillatorLevelParameter,min:0,max:1,ref:h}),E=g.onMouseDown,O=g.onMouseMove,y=g.onMouseClear,k="operator-name pushable ";m===c&&(k+=" selected");var j=!c.enabledParameter.get();j&&(k+=" disabled");var C,S=Object(i.useCallback)(function(){p&&p!==c&&c.fromJson(p.getJson(),!0),d(void 0)},[c,p,d]),w=Object(i.useCallback)(function(){n(void 0);var e=(new Date).getTime();if(e-b.current<250){var t=!c.enabledParameter.get();if(c.enabledParameter.set(t),!t)return void f(void 0)}b.current=e,c.enabledParameter.get()&&f(m===c?void 0:c)},[m,c,f,n]);return u.a.createElement("div",{className:"operator-mixer"},u.a.createElement("div",{draggable:!0,onDragStart:function(e){e.stopPropagation(),d(c)},onDragOver:function(e){return e.preventDefault()},onDrop:S,onClick:w,className:k},c.name),m||j?"":u.a.createElement("div",{draggable:!0,onDragStart:function(e){return e.preventDefault()},ref:h,style:{height:l+6},onClick:function(e){return e.stopPropagation()},onMouseLeave:y,onMouseUp:y,onMouseMove:O,onMouseDown:E,className:"volume-box"},u.a.createElement("div",{className:"rest"}),u.a.createElement("div",{style:v,className:"volume-indicator"}),u.a.createElement("div",{className:"value"},(C=r,Math.round(100*C)/100))),m&&m!==c||j?"":u.a.createElement(ju,{oscWaveforms:t,setOscWaveforms:n,oscillator:c}))}),wu=Object(m.b)(function(e,t){return{}},function(e){return{setPullablePartDragging:function(t){return e(Object(f.Id)(t))}}})(function(e){var t=e.formantsExpanded,n=e.setFormantsExpanded,a=e.setPullablePartDragging,r=e.instrument,c=e.isDraggable,o=void 0===c||c,l=(e.sequencerEngine,e.setShowWaveform),f=e.setOscillatorDetails,m=e.oscillatorDetails,p=e.color,d=r.oscillatorNodes,h=Object(i.useState)(void 0),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useState)(void 0),O=Object(s.a)(E,2),y=O[0],k=O[1],j=Object(i.useCallback)(function(){a({instrument:r,id:r.id,track:r.track,type:Ua.e})},[r]);return u.a.createElement("div",{onDragStart:j,onDragOver:function(e){return e.preventDefault()},draggable:o,className:t?"operators-mixer expanded":"operators-mixer"},u.a.createElement("div",{className:"mixers"},d.map(function(e){return u.a.createElement(Su,{key:e.id,setOscillatorDetails:f,color:p,oscWaveforms:v,setOscWaveforms:g,oscDragging:y,setOscDragging:k,oscillatorDetails:m,oscillator:e,setShowWaveform:l})})),m?u.a.createElement(Eu,{formantsExpanded:t,setFormantsExpanded:n,oscillator:m}):u.a.createElement("div",{className:"global-parameters"},u.a.createElement(Fa.a,{sequencerEngine:r.sequencerEngine,name:"Root Note",parameter:r.carrier.oscillatorFrequencyParameter,onParameterChanged:function(){return r.releaseAll()},displayFunction:function(e){return Lc.a.fromTranspose(e).toString()},isParameter:!0,min:-32,max:32,step:1}),u.a.createElement(Fa.a,{sequencerEngine:r.sequencerEngine,name:"Detune",parameter:r.detuneParameter,isParameter:!0,lfoEnabled:!0,min:-100,max:100,step:1})))}),Pu="LP",Nu=function(e){var t=e.selectedType,n=e.setType,a=e.option,r=e.name,c=t===a?"selected option":"option";return u.a.createElement("div",{onClick:function(){return n(a)},className:c},r)},xu=Object(m.b)(function(e,t){return{selectedParameter:e.effects.accumulatorParameterSelected}},function(e){return{}})(function(e){var t=Object(i.useState)(Pu),n=Object(s.a)(t,2),a=n[0],r=n[1];return Object(i.useEffect)(function(){e.selectedParameter&&(e.selectedParameter.name.includes("hi-pass")?r("HP"):r(Pu))},[e.selectedParameter,e.instrument,r]),u.a.createElement("div",{className:"instrument-subsection filter-section"},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"filter-types"},u.a.createElement(Nu,{name:"Low-pass",option:Pu,selectedType:a,setType:r}),u.a.createElement(Nu,{name:"Hi-pass",option:"HP",selectedType:a,setType:r})),u.a.createElement(Fa.a,{automation:e.automation,name:"Cutoff",sequencerEngine:e.sequencerEngine,lfoEnabled:!0,parameter:a===Pu?e.instrument.filterCutoffParameter:e.instrument.hpFilterCutoffParameter,onParameterChanged:function(){return[]},isParameter:!0,root:1.5,min:0,max:1e4,step:1}),u.a.createElement(Fa.a,{automation:e.automation,name:"Resonance",sequencerEngine:e.sequencerEngine,parameter:a===Pu?e.instrument.filterQParameter:e.instrument.hpFilterQParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:20,step:1}))}),qu=n(1317),Tu=n(62);var Mu=Object(m.b)(function(e,t){return{value:t.parameter.get(),hasAutomations:t.parameter.automations&&t.parameter.automations.length>0}},function(e){return{setShowPianoRoll:function(t){return e(Object(f.Le)(t))},setShowAutomation:function(t){return e(Object(f.xe)(t))},setTrackAutomationParameter:function(t,n){return e(Object(f.rf)(t,n))},setBottomMode:function(t){return e(Object(f.B)(t))}}})(function(e){var t=e.name,n=e.value,a=e.className,r=e.parameter,l=e.hasAutomations,f=e.setShowPianoRoll,m=e.setBottomMode,p=e.setShowAutomation,d=e.setTrackAutomationParameter,h=Object(i.useState)(0),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useRef)(!1),O=Object(i.useRef)(0),y=Object(i.useCallback)(function(){if(p(!0),f(!0),m(Tu.b),r.track){var e=r.track.instrumentRack?r.track.instrumentRack:r.track;d(e.id,r)}},[r]),k=Object(i.useCallback)(function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,o,s,i,u,l,f=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=f.length>1&&void 0!==f[1]?f[1]:1,a=t.clientY,g(a),O.current=0,E.current=n;case 5:if(!E.current){e.next=18;break}return o=Math.pow(O.current,2),O.current<0&&(o=-o),s=r.get(),i=Math.floor(s),u=Math.round(1e3*(s-i)),1===n?i=Math.round(i-o/40):u=Math.round(u-o/40),(l=i+u/1e3)>=0&&r.set(l),e.next=16,Object(Ve.a)(100);case 16:e.next=5;break;case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[r,g]),j=Object(i.useCallback)(function(e){E.current=void 0},[]),C=Object(i.useCallback)(function(e){E.current&&(O.current=e.clientY-v)},[v]),S=Math.floor(n),w=Math.round(1e3*(n-S));return u.a.createElement(vn.a,{element:r,className:"fm-parameter "+a},u.a.createElement(qu.a,{parameter:r}),u.a.createElement("div",null,t),u.a.createElement("div",{className:"values"},u.a.createElement("div",{onMouseDown:function(e){return k(e,1)},onMouseUp:j,onMouseLeave:j,onMouseMove:C,className:"whole-value"},S),u.a.createElement("div",{className:"dot-value"},"."),u.a.createElement("div",{onMouseDown:function(e){return k(e,2)},onMouseUp:j,onMouseLeave:j,onMouseMove:C,className:"decimal-value"},function(e){for(var t=e.toString();t.length<3;)t="0"+t;return t}(w))),l?u.a.createElement("img",{className:"automation-icon",onClick:y,src:"/automation-icon-disabled.png"}):"")});function Ru(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Du=function(e){Object(xe.a)(n,e);var t=Ru(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={oscToVoices:{}},a}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.instrument;this.timeout=setInterval(function(){var n=Object(B.a)({},e.state.oscToVoices);for(var a in t.oscillators){var r=t.oscillators[a].voices.filter(function(e){return"started"===e.oscillator.state}).length;n[a]=r}e.setState({oscToVoices:n})},20)}},{key:"componentWillUnount",value:function(){clearTimeout(this.timeout)}},{key:"render",value:function(){var e=this,t=this.props.instrument.oscillatorNodes;return u.a.createElement("div",{className:"oscs-info"},t.map(function(t,n){return u.a.createElement("div",{className:"osc"},t.name," - ",e.state.oscToVoices[n])}))}}]),n}(i.Component);Object(m.b)(function(e,t){return{}},function(e){return{}})(Du);function Iu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Au=function(e){Object(xe.a)(n,e);var t=Iu(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props.instrument.getOscillator(this.props.selectedOscillator),t=this.props.instrument;return u.a.createElement("div",{className:"oscillators-continued"},u.a.createElement(Fa.a,{sequencerEngine:t.sequencerEngine,name:"Noise",parameter:t.noiseLevelParameter,isParameter:!0,lfoEnabled:!0,root:2,min:0,max:1,step:.001}),u.a.createElement(Fa.a,{sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,name:"Polyphony",parameter:t.polyphonyParameter,onParameterChanged:function(){return[]},isParameter:!0,min:1,max:12,step:1}),u.a.createElement(Fa.a,{sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,name:"Glide",parameter:e.portamentoParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:5,step:.01}),u.a.createElement(Fa.a,{sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,name:"X/Y Mix",parameter:t.mixParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:0,max:1,step:.01}))}}]),n}(i.Component),Lu=Object(m.b)(function(e,t){return{algorithm:t.instrument.algorithmParameter.get(),adjacencyLists:t.instrument.adjacencyLists}},function(e){return{}})(Au);Object(m.b)(function(e,t){return{harmonicity:t.oscillator.harmonicityParameter.get()}},function(e){return{}})(function(e){var t=e.harmonicity,n=Math.floor(t),a=t-n;return u.a.createElement("div",{className:"harmonicity fm-parameter"},u.a.createElement("div",null,"Harmonicity"),u.a.createElement("div",{className:"values"},u.a.createElement("div",{className:"whole-value"},n),u.a.createElement("div",{className:"dot-value"},"."),u.a.createElement("div",{className:"decimal-value"},a)))}),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){return u.a.createElement("div",null)}),Object(m.b)(function(e,t){return{modulation:t.oscillator.modulationIndexParameter.get()}},function(e){return{}})(function(e){return u.a.createElement("div",{className:"harmonicity fm-parameter"},u.a.createElement("div",null,"Modulation"),u.a.createElement("div",{className:"value"},e.modulation))});function Fu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var zu=function(e){Object(xe.a)(n,e);var t=Fu(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"onClickPartialCount",value:function(){var e=this.props.oscillator.partialCountParameter;e.set((e.get()+1)%e.max)}},{key:"render",value:function(){var e=this;this.props.oscillator;return u.a.createElement("div",{className:"partial-count-container"},u.a.createElement("div",{onClick:function(){return e.onClickPartialCount()},className:"partial-count"},this.props.value),u.a.createElement("div",null,"Partials"))}}]),n}(i.Component),Bu=Object(m.b)(function(e,t){var n=t.oscillator.partialCountParameter;return{value:void 0===t.automation||void 0===t.automation.get(n)?e.effects.effectParameters[n.id]:t.automation.get(n).value}},null)(zu);Object(m.b)(function(e,t){var n=t.instrument.getOscillator(t.selectedOscillator);return{keyboard:n.keyboard,customOscillatorType:n.customOscillatorType,oscillatorType:n.oscillatorType,partials:n.partials,bandpass:n.bandpassParameter.get()}},function(e){return{}})(function(e){var t=e.selectedOscillator,n=e.instrument,a=(e.color,n.getOscillator(t));return u.a.createElement("div",{className:"instrument-subsection fm-operator-control"},u.a.createElement("div",{className:"top-of-section"},u.a.createElement("div",{className:"instrument-subsection-name"},a.name),u.a.createElement("div",{className:"osc-type-container"},u.a.createElement(Zc,{instrument:n,oscillator:a,sequencerEngine:n.sequencerEngine}))),a.customOscillatorType?u.a.createElement(Fa.a,{name:"Harmonics",sequencerEngine:n.sequencerEngine,isParameter:!0,parameter:a.harmonicsParameter,step:.001,min:-1,max:1}):"","custom"===a.oscillatorType?u.a.createElement(_c,{partials:a.partials,oscillator:a}):"",a.customOscillatorType||"custom"===a.oscillatorType?"":u.a.createElement("div",{className:"partials"},u.a.createElement(Fa.a,{name:"Partials",sequencerEngine:n.sequencerEngine,isParameter:!0,parameter:a.partialCountParameter,step:1,min:0,max:64})),u.a.createElement(Fa.a,{sequencerEngine:n.sequencerEngine,name:"Volume",parameter:a.oscillatorLevelParameter,onParameterChanged:function(){return[]},displayFunction:function(e){return Math.round(100*e)},unit:"%",isParameter:!0,lfoEnabled:!0,min:0,max:1,step:.01}),u.a.createElement(He.a,{condition:"PWM"===a.oscillatorTypeParameter.get()},u.a.createElement(Fa.a,{sequencerEngine:n.sequencerEngine,name:"PWM",parameter:a.pwmParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:0,max:20,step:.01})),u.a.createElement("div",{className:"frequency-parameters"},u.a.createElement(Fa.a,{sequencerEngine:n.sequencerEngine,name:"Frequency",parameter:a.keyboard?a.oscillatorFrequencyParameter:n.carrier.oscillatorFrequencyParameter,onParameterChanged:function(){return n.releaseAll()},displayFunction:function(e){return Lc.a.fromTranspose(e).toString()},isParameter:!0,min:-32,max:32,step:1}),u.a.createElement(Fa.a,{name:"Detune",sequencerEngine:n.sequencerEngine,lfoEnabled:!0,parameter:a.detuneParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1})),a.bandpassParameter.get()?u.a.createElement("div",{className:"bandpass-parameters"},u.a.createElement(Fa.a,{name:"Band Freq",sequencerEngine:n.sequencerEngine,lfoEnabled:!0,parameter:a.bandpassFrequencyParameter,onParameterChanged:function(){return[]},isParameter:!0,min:10,max:5e3,step:1}),u.a.createElement(Fa.a,{name:"Band Q",sequencerEngine:n.sequencerEngine,lfoEnabled:!0,parameter:a.bandpassQParameter,onParameterChanged:function(){return[]},isParameter:!0,min:.1,max:10,step:.01})):"",u.a.createElement(He.a,{condition:"C"!==a.name},u.a.createElement("div",{className:"keyboard-control"},u.a.createElement(Cr.a,{flipped:!0,name:"FM",parameter:a.keyboardParameter}),u.a.createElement(Cr.a,{name:"Osc. Enabled",parameter:a.enabledParameter}),u.a.createElement(Cr.a,{name:"Bandpass",parameter:a.bandpassParameter}))),u.a.createElement(He.a,{condition:"C"===a.name},u.a.createElement("div",{className:"keyboard-control"},"Keyboard"),u.a.createElement(Cr.a,{name:"Bandpass",parameter:a.bandpassParameter})))});function _u(e,t){for(var n in e)if(t[n]!==e[n])return!1;for(var a in t)if(t[a]!==e[a])return!1;return!0}var Hu=function(){function e(t){Object(Pe.a)(this,e),this.filter=t,this.results=void 0}return Object(Ne.a)(e,[{key:"isEqual",value:function(e){return _u(this.filter.instrumentTypes,e.filter.instrumentTypes)&&_u(this.filter.tags,e.filter.tags)}},{key:"getPaginatedResults",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return void 0===this.results?[]:this.results.length>e+t?this.results.slice(e,e+t):this.results.slice(e)}}]),e}(),Uu=We.a.presets;function Gu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Wu=new(function(){function e(){Object(Pe.a)(this,e),this.queries=[]}return Object(Ne.a)(e,[{key:"clear",value:function(){this.queries=[]}},{key:"getPaginatedPresets",value:function(){var e=Object(o.a)(c.a.mark(function e(t,n){var a,r,o,s,i,u=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=u.length>2&&void 0!==u[2]?u[2]:10,r=u.length>3&&void 0!==u[3]?u[3]:0,t=Object(B.a)({},t),o=new Hu(t),void 0===(s=this.queries.find(function(e){return e.isEqual(o)}))){e.next=7;break}return e.abrupt("return",s.getPaginatedResults(n,a));case 7:return e.next=9,Uu.getPresets(t,r);case 9:return i=e.sent,o.results=i,this.queries.push(o),e.abrupt("return",o.getPaginatedResults(n,a));case 13:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),e}()),Vu=function(e){Object(xe.a)(n,e);var t=Gu(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={presets:[],start:0,loading:!1,loadingCounter:0,probability:.5,crossbreedEffects:!0},a.getPresets(),a.onClickNext=a.onClickNext.bind(Object(Cn.a)(a)),a.onClickPrevious=a.onClickPrevious.bind(Object(Cn.a)(a)),a}return Object(Ne.a)(n,[{key:"onClickNext",value:function(){this.state.start=this.state.start+10,this.getPresets()}},{key:"onClickPrevious",value:function(){this.state.start=Math.max(0,this.state.start-10),this.getPresets()}},{key:"startLoading",value:function(){var e=this;this.setState({loading:!0}),this.loadingTimer=setInterval(function(){e.setState({loadingCounter:(e.state.loadingCounter+1)%5})},200)}},{key:"stopLoading",value:function(){this.setState({loading:!1}),clearInterval(this.loadingTimer)}},{key:"getPresets",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t={instrumentTypes:{},tags:{}}).instrumentTypes[this.props.track.instrument.getInstrumentType()]=!0,e.next=4,Wu.getPaginatedPresets(t,this.state.start);case 4:n=e.sent,this.setState({presets:n});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onUpdateProbability",value:function(e){this.setState({probability:e/100})}},{key:"onClickPreset",value:function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.startLoading(),e.next=3,this.props.track.mateWithPreset(t,this.state.probability,this.state.crossbreedEffects);case 3:this.stopLoading();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getEffectsClassName",value:function(e){return this.state.crossbreedEffects===e?"crossbreed-option enabled":"crossbreed-option"}},{key:"onClickEffects",value:function(e){this.setState({crossbreedEffects:e})}},{key:"render",value:function(){for(var e=this,t="",n=0;n<this.state.loadingCounter;n++)t+=".";return u.a.createElement("div",{className:"fm-genetix"},u.a.createElement("div",{onClick:this.props.onClickBack,className:"back-button"},"Back"),u.a.createElement(He.a,{condition:this.state.loading},u.a.createElement("div",{className:"loading-spinner"},"Loading ",t," ")),u.a.createElement(He.a,{condition:!this.state.loading},u.a.createElement("div",{className:"crossbreed-options"},u.a.createElement("div",null,u.a.createElement("div",{className:"crossbreed-probability"},"Crossbreed Preset: ",100*this.state.probability,"%"),u.a.createElement(be.a,{value:100*this.state.probability,change:function(t){return e.onUpdateProbability(t.target.value)},step:.01,max:100,min:0,orientation:"horizontal",reversed:!1})),u.a.createElement("div",null,"Crossbreed Effects:",u.a.createElement("span",{onClick:function(){return e.onClickEffects(!0)},className:this.getEffectsClassName(!0)},"Yes"),u.a.createElement("span",{onClick:function(){return e.onClickEffects(!1)},className:this.getEffectsClassName(!1)},"No"))),u.a.createElement("div",{className:"presets"},this.state.presets.map(function(t,n){return u.a.createElement("div",{onClick:function(){return e.onClickPreset(t)},className:n%2===0?"preset":"preset odd"},t.title)})),u.a.createElement("div",{className:"pagination-buttons"},u.a.createElement(He.a,{condition:this.state.start>0},u.a.createElement("div",{onClick:this.onClickPrevious,className:"pagination-button"},"PREVIOUS")),u.a.createElement("div",{onClick:this.onClickNext,className:"pagination-button"},"NEXT"))))}}]),n}(i.Component);function Xu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Ku=function(e){Object(xe.a)(n,e);var t=Xu(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={selectedLFO:0},a}return Object(Ne.a)(n,[{key:"getLFOOptions",value:function(){return[{value:0,label:"LFO 1"},{value:1,label:"LFO 2"},{value:2,label:"LFO 3"},{value:3,label:"LFO 4"}]}},{key:"getLFOOption",value:function(e){for(var t=this.getLFOOptions(),n=0;n<t.length;n++)if(t[n].value==e)return t[n];return null}},{key:"onSelectLFO",value:function(e){this.setState({selectedLFO:e.value})}},{key:"onChangeSynced",value:function(e){this.getLFO().isSynced="unsynced"===e,this.setState(this.state)}},{key:"getLFO",value:function(){return this.props.instrument.lfos[this.state.selectedLFO]}},{key:"render",value:function(){var e=this,t=this.getLFO();return u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name lfo-subsection-name colored-lfo-name-"+this.state.selectedLFO},"LFO"),u.a.createElement("div",{className:"osc-type-dropdown-container"},u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.getLFOOptions(),onChange:function(t){return e.onSelectLFO(t)},value:this.getLFOOption(this.state.selectedLFO),placeholder:"LFO"})),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(pu,{lfo:t}),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"refined-checkbox-preferences"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:t.isSynced?"synced":"unsynced",checked:t.isSynced,onChange:function(t){return e.onChangeSynced(t.target.value)}}),"Synced")),t.isSynced?u.a.createElement(lu,{lfo:t}):u.a.createElement(Fa.a,{effectNumber:0,name:"Rate",parameter:t.lfoRateParameter,onParameterChanged:function(){return[]},isParameter:!0,step:.1,min:0,max:32}),u.a.createElement(Fa.a,{effectNumber:0,name:"Min",parameter:t.lfoMinParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}),u.a.createElement(Fa.a,{effectNumber:0,name:"Max",parameter:t.lfoMaxParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}))}}]),n}(i.Component);function Qu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Yu=function(e){Object(xe.a)(n,e);var t=Qu(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"enableOscillator",value:function(){this.props.sequencerEngine.operationManager.dispatch(Object(dt.v)(this.props.oscillator.enabledParameter,!0)),this.setState(this.state)}},{key:"disableOscillator",value:function(){this.props.sequencerEngine.operationManager.dispatch(Object(dt.v)(this.props.oscillator.enabledParameter,!1)),this.setState(this.state)}},{key:"onClick",value:function(){this.props.oscillator.enabled?this.props.selectedOscillator===this.props.number?this.disableOscillator():this.props.onChooseOscillator(this.props.number):(this.enableOscillator(),this.props.onChooseOscillator(this.props.number))}},{key:"render",value:function(){var e=this,t=this.props.number===this.props.selectedOscillator?"oscillator-option selected":"oscillator-option";return this.props.enabled||(t+=" disabled"),u.a.createElement("div",{onClick:function(){return e.onClick()},className:t},this.props.number+1)}}]),n}(i.Component),Ju=Object(m.b)(function(e,t){var n=t.oscillator.enabledParameter;return{enabled:e.effects.effectParameters[n.id]}},null)(Yu);function Zu(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component;var $u=n(278),el=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.color,n=e.onChange,a=(e.instrument,e.option),r=e.isSelected,c={};return r&&(c.backgroundColor=t),u.a.createElement("div",{style:c,onClick:function(){return n(a)},className:r?"envelope-option selected":"envelope-option"},a)});function tl(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component;function nl(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component;var al=Object(m.b)(function(e,t){return{selectedParameter:e.effects.accumulatorParameterSelected,selectedFMEnvelopeType:e.instruments.selectedFMEnvelopeType}},null)(function(e){var t=e.selectedFMEnvelopeType,n=Object(da.a)(e,["selectedFMEnvelopeType"]),a=Object(i.useState)(t||"Amp"),r=Object(s.a)(a,2),c=r[0],o=r[1];Object(i.useEffect)(function(){t&&o(t)},[o,t]);var l=n.instrument,f={};if(void 0===l.oscillatorNodes[1]||void 0===l.oscillatorNodes[2]||void 0===l.oscillatorNodes[3])return u.a.createElement("div",null);switch(c){case"Amp":f.Amp=l.ampEnvelope,f.hasRelease=!0;break;case"Mods":l.oscillatorNodes[1].enabled&&(f.A=l.oscillatorNodes[1].ampEnvelope),l.oscillatorNodes[2].enabled&&(f.B1=l.oscillatorNodes[2].ampEnvelope),l.oscillatorNodes[3].enabled&&(f.B2=l.oscillatorNodes[3].ampEnvelope),f.hasRelease=!1;break;case"Filter":f["Low-pass"]=l.filterEnvelope,f["Hi-pass"]=l.hpFilterEnvelope,f.hasRelease=!0,f.hasDepth=!0;break;case"Pitch":f.Pitch=l.pitchEnvelope,f.hasRelease=!0,f.hasDepth=!0}return Object(i.useEffect)(function(){if(n.selectedParameter){var e=n.selectedParameter.context;if(!e)return;if(e.subDevice){var t=e.subDevice;t===l.pitchEnvelope?o("Pitch"):t===l.filterEnvelope||t===l.hpFilterEnvelope?o("Filter"):l.oscillatorNodes.slice(1).some(function(e){return e.ampEnvelope===t})?o("Mods"):l.ampEnvelope===t&&o("Amp")}}},[n.selectedParameter,o]),u.a.createElement("div",{className:"envelopes-component"},u.a.createElement("div",{className:"envelope-options"},["Amp","Mods","Filter","Pitch"].map(function(e){return u.a.createElement(el,{key:e,instrument:l,onChange:function(e){return o(e)},option:e,isSelected:c===e})})),u.a.createElement("div",{className:"clear-fix"}),Object.keys(f).filter(function(e){return"hasRelease"!==e&&"hasDepth"!==e}).map(function(e,t){return u.a.createElement("div",{key:e+t},u.a.createElement(mi.a,{instrument:l,key:e+t,width:200,fillColor:n.color,lineColor:n.color,sequencerEngine:n.sequencerEngine,envelope:f[e],name:e,hasRelease:f.hasRelease,hasLevel:!1}),f.hasDepth?u.a.createElement(Fa.a,{parameter:f[e].levelParameter,sequencerEngine:n.sequencerEngine,isParameter:!0,name:"Env Depth",max:1,min:-1,step:.01}):"")}))}),rl=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.instrument,n=e.setMods,a=Object(i.useState)(50),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(t.getStats()),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useCallback)(function(){t.simplifyPatch(c);var e=t.getStats();p(e),n(e)},[p,t,c,n]);return u.a.createElement("div",{className:"simplifier"},u.a.createElement("div",{className:"stats"},m," modulations"),u.a.createElement("div",{className:"slider-and-btn"},u.a.createElement(be.a,{value:c,change:function(e){return o(e.target.value)},step:1,max:100,min:0,orientation:"horizontal",reversed:!1}),u.a.createElement("div",{onClick:d,className:"simplify-btn"},"Simplify Patch (",c,"%)")))}),cl=n(733);n(1106),n(2435);function ol(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var sl=function(e){Object(xe.a)(n,e);var t=ol(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"parameterMods",get:function(){var e=[];return this.props.parameters.forEach(function(t){return e=e.concat(t.parameterMods)}),e}},{key:"render",value:function(){var e=this.parameterMods;return 0===e.length?u.a.createElement("div",null):u.a.createElement("div",null,u.a.createElement("div",{className:"synth-mods-name"},this.props.name),e.map(function(e){return u.a.createElement(cl.a,{parameterMod:e})}))}}]),n}(i.Component),il=function(e){var t=Object(i.useState)(0),n=Object(s.a)(t,2),a=(n[0],n[1]),r=e.instrument,c={},o={};if(r.getInstrumentType()==jt.c)c={"Carrier Oscillator":r.carrierOscillator,"Modulator Oscillator":r.modulatorOscillator};else{var l=r.oscillatorNodes[0],f=r.oscillatorNodes[1],m=r.oscillatorNodes[2],p=r.oscillatorNodes[3];c={"Oscillator 1":l,"Oscillator 2":f,"Oscillator 3":m,"Oscillator 4":p};var d=r.ampEnvelope,h=r.filterEnvelope,b=r.pitchEnvelope;o={"Amp Envelope":d,"Filter Envelope":h,"Pitch Envelope":b}}return u.a.createElement("div",{className:"synth-mods"},u.a.createElement(rl,{setMods:a,instrument:r}),u.a.createElement(sl,{name:"Synth",parameters:r.parameters}),Object.keys(c).map(function(e){return u.a.createElement(sl,{name:e,parameters:c[e].parameters})}),Object.keys(o).map(function(e){return u.a.createElement(sl,{name:e,parameters:o[e].parameters})}))},ul=(n(1329),[{value:$u.a,label:"Amp"},{value:$u.e,label:"Op. A"},{value:$u.f,label:"Op. B1"},{value:$u.g,label:"Op. B2"},{value:$u.b,label:"Filter"},{value:$u.h,label:"Pitch"}]),ll=(n(2436),new h.a),fl=Object(m.b)(function(e,t){var n=t.instrument.oscillatorNodes;return n?{preset1:n[0].preset,preset2:n[1].preset,preset3:n[2].preset,preset4:n[3].preset,selectedParameter:e.effects.accumulatorParameterSelected,planeMapping:e.effects.planeMapping,presetName:t.track.presetName,formant:e.instruments.showFormantEffect,selectedFMOperatorDetails:e.instruments.selectedFMOperatorDetails,showFormantPresets:e.instruments.showFormantPresets}:{}},function(e){return{}})(function(e){var t=Object(i.useRef)(void 0),n=Object(i.useState)(void 0),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useState)(!1),l=Object(s.a)(o,2),f=l[0],m=l[1],p=Object($i.a)({ref:t}),d=(p.onContextMenu,p.dropdownPos),h=p.setDropdownPos,b=Object(i.useState)(void 0),v=Object(s.a)(b,2),g=v[0],E=(v[1],Object(i.useState)(void 0)),O=Object(s.a)(E,2),y=O[0],k=O[1],j=Object(i.useState)(0),C=Object(s.a)(j,2),S=C[0],w=C[1],P=Object(i.useState)(!1),N=Object(s.a)(P,2),x=N[0],q=N[1],T=e.instrument,M=e.color||ll.getColorForTrack(e.track),R=Object(i.useCallback)(function(){e.track.subSequence.createZObject(0,0,"synthcontrol").effect.linkSynth(e.instrument)},[e.instrument]);Object(i.useEffect)(function(){void 0!==e.selectedFMOperatorDetails?k(T.oscillatorNodes[e.selectedFMOperatorDetails]):k(void 0)},[e.selectedFMOperatorDetails,k,T]);var D=T.oscillatorNodes[S],I=y;Object(i.useEffect)(function(){var e=T.oscillatorNodes.indexOf(y);w(-1===e?0:e)},[w,y]),Object(i.useEffect)(function(){if(e.selectedParameter){var t=e.selectedParameter.context;if(t.instrument===T){var n=t.subDevice;if(n){n.oscillator&&(n=n.oscillator);var a=T.oscillatorNodes.indexOf(n);a>-1&&(w(a),k(n))}else k(void 0)}}},[e.selectedParameter,T,w,k]);var A=Object(i.useCallback)(function(){q(!x)},[q,x]),L="instrument multi-synth rack-synth";e.planeMapping&&(L+=" plane-mapping");var F=Object(i.useCallback)(function(t){t.stopPropagation(),e.planeMapping&&e.planeMapping.randomlyMapParameters(e.track)},[e.planeMapping,e.instrument]),z="",B="";if(r){var _="";"LFO"===r?_=e.track.lfosTrack.lfos.map(function(t){return u.a.createElement(vu,{key:t.number,lfo:t,sequencerEngine:e.sequencerEngine})}):"ENVELOPE"===r&&(_=e.track.envelopesTrack.envelopes.map(function(t){return u.a.createElement(su,{scrollContainer:e.scrollContainer,key:t.number,envelopeTrack:t,sequencerEngine:e.sequencerEngine})})),z=u.a.createElement("div",{className:"inner showing-mods"},u.a.createElement("div",{className:"mods-inner"},_))}return B=u.a.createElement("div",null,u.a.createElement(He.a,{condition:!x},u.a.createElement("div",{className:"inner"},(!f||!y)&&u.a.createElement(gu,{color:M,track:e.track,osc:D,scrollContainer:e.scrollContainer,setSelectedOscillator:w,sequencerEngine:e.sequencerEngine,instrument:e.instrument}),u.a.createElement("div",null,u.a.createElement("div",{className:"sections"},u.a.createElement("div",{className:"instrument-section"},u.a.createElement(wu,{formantsExpanded:f&&y,setFormantsExpanded:m,color:M,setOscillatorDetails:k,oscillatorDetails:y,sequencerEngine:e.sequencerEngine,instrument:T}),g||y?"":u.a.createElement(xu,{automation:e.automation,sequencerEngine:e.sequencerEngine,instrument:T})),I&&e.showFormantPresets?u.a.createElement(Qo,{isPianoRoll:!1,initialSize:10,oscillator:I||T.oscillators[0],track:I||T.oscillators[0],content:(I||T.oscillators[0]).preset,searchText:"",type:"formants"},u.a.createElement(Ji,{oscillator:I||T.oscillators[0]})):e.formant?u.a.createElement(Jo,{track:e.track,sequencerEngine:e.sequencerEngine,formant:e.formant,instrument:T}):u.a.createElement("div",{className:"instrument-section envelopes"},u.a.createElement("div",{className:"instrument-subsection envelopes"},u.a.createElement(al,{color:M,automation:e.automation,envelopeOptions:ul,sequencerEngine:e.sequencerEngine,instrument:T})),u.a.createElement("div",{className:"aux-parameters"},u.a.createElement(Lu,{instrument:T,selectedOscillator:S,sequencerEngine:e.sequencerEngine}),u.a.createElement("div",{className:"mods-container"},u.a.createElement("div",{onClick:function(){return c("LFO"===r?void 0:"LFO")},className:"LFO"===r?"mod-type-btn selected pushable ":"mod-type-btn pushable"},"LFOs"),u.a.createElement("div",{onClick:function(){return c("ENVELOPE"===r?void 0:"ENVELOPE")},className:"ENVELOPE"===r?"mod-type-btn selected pushable":"mod-type-btn pushable"},"ENVs"),u.a.createElement("div",{onClick:A,className:"mod-type-btn pushable"},"MODS")))))))),u.a.createElement(He.a,{condition:x},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(il,{instrument:T}),u.a.createElement("div",{onClick:A,className:"mods-button common-button small-button"},x?"BACK":"MODS"))),u.a.createElement("div",{ref:t,onClick:F,className:L},u.a.createElement(Zi.a,{dropdownPos:d,setDropdownPos:h},u.a.createElement(eu.a,{onMouseDown:R},"Create Controller Object")),B,z)});function ml(e){var t=e.sequencerEngine.resampleConfig,n=Object(i.useState)(t.samplesPerNote),a=Object(s.a)(n,2),r=(a[0],a[1]),c={label:t.samplesPerNote,value:t.samplesPerNote},o=Object(i.useCallback)(function(e){t.samplesPerNote=e,r(e)},[r]);return u.a.createElement("div",{className:"samples-per-note"},u.a.createElement("div",{className:"dropdown-label"},"Samples Per Note:"),u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=[],n=1;n<=e;n++)t.push({label:n,value:n});return t}(),onChange:function(e){return o(e.value)},value:c,placeholder:"Samples per note"}))}function pl(e){var t=Object(i.useState)(e.sequencerEngine.autoResampleMode),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useCallback)(function(){var t=e.sequencerEngine;if(a)return t.autoResampleMode=!1,t.store.dispatch(Object(f.Ld)(!1)),void r(!1);t.autoResampleMode=!0,t.masterResampler.prepare(),t.store.dispatch(Object(f.Ld)(!0)),r(!0)},[a,r]),o=a?"sample-synth-button sampling":"sample-synth-button";return u.a.createElement("div",{className:"resample-config"},u.a.createElement("div",{onClick:c,className:o},a?"Sample...":"Sample"),u.a.createElement(ml,{sequencerEngine:e.sequencerEngine}))}n(2437);function dl(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var hl=function(e){Object(xe.a)(n,e);var t=dl(n);function n(e){var a;Object(Pe.a)(this,n);var r=void 0===(a=t.call(this,e)).props.track.midiChannel?"all":a.props.track.midiChannel;return a.state={midiChannel:r},a}return Object(Ne.a)(n,[{key:"onSelectMidiChannel",value:function(e){this.state.midiChannel=e.value,this.props.track.midiChannel=e.value,this.setState(this.state)}},{key:"updateLatency",value:function(e){this.props.track.latency=e,this.setState(this.state)}},{key:"onClick",value:function(){this.props.planeMapping&&this.props.planeMapping.randomlyMapParameters(this.props.track,void 0,this.props.track.ccParameters)}},{key:"render",value:function(){var e=this,t=this.props.track.sequencerEngine.midi;return u.a.createElement("div",{onClick:function(){return e.onClick()},className:this.props.planeMapping?"instrument plane-mapping external-instrument":"instrument external-instrument"},u.a.createElement("div",{className:"external-instrument-header"},"External Instrument"),u.a.createElement("div",{className:"inner-instrument"},u.a.createElement("div",{className:"midi-channel-container"},u.a.createElement("div",{className:"midi-channel"},"Channel: "),u.a.createElement(D.a,{className:"midi-input-dropdown",controlClassName:"midi-input-control-dropdown",options:vl,onChange:function(t){return e.onSelectMidiChannel(t)},value:gl(this.state.midiChannel),placeholder:"Midi Channel"})),u.a.createElement("div",{className:"midi-outputs-container"},t.getTrackedOutputs().map(function(t){return u.a.createElement(bl,{track:e.props.track,output:t})})),u.a.createElement("div",null,u.a.createElement("div",null,"Latency: ",this.props.track.latency," ms"),u.a.createElement(be.a,{value:this.props.track.latency,change:function(t){return e.updateLatency(t.target.value)},step:1,max:100,min:1,orientation:"horizontal",reversed:!1})),u.a.createElement(pl,{sequencerEngine:this.props.track.sequencerEngine})))}}]),n}(i.Component),bl=function(e){Object(xe.a)(n,e);var t=dl(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return this.props.track.getMidiOutputs().has(this.props.output)}},{key:"onClickMidiOutput",value:function(){this.isEnabled()?this.props.track.deleteMidiOutput(this.props.output):this.props.track.addMidiOutput(this.props.output),this.setState(this.state)}},{key:"render",value:function(){var e=this;this.isEnabled();return u.a.createElement("div",{className:this.isEnabled()?"midi-option enabled":"midi-option",onClick:function(){return e.onClickMidiOutput()}},this.props.output.name)}}]),n}(i.Component),vl=[{value:"all",label:"All"},{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"6"},{value:7,label:"7"},{value:8,label:"8"},{value:9,label:"9"},{value:10,label:"10"},{value:11,label:"11"},{value:12,label:"12"}];function gl(e){for(var t=0;t<vl.length;t++)if(vl[t].value==e)return vl[t];return null}var El=Object(m.b)(function(e){return{planeMapping:e.effects.planeMapping}},null)(hl),Ol=Object(i.memo)(function(e){var t=e.coloredWaveformPoints;return u.a.createElement(ka.b,null,t.map(function(e,t){return u.a.createElement(ka.g,{key:"point-"+t,x:e.x,y:e.y,width:e.width,height:e.height,fill:"rgb("+e.rgb[0]+","+e.rgb[1]+","+e.rgb[2]+")"})}))}),yl=Object(i.memo)(function(e){e.waveformPoints;var t=e.rmsPoints,n=e.color;return u.a.createElement(ka.b,null,u.a.createElement(ka.e,{bezier:!0,points:t,stroke:n,strokeWidth:2}))}),kl=function(e,t,n){return t?e/t.duration*n:0},jl=Object(i.memo)(function(e){var t=e.sampler,n=e.height,a=e.instrument,r=e.buffer,c=e.color,o=e.width,s=(e.step,e.zoomedStartTime),i=e.setDraggingStart,l=e.setDraggingEnd;if(void 0===r)return u.a.createElement(ka.d,null);var f=t.getLoopPoints(a.getLoopPoints(0,t)),m=f.loopStart,p=f.loopEnd;return m=kl(m-s,r,o),p=kl(p-s,r,o),u.a.createElement(ka.d,null,u.a.createElement(ka.g,{x:m,y:0,width:p-m,height:n,fill:c,opacity:.15}),u.a.createElement(ka.e,{points:[m,0,m,n],stroke:"red",strokeWidth:2}),u.a.createElement(ka.e,{onMouseDown:i,points:[m,0,m,n],stroke:"black",opacity:0,strokeWidth:20}),u.a.createElement(ka.e,{points:[p,0,p,n],stroke:"red",strokeWidth:2}),u.a.createElement(ka.e,{onMouseDown:l,points:[p,0,p,n],stroke:"black",opacity:0,strokeWidth:20}))}),Cl=Object(m.b)(function(e,t){var n=void 0===e.sequencer.sequencerEngine?void 0:e.sequencer.sequencerEngine.getSequenceId();return{step:void 0!==n&&e.sequencer.isPlaying[n]?e.sequencer.sequencerEngine.trackStep:0,loopStart:t.instrument.loopStart,loopLength:t.instrument.loopLength}},null)(jl),Sl=n(596);function wl(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Pl=function(e){Object(xe.a)(n,e);var t=wl(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={playTicks:{}},a.onTriggerSample=a.onTriggerSample.bind(Object(Cn.a)(a)),a.onReleaseSample=a.onReleaseSample.bind(Object(Cn.a)(a)),a}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener(Sl.d,this.onTriggerSample),window.addEventListener(Sl.c,this.onReleaseSample)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(Sl.d,this.onTriggerSample),window.removeEventListener(Sl.c,this.onReleaseSample)}},{key:"onReleaseSample",value:function(e){var t=this;setTimeout(function(){Object.keys(t.state.playTicks).forEach(function(e){return clearInterval(e)}),t.setState({playTicks:{}})},e)}},{key:"onTriggerSample",value:function(e){var t=this;if(e.soundId===this.props.soundId&&!(Object.keys(this.state.playTicks).length>=10)){var n=e.time,a=e.transpose,r=Math.pow(2,a/12);setTimeout(function(){var n=0,a=(new Date).getTime(),c=setInterval(function(){var o=(new Date).getTime();n=(o-a)/1e3;var s=t.state.playTicks,i=n*r;if(t.props.instrument&&t.props.instrument.loop){if(void 0===t.props.instrument.defaultSampler)return;i%=t.props.instrument.defaultSampler.getDuration()*t.props.instrument.loopLength/100}else t.props.sampler&&t.props.sampler.getDuration();var u=e.startTime+i;s[c]=t.props.convertSecondsToSpace(u),e.duration&&n>e.duration&&(clearInterval(c),delete s[c]),t.setState(t.state)},80),o=t.props.convertSecondsToSpace(e.startTime);t.state.playTicks[c]=o,t.setState(t.state)},n)}}},{key:"render",value:function(){var e=this;return Object.values(this.state.playTicks).map(function(t){return u.a.createElement(ka.g,{x:e.props.sequencerEngine&&e.props.sequencerEngine.reverse?e.props.width-t:t,y:0,width:2,height:e.props.height,fill:"rgb(35, 249, 111)"})})}}]),n}(i.Component);function Nl(e){return e?(e.current&&(e=e.current),.99*e.clientWidth):window.innerWidth-30}var xl=window.innerWidth-30,ql=130,Tl="START",Ml=new h.a,Rl=new Ys.a(445,75),Dl=Object(m.b)(null,function(e,t){return{}})(function(e){var t=e.backgroundColor||"black",n=e.buffer,a=e.soundId,r=e.instrument,c=e.sampler,o=Object(i.useState)(!1),l=Object(s.a)(o,2),f=l[0],p=l[1],d=Object(i.useState)(!1),h=Object(s.a)(d,2),b=h[0],v=h[1],g=Object(i.useState)(e.width||xl),E=Object(s.a)(g,2),O=E[0],y=E[1],k=Object(i.useState)(e.height),j=Object(s.a)(k,2),C=j[0],S=j[1],w=Object(i.useState)([]),P=Object(s.a)(w,2),N=P[0],x=P[1],q=Object(i.useState)([]),T=Object(s.a)(q,2),M=T[0],R=T[1],D=Object(i.useState)([]),I=Object(s.a)(D,2),A=I[0],L=I[1];Ml.getBrightness(e.color)<110&&(t=Ml.brighten(t,2));var F=Object(i.useState)(!1),z=Object(s.a)(F,2),B=z[0],_=z[1],H=Object(i.useRef)(0),U=Object(i.useRef)(null),G=function(e,t,n,a,r,c){var o=Object(i.useState)({}),u=Object(s.a)(o,2),l=u[0],f=u[1],m=Object(i.useRef)(void 0),p=Object(i.useRef)(void 0),d=Object(i.useRef)(1);Object(i.useEffect)(function(){v()},[e,c]),Object(i.useEffect)(function(){return window.addEventListener("mousewheel",h,{passive:!1}),function(){return window.removeEventListener("mousewheel",h)}},[f,l,c,t,e]);var h=Object(i.useCallback)(function(e){if(!t)return!0;if(e.ctrlKey){e.preventDefault(),e.stopPropagation();var n=e.deltaY>0?.02:.01,a=d.current-e.deltaY*n;if(a<=1)return void v();d.current=a,b(a)}else{var r=e.deltaX;Math.abs(r)>0&&(e.preventDefault(),g(r))}return!1},[t,c,e,l,f]),b=Object(i.useCallback)(function(t){var r=n.current;if((t*=2)<=2)v();else{var c=p.current||0,o=e.duration/t,s=c+O(r)-o*r/a,i=s+o;if(s<0&&(s=0),!(i-s<.001)){var u=ke.a.Master.context.sampleRate;p.current=s;var l=Object(Qs.a)(e,s*u,i*u,ke.a.Master.context);E(l,s)}}},[c,e,l,f]),v=Object(i.useCallback)(function(){r.index+=100,p.current=void 0,m.current=void 0,d.current=1,f({})},[f]),g=Object(i.useCallback)(function(t){var n=(m.current||e).duration;t/=700*d.current/e.duration;var a=p.current||0;a+=t;var r=n+(p.current||0);if(r+=t,!(a<0||r>e.duration)){var c=ke.a.Master.context.sampleRate;p.current=a;var o=Object(Qs.a)(e,a*c,r*c,ke.a.Master.context);E(o,a)}},[c,e,l,f]),E=Object(i.useCallback)(function(t,n){if(m.current=t,e.duration<3)r.getBasicWaveform(0,t,!1).then(function(e){e&&1!==d.current&&(e.sort(function(e,t){return e.x-t.x}),f({rmsPoints:Ks(e,"rmsY"),waveformPoints:Ks(e,"y")}))});else{var a=Math.ceil(8/Math.pow(d.current,2));r.getWaveform(0,t,!1,a).then(function(e){e&&1!==d.current&&f({coloredWaveformPoints:e})})}},[c,e,f]),O=Object(i.useCallback)(function(t){return(m.current||e).duration*t/a},[e,c,a]);return Object(i.useCallback)(function(t){return t/(m.current||e).duration*a},[e,c,a]),{zoomedBuffer:m.current,zoomedRmsPoints:l.rmsPoints,zoomedColoredPoints:l.coloredWaveformPoints,zoomedWaveformPoints:l.waveformPoints,zoomedStartTime:p.current}}(n,B,H,O,Rl,c),W=G.zoomedBuffer,V=G.zoomedRmsPoints,X=G.zoomedColoredPoints,K=G.zoomedWaveformPoints,Q=G.zoomedStartTime;Object(i.useEffect)(function(){if(n){var t=e.width||Nl(e.div),r=e.height||ql;return c.showingPrettyWaveform=!0,y(t),S(r),r===Rl.height&&t===Rl.width||(Rl=new Ys.a(t,r)),n.duration<3?Rl.getBasicWaveform(a,n).then(function(e){e.sort(function(e,t){return e.x-t.x}),L(Ks(e,"rmsY")),x(Ks(e,"y")),R([])}):Rl.getWaveform(a,n).then(function(e){L([]),x([]),R(e)}),function(){c.showingPrettyWaveform=!1}}},[y,S,L,x,n,a,c,R]);var Y=Object(i.useCallback)(function(){p(!1),v(!1)},[p,v]),J=Object(i.useCallback)(function(){_(!1),Y()},[_]),Z=Object(i.useCallback)(function(e){var t=U.current.getBoundingClientRect(),a=e.clientX-t.left;H.current=a;var c=100*a/O;W&&(c=100*(Q+W.duration*c/100)/n.duration),f&&r.loopStartParameter.set(Math.max(0,c),!1),b&&r.loopLengthParameter.set(Math.max(0,c-r.loopStart),!1)},[r,f,b,O,U,W,Q]),$=Ml.saturate(Ml.getColorForHash(a),3);return u.a.createElement("div",{onMouseOver:function(e){return _(!0)},onMouseUp:Y,onMouseLeave:J,onMouseMove:Z,ref:U,className:"sound-waveform"},u.a.createElement(ka.h,{width:O,height:C},u.a.createElement(m.a,{store:e.store},u.a.createElement(ka.d,{onMouseUp:Y},u.a.createElement(ka.g,{width:O,height:C,x:0,y:0,fill:t})),M.length>0?u.a.createElement(Ol,{coloredWaveformPoints:X||M}):u.a.createElement(yl,{color:$,rmsPoints:V||A,waveformPoints:K||N}),u.a.createElement(Cl,{setDraggingStart:p,setDraggingEnd:v,instrument:r,zoomedStartTime:Q||0,color:$,buffer:W||n,sampler:c,width:O,height:C}),u.a.createElement(ka.b,null,u.a.createElement(Pl,{instrument:r,soundId:a,height:C,convertSecondsToSpace:function(e){return kl(e-(Q||0),W||n,O)}})))))});window.samplerColor="#545e6e";var Il=new h.a,Al=Object(i.memo)(function(e){var t=e.sequencerEngine,n=e.selectedSampler,a=e.track,r=e.instrument,c=e.deleteSample,o=(e.sample,Object(i.useState)("")),l=Object(s.a)(o,2),f=l[0],m=l[1],p=Object(i.useCallback)(function(){a.auditionNext()},[a]),d=Object(i.useCallback)(function(){a.auditionPrevious()},[a]);Object(i.useEffect)(function(){if(n&&n.baseBuffer&&a.sample){var e=Il.getColorForHash(n.sample.getId()),c=u.a.createElement(Dl,{instrument:r,sequencerEngine:t,store:t.store,color:e,div:document.getElementsByClassName("sampled-instrument")[0],track:a,height:75,backgroundColor:window.samplerColor,fullWidth:!1,hideButtons:!0,selectedSlice:0,slices:n.slices,isReversed:n.isReversed(),sampler:n,decentralized:!0,soundId:n.sample.getId(),onKeyDown:function(){return[]},onSelectSlice:function(){return[]},buffer:n.baseBuffer.get()});m(c)}else m("")},[n,m,a,r,a.sample]);var h=a.sample&&a.sample.tags||[];return u.a.createElement("div",{className:"waveform-and-toolbar"},u.a.createElement("div",{className:"waveform-toolbar"},u.a.createElement("div",{className:"sample-name"},n&&n.sample&&n.sample.name?Ll(n.sample.name):""),u.a.createElement("div",{className:"sample-chooser-buttons"},u.a.createElement("div",{onClick:d,className:"previous-button"}),u.a.createElement("div",{onClick:p,className:"next-button"})),h.map(function(e){return u.a.createElement(q.a,{color:"light"},Ll(e))}),u.a.createElement("div",{onClick:function(){return c(n)},className:"delete-button"},"x")),f)});function Ll(e){return e.length>=16?e.substring(0,16):e}var Fl=function(){var e=Object(o.a)(c.a.mark(function e(t,n){var a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.slice(0,t.length-1),r=t[t.length-1],n.selectedTags=a,e.next=5,n.getTopTags();case 5:return o=e.sent,n.selectedTags=[],o=o.map(function(e){return e.value}).filter(function(e){return e.toLowerCase().includes(r.toLowerCase())}),e.abrupt("return",zl(o,a));case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),zl=function(e,t){if(1===e.length)return{tags:[].concat(Object(d.a)(t),[e[0]]),suggestions:[]};var n=e;if(""===t)return{suggestions:n};var a=Bl(e);return a?{suggestions:n,tags:[].concat(Object(d.a)(t),[a])}:{suggestions:n,tags:[]}},Bl=function(e){var t=void 0;for(var n in e)if(void 0===t)t=e[n];else if(void 0===(t=_l(e[n],t)))return;return t},_l=function(e,t){for(var n="",a=0;a<Math.min(e.length,t.length)&&e[a]===t[a];a++)n+=e[a];return""===n?void 0:n},Hl=function(e){var t=e.instrument,n=e.hide,a=e.setSelectedSampler,r=t.sequencerEngine,l=Object(i.useRef)(null),f=Object(i.useState)(""),m=Object(s.a)(f,2),p=m[0],h=m[1],b=Object(i.useState)(!1),v=Object(s.a)(b,2),g=v[0],E=v[1],O=Object(i.useState)(""),y=Object(s.a)(O,2),k=y[0],j=y[1],C=Object(i.useState)([]),S=Object(s.a)(C,2),w=S[0],P=S[1],N=Object(i.useCallback)(Object(o.a)(c.a.mark(function e(){var o,s,i,u,l,f;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=p.split("+").filter(function(e){return""!==e}),j(!0),e.next=4,r.getSample(o);case 4:if(s=e.sent,i=s.sample,u=s.samplesStream,!i){e.next=17;break}return e.next=10,t.newSample(0,i,u);case 10:l=e.sent,f=l.sampler,l.samplers,a(f),n(),e.next=19;break;case 17:j(!1),E(!0);case 19:case"end":return e.stop()}},e)})),[n,a,p,j,E]);Object(i.useEffect)(function(){l.current.focus()},[]);var x=Object(i.useCallback)(function(e){var t=p.split("+");t=[].concat(Object(d.a)(t.slice(0,t.length-1)),[e]),h(t.join("+")+"+"),q([].concat(Object(d.a)(t),[""])),l.current.focus()},[h,p,q,P,l]),q=Object(i.useCallback)(function(){var e=Object(o.a)(c.a.mark(function e(n){var a,r,o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fl(n,t.sequencerEngine.searcher);case 2:a=e.sent,r=a.suggestions,o=a.tags,s=[].concat(Object(d.a)(o),Object(d.a)(r)),P(s);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[P]),T=Object(i.useCallback)(function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h(t.target.value),n=t.target.value.split("+"),g&&E(!1),q(n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[h,P,q,g,E]);return k?u.a.createElement("div",{className:"sample-search-container"},u.a.createElement(Fn.a,{sizeUnit:"px",size:10,color:"#42f4f1",loading:!0})):u.a.createElement("div",{className:"sample-search-container"},u.a.createElement("div",{className:"search-box-container"},u.a.createElement("input",{value:p,ref:l,placeholder:"Type sample tags to search",onChange:T,type:"text",className:"sample-search"}),u.a.createElement("div",{onClick:N,className:"search-button"},"Search")),g?u.a.createElement("div",{className:"no-results"},"No Results"):"",u.a.createElement("div",{className:"suggestions"},w.map(function(e){return u.a.createElement("div",{onClick:function(){return x(e)},className:"suggestion"},e)})))},Ul=n(598);function Gl(e){var t=Object(i.useState)(void 0),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useCallback)(function(t){e.instrument.mixMode=t.value,r(t.value)},[e.instrument]);return Object(i.useEffect)(function(){r(e.instrument.mixMode)},[]),u.a.createElement("div",{className:"interpolation-dropdown-container"},u.a.createElement(D.a,{className:"interpolation-dropdown",controlClassName:"interpolation-control-dropdown",arrowClassName:"interpolation-arrow-dropdown",options:Vl,onChange:c,value:Wl(a),placeholder:"Mode"}))}function Wl(e){return Vl.find(function(t){return t.value===e})}var Vl=[{value:Ul.b,label:"Mix"},{value:Ul.a,label:"Alternate"},{value:Ul.c,label:"Round Robin"}],Xl=new h.a,Kl=["a","b","c","d","e","f","g","h","i","j","k","l"],Ql=function(e){var t=e.instrument,n=e.sampler,a=e.setSelectedSampler,r=e.toggleShowPiano,c=e.showPianoRoll,o=Object(i.useState)(!1),l=Object(s.a)(o,2),f=l[0],m=l[1],p=Object.keys(t.samplers).find(function(e){return t.samplers[e].indexOf(n)>-1}),d=t.samplers[p]||[],h="";return f&&(h=u.a.createElement(Hl,{setSelectedSampler:a,hide:function(){return m(!1)},instrument:t})),u.a.createElement("div",{className:"advanced-controls"},u.a.createElement("div",{className:"samples-container"},d.map(function(e,t){return u.a.createElement("div",{className:n===e?"selected sampled-sound":"sampled-sound",onClick:function(){return a(e)},style:{backgroundColor:Xl.getColorForHash(e.sample.getId())}},Kl[t])}),u.a.createElement("div",{onClick:function(){return m(!0)},className:"add-sample-button"},"+"),u.a.createElement("img",{onClick:r,className:c?"piano-icon on":"piano-icon",src:"/piano-icon.png"})),h,u.a.createElement("div",{className:"drop-here"},"Drop samples here"),u.a.createElement("div",{className:"sampler-dropdowns"},u.a.createElement("div",null,u.a.createElement(Cr.a,{name:"Mono",parameter:t.monophonicParameter}),u.a.createElement(Cr.a,{name:"Loop",parameter:t.loopParameter})),u.a.createElement(Gl,{instrument:t})))},Yl=n(1391),Jl=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.instrument,n=e.sampler,a=e.color;return u.a.createElement("div",{className:"sampler-params"},u.a.createElement("div",{className:"pitch-params"},u.a.createElement($.a,{units:"%",name:"Start",parameter:t.loopStartParameter,color:a}),u.a.createElement($.a,{units:"%",name:"Len.",parameter:t.loopLengthParameter,color:a}),u.a.createElement($.a,{units:"cts",name:"Detune",parameter:t.detuneParameter,color:a,min:-1e3,max:1e3,root:1}),n?u.a.createElement($.a,{name:"Trspe",min:-24,max:24,color:a,parameter:n.transposeParameter,root:1}):"",u.a.createElement($.a,{units:"ms",name:"Glide",color:a,parameter:t.glideParameter}),u.a.createElement($.a,{name:"R.Mix",color:a,parameter:t.crossFadeParameter})),u.a.createElement(Yl.a,{color:a,sequencerEngine:t.sequencerEngine,width:290,parameters:[t.loopStartParameter,t.loopLengthParameter,t.detuneParameter,n&&n.transposeParameter,t.glideParameter,t.crossFadeParameter]}))}),Zl=Object(i.memo)(function(e){var t=e.showColors,n=e.color,a=e.pts;return u.a.createElement(ka.b,null,a.map(function(e,a){return u.a.createElement(ka.g,{key:a,x:e.x,y:e.y,width:e.width,height:e.height,fill:t?"rgb("+e.rgb[0]+","+e.rgb[1]+","+e.rgb[2]+")":n})}))}),$l=Object(m.b)(function(e,t){return{}},function(e){return{}})(Zl);function ef(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}window.markerY=0;var tf=new h.a,nf=function(e){Object(xe.a)(n,e);var t=ef(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={buffer:e.buffer,ticks:[],offset:0,endOffset:0},a.width=a.props.width,a.height=e.height||ql,a.state.startX=a.convertSecondsToSpace(e.start,e.scale),a.state.endX=a.convertSecondsToSpace(e.end,e.scale),a.calculateTicks(void 0,void 0,void 0,!0),a}return Object(Ne.a)(n,[{key:"calculateTicks",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.start,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.end,arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.props.scale,arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"shouldComponentUpdate",value:function(e,t){if(this.width=e.width,this.height=e.height,this.state.buffer!=e.buffer||this.props.scale!==e.scale||this.props.zoomedStartTime!==e.zoomedStartTime||this.props.width||e.width||this.props.start!==e.start||this.props.end!==e.end){this.state.buffer=e.buffer;var n=e.start,a=e.end;this.state.startX=this.convertSecondsToSpace(n,e.scale),this.state.endX=this.convertSecondsToSpace(a,e.scale),this.calculateTicks(n,a,e.scale)}if(this.props.transpose!==e.transpose||this.props.bpm!==e.bpm){var r=e.start,c=e.end;this.calculateTicks(r,c,e.scale)}return!0}},{key:"convertSpaceToSeconds",value:function(e){return this.state.buffer.duration*e/this.width}},{key:"convertSecondsToSpace",value:function(e){return e/this.state.buffer.duration*this.width}},{key:"render",value:function(){var e=this,t=this.props.small?14:20,n=this.props.small?14:20,a=[0,0,n,t,0,t],r=[0,this.height,-n,this.height,0,this.height-t];this.props.isSelectedSlice&&(r[1]-=2,r[3]-=2,r[5]-=2);var c=this.props.color||tf.getColor(this.props.sliceNumber),o=this.state.startX,s=this.state.endX;this.props.sliceNumber,this.props.track.getKeyMapping(this.props.sliceNumber);return u.a.createElement(ka.c,null,this.props.isSelectedSlice?u.a.createElement(ka.g,{x:o,y:0,width:s-o,opacity:.1,height:this.height,fill:c}):u.a.createElement(ka.g,null),u.a.createElement(ka.e,{points:[this.state.startX,0,this.state.startX,this.height],strokeWidth:this.props.small?1:2,stroke:this.props.color,opacity:.8,alpha:.8,fill:this.props.color}),u.a.createElement(ka.e,{onMouseDown:function(t){return e.props.onStartSliceStartedDragging(t.evt.pageX-e.state.startX,t.evt.metaKey||t.evt.ctrlKey)},onMouseUp:this.props.onStartSliceStroppedDragging,onKeyDown:function(t){return e.props.onKeyDown(t)},x:this.state.startX,y:0,style:{cursor:"pointer"},opacity:.9,points:a,closed:!0,strokeWidth:1,stroke:this.props.color,fill:this.props.color}),u.a.createElement(ka.e,{points:[this.state.endX,0,this.state.endX,this.height],strokeWidth:this.props.small?1:2,stroke:this.props.color,fill:this.props.color}),u.a.createElement(ka.e,{onMouseDown:function(t){return e.props.onEndSliceStartedDragging(t.evt.pageX-e.state.endX,t.evt.metaKey||t.evt.ctrlKey)},onMouseUp:this.props.onEndSliceStoppedDragging,x:this.state.endX,y:0,style:{cursor:"pointer"},opacity:.9,points:r,closed:!0,strokeWidth:1,stroke:this.props.color,fill:this.props.color}),this.props.isSelectedSlice?u.a.createElement(ka.g,{x:o,y:this.height-3,width:s-o,height:3,fill:c}):u.a.createElement(ka.g,null),this.props.isSelectedSlice?this.state.ticks.map(function(t){return u.a.createElement(ka.e,{x:t,y:0,style:{cursor:"pointer"},points:[t.x,e.height,t.x,e.height-t.height],closed:!0,opacity:20===t.height?"0.55":"0.4",strokeWidth:1,stroke:e.props.color,fill:e.props.color})}):u.a.createElement(ka.g,null))}}]),n}(i.Component),af=Object(m.b)(function(e,t){var n=e.effects.effectParameters[t.transposeParameter.id],a=e.tracks.sampleSlices[t.sampler.id][t.sliceNumber];return void 0===a?{}:{bpm:e.user.bpm,transpose:n,start:a.startTime-t.zoomedStartTime,end:a.endTime-t.zoomedStartTime}},null)(nf),rf=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){e.selectedSlice,e.sampler;return u.a.createElement("div",null)}),cf=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.buffer,n=e.zoomedStartTime,a=e.convertSecondsToSpace,r=e.height,c=(e.fullDuration,t.duration),o=[],s=15;c<10?s=2:c<30?s=5:c>120&&(s=30);for(var i=0;i<n+c;i+=s)if(!(i-n<0)){var l=a(i-n),f=i,m=Math.floor(f/60),p=f%60;p<10&&(p="0"+p),o.push(u.a.createElement(ka.c,null,u.a.createElement(ka.e,{points:[l,0,l,r],strokeWidth:1,stroke:"#2a635b"}),u.a.createElement(ka.i,{x:l+5,y:r-15,fill:"white",fontSize:10,text:m+":"+p})))}return o});function of(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var sf=function(e){Object(xe.a)(n,e);var t=of(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"onClick",value:function(){this.props.track.warp(),this.setState(this.state),this.props.onWarp&&this.props.onWarp()}},{key:"isWarped",value:function(){return this.props.track.midiEffects.effects.filter(function(e){return"Warp"===e.name}).filter(function(e){return e.enabled}).length>0}},{key:"render",value:function(){var e=this,t=this.props.isWarped?"warp-button selected pushable":"warp-button pushable";return u.a.createElement("div",{onMouseOver:function(){return e.props.setContextualHelp(bn.jb)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)},onClick:function(){return e.onClick()},className:t},"Warp")}}]),n}(i.Component),uf=Object(m.b)(function(e,t){var n=t.track.subSequence.id;return{isWarped:e.tracks.trackWarps[n]&&e.tracks.trackWarps[n][t.track.trackNumber]}},function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(sf),lf=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=e.sampler,a=Object(i.useState)(!1),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(n.tempo||"0"),f=Object(s.a)(l,2),m=f[0],p=f[1];Object(i.useEffect)(function(){p(n.tempo||"0")},[p,n]);var d=Object(i.useCallback)(function(e){"Enter"===e.key&&(o(!1),n.tempo=parseFloat(m))},[m,o,n]);return Object(i.useEffect)(function(){""===m||Object(nn.a)(m)||p("")},[m,p]),u.a.createElement("div",{className:"sample-tempo"},u.a.createElement(uf,{track:t}),u.a.createElement("span",{onClick:function(){return o(!0)},className:"label"},"BPM"),c?u.a.createElement("input",{onKeyDown:d,className:"tempo-input",onChange:function(e){return p(e.target.value)},value:m}):u.a.createElement("span",{onClick:function(){return o(!0)},className:"tempo"},null===m?"":m))});function ff(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var mf=function(e){Object(xe.a)(n,e);var t=ff(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"convertSecondsToSpace",value:function(e){return e/this.props.buffer.duration*this.props.width}},{key:"render",value:function(){var e=this;return this.props.showingOnsets?this.props.sampler.onsets.map(function(t,n){return u.a.createElement(ka.g,{key:"onset-"+n,x:e.convertSecondsToSpace(t/1e3-e.props.zoomedStartTime),y:0,width:e.isSelectedOnset(n)?e.getOnsetWidth(n):1,height:e.props.height,opacity:e.isSelectedOnset(n)?.4:1,fill:e.isSelectedOnset(n)?"red":"#0062ff"})}):[]}},{key:"getOnsetWidth",value:function(e){var t=this.props.sampler.onsets;return e===t.length-1?this.convertSecondsToSpace(this.props.sampler.getDuration()-t[e]/1e3):this.convertSecondsToSpace((t[e+1]-t[e])/1e3)}},{key:"isSelectedOnset",value:function(e){return this.props.selectedOnsets.indexOf(e)>-1}}]),n}(i.Component),pf=Object(m.b)(function(e,t){return{selectedOnsets:e.waveform.selectedOnsets[t.sampleId]||[]}},null)(mf);function df(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var hf=new h.a;window.waveWidth=1,window.waveOpacity=.8;var bf=new Ys.a(xl,ql),vf=function(e){Object(xe.a)(n,e);var t=df(n);function n(e){var r,c;Object(Pe.a)(this,n),(c=t.call(this,e)).state=(r={x:0,slicing:!1,dragging:!1,showColors:!0,end:null,buffer:e.buffer,isPlaying:!1,pts:[],slices:e.slices,fetchedSlices:void 0},Object(a.a)(r,"dragging",!1),Object(a.a)(r,"selection",null),Object(a.a)(r,"zoomedBuffer",void 0),Object(a.a)(r,"zommedIn",!1),Object(a.a)(r,"zoomedStartTime",0),Object(a.a)(r,"zoomedScale",1),Object(a.a)(r,"directionMode",Tl),Object(a.a)(r,"selectedRecording",c.props.track.selectedRecording),Object(a.a)(r,"xBounds",0),r),c.ref=u.a.createRef(),c.scale=1,c.width=e.width||Nl(c.props.div),c.height=e.height||ql,bf.width===c.width&&bf.height===e.height||(bf=new Ys.a(c.width,c.height)),c.markersDragging=!1;new Ct.a(c.props.soundId);return c.state.start=c.convertSecondsToSpace(e.start)/2,c.state.startX=c.convertSecondsToSpace(e.start),c.state.end=c.convertSecondsToSpace(e.end)/2,c.state.endX=c.convertSecondsToSpace(e.end),c.props.isReversed?bf.getReversedWaveform(c.props.soundId,c.props.buffer).then(function(e){c.setState({pts:e})}):bf.getWaveform(c.props.soundId,c.props.buffer).then(function(e){c.setState({pts:e})}),c.convertSpaceToSeconds.bind(Object(Cn.a)(c)),c.computeWaveformPoints.bind(Object(Cn.a)(c)),c.onWheel=c.onWheel.bind(Object(Cn.a)(c)),c.onKeyDown=c.onKeyDown.bind(Object(Cn.a)(c)),c}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){this.props.hideButtons||(this.ref.current.addEventListener("mousewheel",this.onWheel,{passive:!1}),window.addEventListener("keydown",this.onKeyDown)),void 0!==this.props.xBounds&&(this.state.xBounds=this.props.xBounds),this.props.setWaveformShowing(!0)}},{key:"onKeyDown",value:function(e){"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&("ArrowLeft"===e.key&&(e.preventDefault(),this.onArrowLeft(e.metaKey||e.ctrlKey)),"ArrowRight"===e.key&&(e.preventDefault(),this.onArrowRight(e.metaKey||e.ctrlKey)),"Tab"===e.key&&(e.preventDefault(),this.onArrowUp()))}},{key:"onArrowDown",value:function(){var e=this.props.selectedSlice||0;this.props.onSelectSlice(0===e?this.props.sampler.slices.length-1:e-1)}},{key:"onArrowUp",value:function(){var e=this.props.selectedSlice||0;this.props.onSelectSlice((e+1)%this.props.sampler.slices.length)}},{key:"onArrowRight",value:function(e){var t=this.props.sampler.slices;if(void 0!==this.props.selectedSlice){var n=t[this.props.selectedSlice];if(this.state.directionMode===Tl)if(e){var a=this.props.sampler.onsets.find(function(e){return e/1e3>n.startTime});a&&this.props.sampler.slice(this.props.selectedSlice,a/1e3,a/1e3+(n.endTime-n.startTime))}else this.props.sampler.slice(this.props.selectedSlice,Math.min(n.endTime,n.startTime+this.fineGrain),n.endTime);else this.props.sampler.slice(this.props.selectedSlice,n.startTime,Math.min(this.props.sampler.getDuration(),n.endTime+this.fineGrain))}}},{key:"onArrowLeft",value:function(e){var t=this.props.sampler.slices;if(void 0!==this.props.selectedSlice){var n=t[this.props.selectedSlice];if(this.state.directionMode===Tl)if(e){var a=Object(d.a)(this.props.sampler.onsets);a.reverse();var r=a.find(function(e){return e/1e3<n.startTime})||0;this.props.sampler.slice(this.props.selectedSlice,r/1e3,r/1e3+(n.endTime-n.startTime))}else this.props.sampler.slice(this.props.selectedSlice,Math.max(0,n.startTime-this.fineGrain),n.endTime);else this.props.sampler.slice(this.props.selectedSlice,n.startTime,Math.max(n.startTime,n.endTime-this.fineGrain))}}},{key:"fineGrain",get:function(){return.001*this.props.sampler.getDuration()}},{key:"componentWillUnmount",value:function(){this.props.hideButtons||(this.ref.current.removeEventListener("mousewheel",this.onWheel),window.removeEventListener("keydown",this.onKeyDown)),this.props.setWaveformShowing(!1)}},{key:"shouldComponentUpdate",value:function(e){var t=this;return bf.width!==(e.width||Nl(e.div))&&(bf=new Ys.a(e.width||Nl(e.div),this.height),this.width=e.width||Nl(e.div),bf.getWaveform(e.soundId,e.buffer).then(function(e){t.setState({pts:e})})),bf.height!==e.height&&(this.height=e.height,(bf=new Ys.a(Nl(e.div),e.height)).getWaveform(e.soundId,e.buffer).then(function(e){t.setState({pts:e})})),this.props.isReversed==e.isReversed&&e.soundId===this.props.soundId&&e.track.selectedRecording===this.state.selectedRecording||(this.state.selectedRecording=e.track.selectedRecording,e.isReversed?bf.getReversedWaveform(e.soundId,e.buffer).then(function(e){t.setState({pts:e})}):bf.getWaveform(e.soundId,e.buffer).then(function(e){t.setState({pts:e})})),!0}},{key:"computeWaveformPoints",value:function(){var e=Object(o.a)(c.a.mark(function e(t,n,a,r){var o,s,i,u,l,f,m,p,d,h,b,v,g;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.index++,o=this.index,s=this.width,!((n+1)*s>this.width)){e.next=6;break}return r([]),e.abrupt("return");case 6:if(i=Math.floor(t.length/this.width),u=(u=t.getChannelData(0)).subarray(s*n*i,s*(n+1)*i),l=window.api.create_buffer(u.length),Math.min((n+1)*s,this.width),window.Module.HEAPF32.set(u,l>>2),f=1,window.api.getColoredWaveform(l,s,this.height,u.length,i,s*n,f),m=window.api.get_result_pointer(),p=new Uint16Array(window.Module.HEAP16.buffer,m,7*s/f),d=[],!(o<this.index)){e.next=19;break}return e.abrupt("return");case 19:for(h=0;h<7*s/f;h+=7)b=[p[h+4],p[h+5],p[h+6]],d.push({x:p[h],y:p[h+1],width:p[h+2],height:p[h+3],rgb:b});if(v=this,!(o<this.index)){e.next=23;break}return e.abrupt("return");case 23:g=a.concat(d),v.setState({pts:g}),window.api.destroy_buffer(l);case 26:case"end":return e.stop()}},e,this)}));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"duration",get:function(){return this.props.buffer.duration}},{key:"convertSpaceToSeconds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.props.div&&!t&&(e-=this.props.div.current.getBoundingClientRect().left),(this.state.zoomedIn?this.state.zoomedBuffer:this.props.buffer).duration*e/this.width}},{key:"convertSecondsToSpace",value:function(e){return e/(this.state.zoomedIn?this.state.zoomedBuffer:this.props.buffer).duration*this.width}},{key:"newSlice",value:function(e){this.state.slicing&&(this.props.sampler.newSlice(this.convertSpaceToSeconds(e.evt.layerX)),this.state.slices=this.props.sampler.slices,this.state.slicing=!1,this.setState(this.state),this.props.onSelectSlice(this.state.slices.length-1))}},{key:"getSlices",value:function(){var e=this,t=this.props.sampler.slices.map(function(t,n){var a=t.getCopy();return a.startTime-=e.state.zoomedStartTime,a.startTime<0&&a.startTime>=-.1&&(a.startTime=0),a.endTime-=e.state.zoomedStartTime,a.i=n,a});t=t.filter(function(e){return e.startTime>=0});var n=-1;for(var a in t)if(t[a].i===this.props.selectedSlice){n=a;break}return-1===n?t:(n=t.splice(n,1)).concat(t)}},{key:"onClickShowOnsets",value:function(){this.props.setShowOnsets(!this.props.showingOnsets)}},{key:"onClickAddSlice",value:function(e){if(e.target.blur(),this.props.showingOnsets&&this.selectedOnsets.length>0){for(var t in this.selectedOnsets){var n=this.onsets[this.selectedOnsets[t]],a=this.onsets[this.selectedOnsets[t]+1];this.props.sampler.newSlice(n/1e3,a/1e3),this.state.slices=this.props.sampler.slices,this.props.onSelectSlice(this.state.slices.length-1)}return this.props.setSelectedOnsets([]),void this.props.setShowOnsets(!1)}if(null!==this.state.selection){var r=this.convertSpaceToSeconds(this.state.selection.start,!0),c=this.convertSpaceToSeconds(this.state.selection.end,!0);if(c-r<.001)return;this.props.sampler.newSlice(this.state.zoomedStartTime+r,c+this.state.zoomedStartTime),this.setState({selection:null,slices:this.props.sampler.slices}),this.props.onSelectSlice(this.props.sampler.slices.length-1)}}},{key:"onClickDeleteSlice",value:function(){this.props.sampler.deleteSlice(this.props.selectedSlice),this.setState(this.state)}},{key:"onClickAutoSlice",value:function(){this.props.sampler.autoSlice(4),this.setState(this.state)}},{key:"onClickLoadSlices",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.decentralized){e.next=9;break}return t=new Ct.a(this.props.soundId),this.props.sampler.slices=[],this.setState(this.state),e.next=6,t.fetchSlices();case 6:e.sent.forEach(function(e){return n.props.sampler.newSlice(e.startTime,e.endTime)}),this.setState(this.state);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickSaveSlices",value:function(){if(this.props.decentralized){var e=this.props.sampler.slices.map(function(e){return Math.floor(1e3*e.startTime)}),t=this.props.sampler.slices.map(function(e){return Math.floor(1e3*e.endTime)});this.props.soundId;We.a.newSlices(this.props.soundId,e,t)}}},{key:"onsets",get:function(){return this.props.sampler.onsets}},{key:"selectedOnsets",get:function(){return this.props.track.sequencerEngine.store.getState().waveform.selectedOnsets[this.props.sample.getId()]||[]}},{key:"onMouseDown",value:function(e){e.evt.stopPropagation();var t=e.evt.layerX;if(!this.markersDragging){if(this.props.showingOnsets){for(var n=1e3*(this.state.zoomedStartTime+this.convertSpaceToSeconds(t)),a=-1,r=0;r<this.onsets.length;r++){this.onsets[r]<n&&(r===this.onsets.length-1?a=r:this.onsets[r+1]>n&&(a=r))}if(-1!==a){var c=this.selectedOnsets.indexOf(a);if(c>-1){var o=Object(d.a)(this.selectedOnsets);o.splice(c,1),this.props.setSelectedOnsets(o)}else this.props.setSelectedOnsets([].concat(Object(d.a)(this.selectedOnsets),[a]))}}this.state.dragging?this.setState({dragging:!1}):this.setState({selection:{start:t,end:t},dragging:!0})}}},{key:"onMouseMove",value:function(e){var t=e.evt.layerX;if(this.markersDragging){this.state.endSliceDragging;var n=Math.max(0,this.convertSpaceToSeconds(t-this.state.offset,!0));return this.state.selection&&(this.state.selection=null),void this.changeTheSlice(n+this.state.zoomedStartTime)}this.state.mouseX=e.evt.layerX,this.div&&this.div.current&&(this.state.mouseX-=this.div.current.getBoundingClientRect().left),this.state.dragging&&this.setState({selection:{start:this.state.selection.start,end:e.evt.layerX}})}},{key:"changeTheSlice",value:function(e){var t=this.props.sampler.slices;if(void 0!==this.state.startSliceDragging){var n=t[this.state.startSliceDragging];if(e+.001>=n.endTime)return;if(this.ctrl){var a=e-n.startTime;this.props.sampler.slice(this.state.startSliceDragging,e,n.endTime+a)}else this.props.sampler.slice(this.state.startSliceDragging,e,n.endTime)}else if(void 0!==this.state.endSliceDragging){var r=t[this.state.endSliceDragging];if(r.startTime+.001>=e)return;if(this.ctrl){var c=e-r.endTime;this.props.sampler.slice(this.state.endSliceDragging,r.startTime+c,e)}else this.props.sampler.slice(this.state.endSliceDragging,r.startTime,e)}}},{key:"endDrag",value:function(e){if(this.markersDragging)return this.state.startSliceDragging=void 0,this.state.endSliceDragging=void 0,void(this.markersDragging=!1);this.state.dragging=!1}},{key:"scrollWaveform",value:function(e){e/=700*this.scale/this.duration;var t=this.state.zoomedStartTime||0;t+=e;var n=this.buffer.duration+this.state.zoomedStartTime;if(n+=e,!(t<0||n>this.duration)){var a=ke.a.Master.context.sampleRate;this.state.zoomedStartTime=t;var r=Object(Qs.a)(this.props.buffer,t*a,n*a,ke.a.Master.context);this.state.zoomedBuffer=r,this.setState(this.state),this.computeWaveformPoints(r,0,[],function(e){})}}},{key:"cropSelection",value:function(){var e=this.state.zoomedStartTime+this.convertSpaceToSeconds(this.state.selection.start),t=this.state.zoomedStartTime+this.convertSpaceToSeconds(this.state.selection.end);this.props.crop(e,t)}},{key:"zoomIn",value:function(e,t){if((t*=2)<=2)this.zoomOut();else{var n=this.state.zoomedStartTime||0,a=this.duration/t,r=n+this.convertSpaceToSeconds(e,!0)-a*e/this.width,c=r+a;if(r<0&&(r=0),!(c-r<.001)){var o=this.props.buffer;this.state.zoomedStartTime=r,this.state.zoomedScale=t,this.state.zoomedIn=!0;var s=ke.a.Master.context.sampleRate,i=Object(Qs.a)(o,r*s,c*s,ke.a.Master.context);this.state.zoomedBuffer=i,this.computeWaveformPoints(i,0,[],function(e){})}}}},{key:"zoomOut",value:function(){this.state.zoomedIn=!1,this.state.zoomedStartTime=0,this.state.zoomedBuffer=void 0,this.state.selection=null,this.computeWaveformPoints(this.props.buffer,0,[],function(e){})}},{key:"markerDraggingStarted",value:function(){this.markersDragging=!0,this.setState({selection:null,dragging:!1})}},{key:"markerDraggingEnded",value:function(){this.markersDragging=!1,this.setState({selection:null,dragging:!1})}},{key:"onClickSyncTempo",value:function(){var e=this.props.sampler;e.tempoSynced?e.unsyncTempo():e.syncTempo(ke.a.Transport.bpm.value),document.activeElement.blur(),this.setState(this.state)}},{key:"onMouseOver",value:function(){this.mousedOver=!0}},{key:"onWheel",value:function(e){if(e.stopPropagation(),e.ctrlKey){e.preventDefault();var t=this.scale-.01*e.deltaY;t<=1&&(t=1),this.zoomIn(this.state.mouseX,t),this.scale=t}else{var n=e.deltaX;Math.abs(n)>0&&(e.preventDefault(),this.scrollWaveform(n))}}},{key:"buffer",get:function(){return this.state.zoomedBuffer||this.props.buffer}},{key:"onStartSliceStartedDragging",value:function(e,t,n){this.ctrl=n,this.props.div&&this.props.div.current&&(e-=this.props.div.current.getBoundingClientRect().left),this.markersDragging=!0,this.props.onSelectSlice(t),this.state.offset=e,this.state.startSliceDragging=t,this.setState({directionMode:Tl})}},{key:"onStartSliceStoppedDragging",value:function(e){this.markersDragging=!1,this.state.startSliceDragging=void 0}},{key:"onEndSliceStartedDragging",value:function(e,t,n){this.ctrl=n,this.props.div&&this.props.div.current&&(e-=this.props.div.current.getBoundingClientRect().left),this.markersDragging=!0,this.props.onSelectSlice(t),this.state.endSliceDragging=t,this.state.offset=e,this.setState({directionMode:"END"})}},{key:"onEndSliceStoppedDragging",value:function(e){this.markersDragging=!1,this.state.endSliceDragging=void 0}},{key:"onChangeOnsetThreshold",value:function(e){this.props.setOnsetThreshold(e),this.props.sampler.analyze(),this.setState(this.state)}},{key:"onMouseLeave",value:function(e){this.endDrag(e),this.mousedOver=!1}},{key:"onGatedChange",value:function(e){document.activeElement.blur(),this.props.track.gated="gated"===e.target.value,this.props.sampler.release(),this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.state.pts,n=this.props.track,a=hf.getColorForTrack(n),r=null==this.state.selection?{start:0,end:0}:this.state.selection,c=this.state.zoomedIn?this.state.zoomedBuffer:this.props.buffer,o=this.getSlices()[this.props.selectedSlice],s=(void 0===o||this.convertSecondsToSpace(o.startTime),void 0===o||this.convertSecondsToSpace(o.endTime),void 0===o?"black":hf.getColor(this.props.selectedSlice)),i=Math.round(100*this.props.sampler.tempo)/100,l=this.props.sampler,f={};this.props.track&&(f.borderColor=hf.getColorForTrack(this.props.track));var p=u.a.createElement("div",{style:f,ref:this.ref,className:"sound-waveform details-view",onMouseOver:function(t){return e.onMouseOver(t)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},u.a.createElement(ka.h,{onMouseOver:function(t){return e.onMouseOver()},onMouseDown:function(t){return e.onMouseDown(t)},onMouseUp:function(t){return e.endDrag(t)},onMouseMove:function(t){return e.onMouseMove(t)},onMouseLeave:function(t){return e.onMouseLeave(t)},width:this.width+2,height:this.height},u.a.createElement(m.a,{store:this.props.track.sequencerEngine.store},u.a.createElement(ka.d,null,u.a.createElement(ka.g,{onClick:function(t){return e.newSlice(t)},x:0,y:0,width:this.width,height:this.height,fill:this.props.backgroundColor?this.props.backgroundColor:this.props.small?"black":"#222222cf"}),this.props.small?[]:u.a.createElement(cf,{convertSecondsToSpace:function(t){return e.convertSecondsToSpace(t)},fullDuration:this.duration,height:this.height,zoomedStartTime:this.state.zoomedStartTime,buffer:c,width:this.width}),u.a.createElement(pf,{height:this.height,width:this.width,buffer:c,showingOnsets:this.props.showingOnsets,zoomedStartTime:this.state.zoomedStartTime,sampleId:this.props.sample.getId(),sampler:this.props.sampler,onUpdate:function(){return e.setState(e.state)}}),this.markersDragging?[]:u.a.createElement(ka.g,{x:r.start,y:0,width:r.end-r.start,height:this.height,fill:"orange"})),u.a.createElement($l,{color:a,pts:t,showColors:this.state.showColors}),u.a.createElement(ka.d,null,this.getSlices().map(function(t,n){return u.a.createElement(af,{key:"marker-"+n,mode:e.state.directionMode,small:e.props.small,height:e.height,width:e.width,transposeParameter:e.props.track.trackData.transposeParameter,scale:e.state.zoomedScale,onStartSliceStartedDragging:function(n,a){return e.onStartSliceStartedDragging(n,t.i,a)},onStartSliceStoppedDragging:function(){return e.onStartSliceStoppedDragging(t.i)},onEndSliceStartedDragging:function(n,a){return e.onEndSliceStartedDragging(n,t.i,a)},onEndSliceStoppedDragging:function(){return e.onEndSliceStoppedDragging(t.i)},onKeyDown:e.props.onKeyDown,isSelectedSlice:e.props.selectedSlice===t.i,buffer:c,onSelectSlice:function(){return e.props.onSelectSlice(t.i)},track:e.props.track,sliceNumber:t.i,sampler:e.props.sampler,zoomedStartTime:e.state.zoomedStartTime,color:e.props.color||hf.getColor(t.i)})})),u.a.createElement(ka.d,null,u.a.createElement(Pl,{width:this.width,sampler:l,sequencerEngine:this.props.track.sequencerEngine,soundId:this.props.soundId,height:this.height,convertSecondsToSpace:function(t){return e.convertSecondsToSpace(t-e.state.zoomedStartTime)}})))));if(this.props.hideButtons)return p;var d="add-slice-button details-button",h=!0;return(null===this.state.selection||this.state.selection.end-this.state.selection.start<=1)&&(this.props.showingOnsets&&0!==this.selectedOnsets.length||(d+=" disabled",h=!1)),u.a.createElement("div",{className:"waveform-container"},p,u.a.createElement("div",{className:"waveform-buttons"},u.a.createElement("div",{className:d,onClick:function(t){return e.onClickAddSlice(t)}},u.a.createElement("div",{className:"inner"},"Slice")),u.a.createElement("div",{className:this.props.sampler.slices.length>1?"details-button delete-slice":"details-button delete-slice disabled",onClick:function(t){return e.onClickDeleteSlice(t)}},u.a.createElement("div",{className:"inner"},u.a.createElement("div",null,"Delete Slice"),u.a.createElement("div",{style:{backgroundColor:s},className:"dot"}))),u.a.createElement(He.a,{condition:0!==i},u.a.createElement("div",{onClick:function(){return e.onClickShowOnsets()},className:"details-button onsets-btn"},u.a.createElement("div",{className:"inner"},this.props.showingOnsets?"Hide Onsets":"Show Onsets")),u.a.createElement("div",{onClick:function(){return e.onClickAutoSlice()},className:this.props.sampler.slices.length>1?"disabled details-button auto-slice-btn":"details-button auto-slice-btn"},u.a.createElement("div",{className:"inner"},"Auto-Slice"))),u.a.createElement(He.a,{condition:this.state.zoomedStartTime>0},u.a.createElement("div",{onClick:function(){return e.zoomOut()},className:"details-button zoom-out-btn"},u.a.createElement("div",{className:"inner"},"Zoom Out"))),u.a.createElement(lf,{sampler:l,track:this.props.track}),u.a.createElement("div",{className:"radio gate-btn"},u.a.createElement("label",null,u.a.createElement("input",{className:"filter-radio",type:"radio",value:"gated",checked:n.gated,onChange:function(t){return e.onGatedChange(t)}}),u.a.createElement("div",null,"Gated")),u.a.createElement("label",null,u.a.createElement("input",{className:"filter-radio",type:"radio",value:"ungated",checked:!n.gated,onChange:function(t){return e.onGatedChange(t)}}),u.a.createElement("div",null,"Ungated"))),u.a.createElement("div",{className:"radio reverse"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:"reversed",checked:this.props.track.isReversed(),onChange:function(t){return e.props.onChangeReversed(t.target.value)}}),u.a.createElement("div",null,"Reversed"))),u.a.createElement(He.a,{condition:h},u.a.createElement("div",{onClick:function(){return e.cropSelection()},className:"details-button crop-btn"},u.a.createElement("div",{className:"inner crop-button"},"Crop In-Place"))),u.a.createElement(He.a,{condition:!h},u.a.createElement("div",{onClick:function(){return e.props.cropSlices()},className:"details-button crop-btn"},u.a.createElement("div",{className:"inner crop-button"},"Crop Slices"))),u.a.createElement(He.a,{condition:this.props.showingOnsets},u.a.createElement("div",{className:"onset-threshold-container"},u.a.createElement("div",null,"Onset Threshold: ",this.props.onsetThreshold," db"),u.a.createElement(be.a,{value:this.props.onsetThreshold,change:function(t){return e.onChangeOnsetThreshold(t.target.value)},step:.01,max:6,min:-10,orientation:"horizontal",reversed:!1})))),u.a.createElement(rf,{slice:this.props.selectedSlice,sampler:l}))}}]),n}(i.Component),gf=(Object(m.b)(function(e,t){return{onsetThreshold:e.waveform.onsetThreshold,showingOnsets:e.waveform.showingOnsets,slicesLenggth:t.sampler.slices.length}},function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))},setOnsetThreshold:function(t){return e(Object(f.Yc)(t))},setSelectedOnsets:function(n){return e(Object(f.de)(t.sample.getId(),n))},setShowOnsets:function(t){return e(Object(f.Ie)(t))},setWaveformShowing:function(t){return e(Object(f.ig)(t))}}})(vf),n(33)),Ef=new h.a;var Of=Object(m.b)(function(e,t){return{isOn:t.sampler.on||t.instrument.mixMode===Ul.b||t.isSelectedSampler}},function(e,t){return{setSampleDragging:function(t){return e(Object(f.Qd)(t))}}})(function(e){var t=e.sample;if(void 0===t)return u.a.createElement("div",null);var n={backgroundColor:Ef.getColorForHash(t.getId())},a=t.getThumbnail(),r=function(e){e.stopPropagation()},c=Object(i.useCallback)(function(n){e.setSampleDragging(t)},[t]),o="key-info";return e.isOn&&(o+=" on"),a?u.a.createElement("img",{draggable:!0,onDragStart:c,onDragOver:r,onClick:e.onClickSampler,className:o,src:a}):u.a.createElement("div",{draggable:!0,onDragStart:c,onDragOver:r,onClick:e.onClickSampler,style:n,className:o},e.i+1)});new h.a;var yf=Object(m.b)(function(e,t){return{isPlaying:e.keyboard.lastNotePlayed===t.transpose,mixMode:t.instrument.mixMode}},function(e,t){return{setSampleDragging:function(t){return e(Object(f.Qd)(t))}}})(function(e){var t=Object(i.useState)([]),n=Object(s.a)(t,2),a=n[0],r=n[1],c="key";e.note.isBlackNote()?c+=" black":c+=" white";var o=e.note.getTranspose(),l=(a.map(function(e){return e.sample}),Object(i.useCallback)(function(t){t.stopPropagation(),e.sampleDragging&&(e.instrument.newSample(o,e.sampleDragging).then(function(e){r(e.samplers)}),e.setSampleDragging(void 0))},[e.sampleDragging,r])),f=Object(i.useCallback)(function(t){if(void 0===t){var n=a.find(function(e){return e.on});e.onClickSampler(n)}else t!==e.selectedSampler&&(e.onClickSampler(t),e.instrument.selectSampler(o,t))},[o,a,e.onClickSampler,e.selectedSampler,e.mixMode]);Object(i.useEffect)(function(){if(o in e.instrument.samplers){var t=e.instrument.samplers[o];r(t)}},[e.instrument.samplers[o]],e.selectedSampler);var m=Object(i.useCallback)(function(){console.log("transpose =",o);var t=e.instrument.track,n=new gf.a;n.copyFrom(t.trackData),n.transpose=o,n.slice=0,n.duration=null,t.midiEffects.liveInputTrigger(n)},[o]),p=Object(i.useCallback)(function(){e.instrument.track.midiEffects.liveInputRelease(o,0)},[o]),d="key-container";return a.indexOf(e.selectedSampler)>-1&&void 0!==e.selectedSampler&&(d+=" selected"),e.isPlaying&&(d+=" last-played"),u.a.createElement("div",{className:d},u.a.createElement("div",{onMouseDown:m,onMouseUp:p,onClick:function(){return f()},onDrop:l,className:c}),a.map(function(t,n){return u.a.createElement(Of,{i:n,key:"sample-thumb-"+n,isSelectedSampler:t===e.selectedSampler,sampler:t,instrument:e.instrument,onClickSampler:function(){return f(t)},sample:t.sample})}))});new h.a;function kf(e){var t=Lc.a.NOTES.map(function(t){return(t=t.getCopy()).octave=e.octave,t});return u.a.createElement("div",{className:"octave"},u.a.createElement("div",{className:"octave-label"},t[0].toString()),t.map(function(t){return u.a.createElement(yf,{key:t.toString(),selectedSampler:e.selectedSampler,onClickSampler:e.onClickSampler,sampleDragging:e.sampleDragging,octave:e.octave,transpose:t.getTranspose(),note:t,instrument:e.instrument})}))}var jf=Object(i.memo)(function(e){var t=e.selectedSampler,n=e.onClickSampler,a=e.sampleDragging,r=e.instrument;return u.a.createElement("div",{className:"horizontal-piano-container"},u.a.createElement("div",{className:"horizontal-piano"},u.a.createElement(kf,{selectedSampler:t,onClickSampler:n,octave:1,instrument:r,sampleDragging:a}),u.a.createElement(kf,{selectedSampler:t,onClickSampler:n,octave:2,instrument:r,sampleDragging:a}),u.a.createElement(kf,{selectedSampler:t,onClickSampler:n,octave:3,instrument:r,sampleDragging:a}),u.a.createElement(kf,{selectedSampler:t,onClickSampler:n,octave:4,instrument:r,sampleDragging:a}),u.a.createElement(kf,{selectedSampler:t,onClickSampler:n,octave:5,instrument:r,sampleDragging:a}),u.a.createElement(kf,{selectedSampler:t,onClickSampler:n,octave:6,instrument:r,sampleDragging:a}),u.a.createElement(kf,{selectedSampler:t,onClickSampler:n,octave:7,instrument:r,sampleDragging:a})))}),Cf=n(849),Sf=Object(i.memo)(function(e){var t=e.isExponential,n=e.name,a=e.min,r=e.max,c=e.round,o=e.parameter,l=e.value,f=e.sequencerEngine,m=Object(i.useState)(!1),p=Object(s.a)(m,2),d=p[0],h=p[1],b=Object(i.useCallback)(function(){f&&h(!0)},[h]),v="";d&&(v=u.a.createElement(Ki,{sequencerEngine:f,parameter:o})),a=t?Math.cbrt(a):a,r=t?Math.cbrt(r):r;var g,E=t?Math.cbrt(l):l;return u.a.createElement("div",{className:"parameter-knob-container"},u.a.createElement(Cf.Knob,{size:40,angleOffset:220,angleRange:280,value:E,min:a,max:r,onChange:function(e){return n=e,document.activeElement.blur(),t&&(n=Math.pow(n,3)),c&&(n=Math.round(n)),void o.set(n);var n}},u.a.createElement(Cf.Arc,{arcWidth:3,color:"white",background:"#6c757a"}),u.a.createElement(Cf.Pointer,{width:3,height:11,radius:8,type:"rect",color:"white"})),u.a.createElement("div",{onClick:b,className:"knob-label"},n," : ",(g=l,Math.floor(10*g)/10)),v)}),wf=(Object(m.b)(function(e,t){return void 0===t.parameter?{value:0}:{value:e.effects.effectParameters[t.parameter.id]}},null)(Sf),n(1251));wf.a,wf.b;var Pf=new h.a;var Nf=Object(m.b)(function(e,t){var n=t.track.selectedSampler;return{sampleDragging:e.selector.sampleDragging,sampleSlices:n?e.tracks.sampleSlices[n.id]:void 0,presetDragging:e.presets.presetDragging,sampleTagDragging:e.selector.sampleTagDragging,sample:t.track.sample,presetName:t.track.presetName}},function(e,t){return{setSampleDragging:function(t){return e(Object(f.Qd)(t))},setPresetDragging:function(t){return e(Object(f.Ed)(t))},setSampleTagDragging:function(t){return e(Object(f.Td)(t))}}})(function(e){var t=Object(i.useState)(void 0),n=Object(s.a)(t,2),a=(n[0],n[1]),r=e.track.instrument;Object(i.useCallback)(function(e){r.connectToTrack(e),a(e)}),Object(i.useEffect)(function(){a(r.connectedTrack)},[r.connectedTrack]),Object(i.useEffect)(function(){return function(){return e.track.selectedSampler=e.instrument.defaultSampler}},[e.track,e.instrument]);var c=Object(i.useState)(e.track.selectedSampler),o=Object(s.a)(c,2),l=o[0],f=o[1],m=Object(i.useState)(Object.keys(r.samplers).length>1),p=Object(s.a)(m,2),d=p[0],h=p[1];Object(i.useEffect)(function(){r.defaultSampler&&(f(r.defaultSampler),e.track.sample=r.defaultSampler.sample)},[r.defaultSampler]);var b=Object(i.useCallback)(function(){var t=r.allSamplers[0];t?(f(t),e.track.sample=t.sample):(f(void 0),E("")),e.track.selectedSampler=t},[f,e.instrument,e.setWaveform]),v=Object(i.useState)(""),g=Object(s.a)(v,2),E=(g[0],g[1]),O=Object(i.useCallback)(function(t){e.instrument.deleteSampler(l),E(""),b()},[l,f,e.instrument,E]),y=Object(i.useCallback)(function(t){void 0!==t&&(e.track.sample=t.sample,e.track.selectedSampler=t,l===t||f(t))},[l,f,e.track]),k=(Object(i.useCallback)(function(){r.playSampler(l)},[l]),Object(i.useCallback)(function(t){console.log("ON DROP sampler"),t.stopPropagation();var n=function(t,n){e.instrument.newSample(void 0,t,n).then(function(t){var n=t.sampler;e.track.sample=n.sample,e.track.selectedSampler=n,f(n)})};e.sampleDragging?(n(e.sampleDragging),e.setSampleDragging(void 0)):e.presetDragging?(e.track.auditionPreset(e.presetDragging),e.setPresetDragging(void 0)):e.sampleTagDragging&&Bi(e.sampleTagDragging,e.track,e.setSampleTagDragging,n)},[e.track,f,e.sampleDragging,e.sampleTagDragging,e.presetDragging,e.setPresetDragging])),j=Pf.getColorForTrack(e.track);return u.a.createElement("div",{onDrop:k,onDragOver:function(e){return e.preventDefault()},className:"instrument sampled-instrument"},u.a.createElement("div",null,u.a.createElement(Al,{sequencerEngine:e.sequencerEngine,track:e.track,sample:e.track.sample,instrument:r,selectedSampler:l,deleteSample:O,presetName:e.presetName}),u.a.createElement("div",{className:"parameters-container"},u.a.createElement("div",{className:"pane"},u.a.createElement(mi.a,{name:"Amp",backgroundColor:"#545d6e",fullText:!0,width:270,sequencerEngine:e.sequencerEngine,fillColor:Pf.brighten(j,.7),lineColor:j,hasRelease:!0,hasLevel:!1,envelope:r}),u.a.createElement(Jl,{color:Pf.brighten(j,.7),sampler:l,instrument:r})),u.a.createElement(Ql,{showPianoRoll:d,toggleShowPiano:function(){return h(!d)},setSelectedSampler:y,sampler:l,instrument:r}))),u.a.createElement(He.a,{condition:d},u.a.createElement(jf,{onClickSampler:y,selectedSampler:l,track:e.track,sampleDragging:e.sampleDragging,instrument:r})))});function xf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var qf=function(e){Object(xe.a)(n,e);var t=xf(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props.instrument.carrierOscillator,t=this.props.instrument.modulatorOscillator;return u.a.createElement("div",{className:"fm-parameters"},u.a.createElement("div",{className:"oscillator-types"},u.a.createElement("div",{className:"oscillator-type"},u.a.createElement(Zc,{sequencerEngine:this.props.sequencerEngine,oscillator:t}),u.a.createElement(Bu,{oscillator:t})),u.a.createElement("div",{className:"mod-label"},"mods"),u.a.createElement("div",{className:"oscillator-type"},u.a.createElement(Zc,{sequencerEngine:this.props.sequencerEngine,oscillator:e}),u.a.createElement(Bu,{oscillator:e}))),u.a.createElement(mo,{oscillator:this.props.instrument.carrierOscillator,sequencerEngine:this.props.sequencerEngine,instrument:this.props.instrument}),u.a.createElement(Fa.a,{automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,name:"Frequency",parameter:e.oscillatorFrequencyParameter,onParameterChanged:function(){return e.releaseAll()},displayFunction:function(e){return Lc.a.fromTranspose(e).toString()},isParameter:!0,min:-32,max:32,step:1}),u.a.createElement(Fa.a,{automation:this.props.automation,name:"Detune",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:e.detuneParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}))}}]),n}(i.Component);function Tf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Mf=function(e){Object(xe.a)(n,e);var t=Tf(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"getSelectedOscillatorType",value:function(){return this.props.oscillator.oscillatorType}},{key:"onSelectOscillatorType",value:function(e){var t="none"===e.value?void 0:e.value;this.props.oscillator.oscillatorType=t,this.setState(this.state)}},{key:"render",value:function(){var e=this.props.oscillator;return u.a.createElement("div",{className:"oscillator-component"},u.a.createElement(Fa.a,{automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,name:"Polyphony",parameter:e.polyphonyParameter,onParameterChanged:function(){return[]},isParameter:!0,min:1,max:16,step:1}),u.a.createElement(Fa.a,{automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,name:"Glide",parameter:e.portamentoParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:50,step:.1}))}}]),n}(i.Component);var Rf=Mf;function Df(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component;var If=[{value:"square",label:"Square"},{value:"sine",label:"Sine"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"},{value:"pwm",label:"PWM"},{value:"pulse",label:"Pulse"},{value:"fatsquare",label:"Fat Square"},{value:"fatsine",label:"Fat Sine"},{value:"fattriangle",label:"Fat Triangle"},{value:"fatsawtooth",label:"Fat Sawtooth"},{value:"fmsquare",label:"FM Square"},{value:"fmsine",label:"FM Sine"},{value:"fmtriangle",label:"FM Triangle"},{value:"fmsawtooth",label:"FM Sawtooth"}];function Af(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Lf=function(e){Object(xe.a)(n,e);var t=Af(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={showMods:!1,showGenetix:!1},a.onClickMods=a.onClickMods.bind(Object(Cn.a)(a)),a.onClickGenetix=a.onClickGenetix.bind(Object(Cn.a)(a)),a}return Object(Ne.a)(n,[{key:"onClickMods",value:function(){this.setState({showMods:!this.state.showMods})}},{key:"onClickGenetix",value:function(){this.setState({showGenetix:!this.state.showGenetix})}},{key:"render",value:function(){var e=this,t=this.props.instrument;return u.a.createElement("div",{className:"instrument fm-synth"},u.a.createElement(He.a,{condition:!this.state.showMods&&!this.state.showGenetix},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(qf,{sequencerEngine:this.props.sequencerEngine,instrument:t}),u.a.createElement("div",{className:"instrument-section"},u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Filter"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{automation:this.props.automation,name:"Cutoff",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:t.filterCutoffParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1e4,step:1}),u.a.createElement(Fa.a,{automation:this.props.automation,name:"Q",sequencerEngine:this.props.sequencerEngine,parameter:t.filterQParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:9,step:1}),u.a.createElement(Fa.a,{automation:this.props.automation,name:"Noise Level",sequencerEngine:this.props.sequencerEngine,parameter:t.noiseVolumeParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},unit:"db",isParameter:!0,min:-100,max:0,step:.1})),u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement(Rf,{automation:this.props.automation,oscillator:t.carrierOscillator,sequencerEngine:this.props.sequencerEngine,instrument:t}))),u.a.createElement("div",{className:"instrument-section"},u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement(al,{automation:this.props.automation,envelopeOptions:Ff,sequencerEngine:this.props.sequencerEngine,instrument:t})))),u.a.createElement(He.a,{condition:this.state.showGenetix},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Vu,{onClickBack:function(){return e.onClickGenetix()},track:this.props.track,instrument:t})),u.a.createElement(He.a,{condition:this.state.showMods},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(il,{instrument:t})),u.a.createElement(He.a,{condition:!this.state.showGenetix},u.a.createElement("div",{onClick:this.onClickMods,className:"mods-button common-button pink-button small-button"},this.state.showMods?"BACK":"MODS"),u.a.createElement("div",{onClick:this.onClickGenetix,className:"mods-button common-button pink-button small-button"},"GENETIX")))}}]),n}(i.Component),Ff=[{value:$u.a,label:"Amp"},{value:$u.b,label:"Filter"},{value:$u.c,label:"Filter 2"},{value:$u.d,label:"Modulation"}],zf=Lf;function Bf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var _f=function(e){Object(xe.a)(n,e);var t=Bf(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={showMods:!1},a}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props.instrument;return u.a.createElement("div",{className:"instrument"},u.a.createElement("div",{className:"instrument-name"},this.props.instrument.getName()),u.a.createElement(He.a,{condition:!this.state.showMods},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"instrument-section"},u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Filter"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{effectNumber:0,name:"Frequency",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:e.frequencyParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:4e3,step:1}),u.a.createElement(Fa.a,{effectNumber:0,name:"Resonance",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:e.resonanceParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:4e3,step:1}),u.a.createElement(Fa.a,{effectNumber:0,name:"Harmonicity",sequencerEngine:this.props.sequencerEngine,parameter:e.harmonicityParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:200,step:1e-4}),u.a.createElement(Fa.a,{effectNumber:0,name:"Modulation Index",sequencerEngine:this.props.sequencerEngine,parameter:e.modulationIndexParameter,lfoEnabled:!0,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:20,step:1e-4}))),u.a.createElement("div",{className:"instrument-section"},u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Amp/Filter Envelope"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{effectNumber:0,name:"Attack",parameter:e.attackParameter,sequencerEngine:this.props.sequencerEngine,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,min:0,max:6e3,step:1}),u.a.createElement(Fa.a,{effectNumber:0,name:"Decay",sequencerEngine:this.props.sequencerEngine,parameter:e.decayParameter,onParameterChanged:function(){return[]},isParameter:!0,lfoEnabled:!0,min:0,max:6e3,step:1}),u.a.createElement(Fa.a,{effectNumber:0,name:"Sustain",parameter:e.sustainParameter,onParameterChanged:function(){return[]},isParameter:!0,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,min:0,max:1,step:.01}),u.a.createElement(Fa.a,{effectNumber:0,sequencerEngine:this.props.sequencerEngine,name:"Release",parameter:e.releaseParameter,onParameterChanged:function(){return[]},lfoEnabled:!0,isParameter:!0,min:0,max:1e4,step:1})))))}}]),n}(i.Component);function Hf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Uf=function(e){Object(xe.a)(n,e);var t=Hf(n);function n(e){return Object(Pe.a)(this,n),t.call(this,e)}return Object(Ne.a)(n,[{key:"getOscillatorOptions",value:function(){return[{value:"square",label:"Square"},{value:"sine",label:"Sine"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"},{value:"pwm",label:"PWM"},{value:"pulse",label:"Pulse"}]}},{key:"getOscillatorOption",value:function(e){for(var t=this.getOscillatorOptions(),n=0;n<t.length;n++)if(t[n].value==e)return t[n];return null}},{key:"getSelectedOscillatorType",value:function(){return this.props.instrument.oscillatorType}},{key:"onSelectOscillatorType",value:function(e){var t="none"===e.value?void 0:e.value;this.props.instrument.oscillatorType=t,this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.props.instrument;this.props.instrument.lfos[0];return u.a.createElement("div",{className:"instrument synth"},u.a.createElement("div",{className:"instrument-name"},this.props.instrument.getName()),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement("div",{className:"instrument-section"},u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Oscillator"),u.a.createElement("div",{className:"osc-type-dropdown-container"},u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:this.getOscillatorOptions(),onChange:function(t){return e.onSelectOscillatorType(t)},value:this.getOscillatorOption(this.getSelectedOscillatorType()),placeholder:"Osc. Type"})),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{name:"Frequency",automation:this.props.automation,parameter:t.oscillatorFrequencyParameter,onParameterChanged:function(){return t.releaseAll()},displayFunction:function(e){return Lc.a.fromTranspose(e).toString()},isParameter:!0,min:-32,max:32,step:1}),u.a.createElement(Fa.a,{name:"Detune",lfoEnabled:!0,automation:this.props.automation,instrument:t,lfos:t.lfos,parameter:t.detuneParameter,onParameterChanged:function(){return[]},isParameter:!0,min:-100,max:100,step:1}),u.a.createElement(Fa.a,{lfoEnabled:!0,lfos:t.lfos,instrument:t,automation:this.props.automation,name:"Pulse Width",parameter:t.pulseWidthParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1,step:.01}),u.a.createElement(Fa.a,{name:"Polyphony",automation:this.props.automation,parameter:t.polyphonyParameter,onParameterChanged:function(){return[]},isParameter:!0,min:1,max:16,step:1}),u.a.createElement(Fa.a,{name:"Glide",automation:this.props.automation,parameter:t.portamentoParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:50,step:.1})),u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Filter"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{name:"Cutoff",lfoEnabled:!0,automation:this.props.automation,lfos:t.lfos,instrument:t,parameter:t.filterCutoffParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1e4,step:1}),u.a.createElement(Fa.a,{name:"Q",lfoEnabled:!0,automation:this.props.automation,lfos:t.lfos,instrument:t,parameter:t.filterQParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:9,step:1}))),u.a.createElement("div",{className:"instrument-section"},u.a.createElement(Ku,{instrument:t}),u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Amp Envelope"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{automation:this.props.automation,name:"Amp Attack",lfoEnabled:!0,lfos:t.lfos,instrument:t,parameter:t.ampAttackParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:6e3,step:1}),u.a.createElement(Fa.a,{automation:this.props.automation,name:"Amp Decay",lfoEnabled:!0,lfos:t.lfos,instrument:t,parameter:t.ampDecayParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:6e3,step:1}),u.a.createElement(Fa.a,{name:"Amp Sustain",automation:this.props.automation,lfoEnabled:!0,lfos:t.lfos,instrument:t,parameter:t.ampSustainParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1,step:.01}),u.a.createElement(Fa.a,{name:"Amp Release",automation:this.props.automation,lfoEnabled:!0,lfos:t.lfos,instrument:t,parameter:t.ampReleaseParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1e4,step:1}))),u.a.createElement("div",{className:"instrument-section"},u.a.createElement(Gf,{automation:this.props.automation,instrument:t})))}}]),n}(i.Component),Gf=function(e){Object(xe.a)(n,e);var t=Hf(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props.instrument.filterEnvelope;return u.a.createElement("div",{className:"instrument-subsection"},u.a.createElement("div",{className:"instrument-subsection-name"},"Filter Envelope"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(Fa.a,{name:"Frequency",parameter:e.baseFrequencyParameter,automation:this.props.automation,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1e4,step:1}),u.a.createElement(Fa.a,{name:"Octaves",parameter:e.octavesParameter,automation:this.props.automation,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:8,step:.1}),u.a.createElement(Fa.a,{name:"Attack",parameter:e.attackParameter,automation:this.props.automation,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:8e3,step:1}),u.a.createElement(Fa.a,{name:"Decay",parameter:e.decayParameter,automation:this.props.automation,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:8e3,step:1}),u.a.createElement(Fa.a,{name:"Sustain",parameter:e.sustainParameter,automation:this.props.automation,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:1,step:.01}),u.a.createElement(Fa.a,{name:"Release",automation:this.props.automation,parameter:e.releaseParameter,onParameterChanged:function(){return[]},isParameter:!0,min:0,max:8e3,step:1}))}}]),n}(i.Component),Wf=Uf;function Vf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Xf=function(e){Object(xe.a)(n,e);var t=Vf(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={delayEffect:e.delayEffect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.delayEffect=e.delayEffect,!0}},{key:"handleOptionChange",value:function(e){this.setState(this.state)}},{key:"handleFeedbackChange",value:function(e){this.state.delayEffect.setFeedback(e),this.setState(this.state)}},{key:"handleDelayTimeChange",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(dt.v)(this.state.delayEffect.rateParameter,e.value)),this.setState(this.state)}},{key:"handleWetChange",value:function(e){this.state.delayEffect.setWet(e),this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.delayEffect.isEnabled()}},{key:"delay",get:function(){return this.state.delayEffect}},{key:"onChangeSynced",value:function(e){document.activeElement.blur(),this.delay.isSynced="unsynced"===e,this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.state.delayEffect,n=(t.getFeedback(),t.rawDelayRate,t.isSynced);t.getWet(),void 0!==this.props.automation||t.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement("div",{className:"refined-checkbox-preferences lfo-synced-checkbox"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:n?"synced":"unsynced",checked:n,onChange:function(t){return e.onChangeSynced(t.target.value)}}),"Synced")),n?u.a.createElement("div",{className:"lfo-rate-dropdown"},u.a.createElement("div",{className:"lfo-rate-label"},"Rate:"),u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:Kf,onChange:function(t){return e.handleDelayTimeChange(t)},value:Qf(this.delay.rawDelayRate),placeholder:"Rate"}),u.a.createElement("div",{className:"clear-fix"})):u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Rate",parameter:this.state.delayEffect.rateParameter,onParameterChanged:this.props.onParameterChanged,sequencerEngine:this.props.sequencerEngine,isParameter:!0,lfoEnabled:!0,step:1,min:1,max:1e3}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Feedback",lfoEnabled:!0,selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,unit:"%",parameter:this.state.delayEffect.feedbackParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,displayFunction:function(e){return Math.floor(100*e)},step:.01,max:1,min:0}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.delayEffect})):"")}}]),n}(i.Component),Kf=[{value:"1n",label:"1"},{value:"2n",label:"1/2"},{value:"4n",label:"1/4"},{value:"4t",label:"1/4t"},{value:"8n",label:"1/8"},{value:"8n.",label:"1/8."},{value:"8t",label:"1/8t"},{value:"16n",label:"1/16"},{value:"16t",label:"1/16t"},{value:"32n",label:"1/32"}];function Qf(e){var t=Kf.filter(function(t){return t.value===e});return 0==t.length?"16n":t[0]}var Yf=Object(m.b)(function(e,t){return{rate:t.delayEffect.rateParameter.get(),isEnabled:t.delayEffect.isEnabled()}},null)(Xf);function Jf(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Zf=function(e){Object(xe.a)(n,e);var t=Jf(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Gain",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.gainParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.1,max:6,min:.1}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Threshold",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,scrollContainer:this.props.scrollContainer,selectedParameter:this.props.selectedParameter,parameter:this.state.effect.thresholdParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.1,max:0,min:-80}),u.a.createElement("div",{className:"knobs"},u.a.createElement(Ps.a,{effectNumber:this.props.effectNumber,scrollContainer:this.props.scrollContainer,automation:this.props.automation,name:"Ratio",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.state.effect.ratioParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:20,min:1}),u.a.createElement(Ps.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,scrollContainer:this.props.scrollContainer,name:"Knee",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.state.effect.kneeParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:40,min:0}),u.a.createElement(Ps.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Attack",scrollContainer:this.props.scrollContainer,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.state.effect.attackParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:1,min:0}),u.a.createElement(Ps.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Release",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.releaseParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,scrollContainer:this.props.scrollContainer,max:1,min:.15}))):"")}}]),n}(i.Component);function $f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var em=function(e){Object(xe.a)(n,e);var t=$f(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Order",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.orderParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:1,max:100,min:1}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(i.Component);function tm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var nm=function(e){Object(xe.a)(n,e);var t=tm(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Low",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.lowParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:10,min:-10}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Mid",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.midParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:10,min:-10}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"High",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.highParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:10,min:-10}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Low Frequency",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.lowFrequencyParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:10,max:400,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"High Frequency",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.highFrequencyParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:10,max:1e4,min:1e3})):"")}}]),n}(i.Component);function am(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var rm=function(e){Object(xe.a)(n,e);var t=am(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"31",unit:"db",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain31Parameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,sequencerEngine:this.props.sequencerEngine,step:.1,max:12,min:-12,lfoEnabled:!0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"63",sequencerEngine:this.props.sequencerEngine,unit:"db",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain63Parameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:12,min:-12,lfoEnabled:!0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"125",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain125Parameter,onParameterChanged:this.props.onParameterChanged,unit:"db",step:.1,max:12,min:-12,sequencerEngine:this.props.sequencerEngine,isParameter:!0,lfoEnabled:!0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"250",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain250Parameter,onParameterChanged:this.props.onParameterChanged,unit:"db",step:.1,max:12,min:-12,sequencerEngine:this.props.sequencerEngine,isParameter:!0,lfoEnabled:!0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"500",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,parameter:this.state.effect.gain500Parameter,onParameterChanged:this.props.onParameterChanged,unit:"db",step:.1,max:12,min:-12,isParameter:!0,lfoEnabled:!0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,name:"1k",unit:"db",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain1kParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,isParameter:!0,step:.1,max:12,min:-12}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"2k",unit:"db",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,parameter:this.state.effect.gain2kParameter,onParameterChanged:this.props.onParameterChanged,step:.1,max:12,min:-12,isParameter:!0,lfoEnabled:!0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"4k",unit:"db",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain4kParameter,onParameterChanged:this.props.onParameterChanged,lfoEnabled:!0,isParameter:!0,step:.1,max:12,sequencerEngine:this.props.sequencerEngine,min:-12}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"8k",unit:"db",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain8kParameter,onParameterChanged:this.props.onParameterChanged,step:.1,max:12,min:-12,sequencerEngine:this.props.sequencerEngine,isParameter:!0,lfoEnabled:!0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,unit:"db",name:"16k",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.gain16kParameter,onParameterChanged:this.props.onParameterChanged,step:.1,max:12,min:-12,sequencerEngine:this.props.sequencerEngine,isParameter:!0,lfoEnabled:!0})):"")}}]),n}(i.Component);function cm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var om=function(e){Object(xe.a)(n,e);var t=cm(n);function n(e){return Object(Pe.a)(this,n),t.call(this,e)}return Object(Ne.a)(n,[{key:"render",value:function(){return u.a.createElement("div",{className:"compressor-part"},u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Threshold",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.thresholdParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.1,max:8,min:-80}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Ratio",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.ratioParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:20,min:1}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Knee",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.kneeParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:40,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Attack",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.props.effect.attackParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:1,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Release",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.props.effect.releaseParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:1,min:.1}))}}]),n}(i.Component);function sm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var im="LOW",um=function(e){Object(xe.a)(n,e);var t=sm(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={selectedPart:im},a}return Object(Ne.a)(n,[{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.props.effect.isEnabled()}},{key:"onSelectCompressor",value:function(e){e=e.value,this.setState({selectedPart:e})}},{key:"getCompressor",value:function(){var e=this;return this.props.effect.compressors.find(function(t){return t.name===e.state.selectedPart})}},{key:"render",value:function(){var e=this;return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement("div",{className:"osc-type-dropdown-container"},u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:lm,onChange:function(t){return e.onSelectCompressor(t)},value:fm(this.state.selectedPart),placeholder:"LFO"})),u.a.createElement(om,{selectedParameter:this.props.selectedParameter,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,onParameterChanged:this.props.onParameterChanged,effect:this.getCompressor(),effectNumber:this.props.effectNumber})):"")}}]),n}(i.Component),lm=[{value:"LOW",label:"Low"},{value:"MID",label:"Mid"},{value:"HIGH",label:"High"}];function fm(e){for(var t=0;t<lm.length;t++)if(lm[t].value==e)return lm[t];return null}var mm=um;function pm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var dm=function(e){Object(xe.a)(n,e);var t=pm(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Rate",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.rateParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:20,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Feedback",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.feedbackParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:1,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Depth",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.depthParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.01,max:1,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Wet",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.wetParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.001,max:1,min:0})):"")}}]),n}(i.Component);function hm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var bm=function(e){Object(xe.a)(n,e);var t=hm(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Filter Cutoff",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.baseFrequencyParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:10,max:1e4,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Octave",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.octaveParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:10,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Q",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.qParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1,max:10,min:0}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Sensitivity",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.sensitivityParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1,max:3,min:-30}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Attack",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.attackParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:4,min:.1}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Release",selectedParameter:this.props.selectedParameter,parameter:this.state.effect.releaseParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.1,max:4,min:.1}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(i.Component);function vm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var gm=function(e){Object(xe.a)(n,e);var t=vm(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Distortion",parameter:this.state.effect.distortionParameter,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:1,min:0}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(i.Component);function Em(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Om=function(e){Object(xe.a)(n,e);var t=Em(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Bits",sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,selectedParameter:this.props.selectedParameter,parameter:this.state.effect.bitsParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:1,max:8,min:1}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(i.Component);function ym(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var km=function(e){Object(xe.a)(n,e);var t=ym(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Drive",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.driveParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.01,root:3,max:32,min:.01})):"")}}]),n}(i.Component);function jm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Cm=function(e){Object(xe.a)(n,e);var t=jm(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Pitch",parameter:this.state.effect.pitchParameter,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:24,min:-24}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Window Size",parameter:this.state.effect.windowSizeParameter,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:.2,min:.03}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(i.Component);function Sm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var wm=function(e){Object(xe.a)(n,e);var t=Sm(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,name:"Panning",parameter:this.state.effect.panningParameter,lfoEnabled:!0,sequencerEngine:this.props.sequencerEngine,onParameterChanged:this.props.onParameterChanged,isParameter:!0,step:.01,max:1,min:-1})):"")}}]),n}(i.Component),Pm=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine;return u.a.createElement("div",null,u.a.createElement(nc.a,{track:t.getTrack(),onSelectTrack:function(e){e?t.trackParameter.set(e.trackNumber):t.trackParameter.set(-1)},sequencerEngine:n}),u.a.createElement(Fa.a,{name:"Roughness",lfoEnabled:!0,parameter:t.roughnessParameter,isParameter:!0,step:.1,max:100,min:.1}))}),Nm=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine;return u.a.createElement("div",null,u.a.createElement(nc.a,{track:t.getTrack(),onSelectTrack:function(e){e?t.trackParameter.set(e.trackNumber):t.trackParameter.set(-1)},sequencerEngine:n}),u.a.createElement(Fa.a,{name:"Roughness",sequencerEngine:n,lfoEnabled:!0,parameter:t.roughnessParameter,isParameter:!0,step:.1,max:100,min:.1}),u.a.createElement(Fa.a,{name:"Q",sequencerEngine:n,lfoEnabled:!0,parameter:t.qParameter,isParameter:!0,step:.1,max:150,min:.1}))});function xm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var qm={},Tm={},Mm=[50,60,70,80,90,100,200,300,400,500,600,700,800,900,1e3,2e3,3e3,4e3,5e3,6e3,7e3,8e3,9e3,1e4],Rm=function(e){Object(xe.a)(n,e);var t=xm(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a.guideLines=a.getGuideLines(),a.fillCache(),a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.nextProps!==e.nextProps||(this.props.selectedPoint!==e.selectedPoint||JSON.stringify(this.props.equalizerPoints)!==JSON.stringify(e.equalizerPoints))}},{key:"fillCache",value:function(){for(var e=0;e<14e3;e++)this.getXPositionForFrequency(e);for(var t=0;t<650;t++)this.getFrequencyForXPosition(t)}},{key:"getFrequencyForXPosition",value:function(e){if(e in qm)return qm[e];var t=0,n=0,a=0;for(n=0;t<e;n++)t+=this.props.getWidth(n),a+=86;var r=this.props.getWidth(n),c=a-86+(e-(t-r))/r*86;return qm[e]=c,c}},{key:"getXPositionForFrequency",value:function(e){if(e in Tm)return Tm[e];var t=0,n=0,a=0;for(t=0;a<e;t++)n+=this.props.getWidth(t),a+=86;return n-=this.props.getWidth(t),n+=(e-(a-86))/86*this.props.getWidth(t),Tm[e]=n,n}},{key:"getGainYPosition",value:function(e){return 80-5*e}},{key:"equalizerPoints",get:function(){return this.props.effect.equalizerPoints||[]}},{key:"getEQCurve",value:function(){for(var e=[],t=this.equalizerPoints.filter(function(e){return e.enabled}),n=0;n<360;n+=2){var a=this.getFrequencyForXPosition(n),r=0;for(var c in t)r+=t[c].frequencyToGain(a);e.push(n),e.push(this.getGainYPosition(r))}return u.a.createElement(ka.e,{closed:!1,strokeWidth:2,lineCap:"butt",lineJoin:"miter",tension:.91,points:e,stroke:"#f55442"})}},{key:"getEqualizerPoints",value:function(){var e=this,t=this.equalizerPoints.filter(function(e){return e.enabled});return t.map(function(n,a){var r=t[a],c=e.getXPositionForFrequency(n.frequency);return u.a.createElement(ka.c,null,u.a.createElement(ka.a,{onMouseDown:function(t){return e.startDraggingPoint(r)},onMouseUp:function(t){return e.stopDraggingPoint(r)},x:c,y:e.getGainYPosition(n.gain),radius:8,fill:e.props.selectedPoint===r?"yellow":"black",stroke:"yellow",strokeWidth:2}),u.a.createElement(ka.i,{onMouseDown:function(t){return e.startDraggingPoint(r)},onMouseUp:function(t){return e.stopDraggingPoint(r)},text:r.number,fill:e.props.selectedPoint===r?"black":"yellow",fontSize:10,fontFamily:"Arial",x:c-3,y:e.getGainYPosition(n.gain)-5}))})}},{key:"getGuideLines",value:function(){var e=this;return Mm.map(function(t){return e.getXPositionForFrequency(t)}).map(function(e){return u.a.createElement(ka.e,{key:"eq-guideline-"+e,points:[e,0,e,160],stroke:"#1f1f1f",strokeWidth:1,closed:!1})})}},{key:"startDraggingPoint",value:function(e){console.log("start drag"),this.props.setSelectedPoint(e),this.setState({draggingPoint:e})}},{key:"stopDraggingPoint",value:function(e){this.setState({draggingPoint:void 0})}},{key:"onMouseMove",value:function(e){var t=e.evt.layerX,n=e.evt.layerY,a=parseInt(this.getFrequencyForXPosition(t));void 0!==this.state.draggingPoint&&(this.state.draggingPoint.frequency=a,this.state.draggingPoint.gain=(80-n)/5,this.setState(this.state))}},{key:"onMouseLeave",value:function(){this.setState({draggingPoint:void 0})}},{key:"render",value:function(){var e=this;return u.a.createElement(ka.c,{onMouseMove:function(t){return e.onMouseMove(t)},onMouseLeave:function(t){return e.onMouseLeave()}},u.a.createElement(ka.e,{closed:!0,strokeWidth:2,lineCap:"round",lineJoin:"round",points:[0,0,360,0,360,160,0,160],stroke:"black"}),this.guideLines,this.getEQCurve(),this.getEqualizerPoints())}}]),n}(i.Component),Dm=Object(m.b)(function(e,t){var n=t.effect.equalizerPoints,a={};for(var r in n){var c=n[r],o=c.frequencyParameter,s=c.gainParameter,i=c.qParameter,u=c.enabledParameter;a[r]={frequency:o.get(!0),gain:s.get(!0),enabled:u.get(!0),q:i.get(!0)}}return{equalizerPoints:a}},null)(Rm);function Im(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Am={},Lm=function(e){Object(xe.a)(n,e);var t=Im(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect,pts:[],updateRate:e.updateRate},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.state.updateRate!==e.updateRate&&(this.state.updateRate=e.updateRate,clearInterval(this.timer),this.run()),!0}},{key:"componentDidMount",value:function(){this.run()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"run",value:function(){var e=this;this.timer=setInterval(function(){if(e.props.sequencerEngine.playing){var t=Array.from(e.props.effect.getSpectrum());e.setState({pts:t})}},this.state.updateRate)}},{key:"getXPositionForFrequency",value:function(e){if(void 0!==Am[e])return Am[e];for(var t=0,n=0;n<e;n++)t+=this.props.getWidth(n);return Am[e]=t,t}},{key:"getBucketRect",value:function(e,t){var n=Object(Zo.a)(e,-160,0,1,160);return u.a.createElement(ka.g,{width:this.props.getWidth(t),height:-2*n,y:160,x:this.getXPositionForFrequency(t),fill:this.rainbow(t)})}},{key:"rainbow",value:function(e){return"hsl("+e+",100%,50%)"}},{key:"render",value:function(){var e=this;return this.state.pts.map(function(t,n){return e.getBucketRect(t,n)})}}]),n}(i.Component);function Fm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var zm=function(e){Object(xe.a)(n,e);var t=Fm(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props.equalizerPoint,t=e.enabled?"equalizer-point-info":"equalizer-point-info disabled";return this.props.selected&&(t+=" selected"),u.a.createElement("div",{onClick:this.props.onClick,className:t},u.a.createElement("div",{className:"equalizer-point-number"},e.number))}}]),n}(i.Component),Bm=n(1163);function _m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}i.Component;var Hm=[{value:Bm.a,label:"Fastest"},{value:Bm.b,label:"Fast"},{value:Bm.c,label:"Medium"},{value:Bm.e,label:"Slow"},{value:Bm.d,label:"Slowest"}],Um=(n(2438),{});window.WIDTH_CACHE=Um;var Gm=function(e){var t=Object(i.useState)([]),n=Object(s.a)(t,2),a=(n[0],n[1],Object(i.useState)(0)),r=Object(s.a)(a,2),c=(r[0],r[1],Object(i.useState)(e.effect.equalizerPoints[0])),o=Object(s.a)(c,2),l=o[0],f=o[1],p=Object(i.useState)(void 0),d=Object(s.a)(p,2),h=(d[0],d[1]),b=Object(i.useState)(void 0),v=Object(s.a)(b,2),g=v[0],E=v[1];Object(i.useEffect)(function(){l&&E(l.gainParameter)},[l,E]);var O=function(e){if(void 0!==Um[e])return Um[e];var t=void 0;return t=e<5?Object(Zo.a)(256-e,252,256,10,20):e<12?Object(Zo.a)(256-e,245,252,4,10):e<16?Object(Zo.a)(256-e,241,245,2,4):Object(Zo.a)(256-e,0,241,1,2),Um[e]=t,t},y=Object(i.useCallback)(function(t){if(console.log("on click eq"),l!==t)t.enabled||(t.enabled=!0),f(t);else{t.enabled=!1;var n=void 0;for(var a in e.effect.equalizerPoints){var r=e.effect.equalizerPoints[a];if(r.enabled){n=r;break}}f(n)}},[l,f]);e.automation;return u.a.createElement("div",null,u.a.createElement("div",{onDragStart:function(e){return e.stopPropagation()}},u.a.createElement("div",{className:"eq8"},u.a.createElement("div",{className:"eq8-knobs"},u.a.createElement("div",{className:g===l.frequencyParameter?" border border-white":"border-transparent"},u.a.createElement(Ps.a,{setSelectedParameter:E,color:"#f55442",scrollContainer:e.scrollContainer,name:"Freq",unit:"Hz",parameter:l.frequencyParameter})),u.a.createElement("div",{className:g===l.gainParameter?" border border-white":" border-transparent"},u.a.createElement(Ps.a,{setSelectedParameter:E,color:"#f55442",scrollContainer:e.scrollContainer,unit:"db",name:"Gain",parameter:l.gainParameter})),u.a.createElement("div",{className:g===l.qParameter?" border border-white":"border-transparent"},u.a.createElement(Ps.a,{setSelectedParameter:E,color:"#f55442",scrollContainer:e.scrollContainer,name:"Q",min:.1,parameter:l.qParameter}))),u.a.createElement("div",null,u.a.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},className:"spectrum-container"},u.a.createElement(ka.h,{width:360,height:160},u.a.createElement(m.a,{store:e.sequencerEngine.store},u.a.createElement(ka.b,{width:360,height:160},u.a.createElement(ka.g,{width:360,height:160,fill:"black"}),u.a.createElement(Lm,{updateRate:e.effect.updateRate,sequencerEngine:e.sequencerEngine,getWidth:function(e){return O(e)},effect:e.effect})),u.a.createElement(ka.d,{width:360,height:160},u.a.createElement(Dm,{selectedPoint:l,setSelectedPoint:function(e){return f(e)},effect:e.effect,getWidth:function(e){return O(e)},setDraggingPoint:function(e){return h(e)}}))))),u.a.createElement("div",{className:"equalizer-parameters"},u.a.createElement("div",{className:"equalizer-points"},e.effect.equalizerPoints.map(function(e){return u.a.createElement(zm,{onClick:function(){return y(e)},selected:l===e,equalizerPoint:e})}),g&&u.a.createElement("div",{className:"flex flex-1"},u.a.createElement(Ki,{sequencerEngine:e.sequencerEngine,showDepth:!0,parameter:g}))))))))};function Wm(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Vm=function(e){Object(xe.a)(n,e);var t=Wm(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Width",selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,lfoEnabled:!0,parameter:this.state.effect.widthParameter,isParameter:!0,onParameterChanged:this.props.onParameterChanged,step:.01,max:1,min:0}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.effect})):"")}}]),n}(i.Component),Xm=function(e){var t=Object(i.useState)(e.effect._isSaturated),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useCallback)(function(t){var n=!a;e.effect.isSaturated=n,r(n)},[r,a]);void 0!==e.automation||e.effect.isEnabled();return console.log("saturated=",a),u.a.createElement("div",null,u.a.createElement("div",{className:"tape-row"},u.a.createElement("div",{className:"tape-column"},u.a.createElement(Fa.a,{effectNumber:e.effectNumber,name:"Rate",parameter:e.effect.rateParameter,onParameterChanged:e.onParameterChanged,sequencerEngine:e.sequencerEngine,isParameter:!0,lfoEnabled:!0,root:2,step:1e-4,min:0,max:1}),u.a.createElement(Fa.a,{effectNumber:e.effectNumber,automation:e.automation,name:"Feedback",lfoEnabled:!0,selectedParameter:e.selectedParameter,sequencerEngine:e.sequencerEngine,unit:"%",parameter:e.effect.feedbackParameter,onParameterChanged:e.onParameterChanged,isParameter:!0,displayFunction:function(e){return Math.floor(100*e)},step:.01,max:1,min:0}),a&&u.a.createElement(Fa.a,{effectNumber:e.effectNumber,automation:e.automation,name:"Saturation",lfoEnabled:!0,selectedParameter:e.selectedParameter,sequencerEngine:e.sequencerEngine,parameter:e.effect.driveParameter,onParameterChanged:e.onParameterChanged,isParameter:!0,step:.01,max:6,min:.1}),u.a.createElement(bc.a,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onParameterChanged:e.onParameterChanged,effect:e.effect}),u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",checked:!!a,onChange:c}),"Saturated")),u.a.createElement("div",{className:"eq-knobs"},u.a.createElement(Ps.a,{name:"Low",min:-16,max:3,parameter:e.effect.lowEQParameter,scrollContainer:e.scrollContainer}),u.a.createElement(Ps.a,{name:"Mid",min:-16,max:3,parameter:e.effect.midEQParameter,scrollContainer:e.scrollContainer}),u.a.createElement(Ps.a,{min:-16,max:3,name:"Hi",parameter:e.effect.highEQParameter,scrollContainer:e.scrollContainer}))))};function Km(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Qm=function(e){Object(xe.a)(n,e);var t=Km(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={delayEffect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.delayEffect=e.effect,!0}},{key:"handleOptionChange",value:function(e){this.setState(this.state)}},{key:"handleFeedbackChange",value:function(e){this.state.delayEffect.setFeedback(e),this.setState(this.state)}},{key:"handleDelayTimeChange",value:function(e){"LEFT"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LEFT")?this.state.delayEffect.leftDelay.rate=e.value:this.state.delayEffect.rightDelay.rate=e.value,this.setState(this.state)}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.delayEffect.isEnabled()}},{key:"onChangeSynced",value:function(e){document.activeElement.blur(),this.props.effect.isSynced="unsynced"===e,this.setState(this.state)}},{key:"render",value:function(){var e=this,t=this.props.effect,n=t.isSynced;void 0!==this.props.automation||t.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement("div",{className:"refined-checkbox-preferences lfo-synced-checkbox"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:n?"synced":"unsynced",checked:n,onChange:function(t){return e.onChangeSynced(t.target.value)}}),"Synced")),n?u.a.createElement("div",null,u.a.createElement("div",{className:"lfo-rate-dropdown"},u.a.createElement("div",{className:"lfo-rate-label"},"Left Rate:"),u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:Ym,onChange:function(t){return e.handleDelayTimeChange(t,"LEFT")},value:Jm(this.props.effect.leftDelay.rawDelayRate),placeholder:"Rate"}),u.a.createElement("div",{className:"clear-fix"})),u.a.createElement("div",{className:"lfo-rate-dropdown"},u.a.createElement("div",{className:"lfo-rate-label"},"Right Rate:"),u.a.createElement(D.a,{className:"osc-type-dropdown",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:Ym,onChange:function(t){return e.handleDelayTimeChange(t,"RIGHT")},value:Jm(this.props.effect.rightDelay.rawDelayRate),placeholder:"Rate"}),u.a.createElement("div",{className:"clear-fix"}))):u.a.createElement("div",null,u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Left Rate",parameter:this.state.delayEffect.leftDelay.rateParameter,onParameterChanged:this.props.onParameterChanged,sequencerEngine:this.props.sequencerEngine,isParameter:!0,lfoEnabled:!0,step:1,min:1,max:1e3}),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,name:"Right Rate",parameter:this.state.delayEffect.rightDelay.rateParameter,onParameterChanged:this.props.onParameterChanged,sequencerEngine:this.props.sequencerEngine,isParameter:!0,lfoEnabled:!0,step:1,min:1,max:1e3})),u.a.createElement(Fa.a,{effectNumber:this.props.effectNumber,automation:this.props.automation,name:"Feedback",lfoEnabled:!0,selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,unit:"%",parameter:this.state.delayEffect.feedbackParameter,onParameterChanged:this.props.onParameterChanged,isParameter:!0,displayFunction:function(e){return Math.floor(100*e)},step:.01,max:1,min:0}),u.a.createElement(bc.a,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onParameterChanged:this.props.onParameterChanged,effect:this.state.delayEffect})):"")}}]),n}(i.Component),Ym=[{value:"1n",label:"1"},{value:"2n",label:"1/2"},{value:"4n",label:"1/4"},{value:"4t",label:"1/4t"},{value:"8n",label:"1/8"},{value:"8n.",label:"1/8."},{value:"8t",label:"1/8t"},{value:"16n",label:"1/16"},{value:"16t",label:"1/16t"},{value:"32n",label:"1/32"}];function Jm(e){var t=Ym.filter(function(t){return t.value===e});return 0==t.length?"16n":t[0]}var Zm=Qm;function $m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var ep=function(e){Object(xe.a)(n,e);var t=$m(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(nd,{hideIOs:this.props.hideIOs,isDraggable:this.props.isDraggable,track:this.props.track,scrollContainer:this.props.scrollContainer,send:this.props.send,compact:this.props.compact,sequencerEngine:this.props.sequencerEngine,effect:this.state.effect})):"")}}]),n}(i.Component),tp=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=(e.scrollContainer,e.sequencerEngine),a=e.effectNumber;return u.a.createElement("div",{className:"wave-folder"},u.a.createElement(Fa.a,{effectNumber:a,name:"Amount",sequencerEngine:n,root:4,lfoEnabled:!0,parameter:t.amountParameter,isParameter:!0,step:.01,max:4,min:.01}))}),np=(n(1097),new ra.a),ap={},rp=function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ip($e.gb,"tag",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),cp=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d.a,e.next=3,We.a.guilds.getGuildsWithAccess();case 3:e.t1=e.sent,(t=(0,e.t0)(e.t1)).reverse(),e.t2=c.a.keys(t);case 7:if((e.t3=e.t2()).done){e.next=15;break}if(!((n=e.t3.value)>=1)){e.next=11;break}return e.abrupt("break",15);case 11:return e.next=13,We.a.guilds.getGuildKey(t[n]);case 13:e.next=7;break;case 15:return t=[t[0]],e.abrupt("return",[].concat(Object(d.a)(t),[0]));case 17:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),op=function(e,t,n){return ap[e+t+n]},sp=function(e,t,n,a){ap[e+t+n]=a},ip=function(){var e=Object(o.a)(c.a.mark(function e(t,n,a){var r,o,s,i,u=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>3&&void 0!==u[3]?u[3]:"ipfsHash",!op(t,n,a)){e.next=3;break}return e.abrupt("return",op(t,n,a));case 3:return e.next=5,cp();case 5:return o=e.sent,e.next=8,new Je.a(np.contractAddress).from(t).select(r).whereIn("guildId",o).where(n,a).executeQuery();case 8:return s=e.sent,i=Array.from(new Set(s.map(function(e){return e[r]}))),sp(t,n,a,i),e.abrupt("return",i);case 12:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),up=function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Je.a(np.contractAddress).from($e.cb).select("title").select("ipfsHash").whereIn("ipfsHash",t).executeQuery();case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),lp=Object(m.b)(function(e,t){return{convolverSample:t.effect.convolver.convolverSample,wet:t.effect.convolver.wetParameter.get()}},function(e){return{}})(function(e){var t=e.effect,n=e.effectNumber,a=(e.sequencerEngine,Object(i.useState)(void 0)),r=Object(s.a)(a,2),l=r[0],f=r[1],m=Object(i.useState)([]),p=Object(s.a)(m,2),d=p[0],h=p[1],b=Object(i.useState)(t.convolver.convolverSample),v=Object(s.a)(b,2),g=v[0],E=v[1];Object(i.useEffect)(function(){t.convolver.convolverSample!==g&&E(t.convolver.convolverSample)},[t.convolver.convolverSample,E,g]),Object(i.useEffect)(function(){if(void 0!==g){var e=new Ct.a(t.convolver.convolverSample);e.load(!1).then(function(){f(e)})}},[t,g,f]),Object(i.useEffect)(function(){rp("guitar amp").then(function(e){up(e).then(function(e){return h(e)})})},[h]);var O=Object(i.useCallback)(function(){var e=Object(o.a)(c.a.mark(function e(n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.convolver.setConvolverSample(n);case 2:E(n);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[t,E]);if(void 0===l)return[];var y=l.tags||[];return u.a.createElement("div",{className:"guitar-amp"},u.a.createElement("div",{className:"amp-name"},l.name),u.a.createElement("div",{className:"amp-tags"},y.map(function(e){return u.a.createElement("div",{key:e,className:"amp-tag"},e)})),u.a.createElement(Fa.a,{effectNumber:n,automation:void 0,name:"Tone",parameter:t.convolver.pitchParameter,isParameter:!0,onParameterChanged:function(){return[]},step:.1,max:24,min:-24}),u.a.createElement("div",{className:"amps-list"},d.map(function(e,t){return u.a.createElement("div",{key:t,onClick:function(){return O(e.ipfsHash)},className:e.ipfsHash===l.ipfsHash?"amp-option selected":"amp-option"},e.title)})))}),fp=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.scrollContainer,a=e.sequencerEngine,r=e.effectNumber;return u.a.createElement("div",null,u.a.createElement("div",{className:"wave-folder"},u.a.createElement(Ps.a,{scrollContainer:n,name:"Stages",parameter:t.stagesParameter,step:1,max:20,min:1}),u.a.createElement(Ps.a,{scrollContainer:n,name:"Smoothness",parameter:t.smoothnessParameter,step:.1,max:12,min:1})),u.a.createElement(Cr.a,{parameter:t.overSampleParameter,name:"Oversample"}),u.a.createElement(Fa.a,{effectNumber:r,name:"Drive",sequencerEngine:a,root:4,lfoEnabled:!0,parameter:t.driveParameter,isParameter:!0,step:.01,max:32,min:.01}),u.a.createElement(bc.a,{effect:t,sequencerEngine:a}))}),mp=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effectNumber,n=e.effect,a=e.sequencerEngine;return u.a.createElement("div",{className:"ring-modulator"},u.a.createElement(Fa.a,{effectNumber:t,name:"Frequency",sequencerEngine:a,lfoEnabled:!0,parameter:n.frequencyParameter,isParameter:!0,step:.01,max:3e3,min:20}),u.a.createElement(Fa.a,{effectNumber:t,name:"Distortion",sequencerEngine:a,lfoEnabled:!1,parameter:n.distortionParameter,isParameter:!0,step:.01,max:3,min:.01}),u.a.createElement(bc.a,{effectNumber:t,sequencerEngine:a,effect:n}))}),pp=[{value:4,label:4},{value:6,label:6},{value:8,label:8},{value:10,label:10},{value:16,label:16},{value:32,label:32}],dp=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,a=Object(i.useState)(t.numBanks),r=Object(s.a)(a,2),c=(r[0],r[1]),o=Object(i.useCallback)(function(e){var n=e.value;t.numBanks=n,c({value:n,label:n})},[c,t]);return u.a.createElement("div",null,u.a.createElement("div",{className:"bands-toolbar"},u.a.createElement("div",{className:"bands-label"},"Number of Banks: "),u.a.createElement(D.a,{options:pp,onChange:o,value:pp.find(function(e){return e.value===t.numBanks})})),u.a.createElement(Fa.a,{parameter:t.frequencyParameter,min:1,lfoEnabled:!0,max:1e3,name:"Frequency",sequencerEngine:n,isParameter:!0}),u.a.createElement(Fa.a,{parameter:t.delaySpreadParameter,min:0,lfoEnabled:!0,max:1,step:1e-4,name:"Delay Spread",sequencerEngine:n,isParameter:!0}),u.a.createElement(Cr.a,{name:"Reverse delay",parameter:t.delayDirectionParameter}))}),hp=Object(i.memo)(function(e){var t=Object(i.useRef)(void 0),n=u.a.createElement(lr.a,Object.assign({},e,{onDeleteEffect:e.onDeleteEffect,effectNumber:e.effectNumber,onToggle:function(){return[]},track:e.track,group:e.group,showDelete:e.showDelete,send:e.send,noSelect:e.noSelect,effect:e.effect,automation:e.automation}),function(e){if("Filter"===e.effect.name)return u.a.createElement(Rs,Object.assign({},e,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,filterEffect:e.effect}));if("Auto Filter"===e.effect.name)return u.a.createElement(Fs,Object.assign({},e,{sequencerEngine:e.sequencerEngine,effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,filterEffect:e.effect}));if("Gain"===e.effect.name)return u.a.createElement(ys,Object.assign({},e,{sequencerEngine:e.sequencerEngine,effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,filterEffect:e.effect}));if("Delay"===e.effect.name)return u.a.createElement(Yf,Object.assign({},e,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,delayEffect:e.effect}));if("Tremolo"===e.effect.name)return u.a.createElement(ui,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,tremoloEffect:e.effect}));if("Chorus"===e.effect.name)return u.a.createElement(si,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,chorusEffect:e.effect}));if("Faust WaveFolder"===e.effect.name)return u.a.createElement(go,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,chorusEffect:e.effect}));if("Faust Reverb"===e.effect.name)return u.a.createElement(vo,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,chorusEffect:e.effect}));if("Reverb"===e.effect.name)return u.a.createElement(Bs,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,reverbEffect:e.effect}));if("Convolver Reverb"===e.effect.name)return u.a.createElement(ci,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,reverbEffect:e.effect}));if("Compressor"===e.effect.name)return u.a.createElement(Zf,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Distortion"===e.effect.name)return u.a.createElement(gm,Object.assign({},e,{sequencerEngine:e.sequencerEngine,effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("EQ 3"===e.effect.name)return u.a.createElement(nm,Object.assign({},e,{sequencerEngine:e.sequencerEngine,effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("EQ 10"===e.effect.name)return u.a.createElement(rm,Object.assign({},e,{sequencerEngine:e.sequencerEngine,effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Bit Crusher"===e.effect.name)return u.a.createElement(Om,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Ultra Phaser"===e.effect.name)return u.a.createElement(dm,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,sequencerEngine:e.sequencerEngine,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Multi Filter"===e.effect.name)return u.a.createElement(Es,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,selectedParameter:e.selectedParameter,sequencerEngine:e.sequencerEngine,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Auto Wah"===e.effect.name)return u.a.createElement(bm,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Gate"===e.effect.name)return u.a.createElement(ws,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Pitch Shift"===e.effect.name)return u.a.createElement(Cm,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Panner"===e.effect.name)return u.a.createElement(wm,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("EQ8"===e.effect.name)return u.a.createElement(Gm,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Chebyshev"===e.effect.name)return u.a.createElement(em,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Multiband Compressor"===e.effect.name)return u.a.createElement(mm,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Stereo Widener"===e.effect.name)return u.a.createElement(Vm,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Saturator"===e.effect.name)return u.a.createElement(km,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Soft Clipper"===e.effect.name)return u.a.createElement(Os,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Tape Delay"===e.effect.name)return u.a.createElement(Xm,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Stereo Delay"===e.effect.name)return u.a.createElement(Zm,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Oscilloscope"===e.effect.name)return u.a.createElement(Cs,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Effect Rack"===e.effect.name)return u.a.createElement(ep,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Guitar Amp"===e.effect.name)return u.a.createElement(lp,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Wave Folder"===e.effect.name)return u.a.createElement(fp,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Wave Folder 2"===e.effect.name)return u.a.createElement(tp,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Ring Modulator"===e.effect.name)return u.a.createElement(mp,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Follower"===e.effect.name)return u.a.createElement(Pm,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Vocoder"===e.effect.name)return u.a.createElement(Nm,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Frequency Shifter"===e.effect.name)return u.a.createElement(dp,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Transient Shaper"===e.effect.name)return u.a.createElement(li,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Genetic WaveShaper"===e.effect.name)return u.a.createElement(Ns,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Freak Shifter"===e.effect.name)return u.a.createElement(_s,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));if("Zen"===e.effect.name)return u.a.createElement(ho,Object.assign({},e,{effectNumber:e.effectNumber,tracks:e.tracks,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}));var t=Object(bo.a)()[e.effect.name];if(!t)return null;var n=t.component;return u.a.createElement(n,Object.assign({},e,{effectNumber:e.effectNumber,automation:e.automation,sequencerEngine:e.sequencerEngine,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}))}(e));return u.a.createElement("div",{ref:t,className:"audio-effect-container"},u.a.createElement(vn.a,{element:e.effect},n))}),bp=Object(m.b)(function(e,t){return{linkedParameterSelected:e.effects.accumulatorParameterSelected,preset:t.effect.preset}},function(e){return{}})(hp),vp=function(e){var t=e.macros,n=e.setShowMacrosView,a=e.sequencerEngine,r=Object(i.useCallback)(function(){n(!1)},[n]);return u.a.createElement("div",{className:"effect-rack macros-view"},t.map(function(e){return u.a.createElement(Fa.a,{effectNumber:0,automation:void 0,name:e.name,selectedParameter:void 0,sequencerEngine:a,lfoEnabled:!0,root:3,parameter:e.macroParameter,isParameter:!0,onParameterChanged:function(){return[]},step:.01,max:1,min:0})}),u.a.createElement("div",{onClick:r,className:"expand-macros-button"},"Expand"))};function gp(e){var t=e.edge,n=e.sequencerEngine;return e.rack.getEffectType()===Tc.c?u.a.createElement("div",{className:"edge-properties"},u.a.createElement("div",null,"Edge Properties:"),u.a.createElement(Fa.a,{effectNumber:0,automation:void 0,name:"Probability",selectedParameter:void 0,sequencerEngine:n,lfoEnabled:!0,parameter:t.probabilityParameter,isParameter:!0,onParameterChanged:function(){return[]},step:.01,max:100,min:0})):u.a.createElement("div",{className:"edge-properties"},u.a.createElement("div",null,"Edge Properties:"),u.a.createElement(Fa.a,{effectNumber:0,automation:void 0,name:"Gain",selectedParameter:void 0,sequencerEngine:n,lfoEnabled:!0,parameter:t.gainParameter,isParameter:!0,onParameterChanged:function(){return[]},step:.01,min:0,max:1}))}var Ep={INPUT:"Input for node",OUTPUT:"Output for node"};function Op(e){var t=e.x,n=e.y,a=e.mode,r=e.parameter,c=e.isRule,o=e.number,s=(qc.b,Ep[a]);r&&r.name&&(s=r.name+": "+r.get()),n=a===qc.b?n-5:n+5;var i=8*s.length;return c&&(a===qc.b?(s="Then",n-=20):s=1===o?"Before":2===o?"When":"After"),u.a.createElement("g",null,u.a.createElement("rect",{className:"rack-tooltip",x:t,y:n-15,height:15,width:i}),u.a.createElement("text",{className:"tooltip-text",fontSize:12,fill:"white",x:t+5,y:n-3},s))}var yp=300;var kp=Object(m.b)(null,function(e){return{setContextualHelp:function(t,n){return e(Object(f.hb)(t,n))},setParameterToMap:function(t){return e(Object(f.md)(t))}}})(function(e){var t=e.x,n=e.y,a=e.number,r=e.mode,c=e.parameter,o=e.startDrawingEdge,l=(e.drawingEdge,e.rack),f=e.effect,m=e.isModulator,p=e.selectedEdge,d=e.connectEdge,h=e.setContextualHelp,b=e.isMacroMapping,v=e.hideIOs,g=e.setParameterToMap,E=Object(i.useState)(!1),O=Object(s.a)(E,2),y=O[0],k=O[1],j=Object(i.useState)(!1),C=Object(s.a)(j,2),S=C[0],w=C[1],P=Object(i.useState)(null),N=Object(s.a)(P,2),x=N[0],q=N[1];n=r===qc.b?n:m?n+qc.e:n+qc.f[l.getEffectType()],r===qc.b&&v?n-=3:r===qc.h&&v&&(n+=3);var T=Object(i.useCallback)(function(){k(!0),q(setTimeout(function(){w(!0)},yp)),h(r===qc.b?bn.Q:m?bn.P:bn.R)},[k,y,q,w]),M=Object(i.useCallback)(function(e){clearTimeout(x),w(!1),k(!1),h(void 0)},[k,w,x]),R=Object(i.useCallback)(function(e){b&&(e.stopPropagation(),g(c)),o(f,r,t+8*a,n,a-1)},[o,w,f,r,a,t,n,b]);return p&&p.effect&&(p.effect.id===f.id||p.fromNode===f)?[]:u.a.createElement("g",null,u.a.createElement("circle",{className:b?"node-io mapping":"node-io",strokeWidth:y?2:0,stroke:y?"yellow":"black",cx:t+8*a,onMouseDown:R,onMouseOver:y?function(){return[]}:T,onMouseLeave:M,onMouseUp:function(){return d(c||f,r)},cy:n,r:v?5:3,fill:"#626363"}),S?u.a.createElement(Op,{isRule:"Rules Rack"===l.name,number:a,parameter:c,mode:r,x:t+8*a,y:n+20}):u.a.createElement("rect",{x:0,y:0,width:0,height:0}))}),jp=Object(i.memo)(function(e){var t=e.effect,n=e.x,a=e.y,r=e.hideIOs,c=(e.setDragging,e.rack),o=e.connectEdge,s=e.startDrawingEdge,i=e.drawingEdge,l=e.selectedEdge,f=(e.setSelectedEdge,e.edges,e.isMacroMapping),m=Math.floor(t.numberOfOutputs);isNaN(m)&&(m=1);var p=new Array(m).fill(void 0),h=[void 0];return t.parameters&&!r&&(h=c.getEffectType()===Tc.d?Object(d.a)(h):[].concat(Object(d.a)(h),Object(d.a)(t.parameters.filter(function(e){return e.automatable}).filter(function(e){return"enabled"!==e.name})))),h.length>15&&(h=h.slice(0,15)),u.a.createElement("g",null,h.map(function(e,m){return u.a.createElement(kp,{x:n,y:a,key:"intput-"+m,number:m+1,mode:qc.b,selectedEdge:l,parameter:e,effect:t,isMacroMapping:f,hideIOs:r,rack:c,connectEdge:o,drawingEdge:i,startDrawingEdge:s})}),p.map(function(e,f){return u.a.createElement(kp,{key:"output-"+f,x:n,hideIOs:r,y:a,parameter:e,drawingEdge:i,rack:c,selectedEdge:l,number:f+1,mode:qc.h,connectEdge:o,startDrawingEdge:s,effect:t})}))}),Cp=Object(m.b)(function(e,t){return void 0!==t.x?{}:{x:t.effect.x,y:t.effect.y,isMacroMapping:e.effects.isMacroMapping,numberOfOutputs:t.effect.numberOfOutputs}},null)(jp),Sp=n(17),wp=1;function Pp(e){var t=e.effect,n=e.sequencerEngine,a=e.track,r=e.isMidiEffect,c=e.handleChooseEffect,o=e.options,l=e.placeholder,f=Object(i.useState)(1),m=Object(s.a)(f,2),p=m[0],d=m[1],h=Object(i.useCallback)(function(e){var t=r?Object(cr.c)(e,a):Object(cr.b)(e,n);c(t),d(++wp),setTimeout(function(){return d(void 0)},50)},[d,t]),b=o||(r?cr.e:Object(cr.a)());return u.a.createElement("div",null,u.a.createElement(D.a,{className:"effect-dropdown",options:b,option:1===p?void 0:p,value:1===p?void 0:p,onChange:function(e){return h(e.value)},placeholder:l||"Add FX"}))}var Np=["A","B","C","D","E","F","G"],xp=function(e){var t=e.rack,n=e.routingNumber,a=Object(i.useCallback)(function(e){e.target.blur();var n=parseInt(e.target.value);t.currentConfiguration=n},[]),r=t.configurations.map(function(e,t){return{label:Np[t],value:parseInt(t)}});return u.a.createElement(vn.a,{element:bn.O,className:"routing-chooser"},u.a.createElement("form",null,r.map(function(e){return u.a.createElement("label",{key:e.label},e.label,u.a.createElement("input",{type:"radio",value:e.value,onChange:a,checked:n===e.value}))})))},qp=function(e){var t=e.rack,n=e.macrosDisabled,a=e.sequencerEngine,r=e.handleChooseEffect,c=e.setEdges,o=e.setShowMacrosView,s=e.selectedNodes,l=e.setMacros,f=Object(i.useRef)();Object(Da.a)(f);var m=Object(i.useCallback)(function(){t.newMacro(),l(Object(d.a)(t.macros))},[l]),p=Object(i.useCallback)(function(){t.connectNodesInSeries(s),c(Object(B.a)({},t.adjacencyLists))},[c,s,t]),h=t.getEffectType()===Tc.c?Object(cr.e)():Object(cr.a)();return"Rules Rack"===t.name&&(h=cr.f),"Chords Rack"===t.name?"":u.a.createElement("div",{ref:f,className:"rack-toolbar"},u.a.createElement(Pp,{effect:t,track:t.track,options:h,placeholder:"Rules Rack"===t.name?"+":"Add FX",isMidiEffect:t.getEffectType()===Tc.c,sequencerEngine:a,handleChooseEffect:r}),t.getEffectType()===Tc.c&&"Rules Rack"!==t.name?u.a.createElement(Pp,{track:t.track,isMidiEffect:t.getEffectType()===Tc.c,effect:t,placeholder:"Flow",options:cr.d,sequencerEngine:a,handleChooseEffect:r}):"",n?"":[u.a.createElement("div",{key:1,onClick:m,className:"add-macro-button"},"Add Macro"),u.a.createElement("div",{key:2,onClick:function(){return o(!0)},className:"show-macros-button"},"Macros")],s.length>1?u.a.createElement("div",{onClick:p,className:"add-macro-button"},"Connect Nodes"):"")},Tp=function(e){var t=e.rack,n=e.routingNumber,a=(e.sequencerEngine,e.setRoutingNumber),r=Object(i.useCallback)(function(){t.newConfiguration()},[]);return u.a.createElement(vn.a,{element:bn.w,className:"rack-toolbar"},u.a.createElement("div",{onClick:r,className:"new-routing-button"},"New Routing"),u.a.createElement(xp,{routingNumber:n,setRoutingNumber:a,rack:t}))},Mp=n(373);function Rp(e){var t=e.drawingEdge;if(void 0===t)return u.a.createElement("rect",{x:0,y:0,width:0,height:0});var n=t.x1,a=t.y1,r=t.x2,c=t.y2;return u.a.createElement(Mp.a,{pointerLength:6,pointerWidth:4,points:[n,a,(n+r)/2,(a+c)/2,r,c,r,c],strokeWidth:2,stroke:"red"})}new h.a;window.dist=4,window.x=1,window.tension=.4,window.baseColor="#2653d173";var Dp=function(e,t,n,a){return Math.sqrt(Math.pow(n-e,2)+Math.pow(a-t,2))};function Ip(e,t){if(void 0!==e){var n=e.context&&(e.context.macro||e.context.subDevice);if(void 0===n||void 0===n.parameters)return 0;var a=n.parameters.filter(function(e){return e.automatable});t.getEffectType()===Tc.d&&(a=[n.harmonicityParameter,n.modulationIndexParameter]);var r=a.indexOf(e);if(-1!==r)return n.x+8+8*r}}var Ap=Object(m.b)(function(e,t){if(t.modulator){var n=t.edge.context&&(t.edge.context.macro||t.edge.context.subDevice);return n?{x2:n.x,y2:n.y}:{x2:0,y2:0}}return t.macro&&t.edge.parameter.context?{x1:t.macro.x,y1:t.macro.y,x2:t.edge.parameter.context.subDevice.x,y2:t.edge.parameter.context.subDevice.y}:t.effect?{x1:t.effect.x,y1:t.effect.y,x2:t.edge.effect.x,y2:t.edge.effect.y}:{x1:0,y1:0,x2:0,y2:0}},null)(function(e){e.width;var t=e.rack,n=e.effect,a=e.edge,r=e.setSelectedEdge,c=e.selected,o=e.modulator,l=e.macro,f=e.startDrawingEdge,m=e.playing,p=e.triggerCount,d=(e.avgTranspose,Object(i.useState)(!1)),h=Object(s.a)(d,2),b=h[0],v=h[1],g=Object(i.useCallback)(function(){t.deleteEdge(a);var e=a.effect.x+8;f(a.effect,qc.b,e,a.effect.y,0)},[a]),E=Object(i.useCallback)(function(){t.deleteEdge(a),f(a.fromNode,qc.h,a.fromNode.x+8+8*a.outputNumber,a.fromNode.y+qc.f[t.getEffectType()],0)},[a]),O=function(e,t,n){if(void 0===t)return{x1:void 0,y1:void 0,x2:void 0,y2:void 0};var a=8+(t.getType()===Sp.a?4+t.number:t.number)/(e.modulators.length+1)*qc.j[e.getEffectType()],r=qc.f[e.getEffectType()],c=Ip(n,e),o=n.context&&(n.context.macro||n.context.subDevice),s=void 0===o?void 0:o.y;return{x1:a,y1:r,x2:c,y2:s}}(t,o,a),y=O.x1,k=O.y1,j=O.x2,C=O.y2;if(l){var S=function(e,t,n){if(void 0===t)return{x1:void 0,y1:void 0,x2:void 0,y2:void 0};var a=t.x+8,r=t.y+qc.f[e.getEffectType()],c=Ip(n,e),o=n.context&&n.context.subDevice.y;return{x1:a,y1:r,x2:c,y2:o}}(t,l,a.parameter);y=S.x1,k=S.y1,j=S.x2,C=S.y2}else o||(y=n.x+8+8*a.outputNumber,k=n.y+qc.f[t.getEffectType()],j=a.effect.x+8,C=a.effect.y);var w="edge ";o&&(o.getType()===Sp.a?w+=" env-edge":w+=" lfo-edge"),l&&(w+=" macro-edge"),c&&(w+=" selected"),t.getEffectType()===Tc.d&&void 0===o&&(w+=" oscillator-edge",a.operator.synth||(w+=" fm-output-edge")),b&&(w+=" hovered");var P=Object(i.useCallback)(function(){v(!0)},[v]),N=Object(i.useCallback)(function(){v(!1)},[v]),x=Object(i.useCallback)(function(){r(o?{modulator:o,edge:a}:a)},[r,a,o]);if(void 0===j||void 0===C)return[];if(!o&&!l&&void 0===a.gainParameter&&void 0===a.modulation)return[];var q=1;!m||t.getEffectType()!==Tc.c||b||c?l||o||c||(q=Math.max(.2,a.getWeight(t))):0===p&&(q=.4);var T=[];c&&(T=[u.a.createElement("circle",{strokeWidth:1,onMouseDown:g,stroke:"red",cx:y,cy:k,r:3,fill:"white"}),u.a.createElement("circle",{strokeWidth:1,onMouseDown:E,stroke:"red",cx:j,cy:C,r:3,fill:"white"})]);var M=Math.sqrt(Dp(y,k,j,C))*window.dist,R=(Math.abs(C-k),Math.abs(j-y)),D=Math.sqrt(R);j-y<0&&(D*=-1),R<20&&t.getEffectType()!==Tc.d&&(D+=20-R);var I=[y,k,y+window.x*D,k+M,j-window.x*D,C-M,j,C];return n===a.effect&&(I=[y,k,y-50,k+M,j-50,C-M,j,C]),u.a.createElement("g",null,u.a.createElement(Mp.a,{className:w,onMouseOver:P,onMouseLeave:N,tension:window.tension,onMouseDown:x,pointerLength:6,opacity:q,pointerWidth:4,points:I,markerEnd:"",strokeWidth:2}),u.a.createElement(Mp.a,{onMouseOver:P,markerEnd:"",onMouseLeave:N,onMouseDown:x,pointerLength:6,pointerWidth:4,tension:window.tension,className:w,opacity:0,points:I,strokeWidth:8}),T)}),Lp=Object(i.memo)(function(e){var t=e.edges,n=e.rack,a=e.setSelectedEdge,r=e.selectedEdge,c=e.startDrawingEdge,o=(e.stepNumber,e.playing),s=t[-1]||[],i=[],l=function(e){var s=n.effects[e],l=t[s.id];if(void 0===l)return"continue";i=[].concat(Object(d.a)(i),Object(d.a)(l.map(function(e,t){return u.a.createElement(Ap,{triggerCount:e.triggerCount,playing:o,effect:s,key:"input-edge- "+t+"-"+s.id,startDrawingEdge:c,edge:e,rack:n,setSelectedEdge:a,selected:r===e})})))};for(var f in n.effects)l(f);return u.a.createElement("g",null,s.map(function(e,t){return u.a.createElement(Ap,{key:"edge- "+t,effect:n.inputNode,startDrawingEdge:c,edge:e,rack:n,setSelectedEdge:a,selected:r===e})}),i)}),Fp=Object(m.b)(function(e,t){return{stepNumber:t.isMidiEffect?t.rack.sequencerEngine.trackStep:0,playing:t.rack.sequencerEngine.playing}},null)(Lp);function zp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Bp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Bp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var _p=function(e){var t=Object(i.useRef)([]);return Object(i.useEffect)(function(){e&&(t.current=[].concat(Object(d.a)(t.current),Object(d.a)(e)))},[e]),{getLastNode:function(e){var n=Object(d.a)(t.current);n.reverse();var a,r=zp(n);try{for(r.s();!(a=r.n()).done;){var c=a.value;if(e&&!e.includes(c))return c}}catch(o){r.e(o)}finally{r.f()}}}};function Hp(e){var t=e.lfoEdges,n=e.envelopeEdges,a=e.rack,r=e.setSelectedEdge,c=e.selectedEdge,o=e.width,s=[],i=function(e){var i=a.modulators[e],l="LFO"===i.getType()?t[i.number]:n[i.number];if(void 0===l)return"continue";var f={};l.forEach(function(e){return f[e.id]=e}),s=[].concat(Object(d.a)(s),Object(d.a)(Object.keys(f).map(function(e){return u.a.createElement(Ap,{key:i.getType()+"-"+i.number+"-edge-"+e,modulator:i,edge:f[e],setSelectedEdge:r,width:o,rack:a,selected:!!c&&(c.modulator===i&&c.edge===f[e])})})))};for(var l in a.modulators)i(l);return u.a.createElement("g",null,s)}function Up(e){var t=e.macroEdges,n=e.rack,a=e.setSelectedEdge,r=e.selectedEdge,c=[],o=function(e){var o=n.macros[e],s=t[o.id];if(void 0===s)return"continue";c=[].concat(Object(d.a)(c),Object(d.a)(s.map(function(e){return u.a.createElement(Ap,{rack:n,macro:o,edge:e,setSelectedEdge:a,selected:r===e})})))};for(var s in n.macros)o(s);return u.a.createElement("g",null,c)}var Gp=Object(i.memo)(function(e){var t=e.numberOfModulators,n=e.number,a=(e.startDrawing,e.rack),r=e.setDragging,c=e.connectEdge,o=e.startDrawingEdge,s=e.setSelectedNodes,l=e.drawingEdge,f=e.width,m=(e.height,e.modulator),p=e.selected,d=1*(n+1)/(t+1)*f,h=m.getType()===Sp.b?"LFO "+m.number:"Env "+m.number,b=Object(i.useCallback)(function(){s([m])},[s,m]);return u.a.createElement("g",null,u.a.createElement("rect",{onMouseDown:b,fill:p?"red":qc.c,x:d,y:0,width:35,height:qc.e}),u.a.createElement("text",{onMouseDown:b,className:"modulator-node",fill:"white",fontSize:10,fontFamily:"Arial",x:d+3,y:10},h),u.a.createElement(kp,{x:d,y:0,number:1,mode:qc.h,effect:m,setDragging:r,connectEdge:c,isModulator:!0,rack:a,drawingEdge:l,startDrawingEdge:o}))}),Wp=(n(2439),n(372));function Vp(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Xp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xp(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Xp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Kp=Object(i.memo)(function(e){var t=e.rack,n=e.effect,a=e.x,r=e.y,c=e.text,o=e.hasInput,s=e.hasOutput,l=(e.feedbackParam,e.setDragging),f=e.active,m=e.color,p=e.rackRef,d=e.connectEdge,h=e.startDrawingEdge,b=e.hideIOs,v=e.drawingEdge,g=e.selected,E=e.selectedEdge,O=e.setSelectedEdge,y=(e.edges,Object(Wp.a)({ref:p,effect:t}).preventDragging);c||(c=n.prettyName||n.name,n.getText&&n.getText()&&(c+=": "+n.getText()),o=!0,s=!0);var k=c?6*c.length:0;k<40&&(k=40);var j=s?[void 0]:[],C=o?[void 0]:[],S=Object(i.useCallback)(function(e){if(y(!1),l){var t=p.current.getBoundingClientRect();l({effect:n,x:e.clientX-t.left-a,y:e.clientY-t.top-r,origX:n.x,origY:n.y})}},[l,a,r]),w=g?"red":m||(t.getEffectType()===Tc.d?"#ff0076":qc.d);g||"Rules Rack"!==t.name&&"Chords Rack"!==t.name||(w="#515151");var P=[];if(!n)return[];n.feedback&&(P=u.a.createElement(Mp.a,{strokeWidth:2,className:"oscillator-edge",pointerLength:6,pointerWidth:8,stroke:window.baseColor,fill:window.baseColor,points:[a+8,r+qc.f[t.getEffectType()],a-8,r+qc.f[t.getEffectType()],a-8,r,a+8,r]}));var N=5,x=g?"selected node":"node";"Rules Rack"!==t.name&&"Chords Rack"!==t.name||(n.action?(N=6,x+=" action"):n.aux&&(x+=" aux"));var q=g?"selected node-text":"node-text";return n.getChordEffectType&&n.getChordEffectType()&&(x+=" chord-"+n.getChordEffectType(),q+=" chord-"+n.getChordEffectType()),u.a.createElement("g",null,u.a.createElement("rect",{className:x,onMouseDown:function(e){return S(e)},fill:w,opacity:void 0===n.enabledParameter?1:n.enabledParameter.get()?1:.2,rx:N,x:a,y:r,width:k,height:qc.f[t.getEffectType()]}),f?u.a.createElement("circle",{cx:a+k-5,cy:r+10,r:2,fill:"green",className:"active"}):"",u.a.createElement("text",{onMouseDown:function(e){return S(e)},className:q,fill:"white",fontSize:9,fontFamily:"Arial",x:a+3,y:t.getEffectType()===Tc.d?r+15:r+12},c),C.map(function(e,c){return u.a.createElement(kp,{x:a,y:r,key:"intput-"+c,number:c+1,mode:qc.b,hideIOs:b,parameter:e,effect:n,connectEdge:d,rack:t,drawingEdge:v,selectedEdge:E,startDrawingEdge:h})}),j.map(function(e,c){return u.a.createElement(kp,{key:"output-"+c,x:a,y:r,parameter:e,hideIOs:b,setSelectedEdge:O,selectedEdge:E,rack:t,drawingEdge:v,number:c+1,mode:qc.h,connectEdge:d,startDrawingEdge:h,effect:n})}),P)}),Qp=Object(m.b)(function(e,t){if(void 0!==t.x)return{};var n={};if(t.effect.getVisualizedParameters){var a,r=Vp(t.effect.getVisualizedParameters());try{for(r.s();!(a=r.n()).done;){var c=a.value;n[c.id]=c.get(!0)}}catch(o){r.e(o)}finally{r.f()}}return Object(B.a)({},n,{x:t.effect.x,active:t.effect.active,y:t.effect.y,value:t.effect.value,feedbackParam:t.effect.feedback,enabled:t.effect.enabledParameter&&t.effect.enabledParameter.get()})},null)(Kp),Yp=Object(i.memo)(function(e){var t=e.macro,n=e.x,a=e.y,r=e.rack,c=e.setDragging,o=e.connectEdge,s=e.startDrawingEdge,l=e.drawingEdge,f=e.selected,m=e.selectedEdge,p=e.setSelectedEdge,d=e.rackRef,h=(e.edges,t.name),b=8+6*h.length,v=Object(i.useCallback)(function(e){if(c){var r=d.current.getBoundingClientRect();c({effect:t,x:e.clientX-r.left-n,y:e.clientY-r.top-a})}},[c,n,a]),g=f?"red":"#0e2474b8";return u.a.createElement("g",null,u.a.createElement("rect",{className:f?"macro selected node":"macro",onMouseDown:function(e){return v(e)},fill:g,x:n,y:a,width:b,height:qc.e}),u.a.createElement("text",{className:f?"macro selected node-text":"macro-text",onMouseDown:function(e){return v(e)},fill:"white",fontSize:10,fontFamily:"Arial",x:n+3,y:a+10},h),[0].map(function(e,c){return u.a.createElement(kp,{key:"output-"+c,x:n,y:a,rack:r,parameter:e,setSelectedEdge:p,selectedEdge:m,drawingEdge:l,number:c+1,mode:qc.h,connectEdge:o,startDrawingEdge:s,effect:t})}))}),Jp=Object(m.b)(function(e,t){return{x:t.macro.x,y:t.macro.y}},null)(Yp),Zp=n(1319),$p=(n(1320),function(e){var t=e.macro,n=e.sequencerEngine,a=Object(i.useState)(t.name),r=Object(s.a)(a,2),c=r[0],o=r[1],l=t.subMacros,f=Object(i.useCallback)(function(e){t.name=e.target.value,o(t.name)},[o]);return u.a.createElement("div",{className:"macro-details"},u.a.createElement("input",{type:"text",className:"name-editor",value:c,onChange:f,placeholder:"Enter macro's name"}),u.a.createElement(Fa.a,{effectNumber:0,automation:void 0,name:t.name,selectedParameter:void 0,sequencerEngine:n,lfoEnabled:!0,parameter:t.macroParameter,isParameter:!0,onParameterChanged:function(){return[]},step:.01,max:1,min:0}),l.map(function(e){return u.a.createElement(Zp.a,{macro:t,subMacro:e})}))});function ed(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return td(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return td(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function td(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}window.rackColor="#0e24741f";var nd=Object(m.b)(function(e,t){var n;return n={loaded:t.effect.loaded,isSelected:e.effects.selectedEffect===t.effect.id,routingNumber:t.effect.currentConfiguration,algorithm:t.effect.algorithmParameter&&t.effect.algorithmParameter.get(),copiedNodes:e.effects.copiedNodesForRack,numEffects:t.effect&&t.effect.effects?t.effect.effects.length:0,effects:t.effect.effects,adjacencyLists:t.effect.adjacencyLists,selectedParameter:e.effects.accumulatorParameterSelected},Object(a.a)(n,"isSelected",e.effects.selectedEffect===t.effect.id),Object(a.a)(n,"pulledEffects",e.effects.pulledEffects),n},function(e,t){return{setNodePosition:function(n,a,r){return e(Object(f.Gb)(t.effect.id,n,a,r))},setCopiedNodes:function(t){return e(Object(f.ib)(t))},setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(function(e){var t=e.effect,n=Object(i.useRef)(void 0),a=e.routingNumber,r=e.macrosDisabled,c=Object(i.useState)(void 0),o=Object(s.a)(c,2),l=o[0],p=o[1],h=Object(i.useState)(void 0),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useState)(t.effects),O=Object(s.a)(E,2),y=O[0],k=O[1],j=Object(i.useState)(void 0),C=Object(s.a)(j,2),S=C[0],w=C[1],P=Object(i.useState)(t.adjacencyLists),N=Object(s.a)(P,2),x=N[0],q=N[1],T=Object(i.useState)(t.lfoAdjacencyLists),M=Object(s.a)(T,2),R=M[0],D=M[1],A=Object(i.useState)(t.envelopeAdjacencyLists),L=Object(s.a)(A,2),F=L[0],z=L[1],_=Object(i.useState)(t.macroAdjacencyLists),H=Object(s.a)(_,2),U=H[0],G=H[1],W=Object(i.useState)(t.modulators),V=Object(s.a)(W,2),X=V[0],K=V[1],Q=Object(i.useState)(t.macros),Y=Object(s.a)(Q,2),J=Y[0],Z=Y[1],$=Object(i.useState)(t.macros&&t.macros.length>0),ee=Object(s.a)($,2),te=ee[0],ne=ee[1],ae=Object(i.useState)(void 0),re=Object(s.a)(ae,2),ce=re[0],oe=re[1],se=Object(i.useState)([]),ie=Object(s.a)(se,2),ue=ie[0],le=ie[1],fe=_p(ue).getLastNode,me=e.copiedNodes,pe=e.setCopiedNodes,de=ue[0];void 0===e.isDraggable||e.isDraggable,Object(i.useEffect)(function(){q(t.adjacencyLists)},[t.adjacencyLists]);var he=t.getEffectType()===Tc.d?200:qc.i,be=t.getEffectType()===Tc.d?90:qc.a;Object(i.useEffect)(function(){e.selectedParameter&&e.selectedParameter.context&&(e.selectedParameter.context.effect===t&&le([e.selectedParameter.context.subDevice]),t.effects.includes(e.selectedParameter.isMapped)&&le([e.selectedParameter.isMapped]))},[e.selectedParameter,t,le]),Object(i.useEffect)(function(){k(t.effects)},[t.effects,k]);var ve=Object(i.useCallback)(function(n){console.log("rack.id = ",t.id);var a=100,r=be/3;de&&void 0===de.getType&&(a=de.x,r=de.y);var c=Object(Mc.a)(a,r,t),o=c.x,s=c.y;t.addEffect(n),n.x=o,n.y=s,e.setNodePosition(n.id,o,s),le([n]),k(Object(d.a)(t.effects)),setTimeout(function(){e.setContextualHelp(n)},25)},[k,le,de,t]);Object(i.useEffect)(function(){t.setSize(he,be,qc.g,qc.e),k(Object(d.a)(t.effects))},[k,t]),Object(i.useEffect)(function(){K(t.modulators),D(t.lfoAdjacencyLists),z(t.envelopeAdjacencyLists)},[t.loaded,K,D,z]),Object(i.useEffect)(function(){},[ue]),Object(i.useEffect)(function(){v&&(-1===ue.indexOf(v.effect)&&(le([v.effect]),e.setContextualHelp(v.effect)),oe(void 0))},[v,le,p,ue,oe]),Object(i.useEffect)(function(){e.setSelectedOscillator&&e.setSelectedOscillator(ue[0])},[ue]),Object(i.useEffect)(function(){return function(){pe([])}},[]);var ge=Object(i.useCallback)(function(e,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S;if(void 0!==a){if(n===qc.b){if(a.mode===qc.b)return;t.connectNodes(a.node,e,a.outputNumber)}else{if(a.mode===qc.h)return;t.connectNodes(e,a.node,a.outputNumber)}q(Object(B.a)({},t.adjacencyLists)),D(Object(B.a)({},t.lfoAdjacencyLists)),z(Object(B.a)({},t.envelopeAdjacencyLists)),G(Object(B.a)({},t.macroAdjacencyLists))}},[S,q,z,D,G]);Ic({rack:t,selectedEdge:l,selectedNodes:ue,selectedNode:de,setContextualHelp:e.setContextualHelp,setEdges:q,setEffects:k,sequencerEngine:e.sequencerEngine,isSelected:e.isSelected,connectEdge:ge,setCopiedNodes:pe,copiedNodes:me,setSelectedNodes:le,setLfoEdges:D,setEnvelopeEdges:z,getLastNode:fe,setMacros:Z,setMacroEdges:G}),Object(i.useEffect)(function(){de&&p(void 0)},[de,p]),Object(i.useEffect)(function(){l&&(e.setContextualHelp(void 0),le([]))},[l,le]);var Ee=function(e){var t=n.current.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},Oe=Object(i.useCallback)(function(t){t.stopPropagation(),e.isSelected;var n=Ee(t),a=n.x,r=n.y;oe({x1:a,y1:r,x2:a,y2:2})},[oe,e.isSelected,t]),ye=Object(i.useCallback)(function(t){if(v){var n=Ee(t),a=n.x-v.x,r=n.y-v.y,c=v.effect;c.x=a,c.y=r,e.setNodePosition(c.id,a,r);var o,s=ed(ue);try{for(s.s();!(o=s.n()).done;){var i=o.value;if(i!==c){void 0===i._x&&(i._x=i.x),void 0===i._y&&(i._y=i.y);var u=i._x+(a-v.origX),l=i._y+(r-v.origY);i.x=u,i.y=l,e.setNodePosition(i.id,u,l)}}}catch(p){s.e(p)}finally{s.f()}oe(void 0)}else{if(S){var f=Ee(t);return w(Object(B.a)({},S,{x2:f.x,y2:f.y})),void oe(void 0)}if(ce){var m=Ee(t);oe(Object(B.a)({},ce,{x2:m.x,y2:m.y}))}}},[v,y,ue,k,S,w,ce,oe]),ke=Object(i.useCallback)(function(n){if(g(void 0),w(void 0),ce){var a=ce.x1,r=ce.x2,c=ce.y1,o=ce.y2,s=t.effects.filter(function(e){var t=e.x,n=e.y;return t>=a&&t<=r&&n>=c&&n<=o});s.forEach(function(e){e._x=void 0,e._y=void 0}),e.setContextualHelp(s[0]),le(s),oe(void 0)}ue.forEach(function(e){e._x=void 0,e._y=void 0}),e.isSelected},[g,w,oe,ce,le,t,ue,e.isSelected]),je=Object(i.useCallback)(function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;w({node:e,mode:t,x1:n,y1:a,x2:n,y2:a,outputNumber:r}),p(void 0)},[w,p]),Ce="";if(l||t.getEffectType()!==Tc.d||(Ce=u.a.createElement(po,{color:e.color,oscillator:de,setSelectedNode:function(e){return le(e?[e]:[])},instrument:t,sequencerEngine:e.sequencerEngine})),de&&"Rules Rack"!==t.name&&"Chords Rack"!==t.name&&(t.isMacro(de)?Ce=u.a.createElement($p,{sequencerEngine:e.sequencerEngine,macro:de}):de.getType?Ce=de.getType()===Sp.b?u.a.createElement(vu,{hideSelection:!0,sequencerEngine:e.sequencerEngine,lfo:de.context.lfoTrack}):u.a.createElement(su,{hideSelection:!0,sequencerEngine:e.sequencerEngine,envelopeTrack:de.context.envelopeTrack}):de&&de.getEffectType&&(de.getEffectType()===Tc.c?Ce=u.a.createElement(Vd,{isPulled:e.pulledEffects.includes(de),hideBarButtons:!0,sequencerEngine:e.sequencerEngine,onDeleteEffect:function(){return[]},scrollContainer:e.scrollContainer,effect:de,track:e.track,send:e.send}):de.getEffectType()===Tc.a&&(Ce=u.a.createElement(bp,{isPulled:e.pulledEffects.includes(de),hideBarButtons:!0,sequencerEngine:e.sequencerEngine,onDeleteEffect:function(){return[]},noSelect:!0,hideIOs:e.hideIOs,scrollContainer:e.scrollContainer,effect:de,track:e.track,send:e.send})))),l)if(l.effect&&"Rules Rack"!==t.name&&"Chords Rack"!==t.name)Ce=u.a.createElement(gp,{rack:t,edge:l,sequencerEngine:e.sequencerEngine});else if(l.modulator){var Se=l.edge;Ce=u.a.createElement("div",{className:"edge-properties"},u.a.createElement("div",null,"Parameter Mod Properties: "),u.a.createElement(I.a,{parameters:[Se]}))}var we={setSelectedEdge:p,setSelectedNodes:le,selectedEdge:l,setDragging:g,rack:t,startDrawingEdge:je,drawingEdge:S,connectEdge:ge};return te?u.a.createElement(vp,{macros:J,setShowMacrosView:ne,sequencerEngine:e.sequencerEngine}):x&&y?u.a.createElement("div",{className:"effect-rack"},u.a.createElement(qp,{macrosDisabled:r,setEdges:q,selectedNodes:ue,rack:t,setMacros:Z,sequencerEngine:e.sequencerEngine,setShowMacrosView:ne,handleChooseEffect:ve}),u.a.createElement("div",{className:"horizontal"},u.a.createElement("div",{draggable:"true",onDragStart:function(e){return e.preventDefault()},onMouseLeave:function(){return Object(f.hb)(void 0)},className:"draw-component"},u.a.createElement("svg",{className:"rack-canvas",ref:n,width:he,height:be,onMouseDown:Oe,onMouseUp:ke,onMouseMove:ye},u.a.createElement(m.a,{store:e.sequencerEngine.store},u.a.createElement("g",null,!e.hideIOs&&t.getEffectType()!==Tc.d&&u.a.createElement(Hp,{width:he,envelopeEdges:F,lfoEdges:R,rack:t,setSelectedEdge:p,selectedEdge:l}),u.a.createElement(Up,{macroEdges:U,rack:t,setSelectedEdge:p,selectedEdge:l}),!e.hideIOs&&t.getEffectType()!==Tc.d&&"Rules Rack"!==t.name&&"Chords Rack"!==t.name&&X.map(function(e,n){return u.a.createElement(Gp,Object.assign({number:n,key:n},we,{width:he,rack:t,height:be,modulator:e,selected:de===e,numberOfModulators:X?X.length:0}))}),J.map(function(e,a){return u.a.createElement(Jp,Object.assign({rackRef:n,key:a,number:a},we,{width:qc.i,rack:t,height:qc.a,macro:e,selected:de===e,numberOfModulators:X?X.length:0}))}),u.a.createElement(Fp,{edges:x,rack:t,isMidiEffect:t.getEffectType()===Tc.c,startDrawingEdge:je,setSelectedEdge:p,selectedEdge:l}),y.filter(function(e){return ue.indexOf(e)>-1}).map(function(e,a){return u.a.createElement(Qp,Object.assign({},we,{rackRef:n,selected:!0,key:"node-"+e.id+"-"+a,rack:t,edges:x[e.id],effect:e}))})),u.a.createElement("g",null,y.filter(function(e){return-1===ue.indexOf(e)}).map(function(a,r){return u.a.createElement(Qp,Object.assign({},we,{rackRef:n,color:e.color,selected:!1,key:"node-"+a.id,rack:t,edges:x[a.id],effect:a}))})),u.a.createElement("g",null,u.a.createElement(Rp,{drawingEdge:S}),J.map(function(e){return u.a.createElement(Cp,{key:"macro-"+e.id,setSelectedEdge:p,selectedEdge:l,rack:t,setDragging:g,startDrawingEdge:je,drawingEdge:S,connectEdge:ge,edges:U[e.id],effect:e})}),y.filter(function(e){return de===e}).map(function(n,a){return u.a.createElement(Cp,{key:"node-"+n.id,setSelectedEdge:p,hideIOs:e.hideIOs,selectedEdge:l,rack:t,setDragging:g,startDrawingEdge:je,drawingEdge:S,connectEdge:ge,edges:x[n.id],effect:n})}),y.filter(function(e){return de!==e}).map(function(n,a){return u.a.createElement(Cp,{key:"node-"+n.id,setSelectedEdge:p,hideIOs:e.hideIOs,selectedEdge:l,rack:t,setDragging:g,startDrawingEdge:je,drawingEdge:S,connectEdge:ge,edges:x[n.id],effect:n})}),t.getEffectType()!==Tc.d&&"Rules Rack"!==t.name&&"Chords Rack"!==t.name?u.a.createElement(Qp,{hasOutput:!0,effect:t.inputNode,rackRef:n,rack:t,text:"Input",hideIOs:!0,x:0,startDrawingEdge:je,setSelectedEdge:p,selectedEdge:l,edges:x[-1],connectEdge:ge,y:be/2-qc.e/2}):[],t.outputNodeX?[u.a.createElement(Qp,{key:1,hasInput:!0,color:e.color,rackRef:n,text:"X",startDrawingEdge:je,setSelectedEdge:p,rack:t,selectedEdge:l,effect:t.outputNodeX,x:he-32,connectEdge:ge,y:10}),u.a.createElement(Qp,{key:2,hasInput:!0,text:"Y",color:e.color,rackRef:n,startDrawingEdge:je,setSelectedEdge:p,rack:t,selectedEdge:l,effect:t.outputNodeY,x:he-32,connectEdge:ge,y:45})]:"Rules Rack"!==t.name&&"Chords Rack"!==t.name&&u.a.createElement(Qp,{hasInput:!0,hideIOs:!0,text:"Output",rackRef:n,startDrawingEdge:je,key:3,setSelectedEdge:p,rack:t,selectedEdge:l,effect:t.outputNode,x:he-qc.g,connectEdge:ge,y:be/2-qc.e/2}),u.a.createElement(Ac,{mouseSelection:ce}))))),Ce),u.a.createElement(Tp,{routingNumber:a,rack:t})):[]});function ad(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var rd=function(e){Object(xe.a)(n,e);var t=ad(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={effect:e.effect},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.effect=e.effect,!0}},{key:"isEnabled",value:function(){return void 0!==this.props.automation||this.state.effect.isEnabled()}},{key:"render",value:function(){this.state.effect.compressorNode,this.state.effect.effectNode,void 0!==this.props.automation||this.state.effect.isEnabled();return u.a.createElement("div",null,this.isEnabled()?u.a.createElement("div",null,u.a.createElement(nd,{isDraggable:this.props.isDraggable,track:this.props.track,send:this.props.send,compact:this.props.compact,sequencerEngine:this.props.sequencerEngine,effect:this.state.effect})):"")}}]),n}(i.Component),cd=n(1321),od=n(1403),sd=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.note,a=Object(i.useState)(t.offsets[n]),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useCallback)(function(){c||o(t.newNoteOffset(n,0))},[c,o,n]);return c?u.a.createElement("div",{className:"offset-control"},u.a.createElement($.a,{stopPropagation:!1,width:120,parameter:c,root:1.00001})):u.a.createElement("div",{onClick:l,className:"offset-control"},u.a.createElement("div",{className:"hidden-text"},"Click to control offset"))}),id=Lc.a.fromTranspose,ud=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.note,n=e.effect,a=id(t),r=a.isBlackNote();return u.a.createElement("div",{className:"micro-tuning-note"},u.a.createElement("div",{className:r?"black micro-piano-note":"micro-piano-note"},t%12===0?a.toString():""),u.a.createElement(sd,{note:t,effect:n}))}),ld=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=Object(i.useState)(t.scriptParameter.get()),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useState)(!1),l=Object(s.a)(o,2),f=l[0],m=l[1],p=(Object(i.useCallback)(function(){t.scriptParameter.set(r)},[r]),Object(i.useCallback)(function(e){var n=e.target.value;t.executeScript(n)?(t.scriptParameter.set(n,!0,!1),m(!1)):m(!0),c(n)},[c,m]));return u.a.createElement("div",{className:f?"micro-tuning-function error":"micro-tuning-function"},u.a.createElement("input",{className:"micro-script-input",value:r,type:"text",onChange:p}))}),fd=(n(2440),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){for(var t=e.effect,n=Object(i.useState)(-32),a=Object(s.a)(n,2),r=a[0],c=(a[1],Object(i.useRef)(void 0)),o=Object(Wp.a)({ref:c,effect:t}).preventDragging,l=[],f=r;f<r+64;f++)l.push(f);return u.a.createElement("div",{onMouseDown:function(){return o(!1)},onMouseUp:function(){return o(!0)},ref:c,className:"micro-tuning"},u.a.createElement("div",{className:"notes-container"},l.map(function(e){return u.a.createElement(ud,{effect:t,note:e})})),u.a.createElement(ld,{effect:t}))})),md=Object(m.b)(function(e,t){return{step:t.sequencerEngine.trackStep}},function(e){return{}})(function(e){for(var t=e.effect.notes,n=Object.keys(t),a={},r=0,c=n;r<c.length;r++){var o=c[r];a[Lc.a.fromTranspose(parseFloat(o)).note]=parseFloat(parseFloat(o)+32)}return u.a.createElement("div",{className:"note-display"},Lc.a.NOTES.map(function(e){var t="note";return e.isBlackNote()&&(t+=" black"),a[e.note]&&(t+=" playing"),u.a.createElement("div",{style:{filter:"hue-rotate("+2*a[e.note]+"deg)"},className:t})}))}),pd=n(1084),dd=function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Je.a((new pd.a).contractAddress).from($e.h).select("ccNumber").select("parameterName").where("deviceName",t),e.next=3,n.executeQuery();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),hd=Object(m.b)(function(e,t){return{lastMidiCCPlayed:t.effect.id===e.effects.selectedEffect?e.midi.lastMidiCCPlayed:void 0,ccNumber:t.effect.midiCCNumberParameter.get()}},function(e){return{}})(function(e){var t=e.effect,n=e.sequencerEngine,a=e.effectNumber,r=e.lastMidiCCPlayed,c=Object(i.useState)(t.deviceName),o=Object(s.a)(c,2),l=o[0],f=o[1],m=Object(i.useState)([]),p=Object(s.a)(m,2),h=p[0],b=p[1],v=Object(i.useState)(""),g=Object(s.a)(v,2),E=g[0],O=g[1],y=Object.keys(t.midi.deviceToMidiCC).map(function(e){return{label:e,value:e}});Object(i.useEffect)(function(){l?dd(l.value||l).then(function(e){return b(e.map(function(e){var t=e.parameterName,n=e.ccNumber;return{label:t+" ("+n+")",value:n}}))}):b([])},[l,b]),Object(i.useEffect)(function(){f(t.deviceName)},[t,f]);var k=Object(i.useCallback)(function(e){t.deviceNameParameter.set(e.value),f(e)},[f]),j=Object(i.useCallback)(function(){r&&(t.midiCCNumberParameter.set(r.number),t.midiCCValueParameter.set(r.value))},[r]),C=Object(i.useCallback)(function(){var e=t.midiCCNumberParameter.get();!function(e,t,n){new Ye.a(tt.n,"newMidiCCParameter",[W.a.utils.fromAscii(e),t,W.a.utils.fromAscii(n)]).execute()}(t.deviceName,e,E),b([].concat(Object(d.a)(h),[{label:E+" ("+e+")",value:e}]))},[t,E,h,b]),S=Object(i.useCallback)(function(e){t.midiCCNumberParameter.set(e.value)},[]),w=h.find(function(e){return e.value===t.midiCCNumberParameter.get()});return u.a.createElement("div",{className:"midi-cc-effect"},u.a.createElement(D.a,{className:"delay-time-dropdown",options:y,onChange:k,value:l,placeholder:"Device"}),h.length>0?u.a.createElement(D.a,{className:"delay-time-dropdown",options:h,onChange:S,value:w,placeholder:"Choose Midi CC Param"}):"",u.a.createElement(Fa.a,{effectNumber:a,name:"CC Number",sequencerEngine:n,parameter:t.midiCCNumberParameter,lfoEnabled:!0,isParameter:!0,onParameterChanged:function(){return[]},step:1,max:119,min:0}),u.a.createElement(Fa.a,{effectNumber:a,name:"Value",sequencerEngine:n,parameter:t.midiCCValueParameter,isParameter:!0,onParameterChanged:function(){return[]},lfoEnabled:!0,step:1,max:128,min:0}),void 0===w&&null!==t.midiCCNumberParameter.get()&&void 0!==t.midiCCNumberParameter.get()?u.a.createElement("div",{className:"midi-cc-name-container"},u.a.createElement("input",{placeholder:"Type parameter name",value:E,type:"text",className:"midi-cc-name",onChange:function(e){return O(e.target.value)}}),u.a.createElement("div",{onClick:C,className:"label-button"},"Save")):"",r?u.a.createElement("div",{onClick:j,className:"midi-cc-info"},u.a.createElement("div",{className:"midi-cc-number"},"Midi CC: ",r.number),u.a.createElement("div",{className:"midi-cc-value"},"Value: ",r.value)):"")}),bd=n(2441),vd=[3,4,5,6,7,8,9,10,11,12],gd=Object(m.b)(function(e,t){return{scale:t.effect.scale}},function(e){return{}})(function(e){var t=e.effect,n=Object(i.useRef)(void 0),a=Object(i.useState)(t.scale),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(t.annotation||""),f=Object(s.a)(l,2),m=f[0],p=f[1];Object(i.useEffect)(function(){o(Object(d.a)(t.scale))},[t.scale,o]);var h=Object(i.useCallback)(function(e){var n=e.value,a=c;if(n<c.length)a=a.slice(0,n);else if(n>c.length)for(var r=c.length;r<n;r++)a.push("2/1");o(a),t.scale=a},[o,c,t]),b=Object(i.useCallback)(function(e){var n=e.target.value;p(n),t.annotation=n},[p,t]),v=Object(i.useCallback)(function(e,n){var a=Object(d.a)(c);a[n]=e.target.value,o(a),t.scale=a},[o,t,c]),g=Object(i.useCallback)(function(e){var n=Object(d.a)(t.subset);n[e]?n[e]=!1:n[e]=!0,t.subset=n,o(Object(d.a)(c))},[o,c,t]);return Object(bd.a)({ref:n,effect:t,setScale:o,setAnnotation:function(e){return b({target:{value:e}})}}),console.log("SCALE.length == ",c.length),u.a.createElement("div",{ref:n,className:"scale-component"},u.a.createElement("div",{className:"scale-data"},u.a.createElement(D.a,{onChange:h,value:{value:c.length,label:c.length},options:vd.map(function(e){return{label:e,value:e}})}),u.a.createElement(Fa.a,{parameter:t.referencePitchParameter,isParameter:!0,root:1,min:150,max:400,name:"Reference Pitch",units:"Hz"}),u.a.createElement("div",{className:"scale-notes"},c.map(function(e,n){return u.a.createElement("div",{className:"note-row"},u.a.createElement("div",{onClick:function(){return g(n)},className:t.subset[n]?"note on dot":"note off dot"}),u.a.createElement("input",{className:"scale-note",onChange:function(e){return v(e,n)},value:e}))}))),u.a.createElement(q.g,{type:"textarea",value:m,className:"comment-text",placeholder:"Write a comment here",onChange:b}))}),Ed=n(363),Od=Object(m.b)(function(e,t){return{steps:t.effect.stepsParameter.get()}},function(e){return{}})(function(e){var t=e.effect,n=e.steps;"number"===typeof n&&(n=Object(Ed.c)(n));var a=Object(i.useCallback)(function(e,a){var r=Object(d.a)(n);r[e]=!a,t.stepsParameter.set(Object(Ed.b)(r))},[t,n]);return u.a.createElement("div",{className:"gate-steps"},n.map(function(e,t){return u.a.createElement("div",{key:t,onClick:function(){return a(t,e)},className:e?"on gate-step":"gate-step"})}))}),yd=n(894),kd=n(893),jd=n(888),Cd=n(848),Sd=(n(2442),Object(m.b)(function(e,t){return{tidals:t.effect.tidals}},function(e){return{}})(function(e){var t=e.effect,n=e.track,a=e.sequencerEngine,r=Object(i.useState)(void 0),c=Object(s.a)(r,2),o=c[0],l=c[1];return u.a.createElement("div",{onClick:function(){return l(void 0)},className:"jaki"},u.a.createElement("div",null,u.a.createElement(yd.a,{setChosen:l,chosen:o,effect:t,track:n,sequencerEngine:a}),u.a.createElement(Cd.a,{setChosen:l,chosen:o,effect:t})),u.a.createElement("div",null,u.a.createElement(jd.a,{setChosen:l,chosen:o,effect:t}),t.tidals&&u.a.createElement(kd.a,{tidals:t.tidals})))})),wd=n(1224);function Pd(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Nd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nd(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Nd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var xd=[{label:"==",value:wd.a},{label:"<=",value:wd.c},{label:">=",value:wd.b}],qd=Object(m.b)(function(e,t){return{mode:t.effect.conditionalType,parameter:t.effect._parameters[0]}},function(e){return{}})(function(e){var t,n=e.mode,a=e.sequencerEngine,r=e.effect,c=e.isDraggable,o=Object(i.useState)(r._parameters),l=Object(s.a)(o,2),f=l[0],m=(l[1],1),p=0,d=Pd(f.slice(1));try{for(d.s();!(t=d.n()).done;){var h=t.value;h&&(h.min<p&&(p=h.min),h.max>m&&(m=h.max))}}catch(v){d.e(v)}finally{d.f()}var b=r._parameters[0];return u.a.createElement("div",{className:"control-parameters accumulator"},u.a.createElement("div",{className:"acc-column"},u.a.createElement(vn.a,{element:r.modeParameter,className:"synced-parameter"},u.a.createElement("span",null,"Condition: "),u.a.createElement(D.a,{placeholder:"C",options:xd,value:xd.find(function(e){return e.value===n}),onChange:function(e){return r.conditionalTypeParameter.set(e.value)}}),u.a.createElement(Fa.a,{name:"Cond. Value",parameter:r.conditionalValueParameter,isParameter:!0,sequencerEngine:a,lfoEnabled:!0,step:.001,min:b?b.min:0,max:b?b.max:1}),u.a.createElement(Fa.a,{name:"Then. Value",parameter:r.thenValueParameter,isParameter:!0,sequencerEngine:a,lfoEnabled:!0,step:.001,min:p,max:m}))),u.a.createElement(jr.a,{isDraggable:c,effect:r},u.a.createElement(Fa.a,{name:"Ramp Time",parameter:r.rampTimeParameter,isParameter:!0,sequencerEngine:a,lfoEnabled:!0,unit:"ms",step:1,min:1,max:3e3}),u.a.createElement(Cr.a,{name:"Reset on step 1",parameter:r.resetAtZeroParameter})))}),Td=n(385),Md=n(1238),Rd=n(791),Dd=(n(792),[{label:"1st",value:1},{label:"2nd",value:2},{label:"3rd",value:3},{label:"4th",value:4},{label:"5th",value:5},{label:"6th",value:6},{label:"7th",value:7},{label:"8th",value:8},{label:"9th",value:9},{label:"10th",value:10},{label:"11th",value:11},{label:"12th",value:12},{label:"13th",value:13}]),Id=[{label:"Alternate",value:"Alternate"},{label:"Split",value:"Split"}],Ad=[{label:"Thick",value:"Thick"},{label:"Flat",value:"Flat"},{label:"Octave",value:"Octave"}],Ld=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=Object(i.useState)(void 0),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useCallback)(function(e){var n=function(e,t){switch(t){case"Alternate":return new Rd.a(e);case"Split":return new Md.b(e)}}(t.track,e.value);m(n)},[t,c]),l=Object(i.useCallback)(function(e){var n,a,r=(n=t.track,a=e.value,new Td.f(n,a));m(r)},[t,c]),f=Object(i.useCallback)(function(e){var n=function(e,t){switch(t){case"Octave":return new Td.c(e);case"Flat":return new Md.a(e);case"Thick":return new Md.c(e)}}(t.track,e.value);m(n)},[t,c]),m=Object(i.useCallback)(function(e){t.chordProgression.addEffect(e),c(e)},[t,c]);return Object(i.useEffect)(function(){r&&c(null)},[c,r]),u.a.createElement("div",{className:"chord-effect-chooser"},u.a.createElement(D.a,{options:Dd,onChange:l,value:r,placeholder:"Voices"}),u.a.createElement(D.a,{options:Ad,onChange:f,value:r,placeholder:"Transforms"}),u.a.createElement(D.a,{options:Id,onChange:o,value:r,placeholder:"Flow"}))}),Fd=n(1237),zd=[{label:"Major",value:Fd.b},{label:"Minor",value:Fd.c},{label:"Harmonic Minor",value:Fd.a}],Bd=Object(m.b)(function(e,t){return{scale:t.effect.scale}},function(e){return{}})(function(e){var t=e.effect,n=e.scale,a=Object(i.useCallback)(function(e){t.scale=e.value},[t]);return u.a.createElement("div",{className:"scale-chooser"},u.a.createElement("div",{className:"scale-label"},"Scale: "),u.a.createElement(D.a,{className:"osc-type-dropdown float-left",controlClassName:"osc-type-control-dropdown",arrowClassName:"osc-type-arrow-dropdown",options:zd,onChange:a,value:zd.find(function(e){return e.value===n}),placeholder:"Rate"}))}),_d=(Object(m.b)(function(e,t){return{currentCycles:t.effect.tidals&&t.effect.tidals[0]&&t.effect.tidals[0].currentCycles}},function(e){return{}})(function(e){var t=e.effect,n=e.currentCycles,a=Object(i.useState)(void 0),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(void 0),f=Object(s.a)(l,2),m=f[0],p=f[1],d=[];for(var h in n)if(t.tidals[0]){var b=t.tidals[0].cycle.flat(16).map(function(e){return e.id});d.push(b.indexOf(h)%t.expressionSeries.length)}Object(i.useEffect)(function(){return window.addEventListener("keydown",v),function(){return window.removeEventListener("keydown",v)}},[m,o]);var v=Object(i.useCallback)(function(e){"Enter"===e.key&&(t.expressionSeries[c]=m,o(void 0))},[m,o,c]);return Object(i.useEffect)(function(){void 0!==c&&p(t.expressionSeries[c])},[c,p]),void 0!==c?u.a.createElement("div",{className:"expression-series"},u.a.createElement("input",{value:m,onChange:function(e){return p(e.target.value)},type:"text"})):u.a.createElement("div",{className:"expression-series"},t.expressionSeries.map(function(e,t){return u.a.createElement("div",{onClick:function(){return o(t)},className:d.includes(t)?"expression selected":"expression"},e,"th")}))}),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.chord,a=(e.setNoteSelected,t.getCurrentChordNotes());return u.a.createElement("div",{className:"current-chord-viewer"},"Current Chord: ",u.a.createElement("div",{className:"current-chord"},n.prettyName),a.map(function(e){return u.a.createElement("div",{className:"chord-note"},u.a.createElement("div",{className:"note-name"},Lc.a.fromTranspose(e).toString()),u.a.createElement("div",{className:"degree"},t.getNoteDegree(e)))}))})),Hd=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.position,n=e.effect,a=(e.chosen,e.currentChord,Object(i.useState)(void 0)),r=Object(s.a)(a,2),c=r[0],o=r[1],l=[],f=n.chordProgression,m=f.getStartingChord(),p=f.getChord(m);l.push(p);for(var d=0;d<n.progressionLength-1;d++)if(void 0!==m){var h=f.getNextChordEffect(m,d);h&&(l.push(h),m=h.numeral)}Object(i.useEffect)(function(){t===c&&o(void 0)},[t,o,c]);var b=Object(i.useCallback)(function(e,t){n.position=t-1,n.position<0&&(n.position=n.progressionLength-1),n.currentChord=e.numeral,o(t)},[o,n]),v=Object(i.useCallback)(function(e){var n="chord-part";return void 0===c&&t===e&&(n+=" current"),c===e&&(n+=" selected"),n},[t,c]);return u.a.createElement("div",{className:"progression"},l.map(function(e,t){return u.a.createElement("div",{onClick:function(){return b(e,t)},className:v(t)},e.prettyName)}))}),Ud=(Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=Object(i.useState)(t.tidalString),a=Object(s.a)(n,2),r=a[0],c=a[1];Object(i.useEffect)(function(){return window.addEventListener("keydown",o),function(){return window.removeEventListener("keydown",o)}},[r,t]);var o=Object(i.useCallback)(function(e){"Enter"===e.key&&f()},[r,t]),l=Object(i.useCallback)(function(e){c(e.target.value)},[c]),f=Object(i.useCallback)(function(){t.tidalString=r},[r,t]);return u.a.createElement("div",{className:"tidal-string"},u.a.createElement("input",{value:r,onChange:l,type:"text",className:"tidal-input"}),u.a.createElement("div",{className:"Enter",onClick:f},"Enter"))}),function(e){var t=e.onClick,n=(e.currentChord,e.isSelected),a=e.possibleChord,r="possible-next";return n&&(r+=" selected"),u.a.createElement("div",{onClick:t,className:r},a.prettyName)}),Gd=Object(m.b)(function(e,t){return{position:t.effect.position,currentChord:t.effect.currentChord}},function(e){return{}})(function(e){var t=e.effect,n=e.position,a=e.currentChord,r=t.chordProgression,c=t.getPossibleNextChords().map(function(e){return r.getChord(e)}),o=r.getChord(a),l=Object(i.useState)(r.getNextChordEffect(a,n)),f=Object(s.a)(l,2),m=f[0],p=f[1];Object(i.useEffect)(function(){var e=r.getNextChordEffect(a,n);p(e)},[a,n,c,p]);var d=Object(i.useCallback)(function(e){o.nextChords[n]=e,p(e)},[o,n,p]);return u.a.createElement("div",{draggable:"true",onDragStart:function(e){return e.preventDefault()},className:"chord-chooser"},u.a.createElement(Hd,{position:n,effect:t,currentChord:a,chosen:m}),u.a.createElement(_d,{effect:t,chord:o}),u.a.createElement("div",{className:"possibilities"},u.a.createElement("div",{className:"possibility-label"},"Next Chord: "),c.map(function(e){return u.a.createElement(Ud,{isSelected:m===e,onClick:function(){return d(e)},currentChord:o,possibleChord:e})})),u.a.createElement(Fa.a,{parameter:t.progressionLengthParameter,min:1,max:16,step:1,name:"Length",isParameter:!0,lfoEnabled:!0,sequencerEngine:t.track.sequencerEngine}),u.a.createElement(Fa.a,{parameter:t.chordProgression.progressionStartParameter,min:1,max:7,step:1,name:"Start",isParameter:!0,lfoEnabled:!0,sequencerEngine:t.track.sequencerEngine}))}),Wd=(n(2443),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=t.track,a=t.chordProgression;return u.a.createElement("div",{className:"generative-chords"},u.a.createElement("div",null,u.a.createElement(Bd,{effect:t}),u.a.createElement(nd,{effect:a,track:n,sequencerEngine:n.sequencerEngine}),u.a.createElement(Ld,{effect:t})),u.a.createElement(Gd,{effect:t}))})),Vd=Object(i.memo)(function(e){var t=Object(i.useState)(!1),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useRef)(void 0),o=Object(i.useCallback)(function(){return"Arpeggiator"===e.effect.name?u.a.createElement(kr,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Max Parameter"===e.effect.name?u.a.createElement(or.a,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Parameterizer"===e.effect.name?u.a.createElement(Ur.a,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Accumulator"===e.effect.name?u.a.createElement(Mr,{isDraggable:e.isDraggable,effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Control Parameters"===e.effect.name?u.a.createElement(Dr,{isDraggable:e.isDraggable,effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Conditional Parameters"===e.effect.name?u.a.createElement(qd,{isDraggable:e.isDraggable,effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Plane Parameters"===e.effect.name?u.a.createElement(Hr,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Every"===e.effect.name?u.a.createElement(kc,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Timing"===e.effect.name?u.a.createElement(Xr,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi Outputter"===e.effect.name?u.a.createElement(rc,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi Interface"===e.effect.name?u.a.createElement(ic,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Harmony"===e.effect.name?u.a.createElement(fc,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Alternate Tuning"===e.effect.name?u.a.createElement(hc,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Micro Tuning"===e.effect.name?u.a.createElement(fd,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Warp"===e.effect.name?u.a.createElement($r,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Flush"===e.effect.name?u.a.createElement(sr.a,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Message"===e.effect.name?u.a.createElement(ir.a,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi Delay"===e.effect.name?u.a.createElement(gc,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Chord Rhythm"===e.effect.name?u.a.createElement(Sc,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Chord Sculptor"===e.effect.name?u.a.createElement(Nc,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Tidal"===e.effect.name?u.a.createElement(ec.a,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Linked Tidal"===e.effect.name?u.a.createElement(tc,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Scale"===e.effect.name?u.a.createElement(gd,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi Effect Rack"===e.effect.name?u.a.createElement(rd,{isDraggable:e.isDraggable,effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Limit"===e.effect.name?u.a.createElement(Yr,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi Gate"===e.effect.name?u.a.createElement(Od,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"User Script"===e.effect.name?u.a.createElement(Aa.a,{isDraggable:e.isDraggable,setExpanded:r,expanded:a,effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,doc:ur.a,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Midi CC"===e.effect.name?u.a.createElement(hd,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Note Display"===e.effect.name?u.a.createElement(md,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Jaki"===e.effect.name?u.a.createElement(Sd,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Generative Chords"===e.effect.name?u.a.createElement(Wd,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):"Stats"===e.effect.name?u.a.createElement(cd.a,Object.assign({effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect},e)):e.effect.isScript?u.a.createElement(od.a,{effectNumber:e.effectNumber,sequencerEngine:e.sequencerEngine,automation:e.automation,selectedParameter:e.selectedParameter,onEffectsChange:e.onEffectsChange,onParameterChanged:e.onParameterChanged,effect:e.effect}):[]},[a,r,e.effect]);return u.a.createElement(vn.a,{refObj:c,className:"midi-effect-container",element:e.effect},u.a.createElement(lr.a,Object.assign({},e,{onDeleteEffect:e.onDeleteEffect,isMidiEffect:!0,effectNumber:e.effectNumber,onToggle:function(){return[]},track:e.track,effect:e.effect,automation:e.automation}),o()))}),Xd=Object(m.b)(function(e,t){return{pulledEffects:e.effects.pulledEffects}},function(e){return{}})(function(e){var t=e.track,n=e.pulledEffects,a=Object(i.useState)(t.midiEffects.effects),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useCallback)(function(e){var n=Object(cr.c)(e,t);t.sequencerEngine.operationManager.dispatch(Object(dt.b)(n,t)),o(Object(d.a)(t.midiEffects.effects))},[o,c,t]),f=Object(i.useCallback)(function(){o(Object(d.a)(t.midiEffects.effects))},[c,o]);return u.a.createElement("div",{className:"effects-overview"},c.map(function(e){return u.a.createElement(Vd,{sequencerEngine:t.sequencerEngine,isPulled:n.includes(e),key:e.id,onDeleteEffect:f,effect:e,track:t,tracks:t.sequencerEngine.tracks,onEffectsChange:function(){return[]}})}),u.a.createElement("div",{className:"add-effect-type"},u.a.createElement(D.a,{className:"delay-time-dropdown",option:void 0,options:cr.e,onChange:function(e){return l(e.value)},placeholder:"MIDI FX"})))}),Kd=Object(m.b)(function(e,t){var n=t.pad.sequencerEngine.tracks[e.mix.selectedTrack];return{selectedTrack:e.mix.selectedTrack,loaded:n&&n.getSampler(0),tracks:t.pad.tracks}},function(e){return{}})(function(e){e.div,e._track,e.pad,e.selectedTrack}),Qd=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.track,n=Object(i.useRef)(void 0),a="";return t.getTrackType()===M.f?a=u.a.createElement(Kd,{div:n,pad:t,_track:t}):t.getTrackType()===M.b&&t.getInstrumentType()===jt.f&&(a=u.a.createElement(fl,{sequencerEngine:t.sequencerEngine,track:t,instrument:t.instrument})),u.a.createElement("div",{ref:n,className:"instrument-overview"},a)}),Yd=Object(m.b)(function(e,t){return{pulledEffects:e.effects.pulledEffects}},function(e){return{}})(function(e){var t=e.track,n=e.pulledEffects,a=Object(i.useState)(t.effects),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useCallback)(function(e){var n=Object(cr.b)(e,t.sequencerEngine);n.enable(!0),t.sequencerEngine.operationManager.dispatch(Object(dt.b)(n,t)),o(Object(d.a)(t.effects))},[o,c,t]),f=Object(i.useCallback)(function(){o(Object(d.a)(t.effects))},[c,o]);return u.a.createElement("div",{className:"effects-overview"},c.map(function(e){return u.a.createElement(bp,{sequencerEngine:t.sequencerEngine,isPulled:n.includes(e),key:e.id,onDeleteEffect:f,effect:e,track:t,tracks:t.sequencerEngine.tracks,onEffectsChange:function(){return[]}})}),u.a.createElement("div",{className:"add-effect-type"},u.a.createElement(D.a,{className:"delay-time-dropdown",option:void 0,options:cr.a,onChange:function(e){return l(e.value)},placeholder:"Audio FX"})))}),Jd=n(756),Zd=Object(m.b)(function(e,t){var n=t.track;n&&n.tracks&&n.tracks[0]&&(n=n.tracks[0].track);var a=e.mix.selectedTrack===t.track.trackNumber&&t.track.sequencerEngine.currentSubSequence===t.track.subSequence,r=(e.tracks.trackIsEnabled[t.track.subSequence.id]||{})[t.track.id];return{isSelected:a,id:void 0===n?0:void 0!==n.sample&&void 0!==n.sample.getId()?n.sample.getId():n.presetName||n.getName(),isEnabled:r,numEffects:n.effects.length}},function(e){return{setTrackDragging:function(t){return e(Object(f.uf)(t))}}})(function(e){var t=e.track,n=e.isSelected,a=e.isEnabled,r=e.setTrackDragging,c=e.setExpandTrack,o=e.numEffects,l=Object(Jd.a)(t,t.sample),f=Object(i.useState)(void 0),m=Object(s.a)(f,2),p=m[0],d=m[1],h="tr-overview";n&&(h+=" selected"),Object(i.useEffect)(function(){c(p?{id:t.id,numEffects:o}:void 0)},[o,p,c,t]);var b=Object(i.useCallback)(function(){t.sequencerEngine.selectTrack(t.trackNumber)},[t]);return u.a.createElement("div",{onClick:b,className:h},u.a.createElement("div",{className:"tr-inner"},u.a.createElement("div",{className:"track-number"},t.trackNumber+1),u.a.createElement("div",{onClick:function(){return t.toggleEnabled()},className:a?"dot enabled":"dot"}),u.a.createElement("div",{onClick:function(){return d("M_FX"===p?void 0:"M_FX")},className:"M_FX"===p?"m-fx showing":"m-fx"},"m. fx"),u.a.createElement("img",{className:"right-arr",src:"/right-arrow.svg"}),u.a.createElement("div",{draggable:!0,onMouseDown:function(e){return e.stopPropagation()},onDragStart:function(e){e.stopPropagation(),r(t)},onDragOver:function(e){return e.preventDefault()},onClick:function(){return d("INST"===p?void 0:"INST")},style:{backgroundColor:t.color},className:"INST"===p?"inst showing":"inst"},l),u.a.createElement("img",{className:"right-arr",src:"/right-arrow.svg"}),u.a.createElement("div",{onClick:function(){return d("A_FX"===p?void 0:"A_FX")},className:"A_FX"===p?"a-fx showing":"a-fx"},"fx")),"INST"===p&&u.a.createElement(Qd,{track:t}),"A_FX"===p&&u.a.createElement(Yd,{track:t}),"M_FX"===p&&u.a.createElement(Xd,{track:t}))}),$d=n(333),eh=(n(2444),Object(m.b)(function(e,t){return{coords:e.windows.windowPositions[t.subSequence.id],numTracks:t.subSequence.tracks&&t.subSequence.tracks.length}},function(e){return{}})(function(e){var t=e.setOrdering,n=e.ordering,a=e.scale,r=e.subSequence,c=e.scrollContainer,o=e.elements,l=e.sizeRef,f=e.size,m=e.setSize,p=(e.isCurrent,e.padsExpand,e.coords),d=(e.isSelected,Object(i.useRef)(void 0)),h=Object(i.useState)(void 0),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object($d.a)({scale:a,ref:d,sequencerEngine:r.sequencerEngine,windowPosition:p,sizeRef:l,expand:v?r.tracks.length+v.id+v.numEffects:r.tracks.length,containerRef:c,size:f,setSize:m,elements:o,element:r,setOrdering:t,ordering:n}),O=E.style,y=(E.onContextMenu,E.onMouseDown),k=E.onMouseUp;E.setCoords;Object(i.useEffect)(function(){p&&(r.x=p.x,r.y=p.y)},[p]);var j=Object(B.a)({},O);return p&&(j=Object(B.a)({},O,{top:p.y,left:p.x})),u.a.createElement("div",{style:j,className:"module-overview",onMouseDown:y,onMouseUp:k,ref:d},r.tracks.map(function(e){return u.a.createElement(Zd,{setExpandTrack:g,track:e})}))}),n(1395)),th=(n(505),new h.a),nh=n(612),ah=Object(m.b)(function(e,t){return{drawingEdge:e.pads.drawingEdges[t.pad.subSequence.id]}},function(e){return{setDrawingPadEdge:function(t,n){return e(Object(f.wb)(t,n))}}})(function(e){var t=e.setDrawingPadEdge,n=e.isSpeaker,a=e.drawingEdge,r=e.fx,c=e.pad,o=e.id,s="effect-input-"+(void 0===o?r.id:o),l=Object(i.useCallback)(function(e){if(a){var o=a.effect,s=a.rack,i=a.outputNumber;(s=s||c.effectRack).connectNodes(o,n?void 0:r,i),t(c.subSequence.id,void 0)}},[a]);return u.a.createElement("div",{onMouseUp:l,id:s,className:"effect-input"})}),rh=Object(m.b)(function(e,t){return{}},function(e){return{setDrawingPadEdge:function(t,n){return e(Object(f.wb)(t,n))}}})(function(e){var t=e.isControl,n=e.containerRef,a=e.pad,r=e.setDrawingPadEdge,c=e.fx,o=e.rack,s=e.id,l=void 0===s?c.id:s,f=e.coords,m=e.nodeRef,p=e.outputNumber,d="effect-output-"+l;void 0!==p&&(d="effect-output-"+p+"-"+l);var h=Object(i.useRef)(void 0),b=Object($i.a)({ref:h}),v=b.onContextMenu,g=b.dropdownPos,E=b.setDropdownPos,O=Object(i.useRef)({x:0,y:0});Object(i.useEffect)(function(){if(f&&m&&m.current){var e=f.x,t=f.y;e+=m.current.offsetWidth+20,O.current.x=e,O.current.y=t}},[f]);var y=Object(i.useCallback)(function(e){n.current.getBoundingClientRect();var s=e.clientX,i=e.clientY,u=(a.state.spatial.edgesPadding,{effect:t?c.inputNode:c,outputNumber:p,rack:o,x1:s,y1:i,x2:s,y2:i});e.stopPropagation(),r(a.subSequence.id,u)},[]),k=c.getEffectType&&c.getEffectType()===Tc.c,j={};return c.numberOfOutputs>1&&(j.top=30+20*p+"%"),u.a.createElement("div",{ref:h,style:j,onContextMenu:v,id:d,onMouseDown:y,className:"effect-output"},!t&&u.a.createElement(nh.a,{isMidi:k,setDropdownPos:E,outputNumber:p,dropdownPosRef:O,effectOptions:k?cr.e:Object(cr.a)(),initializeEffect:k?cr.c:cr.b,dropdownPos:g,effect:c,node:a}))}),ch=Object(m.b)(function(e,t){return t.pad.effectRack?{coords:e.windows.windowPositions[t.pad.effectRack.outputNode.id],isSelected:e.windows.selectedElements[t.pad.effectRack.outputNode.id]}:{}},function(e){return{}})(function(e){var t=e.isMidi,n=e.pad,a=e.isSelected,r=e.coords,c=Object(da.a)(e,["isMidi","pad","isSelected","coords"]),o=Object(i.useRef)(void 0),s=Object($i.a)({ref:o}),l=s.onContextMenu,f=s.dropdownPos,m=s.setDropdownPos,p=Object(i.useRef)({x:0,y:0}),d=Object($d.a)(Object(B.a)({ref:o,element:n.effectRack&&n.effectRack.outputNode,windowPosition:r,sequencerEngine:n.sequencerEngine},c)),h=d.style,b=(d.isDragging,d.onMouseDown),v=d.onMouseUp,g=(d.setCoords,function(e){var t=e.id;return{backgroundColor:th.getColorForHash(t)}}({id:n&&n.effectRack&&n.effectRack.id}));Object(i.useEffect)(function(){r&&(p.current={x:r.x+150,y:r.y+150})},[r]);var E="pad-effect-control speakers";a&&(E+=" selected");var O=Object(B.a)({},h,g);return t&&(delete O.backgroundColor,E+=" midi-speakers"),r&&(O.left=r.x,O.top=r.y),n&&n.effectRack?[u.a.createElement("div",{key:1,onContextMenu:function(e){l(e),d.onContextMenu(e)},onMouseDown:b,onMouseUp:v,ref:o,style:O,className:E},t?u.a.createElement("div",{className:"speaker-name"},"Out"):u.a.createElement("img",{draggable:!1,src:"/speakers.svg"}),t?"":u.a.createElement(nh.a,{effectOptions:cr.a,initializeEffect:cr.b,dropdownPosRef:p,dropdownPos:f,setDropdownPos:m,node:n}),u.a.createElement(ah,{isSpeaker:!0,id:n.effectRack.id+"-speakers",containerRef:c.containerRef,pad:n,fx:n.effectRack.outputNode}))]:""}),oh=(n(902),new h.a),sh=Object(m.b)(function(e,t){return{coords:e.windows.windowPositions[t.pad.effectRack.id],isCollapsed:e.effects.effectCollapsed[t.pad.effectRack.id],isSelected:e.windows.selectedElements[t.pad.effectRack.id],isMacroMapping:e.effects.isMacroMapping,hidden:e.spatial.hiddenObjects[t.pad.id]}},function(e,t){return{setParameterToMap:function(t){return e(Object(f.md)(t))},setIsCollapsed:function(n){return e(Object(f.Cb)(t.pad.effectRack.id,n))}}})(function(e){var t=e.pad,n=e.setIsCollapsed,a=e.isCollapsed,r=e.coords,c=e.isSelected,o=Object(da.a)(e,["pad","setIsCollapsed","isCollapsed","coords","isSelected"]),s=Object(i.useRef)(void 0),l=Object(i.useRef)(void 0),f=t.fxMacro.macroParameter;Object(i.useEffect)(function(){n(t.effectRack.isCollapsed)},[]),Object(i.useEffect)(function(){t.effectRack.isCollapsed=a},[a]);var m=Object($i.a)({ref:s}),p=m.onContextMenu,d=m.dropdownPos,h=m.setDropdownPos,b=Object(i.useRef)({x:0,y:0}),v=Object($d.a)(Object(B.a)({ref:s,element:t.effectRack,windowPosition:r,sequencerEngine:t.sequencerEngine},o)),g=v.style,E=(v.isDragging,v.onMouseDown),O=v.onMouseUp;v.setCoords;Object(i.useEffect)(function(){r&&(b.current={x:r.x+100,y:r.y+50})},[r]);var y=Object(i.useCallback)(function(e){e.stopPropagation(),o.isMacroMapping&&(f.isMapped||o.setParameterToMap(f));var r=(new Date).getTime();e.stopPropagation(),r-l.current<=450&&(t.effectRack.isCollapsed=!a,n(!a)),l.current=r},[o.isMacroMapping,n,a]),k="pad-effect-control";a||(k+=" expanded"),c&&(k+=" selected");var j=Object(B.a)({},g,{backgroundColor:oh.getColorForHash(t.effectRack.id)});return r&&(j.left=r.x,j.top=r.y),o.isMacroMapping&&(k+=" plane-mapping"),o.hidden?"":[u.a.createElement("div",{onClick:y,key:1,onContextMenu:function(e){p(e),v.onContextMenu(e)},onMouseDown:E,onMouseUp:O,ref:s,style:j,className:k},u.a.createElement("div",{className:"control-inner"},u.a.createElement($.a,{color:"white",name:"",parameter:t.fxMacro.macroParameter}),u.a.createElement(nh.a,{allowSendsOnly:!0,effectOptions:cr.a,initializeEffect:cr.b,addToBack:!1,dropdownPosRef:b,setDropdownPos:h,dropdownPos:d,node:t}),u.a.createElement(ah,{containerRef:o.containerRef,pad:t,fx:t.effectRack}),!a&&u.a.createElement(rh,{outputNumber:0,isControl:!0,containerRef:o.containerRef,pad:t,fx:t.effectRack}),u.a.createElement("div",{className:"control-name"},"FX")))]}),ih=n(500),uh=n(501),lh=new h.a,fh=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.onDeleteEffect,n=e.sequencerEngine,a=e.instrumentPart,r=Object(i.useState)(void 0),c=Object(s.a)(r,2),o=c[0],l=c[1],f=Object(i.useState)(void 0),m=Object(s.a)(f,2),p=m[0],d=m[1],h=a.effect,b=a.instrument,v=a.track,g=a.type,E=a.subType,O="",y=u.a.createElement("div",{className:"pulled-header"},b&&g===Ua.d&&u.a.createElement("div",{className:"lfo-name"},"LFO ",b.number),b&&"MODULE_ENVELOPE"===g&&u.a.createElement("div",{className:"lfo-name"},"Envelope ",b.number),v&&u.a.createElement("div",{style:{backgroundColor:lh.getColorForTrack(v)},className:"effect-from"},v.envelopesTrack?v.name:v.trackNumber+1+". "+v.getName()),u.a.createElement("div",{onClick:t,className:"delete-button"},"-")),k=lh.getColorForTrack(v);if(g===Ua.e)O=u.a.createElement(wu,{isDraggable:!1,setOscillatorDetails:l,oscillatorDetails:o,showWaveform:p,setShowWaveform:d,color:k,sequencerEngine:n,instrument:b});else if("SYNTH_ENVELOPE"===g){var j;"Amp"===E?j=b.ampEnvelope:"A"===E?j=b.oscillatorNodes[1].ampEnvelope:"B1"===E?j=b.oscillatorNodes[2].ampEnvelope:"B2"===E&&(j=b.oscillatorNodes[3].ampEnvelope),console.log("subtype = ",E),O=u.a.createElement(mi.a,{instrument:b,width:200,fillColor:k,lineColor:k,sequencerEngine:n,envelope:j,name:E,hasRelease:!0,hasLevel:!1})}else"MODULE_ENVELOPE"===g?O=u.a.createElement(mi.a,{name:"Env "+E,envelope:b,width:200,hasRelease:!0,hasLevel:!1,sequencerEngine:n}):g===Ua.f?O=u.a.createElement(Ga,{effect:h}):g===Ua.c?O=u.a.createElement(jd.a,{isDraggable:!1,effect:h}):g===Ua.b?O=u.a.createElement(Cd.a,{isDraggable:!1,effect:h}):g===Ua.a?O=u.a.createElement(gu,{isDraggable:!1,color:k,sequencerEngine:n,instrument:b}):g===Ua.d&&(O=u.a.createElement(vu,{isDraggable:!1,hideName:!0,lfo:b,sequencerEngine:n}));return u.a.createElement("div",{className:"pulled-instrument"},y,O)}),mh=(n(1330),Object(m.b)(function(e,t){return{coords:e.windows.windowPositions[t.fx.id],isCollapsed:e.effects.effectCollapsed[t.fx.id],numberOfOutputs:t.fx.numberOfOutputs,isSelected:e.windows.selectedElements[t.fx.id]}},function(e){return{}})(function(e){var t=e.fx,n=e.scale,a=e.containerRef,r=e.sequencerEngine,c=e.setSize,o=e.elements,s=e.size,l=e.sizeRef,f=e.setOrdering,m=e.ordering,p=e.rack,d=e.coords,h=e.isSelected,b=e.onDelete,v=e.showDelete,g=e.isCollapsed,E=e.pad,O=e.isStatic,y=Object(i.useRef)(void 0),k=Object($d.a)({scale:n,ref:y,sequencerEngine:r,sizeRef:l,windowPosition:d,containerRef:a,size:s,setSize:c,elements:o,element:t,expand:g,setOrdering:f,ordering:m}),j=k.style,C=k.onContextMenu,S=k.isDragging,w=k.onMouseDown,P=k.onMouseUp,N=(k.setCoords,"pulled-effect");S&&(N+=" dragging"),h&&(N+=" selected");var x=Object(B.a)({},j);d&&(x.left=d.x,x.top=d.y);var q=t.numberOfOutputs||1,T=new Array(q).fill(0).map(function(e,t){return t});return[u.a.createElement("div",{key:1,style:x,onContextMenu:C,onMouseDown:O?function(){return[]}:w,onMouseUp:O?function(){return[]}:P,ref:y,className:N},t.instrument?u.a.createElement(fh,{onDeleteEffect:b,showStar:!0,sequencerEngine:r,instrumentPart:t}):t.getEffectType()===Tc.a?u.a.createElement(bp,{showDelete:v,isDraggable:!1,sequencerEngine:r,showStar:!0,featured:!0,track:t.track,compact:!0,instrument:!0,onDeleteEffect:b,effect:t,send:void 0}):t.getEffectType()===Tc.b?u.a.createElement(Ai.a,{featured:!0,isDraggable:!1,sequencerEngine:r,showStar:!0,onDeleteEffect:b,effect:t,track:t.track,onEffectsChange:function(){return[]}}):u.a.createElement(Vd,{showDelete:v,isDraggable:!1,featured:!0,sequencerEngine:r,track:t.track,showStar:!0,compact:!0,instrument:!0,onDeleteEffect:b,effect:t,send:void 0}),E&&u.a.createElement(ah,{containerRef:a,fx:t,pad:E}),E&&T.map(function(e){return u.a.createElement(rh,{nodeRef:y,rack:p,coords:d,outputNumber:e,containerRef:a,fx:t,pad:E})}),u.a.createElement(ih.a,{effect:t}),u.a.createElement(uh.a,{subSequence:t.track&&t.track.subSequence,containerRef:a,scale:n,effect:t}))]})),ph=Object(m.b)(function(e,t){var n=t.track.effectRack&&t.track.effectRack.id;return{effects:e.pads.trackMidiEffects[t.track.id],isCollapsed:e.effects.effectCollapsed[n]}},function(e){return{}})(function(e){var t=e.track,n=(e.effects,e.isCollapsed),a=Object(da.a)(e,["track","effects","isCollapsed"]),r=Object(i.useCallback)(function(e){t.effectRack.deleteEffect(e),t.updateMidiEffectsRedux()},[]);return t.effectRack&&t.zObject&&!n?[u.a.createElement(ch,Object.assign({isMidi:!0,key:5,pad:t},a)),,].concat(Object(d.a)(t.effectRack.effects.map(function(e){return u.a.createElement(mh,Object.assign({onDelete:r,key:e.id,fx:e,rack:t.effectRack,showDelete:!0,sequencerEngine:t.sequencerEngine,pad:t},a))}))):[]}),dh=function(e){var t="ztoolbar-option  ";return e.expanded&&(t+=" selected"),e.hideOnPadSequencer&&(t+=" hide-on-pad-sequencer"),u.a.createElement("div",Object.assign({},e,{className:t}),u.a.createElement("img",Object.assign({},e,{onClick:function(){return 0}})))},hh=function(e){e.subSequence;var t=e.type,n=e.drag;return u.a.createElement("div",{className:"modulator-expansion"},u.a.createElement("div",{className:"modulator-type"},"MODULE_ENVELOPE"===t?"Envelopes":"LFOs"),[1,2,3,4].map(function(e){return u.a.createElement("div",{draggable:!0,onDragStart:function(){return n(t+" "+e)},className:"modulator-number"},e)}))},bh=Object(m.b)(function(e,t){var n=t.subpatch||t.subSequence;return{uxLocked:e.zobject.uxLocked,showLFOs:e.sequencer.showLFOs,showEnvelopes:e.sequencer.showEnvelopes,showPadSequencer:e.spatial.showPadSequencer,presentationMode:n.presentationMode}},function(e){return{setShowEnvelopes:function(t){return e(Object(f.ze)(t))},setShowLFOs:function(t){return e(Object(f.Fe)(t))},setTypeDragging:function(t){return e(Object(f.xg)(t))},setUXLocked:function(t){return e(Object(f.Yf)(t))},setShowModulators:function(t){return e(Object(f.He)(t))},setPresentationMode:function(t){return e(Object(f.Cd)(t))}}})(function(e){e.setPresentationMode;var t=e.presentationMode,n=e.showPadSequencer,a=e.setShowEnvelopes,r=e.showLFOs,c=e.showEnvelopes,o=e.setShowLFOs,l=e.children,f=e.subpatch,m=e.subSequence,p=e.setTypeDragging,d=e.setUXLocked,h=(e.setShowModulators,e.uxLocked),b=Object(i.useState)(void 0),v=Object(s.a)(b,2),g=v[0],E=v[1],O=Object(i.useState)(void 0),y=Object(s.a)(O,2),k=y[0],j=y[1],C=Object(i.useRef)(0);Object(i.useEffect)(function(){return g?window.addEventListener("mouseup",S):window.removeEventListener("mouseup",S),function(){return window.removeEventListener("mouseup",S)}},[g,E]);var S=Object(i.useCallback)(function(){E(void 0)},[g,E]),w=Object(i.useCallback)(function(e){p(e),j(void 0),e.includes("LFO")||e.includes("MODULE_ENVELOPE")||E(void 0),C.current++},[E,j]),P=Object(i.useCallback)(function(e){var t=C.current;setTimeout(function(){t===C.current&&j(e)},250)},[j]),N=Object(i.useCallback)(function(){C.current++,j(void 0)},[]),x=Object(i.useCallback)(function(){d(!h)},[h]),q=Object(i.useCallback)(function(){var e=f||m;console.log("setting presentation mode = ",!e.presentationMode,e),e.presentationMode=!e.presentationMode},[f,m,t]),T="",M=0;if(k)switch(k){case"zobject":T="Drag an object into the canvas",M=0;break;case"zmessage":T="Drag a message box into the canvas",M=1;break;case"zcomment":T="Drag a comment box into the canvas",M=2;break;case"zbutton":T="Drag a button into the canvas",M=3;break;case"ztoggle":T="Drag a toggle into the canvas",M=5;break;case"znumber":T="Drag a number button into the canvas",M=6;break;case"zpad":T="Drag a drum pad into the canvas",M=5;break;case"sequencer":T="Drag a step sequencer into the canvas",M=7;break;case"zlock":T="Toggle the UI to lock in place or be editable",M=8}var R="zobject-toolbar";return n&&(R+=" showing-pad-sequencer"),u.a.createElement("div",{className:R},k&&u.a.createElement("div",{className:"toolbar-tooltip",style:{left:25*M}},T),u.a.createElement(dh,{onMouseOver:function(){return P("zobject")},onMouseLeave:N,hideOnPadSequencer:!0,draggable:"true",onDragStart:function(){return w("zobject")},src:"/zobject-light.svg"}),u.a.createElement(dh,{onMouseLeave:N,hideOnPadSequencer:!0,onMouseOver:function(){return P("zmessage")},draggable:"true",onDragStart:function(){return w("zmessage")},src:"/zmessage-light.svg"}),u.a.createElement(dh,{onMouseLeave:N,hideOnPadSequencer:!0,onMouseOver:function(){return P("zcomment")},draggable:"true",onDragStart:function(){return w("zcomment")},src:"/zcomment-light.svg"}),u.a.createElement(dh,{draggable:"true",hideOnPadSequencer:!0,onMouseLeave:N,onMouseOver:function(){return P("zbutton")},onDragStart:function(){return w("zbutton")},src:"/zbutton-light.svg"}),u.a.createElement(dh,{draggable:"true",onMouseLeave:N,hideOnPadSequencer:!0,onMouseOver:function(){return P("ztoggle")},onDragStart:function(){return w("ztoggle")},src:"/ztoggle-light.svg"}),u.a.createElement(dh,{draggable:"true",onMouseLeave:N,hideOnPadSequencer:!0,onMouseOver:function(){return P("znumber")},onDragStart:function(){return w("znumber")},src:"/znumber-light.svg"}),!f&&u.a.createElement(dh,{draggable:"true",onMouseLeave:N,hideOnPadSequencer:!0,onMouseOver:function(){return P("zpad")},onDragStart:function(){return w("zpad")},src:"/zpad-light.svg"}),!f&&u.a.createElement(dh,{className:r?"expanded":"",expanded:r,draggable:"false",onClick:function(){return o(!r)},src:"/zlfo-light.svg"}),!f&&u.a.createElement(dh,{draggable:"false",expanded:c,className:c?"expanded":"",onClick:function(){return a(!c)},src:"/zenvelope-light.svg"}),g&&u.a.createElement(hh,{drag:w,subSequence:m,type:g}),u.a.createElement(dh,{onClick:function(){console.log("CLICKED TOGGLE"),q()},expanded:t,onMouseOver:function(){return P("zlock")},hideOnPadSequencer:!0,onMouseLeave:N,className:"presentation-icon",src:"/presentation-mode.svg"}),u.a.createElement(dh,{onClick:x,onMouseOver:function(){return P("zlock")},hideOnPadSequencer:!0,onMouseLeave:N,expanded:h,src:h?"/zlock-closed.svg":"/zlock-open.svg"}),f&&l)}),vh=(n(1324),n(2445),Object(m.b)(function(e,t){return{collapsed:e.pads.modulesCollapsed[t.subSequence.id],isCurrent:t.subSequence===t.subSequence.sequencerEngine.currentSubSequence}},function(e,t){return{setCollapsed:function(n){return e(Object(f.Oc)(t.subSequence.id,n))},setModuleColor:function(n){return e(Object(f.Pc)(t.subSequence.id,n))}}})(function(e){var t=e.subSequence,n=e.collapsed,a=e.isCurrent,r=e.setCollapsed,c=e.setModuleColor,o=Object(i.useState)(t.color),l=Object(s.a)(o,2),f=(l[0],l[1]),m=Object(i.useState)(!1),p=Object(s.a)(m,2),d=(p[0],p[1],Object(i.useCallback)(function(e){t.color=e.hex,f(e.hex),c(e.hex)},[t,f]),"module-tab grids-name");a&&(d+=" selected");var h=Object(i.useCallback)(function(){t.sequencerEngine.switchToSubSequence(t.id)},[t]);return u.a.createElement("div",{onMouseDown:h,className:d},t.name,!n&&u.a.createElement(bh,{subSequence:t}),u.a.createElement("div",{onClick:function(){return r(!n)},className:"collapse-button"},u.a.createElement("div",{className:n?"arrow-left":"arrow-down"})))})),gh=n(282),Eh=n(1328),Oh=n(1327),yh=Object(m.b)(function(e,t){return{effects:e.pads.padEffects[t.pad.id],isCollapsed:e.effects.effectCollapsed[t.pad.effectRack.id]}},function(e){return{}})(function(e){var t=e.pad,n=e.effects,a=e.isCollapsed,r=Object(da.a)(e,["pad","effects","isCollapsed"]),c=Object(i.useCallback)(function(e){console.log("on delete fx =",e),t.effectRack.deleteEffect(e),t.updateEffectRedux()},[]);return t.effectRack&&n&&0!==n.length?a?[u.a.createElement(sh,Object.assign({key:0,pad:t},r))]:[u.a.createElement(sh,Object.assign({key:0,pad:t},r)),u.a.createElement(ch,Object.assign({key:5,pad:t},r)),,].concat(Object(d.a)(t.effectRack.effects.map(function(e){return u.a.createElement(mh,Object.assign({onDelete:c,key:e.id,rack:t.effectRack,fx:e,showDelete:!0,sequencerEngine:t.sequencerEngine,pad:t},r))}))):[]}),kh=n(1380),jh=n(503),Ch=n(366),Sh=n(635),wh=(Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.parameter,n=e.sequencerEngine,a=Object(i.useState)(t.get()),r=Object(s.a)(a,2),c=(r[0],r[1]),o=n.tracks.map(function(e){return e.pattern.stepGroups.map(function(t){return t.transformations.map(function(n,a){return{value:n.id,label:e.trackNumber+1+"."+t.name+".tr"+(a+1)}})}).reduce(function(e,t){return[].concat(Object(d.a)(e),Object(d.a)(t))},[])}).reduce(function(e,t){return[].concat(Object(d.a)(e),Object(d.a)(t))},[]),l=Object(i.useCallback)(function(e){t.set(e.value),c(e.value)},[c]);return u.a.createElement(D.a,{options:o,value:o.find(function(e){return e.value===t.get()}),onChange:l,placeholder:"Depends"})}),Object(m.b)(function(e,t){return{isMacroMapping:e.effects.isMacroMapping,val:t.parameter.get()}},function(e){return{setParameterToMap:function(t){return e(Object(f.md)(t))}}})(function(e){var t=e.val,n=e.placeholder,a=e.parameter,r=e.className,c=e.isMacroMapping,o=e.setParameterToMap,l=Object(i.useState)(""),f=Object(s.a)(l,2),m=f[0],p=f[1];Object(i.useEffect)(function(){p(t)},[t,p]);var d=Object(i.useCallback)(function(e){var t=e.target.value;if("."===t||"-."===t)t=0;else if("-"===t)t=0;else if(""===t)t=0;else{if(!Object(nn.a)(t))return;t=parseFloat(t)}a.set(t),p(t)},[p,a]);c&&(r+=" mapping");var h=Object(i.useCallback)(function(e){c&&(e.stopPropagation(),e.preventDefault(),a.isMapped||o(a))},[c,a]),b="parameter-"+a.id;return u.a.createElement("input",{id:b,onClick:h,className:r,value:m,onChange:d,placeholder:n})})),Ph=new h.a,Nh=(Object(m.b)(function(e,t){return{_whenType:t.transformation.whenType}},function(e){return{}})(function(e){var t=e.transformation,n=e.sequencerEngine,a=e.track,r=e._whenType,c=Object(i.useState)(t.whenType),o=Object(s.a)(c,2),l=o[0],f=o[1],m=Object(i.useState)(t.thenType),p=Object(s.a)(m,2),d=p[0],h=p[1],b=Object(i.useState)(t.thenValue),v=Object(s.a)(b,2),g=(v[0],v[1],{color:Ph.getColorForHash(t.id)});Object(i.useEffect)(function(){f(r)},[r,f]);var E=Object(i.useCallback)(function(e){var n=e.value;t.whenType=n,f(n)},[f,t]),O=Object(i.useCallback)(function(e){var n=e.value;t.thenType=n,n===Ch.n&&(t.midiEffect=new Sh.a(a)),h(n)},[h,t,a]),y=Object(Ch.r)(t.thenType),k=y.min,j=y.max,C=y.step;return u.a.createElement("div",{className:"step-transformation-editor"},u.a.createElement("div",{className:"transformation-header"},u.a.createElement("div",{style:g,className:"transformation-name"},t.name),u.a.createElement("div",{className:l?"transformation":"transformation none"},u.a.createElement(D.a,{options:Ch.q,value:Ch.q.find(function(e){return e.value===l}),onChange:E,placeholder:"When"}),l===Ch.g?u.a.createElement(wh,{className:"when-value",placeholder:"Value",parameter:t.auxValue}):u.a.createElement(wh,{className:"when-value",placeholder:"Value",parameter:t.whenValue}),u.a.createElement("div",{className:"unit-type"},l===Ch.k||l===Ch.g?"%":" loops"),u.a.createElement(D.a,{className:"action",options:Ch.o,value:Ch.o.find(function(e){return e.value===d}),onChange:O,placeholder:"Action"}))),Ch.i.includes(d)?u.a.createElement("div",{className:"transformation"},u.a.createElement(Fa.a,{root:1,min:k,max:j,step:C,parameter:t.thenValue,name:"Amount"})):"",d===Ch.n&&t.midiEffect?u.a.createElement(Vd,{effect:t.midiEffect,sequencerEngine:n,track:a}):"")}),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.transformation,n=(e.track,t.thenType),a=t.whenType,r=Ch.q.find(function(e){return e.value===a}),c=t.whenValue.get(),o=t.auxValue.get(),s=Ch.o.find(function(e){return e.value===n}),i=t.thenValue.get();return u.a.createElement("div",{className:"transformation-tooltip"},u.a.createElement("div",{className:"when-type"},r&&r.label),a===Ch.g?u.a.createElement("div",{className:"when-value"},o,"%"):u.a.createElement("div",{className:"when-value"},c," ",t.whenType===Ch.c?"loops":t.whenType===Ch.k?"%":""),u.a.createElement("div",{className:"arrow-right"}),u.a.createElement("div",{className:"then-type"},s&&s.label),u.a.createElement("div",{className:"then-value"},Ch.i.includes(n)?i:""))}));function xh(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return qh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qh(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function qh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Th=new h.a;window.groupOpacity=.5;var Mh=n(302),Rh=(new h.a,Object(m.b)(function(e,t){return{selectedPianoRollSteps:e.keyboard.selectedPianoRollSteps,numTransformations:t.group.transformations.length}},function(e){return{setSelectedPianoRollSteps:function(t){return e(Object(f.ge)(t))},setTransformationEdgeDragging:function(t){return e(Object(f.Tf)(t))},setStepsGroupMode:function(t){return e(Object(f.if)(t))}}})(function(e){var t=e.setTransformationEdgeDragging,n=e.trackSteps,a=e.group,r=e.track,c=e.setSelectedPianoRollSteps,o=e.selectedPianoRollSteps,l=e.setStepsGroupMode,f=(e.showEffects,e.container),m=e.scale,p=function(e){var t=e.container,n=e.group,a=e.track,r=e.trackSteps,c=e.scale,o=void 0===c?1:c;0===o&&(o=1);var u=Object(i.useState)(void 0),l=Object(s.a)(u,2),f=l[0],m=l[1],p=Object(i.useRef)(0);return Object(i.useEffect)(function(){if(t.current){var e=++p.current;setTimeout(function(){if(e===p.current){var a,r=[],c=xh(n.steps);try{for(c.s();!(a=c.n()).done;){var s=a.value,i=document.getElementById("stepdata-"+s.id);if(i){var u=i.getBoundingClientRect();r.push(u)}}}catch(E){c.e(E)}finally{c.f()}var l=Math.min.apply(Math,Object(d.a)(r.map(function(e){return e.left}))),f=Math.max.apply(Math,Object(d.a)(r.map(function(e){return e.left}))),h=Math.min.apply(Math,Object(d.a)(r.map(function(e){return e.top}))),b=Math.max.apply(Math,Object(d.a)(r.map(function(e){return e.top})));if(t.current){var v=t.current.getBoundingClientRect(),g={x:1/o*(l-v.left-4),y:1/o*(h-v.top+3),height:b-h+18,width:f-l+30};m(g)}}},75)}},[m,n,a,r]),{pos:f}}({container:f,group:a,track:r,trackSteps:n,scale:m}).pos,h=function(e){var t=e.pos,n=e.group,a=e.selectedPianoRollSteps,r={};t&&(r={left:t.x,top:t.y-5,height:t.height,width:t.width,backgroundColor:Th.transparent(Th.saturate(Th.getColorForHash(n.id),1.1),window.groupOpacity)}),void 0===r.left&&(r.height=0);var c=a&&a.some(function(e){return e.group===n}),o="steps-group";return c&&(o+=" selected"),{style:r,selected:c,className:o}}({group:a,pos:p,selectedPianoRollSteps:o}),b=h.style,v=h.className,g=h.selected,E=function(e){var t=e.setTransformationEdgeDragging,n=e.track;return{startDragging:Object(i.useCallback)(function(e){t({transformation:e})},[]),endDragging:Object(i.useCallback)(function(e){var a=n.sequencerEngine.state.groups.transformationEdgeDragging;if(a){var r=a.transformation;r!==e?(e.whenType=Ch.g,e.whenValue.set(r.id),n.updateSteps(),t(void 0)):t(void 0)}},[n])}}({track:r,setTransformationEdgeDragging:t}),O=E.startDragging,y=E.endDragging,k=function(){var e=Object(i.useState)(void 0),t=Object(s.a)(e,2),n=t[0],a=t[1],r=Object(i.useRef)(!1);return{showTooltip:n,onMouseOver:Object(i.useCallback)(function(e,t){r.current=t,setTimeout(function(){r.current===t&&a(t)},250)},[a]),onMouseLeave:Object(i.useCallback)(function(e,t){r.current=!1,a(void 0)},[a])}}(),j=k.showTooltip,C=(k.setShowTooltip,k.onMouseOver),S=k.onMouseLeave,w=Object(i.useCallback)(function(){c(g?[]:a.steps),l(!0)},[g]);return Object(i.useEffect)(function(){return function(){(r.isEffectsShowing()||r.isHidden())&&l(!1)}},[]),u.a.createElement("div",{id:"steps-group-"+a.id,onClick:w,style:b,className:v},isNaN(b.left)?"":u.a.createElement("span",{className:"group-name"},a.name.split(" ")[1]),isNaN(b.left)?"":u.a.createElement("div",{className:"transformations"},a.transformations.map(function(e){return u.a.createElement("div",{key:e.id,className:"transformation-wrapper",onMouseOver:function(t){return C(t,e)},onMouseLeave:S},u.a.createElement("div",{onMouseUp:function(){y(e),w()},onMouseDown:function(){return O(e)},id:"transformation-"+e.id,className:Object(Mh.h)(e)?"transforming transformation":"transformation"}),j===e?u.a.createElement(Nh,{track:r,transformation:e}):"")})))})),Dh=(n(2446),Object(m.b)(function(e,t){return{stepsGroupMode:e.groups.stepsGroupMode,trackSteps:e.tracks.trackSteps[t.track.trackNumber],stepGroups:e.steps.stepGroups}},function(e){return{}})(function(e){var t=e.trackSteps,n=e.track,a=e.stepsGroupMode,r=e.scale,c=void 0===r?1:r,o=Object(i.useRef)(void 0);if(!a)return[];var s=n.pattern.getAllGroups();return u.a.createElement("div",{ref:o,className:"track-step-groups"},s.map(function(e){return u.a.createElement(Rh,{scale:c,container:o,key:e.id,trackSteps:t,group:e,track:n})}))}));function Ih(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Ah=function(e){Object(xe.a)(n,e);var t=Ih(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"onPlayClicked",value:function(e){e.target.parentNode.blur(),e.target.blur(),e.currentTarget.blur(),this.props.play(),this.setState(this.state)}},{key:"render",value:function(){var e=this,t={};return this.props.color&&(t.backgroundColor=this.props.color),u.a.createElement("div",{style:t,onClick:function(t){return e.onPlayClicked(t)},className:"playpause playpause-user"},u.a.createElement("input",{checked:!this.props.isPlaying,type:"checkbox",value:!this.props.isPlaying,id:"playpause",name:"check"}),u.a.createElement("label",{htmlFor:"playpause playpause-user",tabIndex:1}))}}]),n}(i.Component),Lh=Object(m.b)(function(e,t){return{}},function(e){return{setFreezeDragging:function(t){return e(Object(f.Wb)(t))},setSampleDragging:function(t){return e(Object(f.Qd)(t))}}})(function(e){var t=e.sample,n=e.setFreezeDragging,a=e.setSampleDragging,r=Object(i.useRef)(void 0),c=Object(i.useState)(t.name),o=Object(s.a)(c,2),l=o[0],f=o[1],m=Object(i.useState)(!1),p=Object(s.a)(m,2),d=p[0],h=p[1],b=Object(i.useCallback)(function(){if(!d){var e=(new Date).getTime();r.current&&e-r.current<=200&&h(!0),r.current=e}},[d,h]),v=Object(i.useCallback)(function(e){"Enter"===e.key&&(t.name=l,h(!1))},[h,t,l]);return u.a.createElement("div",{draggable:!0,onDragStart:function(){console.log("drag start setting sample dragging=",t),a(t),n(t.ipfsHash)},onDragOver:function(e){return e.preventDefault()},onClick:b,className:"freeze-name"},d?u.a.createElement("input",{type:"text",value:l,onKeyDown:v,onChange:function(e){return f(e.target.value)},className:"freeze-name-edit"}):l)}),Fh=Object(m.b)(function(e,t){var n=t.track.sequencerEngine.getSequenceId(),a=(e.sequencer.currentStep[n],e.sequencer.currentGlobalStep[n]||0),r=e.tracks.frozenTracksPlaying[t.track.subSequence.id]||{},c=e.tracks.isResampling===t.track.trackNumber,o=t.column.playing===t.number,s=e.tracks.trackToFreeze&&e.tracks.trackToFreeze.trackNumber===t.track.trackNumber,i=(e.tracks.tracksFrozen[t.track.subSequence.id]||{})[t.track.id];return{oldPlaying:r[t.track.id],isSelected:e.freeze.selectedFreeze===t.sample.ipfsHash,isPlaying:o,currentGlobalStep:(o||s||c)&&a,isPreparingToFreeze:s,isResampling:c,frozenPatternPlaying:t.column.playing,isTrackFrozen:i}},function(e,t){return{setSelectedFreeze:function(t){return e(Object(f.Zd)(t))},setFreezeDragging:function(t){return e(Object(f.Wb)(t))},setPlaying:function(n){return e(Object(f.Xb)(t.track.subSequence.id,t.track.id,n))}}})(function(e){e.oldPlaying;var t=e.sample,n=(e.setSampleDragging,e.setFreezeDragging,e.isTrackFrozen),a=e.color,r=e.isSelected,c=e.track,o=e.isPlaying,s=e.setSelectedFreeze,l=e.currentGlobalStep,f=e.column,m=e.number,p=Object(i.useCallback)(function(){n?f.playing=o?void 0:m:f.saveAndPlayFrozen(m)},[o,n,m]),d="";if(o){for(var h=l%c.pattern.length()/c.pattern.length(),b=[],v=0;v<16;v++)h>1*v/16&&b.push(v);var g={backgroundColor:a};d=u.a.createElement("div",{className:"frozen-progress"},b.map(function(e,t){return u.a.createElement("div",{key:t,style:g,className:"progress-part"})}))}var E="frozen-container";return r&&(E+=" selected"),u.a.createElement("div",{onClick:function(){return s(t.ipfsHash)},style:{backgroundColor:a},className:E},u.a.createElement(Ah,{play:function(e){return p()},isPlaying:o}),d,u.a.createElement(Lh,{sample:t}))});n(2447);function zh(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Bh=function(e){Object(xe.a)(n,e);var t=zh(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"getProgress",value:function(e){var t=this.props.currentGlobalStep%this.props.track.length/this.props.track.length,n=[];if(this.props.isPreparingToFreeze||this.props.isResampling)for(var a=0;a<16;a++)t>1*a/16&&n.push(a);var r={backgroundColor:this.props.color};return u.a.createElement("div",{className:"frozen-progress"},n.map(function(e){return u.a.createElement("div",{style:r,className:"progress-part"})}))}},{key:"expandSample",value:function(){var e=Object(o.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"play",value:function(e,t){this.props.isTrackFrozen?(this.props.column.playing===t?this.props.setPlaying(!this.props.isPlaying):this.props.setPlaying(!0),this.props.column.playing=t):this.props.column.saveAndPlayFrozen(t)}},{key:"onDrop",value:function(e){e.stopPropagation(),this.props.freezeDragging&&this.props.track.dragFreezeIntoColumn(this.props.freezeDragging,this.props.column)}},{key:"render",value:function(){var e=this,t=this.props.column.frozenSamples;return u.a.createElement("div",{onDrop:function(t){return e.onDrop(t)},className:"frozen-containers"},t.map(function(t,n){return u.a.createElement(Fh,{key:t.id,column:e.props.column,frozenPatternPlaying:e.props.frozenPatternPlaying,number:n,color:e.props.color,track:e.props.track,sample:t})}),0===this.props.number&&(this.props.isPreparingToFreeze||this.props.isResampling)?u.a.createElement("div",{className:"frozen-container"},u.a.createElement("div",{className:"freezing-label"},"Freezing"),this.getProgress()):"")}}]),n}(i.Component),_h=Object(m.b)(function(e,t){var n=t.track.sequencerEngine.getSequenceId(),a=(e.sequencer.currentStep[n],e.sequencer.currentGlobalStep[n]||0),r=(e.tracks.frozenTracksPlaying[t.track.subSequence.id],e.tracks.isResampling===t.track.trackNumber),c=e.tracks.trackToFreeze&&e.tracks.trackToFreeze.trackNumber===t.track.trackNumber,o=(e.tracks.tracksFrozen[t.track.subSequence.id]||{})[t.track.id];return{currentGlobalStep:(c||r)&&a,isPreparingToFreeze:c,isResampling:r,frozenSamplePlaying:t.column.playing,showPlayButton:!0,isTrackFrozen:o,selectedFreeze:e.freeze.selectedFreeze,freezeDragging:e.freeze.freezeDragging,frozenSamples:e.freeze.freezeColumnSamples[t.track.id]&&e.freeze.freezeColumnSamples[t.track.id][t.column.number]}},function(e,t){return{setPlaying:function(n){return e(Object(f.Xb)(t.track.subSequence.id,t.track.id,n))}}})(Bh),Hh=Object(m.b)(function(e,t){return Object(B.a)({freezeDragging:e.freeze.freezeDragging},t.track.frozenColumns.map(function(e){return e.frozenSamplers.length}))},function(e){return{}})(function(e){var t=e.track,n=e.freezeDragging,a=Object(i.useCallback)(function(){t.dragFreezeIntoColumn(n)},[n]);return t.frozenColumns.every(function(e){return 0===e.frozenSamplers.length})?u.a.createElement("div",null):u.a.createElement("div",{onDrop:a,className:"frozen-drag-area"},u.a.createElement("div",{className:"text-drag"},"Drag Frozen Track Here"))}),Uh=Object(m.b)(function(e,t){return{isFrozen:t.track.isFrozen,numColumns:t.track.frozenColumns&&t.track.frozenColumns.length}},function(e){return{}})(function(e){var t=e.track,n=e.trackColor,a=(e.isTrackFrozen,e.isFrozen),r=t.sequencerEngine;t&&t.frozenColumns&&t.frozenColumns.some(function(e){return e.frozenSamplers.length>0});return u.a.createElement("div",{className:"frozen-columns-container"},t.frozenColumns.map(function(e,a){return u.a.createElement(_h,{key:a,number:a,column:e,color:n,sequencerEngine:r,track:t})}),u.a.createElement("div",null,u.a.createElement(Hh,{track:t}),u.a.createElement(He.a,{condition:a},u.a.createElement(vn.a,{element:bn.ib},u.a.createElement("div",{style:{backgroundColor:n},onClick:function(){t.unfreeze()},className:"expand-sample"},"Unfreeze")))))}),Gh=n(1389),Wh=n(251),Vh=Object(m.b)(function(e,t){return{resolution:e.sequencer.displayResolution,size:e.tracks.trackLengthChoice}},function(e){return{setSize:function(t){return e(Object(f.zf)(t))}}})(function(e){var t=e.resolution,n=(e.resizable,e.rowLength,e.color),a=e.track,r=e.row,c=e.setSize,o=e.size,s=Object(i.useRef)(void 0),l={backgroundColor:n,width:528};Object(i.useEffect)(function(){c(a.pattern.length(t))},[t]);var f=new Array(16).fill(0);return u.a.createElement("div",{ref:s,style:l,className:"track-length-bar"},f.map(function(e,t){return u.a.createElement("div",{onClick:function(){return c(16*r+t+1)},className:o===16*r+t+1?"length-option selected":o<16*r+t+1?"length-option disabled":"length-option"},16*r+t+1)}))}),Xh=n(105),Kh=n(198);function Qh(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Yh=function(e){Object(xe.a)(n,e);var t=Qh(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){var e=this.props.currentStep,t=(this.props.isMini?20:32)*e,n=(Math.floor(e/4),{width:t+(this.props.isMini?15:30)});return u.a.createElement("div",{className:"steps-row-bottom"},void 0!==e?u.a.createElement("div",{style:n,className:"current-step-box"},u.a.createElement("div",{className:"right-box"})):"")}}]),n}(i.Component),Jh=Object(m.b)(function(e,t){var n=t.sequencerEngine.getSequenceId(),a=e.tracks.trackSteps[t.track.id]?e.tracks.trackSteps[t.track.id].length:16,r=e.sequencer.currentGlobalStep[n]||0,c=t.track.getPatternStep(r,!1),o=Math.floor(c/(Kh.a.baseResolution.numSteps()/e.sequencer.displayResolution.numSteps()));o%=a;var s=t.chunk*t.stepsInRow,i=(t.chunk+1)*t.stepsInRow;return{patternStep:c,currentStep:o>=s&&o<i?o%t.stepsInRow:void 0}},null)(Yh),Zh=n(609),$h=n(846),eb=new h.a,tb=function(e){var t=e.palette,n=e.selectedPalette,a=e.onChoosePalette,r="palette-option";t===n&&(r+=" selected");var c={backgroundColor:$h.a[t]};return u.a.createElement("div",{style:c,onClick:function(){return a(t===n?void 0:t)},className:r},t+1)},nb=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.effect,n=e.stepData,a=Object(i.useState)(n.palette),r=Object(s.a)(a,2),c=r[0],o=r[1],l=t.track.sequencerEngine,f=Object(i.useCallback)(function(e){l.operationManager.dispatch(Object(dt.w)(t.track,n,n.paletteParameter,e)),o(e)},[o,n]);return u.a.createElement("div",{className:"palettes-container"},t.palettes.map(function(e){return u.a.createElement(tb,{onChoosePalette:f,palette:e,selectedPalette:c})}))}),ab=Object(m.b)(null,function(e,t){return{setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(function(e){var t=Object(i.useCallback)(function(t,n){t.stopPropagation(),e.setContextualHelp(n)},[]);return u.a.createElement("div",{className:"lock-button-container"},u.a.createElement("img",{onMouseOver:function(n){return t(n,e.contextualHelp||bn.cb)},onMouseLeave:function(){return e.setContextualHelp(void 0)},onClick:function(){return e.toggleLock()},className:"lock-button",src:e.patternLocked?"/closed-padlock.png":"/opened-padlock.png"}))});function rb(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var cb=new h.a,ob=function(e){Object(xe.a)(n,e);var t=rb(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={showMods:!1,showGenetix:!1,selectedOscillator:0},a.onClickMods=a.onClickMods.bind(Object(Cn.a)(a)),a.onClickGenetix=a.onClickGenetix.bind(Object(Cn.a)(a)),a}return Object(Ne.a)(n,[{key:"onChooseOscillator",value:function(e){this.setState({selectedOscillator:e})}},{key:"onClickGenetix",value:function(){this.setState({showGenetix:!this.state.showGenetix})}},{key:"onClickMods",value:function(){this.setState({showMods:!this.state.showMods})}},{key:"render",value:function(){var e=this,t=this.props.instrument,n=cb.getColorForTrack(this.props.track);cb.getBrightness(n)>180&&(n=cb.brighten(n,.6));var a=t.oscillatorNodes[this.state.selectedOscillator];return u.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"instrument multi-synth rack-synth"},u.a.createElement(He.a,{condition:!this.state.showMods&&!this.state.showGenetix},u.a.createElement("div",{className:"inner"},u.a.createElement("div",{className:"instrument-section"},u.a.createElement(nd,{track:this.props.track,scrollContainer:this.props.scrollContainer,setSelectedOscillator:function(n){return e.setState({selectedOscillator:Math.max(0,t.oscillatorNodes.indexOf(n))})},send:this.props.send,sequencerEngine:this.props.sequencerEngine,effect:this.props.instrument}),u.a.createElement("div",{className:"fm-parameters"},u.a.createElement("div",{className:"osc-name"},a.name),u.a.createElement(Mu,{parameter:a.harmonicityParameter,oscillator:a,name:"Harmonicity",className:"harmonicity"}),u.a.createElement(Mu,{parameter:a.modulationIndexParameter,oscillator:a,name:"Modulation",className:"modulation"}))),u.a.createElement("div",null,u.a.createElement("div",{className:"sections"},u.a.createElement("div",{className:"instrument-section"},u.a.createElement(wu,{sequencerEngine:this.props.sequencerEngine,instrument:t}),u.a.createElement(xu,{automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,instrument:t})),u.a.createElement("div",{className:"instrument-section envelopes"},u.a.createElement("div",{className:"instrument-subsection envelopes"},u.a.createElement(al,{automation:this.props.automation,envelopeOptions:ul,sequencerEngine:this.props.sequencerEngine,instrument:t})),u.a.createElement("div",{className:"aux-parameters"},u.a.createElement(Lu,{instrument:t,selectedOscillator:this.state.selectedOscillator,sequencerEngine:this.props.sequencerEngine}),u.a.createElement("div",{onClick:this.onClickMods,className:"mods-button common-button small-button"},this.state.showMods?"BACK":"MODS"))))))),u.a.createElement(He.a,{condition:this.state.showMods},u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(il,{instrument:t}),u.a.createElement("div",{onClick:this.onClickMods,className:"mods-button common-button small-button"},this.state.showMods?"BACK":"MODS")))}}]),n}(i.Component);function sb(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var ib=function(e){Object(xe.a)(n,e);var t=sb(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={},a}return Object(Ne.a)(n,[{key:"getEffect",value:function(){return"Filter"===this.props.effect.name?u.a.createElement(Rs,Object.assign({},this.props,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,filterEffect:this.props.effect})):"Auto Filter"===this.props.effect.name?u.a.createElement(Fs,Object.assign({},this.props,{track:this.track,sequencerEngine:this.props.sequencerEngine,effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,filterEffect:this.props.effect})):"Delay"===this.props.effect.name?u.a.createElement(Yf,Object.assign({},this.props,{effectNumber:this.props.effectNumber,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,delayEffect:this.props.effect})):"Tremolo"===this.props.effect.name?u.a.createElement(ui,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,tremoloEffect:this.props.effect})):"Chorus"===this.props.effect.name?u.a.createElement(si,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,chorusEffect:this.props.effect})):"Reverb"===this.props.effect.name?u.a.createElement(Bs,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,reverbEffect:this.props.effect})):"Convolver Reverb"===this.props.effect.name?u.a.createElement(ci,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,reverbEffect:this.props.effect})):"Compressor"===this.props.effect.name?u.a.createElement(Zf,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Distortion"===this.props.effect.name?u.a.createElement(gm,Object.assign({},this.props,{sequencerEngine:this.props.sequencerEngine,effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"EQ 3"===this.props.effect.name?u.a.createElement(nm,Object.assign({},this.props,{sequencerEngine:this.props.sequencerEngine,effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"EQ 10"===this.props.effect.name?u.a.createElement(rm,Object.assign({},this.props,{sequencerEngine:this.props.sequencerEngine,effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Bit Crusher"===this.props.effect.name?u.a.createElement(Om,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Ultra Phaser"===this.props.effect.name?u.a.createElement(dm,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,selectedParameter:this.props.selectedParameter,sequencerEngine:this.props.sequencerEngine,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Auto Wah"===this.props.effect.name?u.a.createElement(bm,Object.assign({},this.props,{effectNumber:this.props.effectNumber,automation:this.props.automation,sequencerEngine:this.props.sequencerEngine,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Gate"===this.props.effect.name?u.a.createElement(ws,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Pitch Shift"===this.props.effect.name?u.a.createElement(Cm,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Panner"===this.props.effect.name?u.a.createElement(wm,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"EQ8"===this.props.effect.name?u.a.createElement(Gm,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Chebyshev"===this.props.effect.name?u.a.createElement(em,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Multiband Compressor"===this.props.effect.name?u.a.createElement(mm,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Stereo Widener"===this.props.effect.name?u.a.createElement(Vm,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Saturator"===this.props.effect.name?u.a.createElement(km,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Tape Delay"===this.props.effect.name?u.a.createElement(Xm,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Stereo Delay"===this.props.effect.name?u.a.createElement(Zm,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Oscilloscope"===this.props.effect.name?u.a.createElement(Cs,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):"Effect Rack"===this.props.effect.name?u.a.createElement(ep,Object.assign({},this.props,{effectNumber:this.props.effectNumber,tracks:this.props.tracks,sequencerEngine:this.props.sequencerEngine,automation:this.props.automation,selectedParameter:this.props.selectedParameter,onEffectsChange:this.props.onEffectsChange,onParameterChanged:this.props.onParameterChanged,effect:this.props.effect})):null}},{key:"render",value:function(){var e=this,t=this.getEffect();return u.a.createElement(lr.a,Object.assign({},this.props,{onDeleteEffect:this.props.onDeleteEffect,effectNumber:this.props.effectNumber,onToggle:function(){return e.setState(e.state)},track:this.props.track,group:this.props.group,send:this.props.send,effect:this.props.effect,automation:this.props.automation}),t)}}]),n}(i.Component),ub=function(e){Object(xe.a)(n,e);var t=sb(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={selectedParameter:void 0,effectsView:u.a.createRef()},a.unmapSelectedParameter=a.unmapSelectedParameter.bind(Object(Cn.a)(a)),a}return Object(Ne.a)(n,[{key:"unmapSelectedParameter",value:function(){console.log("UMMAP!"),this.props.sequencerEngine.dispatch(Object(f.p)(void 0))}},{key:"componentDidMount",value:function(){console.log("component did mount = ",this.state.effectsView),this.state.effectsView.current.addEventListener("scroll",this.unmapSelectedParameter)}},{key:"componentWillUnmount",value:function(){this.state.effectsView.current.removeEventListener("scroll",this.unmapSelectedParameter),this.unmapSelectedParameter()}},{key:"handleChooseMidiEffect",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(dt.b)(e,this.props.track,this.props.group,this.props.send)),this.setState(this.state)}},{key:"handleChooseLiveEffect",value:function(e){this.props.track.liveEffects.addEffect(e),this.setState(this.state)}},{key:"handleChooseEffect",value:function(e){e.enable(!0),this.props.sequencerEngine.operationManager.dispatch(Object(dt.b)(e,this.props.track,this.props.group,this.props.send)),this.setState(this.state)}},{key:"onParameterChanged",value:function(e,t){void 0===this.props.track&&void 0===this.props.group&&void 0===this.props.send||(this.props.setSelectedEffect(t.id),this.props.onParameterChanged(e))}},{key:"onDeleteEffect",value:function(){this.setState(this.state)}},{key:"toggleLock",value:function(){this.props.track.togglePatternLock()}},{key:"onChangePanning",value:function(e){void 0!==this.props.track?this.props.track.setPanning(e):void 0!==this.props.group&&this.props.group.setPanning(e)}},{key:"render",value:function(){var e=this,t=void 0!==this.props.send?this.props.send.effects:void 0!==this.props.track?this.props.track.effects:this.props.group.effects;this.props.track&&(t=this.props.track.getEffects(this.props.chainNumber));var n=void 0!==this.props.send?this.props.send.getSendNodes():void 0!==this.props.track?this.props.track.getSendNodes():this.props.group.getSendNodes(),a=void 0!==this.props.track?this.props.track.midiEffects.effects:[],r=void 0!==this.props.track?this.props.track.liveEffects.effects:[],c=function(e,t){if(void 0!==e){if("MIDI"===e.getTrackType())return u.a.createElement(El,{track:e});if("INSTRUMENT_RACK"===e.getTrackType())return u.a.createElement(Yi,{scrollContainer:t,track:e});if("INSTRUMENT"===e.getTrackType()){var n=e.sequencerEngine;if(!e.instrument)return[];var a=e.instrument.getInstrumentType();if(a===jt.j){var r=e.instrument.zobject;if(!r)return"";var c=r.subSequence;return c.zObjects&&c.zObject?(console.log("loading zobject with scorllContainer=",t),u.a.createElement(u.a.Fragment,null,u.a.createElement(fi.a,{subSequence:c.zObject,skipSelect:!0}),u.a.createElement($c.a,{isExpandedCopy:!0,expansionId:c.zObject.id,zobject:c.zObject,containerRef:t}))):""}return a===jt.i?u.a.createElement(Wf,{scrollContainer:t,key:e.trackNumber+"-instrument",track:e,instrument:e.getInstrument()}):a===jt.f?u.a.createElement(fl,{scrollContainer:t,key:e.trackNumber+"-instrument",sequencerEngine:n,track:e,instrument:e.getInstrument()}):a===jt.g?u.a.createElement(pi,{scrollContainer:t,key:e.trackNumber+"-instrument",sequencerEngine:n,track:e,instrument:e.getInstrument()}):a===jt.c?u.a.createElement(zf,{scrollContainer:t,key:e.trackNumber+"-instrument",sequencerEngine:n,track:e,instrument:e.getInstrument()}):a===jt.e?u.a.createElement(_f,{key:e.trackNumber+"-instrument",scrollContainer:t,sequencerEngine:n,track:e,instrument:e.getInstrument()}):a===jt.h?u.a.createElement(Nf,{scrollContainer:t,key:e.trackNumber+"-instrument",sequencerEngine:n,track:e,instrument:e.getInstrument()}):void 0}}}(this.props.track,this.props.scrollContainer||this.state.effectsView)||"";return this.props.isFrozen&&(c=""),void 0===t||void 0===r||void 0===a?u.a.createElement("div",null):u.a.createElement("div",{ref:this.state.effectsView,className:"effects-view"},r.map(function(t,n){return u.a.createElement(Ai.a,{key:"live-effect-"+n,scrollContainer:e.props.scrollContainer||e.state.effectsView,sequencerEngine:e.props.sequencerEngine,onDeleteEffect:function(){return e.onDeleteEffect()},effect:t,selectedParameter:e.state.selectedParameter,track:e.props.track,tracks:e.props.tracks,onParameterChanged:function(n){return e.onParameterChanged(n,t)},onEffectsChange:e.props.onEffectsChange})}),c,a.map(function(t,n){return u.a.createElement(Vd,{key:"midi-effect-"+n,sequencerEngine:e.props.sequencerEngine,scrollContainer:e.props.scrollContainer||e.state.effectsView,onDeleteEffect:function(){return e.onDeleteEffect()},effect:t,isMixCollapsed:e.props.isMixCollapsed,selectedParameter:e.state.selectedParameter,track:e.props.track,tracks:e.props.tracks,onParameterChanged:function(n){return e.onParameterChanged(n,t)},onEffectsChange:e.props.onEffectsChange})}),t.map(function(t,n){return u.a.createElement(ib,{sequencerEngine:e.props.sequencerEngine,scrollContainer:e.props.scrollContainer||e.state.effectsView,key:"effect-"+n,onDeleteEffect:function(){return e.onDeleteEffect()},effect:t,isMixCollapsed:e.props.isMixCollapsed,selectedParameter:e.state.selectedParameter,track:e.props.track,group:e.props.group,send:e.props.send,tracks:e.props.tracks,onParameterChanged:function(n){return e.onParameterChanged(n,t)},onEffectsChange:e.props.onEffectsChange})}),u.a.createElement(Ii,{track:this.props.track,sequencerEngine:this.props.sequencerEngine,addClassName:"add-track-effects-button",handleChooseMidiEffect:function(t){return e.handleChooseMidiEffect(t)},handleChooseLiveEffect:function(t){return e.handleChooseLiveEffect(t)},handleChooseEffect:function(t){return e.handleChooseEffect(t)},store:this.props.store}),u.a.createElement("div",{className:"sends-and-options-container"},u.a.createElement("div",{className:"sends-container"},n.map(function(t,n){return u.a.createElement(Si,{key:"track-send-"+n,track:e.props.track,sequencerEngine:e.props.sequencerEngine,sendNumber:n,send:e.props.sends.getSends()[n],sendNode:t})}),u.a.createElement(qs,{panning:this.props.panning,onChangePanning:function(t){return e.onChangePanning(t)}})),this.props.track?u.a.createElement(ki,{track:this.props.track}):""),u.a.createElement("div",{className:"effect-lock"},u.a.createElement(He.a,{condition:!this.props.hideLock},u.a.createElement(ab,{patternLocked:this.props.patternLocked,toggleLock:function(){return e.toggleLock()}}))))}}]),n}(i.Component),lb={EffectsView:Object(m.b)(function(e,t){var n=!1,a=!1;void 0!==t.track&&(n=((e.tracks.trackPatternLocks[t.track.subSequence.id]||{})[t.track.trackNumber]||{})[t.track.currentPattern]||!1,a=t.track.isFrozen);var r=0,c=void 0;void 0!==t.track?(r=e.tracks.trackPannings[t.track.trackNumber]||0,c=t.track.chainNumber):void 0!==t.group&&(r=e.tracks.groupPannings[t.group.groupNumber]||0);var o=t.track||t.group||t.send;return{isFrozen:a,patternLocked:n,panning:r,chainNumber:c,effects:o.effects,effectsLen:o.effects?o.effects.length:o.midiEffects&&o.midiEffects.effects?o.midiEffects.effects.length:0,midiEffects:o.midiEffects&&o.midiEffects.effects}},function(e){return{setSelectedEffect:function(t){return e(Object(f.Xd)(t))}}})(ub),EffectComponent:ib};n(2448),n(1331);function fb(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var mb=new h.a,pb=function(e){Object(xe.a)(n,e);var t=fb(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={showMoreParameters:!1,refined:!1},a}return Object(Ne.a)(n,[{key:"effectToShow",get:function(){return void 0===this.props.showStepOptions?void 0:this.props.showStepOptions.effect}},{key:"showOption",get:function(){return void 0===this.props.showStepOptions?void 0:this.props.showStepOptions.option}},{key:"hasMidiFX",value:function(){return this.props.track.midiEffects.effects.length>0}},{key:"hasInstrument",value:function(){return void 0!==this.props.track.instrument}},{key:"onClickMore",value:function(){this.setState({showMoreParameters:!this.state.showMoreParameters})}},{key:"shouldBeRefined",value:function(){return this.props.stepData.duration%1!==0||this.props.stepData.transpose%1!==0}},{key:"onChangeRefined",value:function(e){var t="refined"===e;document.activeElement.blur(),this.setState({refined:t})}},{key:"onChangeDuration",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(dt.w)(this.props.track,this.props.stepData,this.props.stepData.durationParameter,e)),this.setState(this.state)}},{key:"onChangeChop",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(dt.w)(this.props.track,this.props.stepData,this.props.stepData.chopParameter,e)),this.state.chop=e,this.setState(this.state)}},{key:"onChangeParameter",value:function(e,t){this.props.sequencerEngine.operationManager.dispatch(Object(dt.w)(this.props.track,this.props.stepData,e,t))}},{key:"onChangeChopDuration",value:function(e){this.props.stepData.chopDuration=e,this.state.chopDuration=e,this.setState(this.state)}},{key:"onChangeTranspose",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(dt.w)(this.props.track,this.props.stepData,this.props.stepData.transposeParameter,e)),this.state.transpose=e,this.setState(this.state)}},{key:"onChangeReversed",value:function(e,t){this.props.stepData.reverse=!t.reverse,document.activeElement.blur(),this.setState(this.state)}},{key:"onChangeVelocity",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(dt.w)(this.props.track,this.props.stepData,this.props.stepData.velocityParameter,e)),this.state.velocity=e,this.setState(this.state)}},{key:"onChangeSlice",value:function(e){this.props.sequencerEngine.operationManager.dispatch(Object(dt.w)(this.props.track,this.props.stepData,this.props.stepData.sliceParameter,e)),this.state.slice=e,this.setState(this.state)}},{key:"effects",get:function(){return this.props.track.effectsChains[this.props.effectsChain].effects}},{key:"onClickFX",value:function(){this.effects.length>0&&this.props.setShowStepOptions("AUDIO_FX",0)}},{key:"onClickInstrument",value:function(){return this.props.setShowStepOptions("INSTRUMENT",0)}},{key:"onClickMidiFX",value:function(){this.props.setShowStepOptions("MIDI_FX",0)}},{key:"onClickNextFX",value:function(){var e="MIDI_FX"===this.showOption?this.midiFX:this.effects;if(e.length>0){var t=(this.effectToShow+1)%e.length;this.props.setShowStepOptions(this.showOption,t)}}},{key:"onClickBack",value:function(){this.props.setShowStepOptions(void 0)}},{key:"onChangePanning",value:function(e){this.props.stepData.panning=e,this.state.panning=e,this.setState(this.state)}},{key:"getParametersToShow",value:function(e){var t=this,n=this.state.refined?.01:1,a=this.state.refined?2:64,r=this.props.isMidi?Lc.a.middleC.transpose(e.transpose).toString():e.transpose,c=this.state.refined?.01:1;if(this.state.showMoreParameters)return u.a.createElement("div",null,u.a.createElement(db,{label:"Attack",labelValue:e.attack,value:e.attack,min:0,step:1,max:4e3,onChange:function(e){return t.onChangeParameter(t.props.stepData.attackParameter,e)}}),u.a.createElement(db,{label:"Release",labelValue:e.release,value:e.release,min:0,step:1,max:6e3,onChange:function(e){return t.onChangeParameter(t.props.stepData.releaseParameter,e)}}),u.a.createElement(db,{label:"Pitch Attack",labelValue:e.pitchAttack,value:e.pitchAttack,min:0,step:1,max:6e3,onChange:function(e){return t.onChangeParameter(t.props.stepData.pitchAttackParameter,e)}}),u.a.createElement(db,{label:"Pitch Decay",labelValue:e.pitchDecay,value:e.pitchDecay,min:0,step:1,max:6e3,onChange:function(e){return t.onChangeParameter(t.props.stepData.pitchDecayParameter,e)}}),u.a.createElement(db,{label:"Pitch Sustain",labelValue:e.pitchSustain,value:e.pitchSustain,min:-10,step:.01,max:10,onChange:function(e){return t.onChangeParameter(t.props.stepData.pitchSustainParameter,e)}}),u.a.createElement(db,{label:"Pitch Release",labelValue:e.pitchRelease,value:e.pitchRelease,min:0,step:1,max:8e3,onChange:function(e){return t.onChangeParameter(t.props.stepData.pitchReleaseParameter,e)}}));var o=null===e.panning?this.props.track.getPanning():e.panning;return u.a.createElement("div",null,u.a.createElement(db,{label:"Duration",labelValue:e.duration,value:e.duration,min:n,step:c,max:a,onChange:function(e){return t.onChangeDuration(e)}}," "),u.a.createElement(db,{label:"Chop",labelValue:e.chop,value:e.chop,min:1,step:1,max:64,onChange:function(e){return t.onChangeChop(e)}}," "),u.a.createElement(db,{label:"Slice",labelValue:e.slice+1,isSlice:!0,value:e.slice,min:0,step:1,max:this.props.slices-1,onChange:function(e){return t.onChangeSlice(e)}}," "),u.a.createElement(db,{label:"Transpose",labelValue:r,value:e.transpose,min:-23,max:23,step:1,onChange:function(e){return t.onChangeTranspose(e)}}," "),u.a.createElement(db,{label:"Velocity",labelValue:e.velocity,value:e.velocity,min:0,max:1,step:.1,onChange:function(e){return t.onChangeVelocity(e)}}," "),u.a.createElement(db,{label:"Pan",labelValue:o,value:o,min:-1,max:1,step:.1,onChange:function(e){return t.onChangePanning(e)}}," "))}},{key:"getCheckboxes",value:function(e){var t=this;return u.a.createElement("div",null,u.a.createElement("div",{className:"reverse-parameter"},u.a.createElement("form",null,u.a.createElement("div",{className:"refined-checkbox"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:"reversed",checked:e.reverse,onChange:function(n){return t.onChangeReversed(n.target.value,e)}}),"Reverse")))),u.a.createElement("div",{className:"refined-parameter"},u.a.createElement("form",null,u.a.createElement("div",{className:"refined-checkbox"},u.a.createElement("label",null,u.a.createElement("input",{type:"checkbox",value:"refined",checked:this.state.refined,onChange:function(e){return t.onChangeRefined(e.target.value)}}),"Refine")))))}},{key:"getPalettes",value:function(){var e=this.props.track.liveEffects.effects.find(function(e){return e.effect===Ti.d});return void 0===e?[]:u.a.createElement(nb,{effect:e,stepData:this.props.stepData})}},{key:"midiFX",get:function(){return this.props.track.midiEffects.effects}},{key:"effectExists",value:function(e){return"MIDI_FX"===this.showOption?void 0!==this.midiFX[e]:void 0!==this.effects[e]}},{key:"render",value:function(){var e=this,t=this.props.track.getStepDataForStep(this.props.stepData,!0);return"INSTRUMENT"===this.showOption&&this.hasInstrument()||"MIDI_FX"===this.showOption&&this.hasMidiFX()||"AUDIO_FX"===this.showOption&&this.effects.length>0?u.a.createElement("div",null,this.getEffectOrInstrument(),u.a.createElement("div",{className:"effects-parameters-button-container"},u.a.createElement(He.a,{condition:"AUDIO_FX"===this.showOption||"MIDI_FX"===this.state.showOption},u.a.createElement("div",{onClick:function(){return e.onClickNextFX()},className:"small-button pink-button float-right"},"NEXT")),u.a.createElement("div",{onClick:function(){return e.onClickBack()},className:"small-button pink-button float-right"},"BACK"))):u.a.createElement("div",null,this.getParametersToShow(t),this.getPalettes(t),this.getCheckboxes(t),u.a.createElement("div",{className:"effects-parameters-button-container"},u.a.createElement("div",{onClick:function(){return e.onClickMore()},className:"small-button pink-button float-right"},this.state.showMoreParameters?"BACK":"MORE")))}},{key:"getEffectOrInstrument",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.effectToShow,n="MIDI_FX"===this.showOption?this.props.track.midiEffects.effects[t]:this.effects[t];if("MIDI_FX"===this.showOption&&this.effectExists(t))return u.a.createElement(Vd,{onEffectsChange:function(){return e.props.track.updateEffects()},sequencerEngine:this.props.sequencerEngine,effect:n,track:this.props.track,effectNumber:t,automation:this.props.stepData.effectAutomations});if("AUDIO_FX"===this.showOption&&this.effectExists(t))return u.a.createElement(lb.EffectComponent,{onEffectsChange:function(){return e.props.track.updateEffects()},sequencerEngine:this.props.sequencerEngine,effect:n,track:this.props.track,effectNumber:t,automation:this.props.stepData.effectAutomations});if("INSTRUMENT"===this.showOption&&this.hasInstrument()){var a=this.props.track.instrument.getInstrumentType();if(a===jt.i)return u.a.createElement(Wf,{track:this.props.track,automation:this.props.stepData.effectAutomations,instrument:this.props.track.getInstrument()});if(a===jt.f)return u.a.createElement(ob,{sequencerEngine:this.props.sequencerEngine,track:this.props.track,automation:this.props.stepData.effectAutomations,instrument:this.props.track.getInstrument()});if(a===jt.c)return u.a.createElement(zf,{sequencerEngine:this.props.sequencerEngine,track:this.props.track,automation:this.props.stepData.effectAutomations,instrument:this.props.track.getInstrument()});if(a===jt.e)return u.a.createElement(_f,{sequencerEngine:this.props.sequencerEngine,automation:this.props.stepData.effectAutomations,track:this.props.track,instrument:this.props.track.getInstrument()})}return""}}]),n}(i.Component),db=function(e){Object(xe.a)(n,e);var t=fb(n);function n(e){return Object(Pe.a)(this,n),t.call(this,e)}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e){return this.props.value!==e.value||this.props.step!==e.step}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"step-parameter"},u.a.createElement("div",{className:"parameter-label"},this.props.label,": ",Math.round(10*this.props.labelValue)/10),this.props.isSlice?u.a.createElement("div",{style:{backgroundColor:mb.getColor(this.props.labelValue-1)},className:"slice-indicator"}):"",u.a.createElement(be.a,{value:this.props.value,change:function(t){return e.props.onChange(t.target.value)},step:this.props.step,max:this.props.max,min:this.props.min,orientation:"horizontal",reversed:!1}))}}]),n}(i.Component);Object(m.b)(function(e,t){var n=t.track.trackNumber;return{effectsChain:e.tracks.trackEffectsChain[n]||0,showStepOptions:e.steps.showStepOptions}},function(e){return{setShowStepOptions:function(t,n){return e(Object(f.Se)(t,n))}}})(pb);function hb(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var bb=new h.a;window.factorFill=.9;var vb=function(e){Object(xe.a)(n,e);var t=hb(n);function n(e){return Object(Pe.a)(this,n),t.call(this,e)}return Object(Ne.a)(n,[{key:"brighten",value:function(e,t){var n=Math.min(255,Math.floor(parseInt(e.slice(1,3),16)*t)),a=Math.min(255,Math.floor(parseInt(e.slice(3,5),16)*t)),r=Math.min(255,Math.floor(parseInt(e.slice(5),16)*t));return n=n.toString(16),a=a.toString(16),r=r.toString(16),1===n.length&&(n="0"+n),1===a.length&&(a="0"+a),1===r.length&&(r="0"+r),"#"+n+a+r}},{key:"render",value:function(){var e=this,t={};if(this.props.fill){t={backgroundColor:bb.brighten(bb.getColorForTrack(this.props.track),window.factorFill)}}this.props.stepData&&this.props.on&&this.props.stepData.duration<1&&(t.width=30*this.props.stepData.duration);var n="fill ";return this.props.isCurrentStep&&(n+=" current-step"),this.props.isCursor&&(n+=" cursor"),this.props.on&&(n+=" on"),u.a.createElement("div",{onMouseDown:function(t){return e.props.onMouseDown(t)},onMouseUp:function(t){return e.props.onMouseUp(t)},style:t,className:n})}}]),n}(i.Component),gb=new h.a,Eb=new b.a(16,!1),Ob=new gf.a;window.pianoRoll=7;var yb=Object(i.memo)(function(e){var t=gb.getColorForTrack(e.track),n=Object(i.useRef)(void 0),a=e.sequencerEngine.store.getState().tracks.trackStepIds[e.track.id],r=a&&a[e.stepNumber];void 0!==r&&r.on||(r=Ob);var c=function(e,t){return!(void 0===e.selectedSteps||!e.on||e.showParameters||void 0===t)&&e.selectedSteps.filter(function(e){return void 0!==e&&e.id===t.id}).length>0}(e,r),o=function(e){var t=e.stepsSelection;return void 0!==t&&e.stepNumber>=t.fromStep&&e.stepNumber<=t.toStep}(e),s=function(e,t,n,a,r){var c={},o="step ";if(r.group&&(a=eb.getColorForHash(r.group.id)),e.on){if(o+="on ",c.backgroundColor=a,!e.showParameters)if(0===e.velocity||e.velocity){var s=.7*e.velocity+.3;c.opacity=s}else c.opacity=1}else o+="off ";e.isAlternateColor&&(o+=" alternate "),t?(o+=" selected ",c.borderColor=a,c.backgroundColor=eb.brighten(a,.4)):e.isCurrentStep&&e.isCursor?o+=" cursor ":e.isCurrentStep?o+=" current-step ":e.isCursor&&(o+=" cursor "),e.viMode&&(o+=" vi-mode"),e.on&&!t&&(r.trackData&&void 0!==r.palette&&null!==r.palette?(c.borderBottomColor=$h.a[r.palette],c.borderBottomWidth="5px"):0!==r.slice&&(c.borderBottomColor=eb.getColor(r.slice),c.borderBottomWidth="5px",c.borderBottomStyle="solid")),r.pLockedParameters.length>0&&(o+=" p-locked"),e.showParameters||(o+=" not-expanded"),o+=n?" selection ":"";var i=Object(Zh.a)(e.resolution);i>2&&e.stepNumber%i===0&&(o+=" beat-division");var u="step-container";return n&&(u+=" selection"),{className:o,style:c,containerClassName:u}}(e,c,o,t,r),l=s.className,f=s.style,m=s.containerClassName,p=Object(i.useCallback)(function(t){if(!e.showParameters){if(e.mouseDown(!0),e.sequencerEngine.select(e.trackNumber,e.stepNumber,e.track),c)e.setStepNumberDraggingFrom(e.stepNumber);else if(t.metaKey||t.ctrlKey||!e.on)e.setSelectedSteps(void 0),e.setStepsSelection(e.trackNumber,e.stepNumber,e.stepNumber);else{e.setSelectedSteps(void 0);var n=e.sequencerEngine.state.tracks.trackStepIds[e.track.id]||{};e.setSingleStepToDrag(n[e.stepNumber]),e.setStepNumberDraggingFrom(e.stepNumber)}e.setStepNumberDraggingFrom(e.stepNumber)}},[c,e.showParameters,r,e.on,e.stepNumber,e.trackNumber,e.track]),d=Object(i.useCallback)(function(){e.setSingleStepToDrag(void 0),e.setIsDraggingDuration(!1),e.setStepToCopy(void 0);var t=e.sequencerEngine.store.getState();(kb(e)||t.steps.stepNumberDraggedTo!==e.stepNumber)&&t.steps.stepNumberDraggingFrom===e.stepNumber?(kb(e)?(e.setStepsSelection(void 0),e.sequencerEngine.cursor.show=!0):(e.sequencerEngine.operationManager.dispatch(Object(dt.t)(e.sequencerEngine.tracks[e.trackNumber],e.stepNumber,e.resolution)),e.setSelectedSteps(void 0),e.sequencerEngine.select(e.trackNumber,e.stepNumber),e.setStepsSelection(void 0),e.sequencerEngine.cursor.track=e.trackNumber),e.setStepNumberDraggedTo(void 0)):e.setStepNumberDraggedTo(void 0)},[e.stepNumber,e.resolution,e.track,e.trackNumber]),h=Object(i.useCallback)(function(t){t.stopPropagation();var n=e.sequencerEngine.store.getState();if(n.keyboard.isDraggingDuration&&n.keyboard.isMouseDown)b();else if(void 0===n.steps.stepNumberDraggingFrom||void 0===n.keyboard.selectedPianoRollSteps&&!n.steps.singleStepToDrag){if(void 0!==e.stepsSelection){var a=e.stepsSelection;e.stepNumber>=a.fromStep?e.setStepsSelection(e.trackNumber,a.fromStep,e.stepNumber):e.setStepsSelection(e.trackNumber,e.stepNumber,a.toStep)}}else{var r=g(n.steps.stepNumberDraggingFrom),c=void 0!==n.keyboard.selectedPianoRollSteps?n.keyboard.selectedPianoRollSteps:[n.steps.singleStepToDrag];e.sequencerEngine.operationManager.dispatch(Object(dt.n)(e.sequencerEngine.tracks[e.trackNumber],c,r,e.resolution)),e.setStepNumberDraggingFrom(e.stepNumber),e.setStepNumberDraggedTo(e.stepNumber),e.sequencerEngine.select(e.trackNumber,e.stepNumber)}},[e.stepsSelection,e.selectedSteps,e.track,e.trackNumber,e.resolution,e.stepNumber]),b=Object(i.useCallback)(function(){var t=e.sequencerEngine.state,n=1+e.stepNumber-t.keyboard.stepDragging,a=Eb.transformStepAtResolution2(n,e.resolution),r=t.keyboard.stepToCopy;null===r.duration?e.track.trackData.duration:r.duration;e.selectedSteps?e.selectedSteps.forEach(function(e){return v(e,a)}):v(r,a)},[e.selectedSteps,e.track,e.resolution]),v=function(t,n){null===t.duration?e.track.trackData.duration:t.duration;e.sequencerEngine.operationManager.dispatch(Object(dt.w)(e.sequencerEngine.tracks[e.trackNumber],t,t.durationParameter,Math.max(.1,n)))},g=Object(i.useCallback)(function(t){return{stepDifference:e.stepNumber-t,transposeDifference:0}},[e.stepNumber]),E=Object(i.useCallback)(function(t){t.stopPropagation();var n=e.sequencerEngine.state.tracks.trackStepIds[e.track.id],a=n&&n[e.stepNumber];c||e.setSelectedSteps([a]),e.setIsDraggingDuration(!0),e.setStepDragging(e.stepNumber),e.setStepToCopy(a),e.mouseDown(!0)},[c,r,e.track]),O=r&&(r.position>.6&&r.position<.7||r.position>.3&&r.position<.4),y=r&&r.reverse;return u.a.createElement(vn.a,{element:bn.Y},u.a.createElement("div",{onMouseOver:h,className:m},u.a.createElement("div",{ref:n,id:"stepdata-"+r.id,onMouseDown:p,onMouseUp:d,className:l,style:f},"",u.a.createElement(He.a,{condition:e.on},y?u.a.createElement("i",{className:"reverse-indicator"}):"",r.group?u.a.createElement("div",{className:"group-indicator"}):"",r.pLockedParameters.length>0?u.a.createElement("div",{style:{backgroundColor:gb.getColorForHash(jb(r))},className:"p-lock-indicator"}):"",O?u.a.createElement("div",{className:"triplet"},"t"):"",u.a.createElement("div",{draggable:!1,onMouseDown:E,className:"right-edge"}))),u.a.createElement(vb,{stepData:r,onMouseDown:p,onMouseUp:d,sampleId:e.id,on:e.on,fill:e.fill,track:e.track,isCurrentStep:e.isCurrentStep,isCursor:e.isCursor})))}),kb=function(e){return e.sequencerEngine.store.getState().keyboard.isCommandDown};var jb=function(e){var t=e.pLockedParameters.map(function(t){return t.stepToValue[e.id]}).reduce(function(e,t){return e+t},0);return t<31&&(t=Math.pow(2,t)),t+"-"+e.pLockedParameters[0].id},Cb=Object(m.b)(null,function(e){return{mouseDown:function(t){return e(Object(f.l)(t))},dragToggle:function(t){return e(Object(f.j)(t))},setContextualHelp:function(t){return e(Object(f.hb)(t))},setStepToCopy:function(t){return e(Object(f.hf)(t))},setStepDragging:function(t){return e(Object(f.df)(t))},setSingleStepToDrag:function(t){return e(Object(f.bf)(t))},setStepsSelection:function(t,n,a){return e(Object(f.jf)(t,n,a))},setStepNumberDraggingFrom:function(t){return e(Object(f.ff)(t))},setStepNumberDraggedTo:function(t){return e(Object(f.ef)(t))},setIsDraggingDuration:function(t){return e(Object(f.hc)(t))},setSelectedSteps:function(t){return e(Object(f.ge)(t))}}})(yb),Sb=(new gf.a,Object(i.memo)(function(e){var t=e.stepGroups,n=e.cursorStep,a=e.chunk,r=(e.show,e.stepsLength,e.stepNumbers),c=e.track,o=e.resolution,s=e.barLength,i=e.sequencerEngine,l=e.id,f=e.selectedSteps,m=e.stepsSelection,p=e.trackLengthMode,d=e.showPianoRoll,h=e.isSelectedTrack,b=e.isMini,v=e.trackColor,g=e.chunkSize,E=e.stepsInRow,O=e.partNumber,y=void 0===O?0:O,k=(e.rowHash,"steps-row"),j=!1;Math.floor(a/2)%2===1&&(k+=" odd",j=!0);var C=function(e){return Math.ceil((e+1)/s)%2!=0},S=c.numberOfSlices(),w=(i.cursor,i.getSelectedStep(),i.state.tracks.trackStepIds[c.id]||{}),P=i.state.tracks.trackSteps[c.id],N=i.state.tracks.trackFills[c.id];return u.a.createElement("div",{className:"steps-row-container"},u.a.createElement("div",{className:k},r.map(function(e,a){return u.a.createElement(Cb,{id:l,odd:j,key:a,isCursor:n===e,on:P&&P[e],fill:N&&N[e],showParameters:!1,showPianoRoll:d,selectedSteps:f,stepsSelection:m,group:w[e]?w[e].group:void 0,slice:w[e]?w[e].slice:0,velocity:w[e]?w[e].velocity:1,trackColor:v,sequencerEngine:i,trackNumber:c.trackNumber,stepGroups:t,resolution:o,stepNumber:e,trackData:c,isAlternateColor:C(a),slices:S,track:c})})),!b&&p&&h?u.a.createElement(Vh,{resizable:a===g-1,rowLength:P.length,track:c,color:v,row:a}):"",u.a.createElement(Jh,{isMini:b,sequencerEngine:i,track:c,stepsInRow:E,chunk:a+4*y}))})),wb=Object(Xh.a)([function(e,t){return e.tracks.trackSteps[t.track.id]},function(e,t){return t.chunk*t.stepsInRow},function(e,t){return(t.chunk+1)*t.stepsInRow}],function(e,t,n,a){return Object(Wh.a)([].concat(Object(d.a)(e||[]),Object(d.a)(a||[])).slice(t,n).join(","))}),Pb=Object(m.b)(function(e,t){var n=e.steps.stepsSelection,a=-1,r=t.sequencerEngine.currentSubSequence===t.track.subSequence;if(e.mix.selectedTrack===t.track.trackNumber&&r){var c=e.mix.selectedStep,o=t.chunk+4*t.partNumber;c>=o*t.stepsInRow&&c<=(o+1)*t.stepsInRow&&(a=c)}var s=e.keyboard.selectedPianoRollSteps;return s&&s[0]&&s[0].track!==t.track&&(s=void 0),{fills:e.tracks.trackFills[t.track.id],rowHash:wb(e,t),selectedSteps:s,stepsSelection:void 0!==n&&r&&n.trackNumber===t.track.trackNumber?n:void 0,cursorStep:a,cursorShow:t.sequencerEngine.cursor.show,showPianoRoll:e.sequencer.showPianoRoll,stepGroups:e.steps.stepGroups}},function(e){return{}})(Sb),Nb=function(e){var t=e.resolution,n=e.stepNumber,a=e.length,r=(e.track,e.stepData),c=e.trackColor,o=e.width,s=void 0===o?448:o,i=e.height,l=void 0===i?25:i,f=e.pattern;if(void 0===r){var m=f.getAllOnStepAtResolutionAtAnyPosition(n,t);if(0===m.length)return u.a.createElement("div",null);r=m[0]}var p=l/2,d={left:s*n/a,width:r.duration*s/a,top:p-r.transpose/2};r.on&&(d.backgroundColor=c);var h=r.on?"on":"off";return u.a.createElement("div",{className:h,style:d})},xb=Object(i.memo)(function(e){var t=e.steps,n=e.length,a=e.pattern,r=e.trackColor,c=e.resolution;return t.map(function(e){return u.a.createElement(Nb,{key:e.step.id,trackColor:r,pattern:a,length:n,stepNumber:e.stepNumber,resolution:c,stepData:e.step})})});var qb=Object(m.b)(function(e,t){var n=t.sequencerEngine.getSequenceId(),a=e.sequencer.currentGlobalStep[n]||0;return{currentStep:t.track.getPatternStep(a)}},null)(function(e){var t={left:448*e.currentStep/e.track.length};return u.a.createElement("div",{className:"play-tick",style:t})}),Tb=128;function Mb(e){var t="part";e.i===e.partNumber&&(t+=" current-part");return u.a.createElement("div",{onClick:function(){return function(){e.sequencerEngine.cursor.step=e.i*Tb;var t=e.sequencerEngine.trackStep;e.sequencerEngine.seekToTrackStep(t%Tb+e.i*Tb,!1)}()},className:t})}var Rb=Object(m.b)(function(e,t){t.sequencerEngine.getSequenceId();var n=e.tracks.trackSteps[t.track.id];return{resolution:e.sequencer.displayResolution,steps:n,trackStepIds:e.tracks.trackStepIds[t.track.id]}},null)(function(e){var t=e.track.pattern.length(e.resolution),n=(Array(t).fill(0),(e.trackStepIds||[]).map(function(e,t){return{step:e,stepNumber:t}}).filter(function(e){return e.step&&e.step.on})),a=Math.ceil(e.track.length/Tb),r=Array(a).fill(0);return u.a.createElement("div",{className:"steps-map"},r.map(function(t,n){return u.a.createElement(Mb,{i:n,track:e.track,sequencerEngine:e.sequencerEngine,partNumber:e.partNumber})}),u.a.createElement(xb,{resolution:e.resolution,steps:n,pattern:e.track.pattern,trackColor:e.trackColor,length:t}),u.a.createElement(qb,{track:e.track,sequencerEngine:e.sequencerEngine}))}),Db={};new b.a(32,!1),new gf.a,new h.a;var Ib=Object(i.memo)(function(e){var t=e.borderColor,n=e.isTrackFrozen,a=e.trackLengthMode,r=e.sequencerEngine,c=e.trackColor,o=e.track,s=e.id,i=e.partNumber,l=e.numberParts,f=e.resolution,m=e.isMini,p=e.show,d=e.isSelectedTrack,h=e.setTrackLengthMode,v=(e.stepGroups,e.sequencerScale),g=e.onClickTrack,E="steps-container";n&&(E+=" frozen");a&&(" selected",E+=" track-length-mode");var O=o.length,y=function(e){return e.isTriplet?12:16}(f),k=function(e,t){if(void 0===e||void 0===e.pattern||void 0===t)return[];var n=t.transformStepAtResolution2(e.pattern.length(),new b.a(32,!1));n=Math.floor(n);for(var a=[],r=0;r<n;r++)a.push(r);for(var c=t.isTriplet?12:16,o=a.length/c,s=[],i=0;i<o;i++){var u=i*c,l=u+c;a.length<l&&(l=a.length);var f=u+","+l;if(f in Db)s.push(Db[f]);else{var m=a.slice(u,l);Db[f]=m,s.push(m)}}return s}(o,f),j=0;if(O>128){j=Math.floor(i*k.length/l);var C=Math.floor((i+1)*k.length/l);k=k.filter(function(e,t){return t>=j&&t<C})}if(void 0===k[0])return u.a.createElement("div",null);k[0].length;var S=Object(Zh.a)(f);return n&&(k=[]),u.a.createElement("div",{onMouseDown:function(e){e.stopPropagation(),g()},className:E},u.a.createElement(Dh,{scale:v,track:o}),!m&&O>128&&!n?u.a.createElement(Rb,{partNumber:i,track:o,trackColor:c,sequencerEngine:r}):"",k.map(function(e,t){return u.a.createElement(Pb,{isMini:m,key:t,trackColor:c,sequencerEngine:r,resolution:f,show:p,barLength:S,isSelectedTrack:d,trackLengthMode:a,id:s,stepNumbers:e,stepsInRow:y,partNumber:isNaN(i)?0:i,chunk:t,track:o})}),u.a.createElement(Uh,{track:o,trackColor:t,isTrackFrozen:n}),u.a.createElement(Gh.a,{stepsInRow:y,trackLengthMode:a,isSelectedTrack:d,trackColor:c,resolution:f,setTrackLengthMode:h,track:o}))}),Ab=Object(m.b)(function(e,t){var n=t.sequencerEngine.getSequenceId(),a=e.sequencer.currentGlobalStep[n]||0,r=(e.tracks.tracksFrozen[t.track.subSequence.id]||{})[t.track.id],c=void 0,o=void 0;if(t.track.length>128){c=Math.floor(a%t.trackData.length/128),o=t.track.length/128;var s=e.mix.selectedTrack==t.trackNumber,i=t.sequencerEngine.cursor.getStep();s&&!t.sequencerEngine.playing&&(c=Math.floor(i/128))}e.steps.stepsSelection;return{numberParts:o,resolution:e.sequencer.displayResolution,partNumber:c,isTrackFrozen:r,trackLengthMode:e.tracks.trackLengthMode,stepsLength:e.tracks.trackStepIds[t.track.id]&&e.tracks.trackStepIds[t.track.id].length}},function(e){return{setTrackLengthMode:function(t){return e(Object(f.Af)(t))}}})(Ib),Lb=new h.a,Fb=Object(m.b)(function(e,t){var n=e.mix.selectedTrack===t.track.trackNumber,a=t.track,r=a;return a&&a.tracks&&a.tracks[0]&&(r=a.tracks[0].track),{trackId:a.id,id:r.presetName?r.presetName:void 0!==r.sample&&void 0!==r.sample.getId()?r.sample.getId():r.getName(),isSelectedTrack:n,resolution:e.sequencer.displayResolution,muted:e.tracks.trackMutes[t.track.id],trackLength:a.length}},function(e){return{setStepNumberDraggingFrom:function(t){return e(Object(f.ff)(t))},setSelectedPianoRollSteps:function(t){return e(Object(f.ge)(t))},setStepsSelection:function(t){return e(Object(f.jf)(t))},mouseDown:function(t){return e(Object(f.l)(t))}}})(function(e){var t=e.track,n=e.id,a=e.isSelectedTrack,r=e.resolution,c=e.mouseDown,o=e.setSelectedPianoRollSteps,s=e.setStepsSelection,l=e.onTrackRendered,f=e.setStepNumberDraggingFrom,m=e.isHiding,p=e.setIsHiding,d=e.sequencerScale,h=e.muted,b=e.trackLength,v=Object(i.useRef)(void 0),g=Lb.getColorForTrack(t),E=Lb.brighten(void 0===n?"#353535c7":g,.64),O=t.sequencerEngine;Object(i.useEffect)(function(){setTimeout(function(){l(t,v)},100)},[b]);var y=Object(i.useCallback)(function(){c(!1);var e=O.store.getState().steps.stepsSelection;if(void 0!==e&&e.toStep-e.fromStep>0){var n=t.getEasyPattern().getSelectedSteps(e,r);0===n.length?o(void 0):o(n)}s(void 0),f(void 0)},[t,r]),k=Object(i.useCallback)(function(e){t.sequencerEngine.selectTrack(t.trackNumber)},[t]),j=Object(i.useCallback)(function(){p(m===t?void 0:t)},[m,p]),C=m===t;if(m&&m!==t)return[];var S="track";return m&&(S+=" hiding"),S+=a?" selected":" not-selected",h&&(S+=" muted"),u.a.createElement("div",{ref:v,style:{},onMouseDown:k,onMouseUp:y,className:S},u.a.createElement("div",{className:"track-inner"},u.a.createElement(en.a,{hasBorder:!0,isSelectedTrack:a,onMouseDown:function(e){e.stopPropagation(),k()},track:t,sample:t.sample,onClickThumbnail:j}),C?u.a.createElement(ar.a,{color:E,track:t}):u.a.createElement(Ab,{sequencerScale:d,key:1,isSelectedTrack:a,sequencerEngine:t.sequencerEngine,store:t.sequencerEngine.store,trackNumber:t.trackNumber,id:n,trackColor:E,sample:t.sample,track:t,isMini:!0,trackData:t})),u.a.createElement("div",{style:{color:g},className:"delete-track-trash",onClick:function(){return t.sequencerEngine.deleteTrack(t.trackNumber)}},"x"))}),zb=n(610);function Bb(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return _b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function _b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Hb=Object(m.b)(function(e,t){return{coords:e.windows.windowPositions[t.sequencer.id],isSelected:e.windows.selectedElements[t.sequencer.id],tracks:t.sequencer.tracks,numTracks:t.sequencer.tracks.length,isStarred:e.effects.effectStarred[t.sequencer.id]}},function(e,t){return{setStarred:function(n){return e(Object(f.Hb)(t.sequencer.id,n))},setTrackDragging:function(t){return e(Object(f.uf)(t))},setSampleDragging:function(t){return e(Object(f.Qd)(t))},setSampleTagDragging:function(t){return e(Object(f.Td)(t))}}})(function(e){var t=e.sequencer,n=e.scale,a=(e.pad,e.scrollContainer),r=e.elements,c=e.sizeRef,o=e.size,l=e.setSize,f=e.isCurrent,m=e.setTrackDragging,p=e.numTracks,d=e.setOrdering,h=e.isStarred,b=e.setStarred,v=e.coords,g=e.ordering,E=e.setSampleDragging,O=e.setSampleTagDragging,y=e.isSelected,k=Object(i.useRef)(void 0),j=Object(i.useState)({}),C=Object(s.a)(j,2),S=C[0],w=C[1],P=Object(i.useState)(!1),N=Object(s.a)(P,2),x=N[0],q=N[1],T=Object(i.useRef)(void 0),M=Object(i.useRef)(void 0),R=Object(i.useCallback)(function(e,t){var n=Object(B.a)({},S);n[e.id]=t,w(n)},[S,w]),D=r?Object($d.a)({scale:n,ref:k,sizeRef:c,sequencerEngine:t.sequencerEngine,windowPosition:v,containerRef:a,size:o,setSize:l,elements:r,element:t,setOrdering:d,ordering:g}):{},I=D.setWindowScale,A=D.style,L=D.adjust,F=D.windowScale,z=D.onContextMenu,_=D.onMouseDown,H=D.onMouseUp,U=(D.setCoords,D.startResizing);Object(i.useEffect)(function(){v&&(t.x=v.x,t.y=v.y)},[v]),Object(i.useEffect)(function(){r&&setTimeout(function(){if(T.current)if(T.current.clientHeight<T.current.scrollHeight){var e={x:M.current,y:T.current.scrollHeight+30};I(e)}else L(t.x,t.y)},50)},[p,I]),Object(i.useEffect)(function(){F&&(M.current=F.x)},[F]);var G=Object(i.useCallback)(function(e){e.stopPropagation(),t.sequencerEngine.switchToSubSequence(t.subSequence.id);var n=t.sequencerEngine.state,a=n.tracks.trackDragging,r=n.selector,c=r.sampleDragging,o=r.sampleTagDragging,s=t.subSequence,i=t.sequencerEngine;if((a||c||o)&&s.pads.length,a){var u,l=Bb(t.subSequence.sequencers);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(f!==t&&f.tracks.includes(a)){f.removeTrack(a);break}}}catch(d){l.e(d)}finally{l.f()}t.addTrack(a)}else if(c)i.addSound(c).then(function(e){return t.addTrack(e)});else if(o){var p=i.state.selector.sampleTagDragging;Array.isArray(p)||(p=[p]),i.searchForSounds(p,void 0,void 0,void 0,!0).then(function(e){return t.addTrack(e)})}m(void 0),E(void 0),O(void 0)},[]),W=Object(B.a)({},A);F&&0!==F.x&&(x?(W.minWidth=F.x,W.minHeight=F.y):(W.width=F.x,W.height=F.y)),v&&(W.left=v.x,W.top=v.y);var V=x||!F?1:F.x/420;1!=V&&(t.scale=V);var X="pulled-sequencer";return f&&(X+=" current"),y&&(X+=" selected"),u.a.createElement("div",{style:W,onDrop:G,onContextMenu:z,onMouseDown:_,onMouseUp:H,ref:k,className:X},u.a.createElement("div",{className:"pulled-header"},u.a.createElement("div",{className:"header-name"},"Sequencer"),u.a.createElement("div",{onClick:function(){return b(!h)},className:h?"starred star":"star"},u.a.createElement("span",null,"\u2606")),u.a.createElement("div",{onClick:function(){return t.dispose()},className:"delete-button"},"x")),u.a.createElement("div",{style:r&&V&&!x?{width:W.width/V,maxHeight:W.height/V,transform:"scale("+.95*V+")"}:{},ref:T,className:"inner-sequencer"},0===t.tracks.length&&u.a.createElement("div",{className:"drop-here"},"Drop Tracks Here"),t.tracks.map(function(e){return u.a.createElement(Fb,{onTrackRendered:R,sequencerScale:V,setIsHiding:q,isHiding:x,key:e.id,scrollContainer:a,track:e})})),u.a.createElement("div",{onMouseDown:function(e){return U(zb.b,e)},className:"top-left-edge"}),u.a.createElement("div",{onMouseDown:function(e){return U(zb.a,e)},className:"top-right-edge"}),u.a.createElement("div",{onMouseDown:function(e){return U(zb.d,e)},className:"bottom-left-edge"}),u.a.createElement("div",{onMouseDown:function(e){return U(zb.c,e)},className:"bottom-right-edge"}),t.tracks.map(function(e,r){return u.a.createElement(jh.a,{sequencerScale:V,isMidi:!0,trackPositions:S,number:r,containerRef:a,sequencerEngine:t.sequencerEngine,scale:n,node:e})}))}),Ub=n(885),Gb=Object(m.b)(function(e,t){return{coords:e.windows.windowPositions[t.pad.id],hidden:e.spatial.hiddenObjects[t.pad.id],isSelectedZObject:e.zobject.selectedZObject===t.pad,isSelected:e.windows.selectedElements[t.pad.id],isCurrent:t.pad.subSequence===t.pad.sequencerEngine.currentSubSequence,padsExpand:e.pads.padsExpand}},function(e){return{setSelectedZObject:function(t){return e(Object(f.ne)(t))}}})(function(e){var t=e.hidden,n=e.setOrdering,a=e.ordering,r=e.scale,c=e.pad,o=e.scrollContainer,s=e.elements,l=e.sizeRef,f=e.size,m=e.setSize,p=e.isCurrent,d=e.padsExpand,h=e.coords,b=e.isSelected,v=(e.setSelectedZObject,e.isSelectedZObject,Object(i.useRef)(void 0)),g=Object($d.a)({scale:r,ref:v,sequencerEngine:c.sequencerEngine,windowPosition:h,sizeRef:l,containerRef:o,size:f,setSize:m,elements:s,element:c,isPad:!0,expand:d,setOrdering:n,ordering:a}),E=g.style,O=g.onContextMenu,y=g.onMouseDown,k=g.onMouseUp;g.setCoords;Object(i.useEffect)(function(){h&&(c.x=h.x,c.y=h.y)},[h]);var j="pulled-pad";p&&(j+=" current"),b&&(j+=" selected");var C=Object(B.a)({},E);return h&&(C.left=h.x,C.top=h.y),d&&d.pad===c&&(j+=" expanded"),t?"":u.a.createElement("div",{style:C,onMouseDown:function(e){y(e)},onContextMenu:O,onMouseUp:k,ref:v,className:j},u.a.createElement(Ub.a,{isPulled:!0,scrollContainer:o,pad:c}),u.a.createElement(jh.a,{isRoot:!0,useClick:!0,hideNumber:!0,sequencerEngine:c.sequencerEngine,node:c}),u.a.createElement(ih.a,{effect:c}),u.a.createElement(uh.a,{subSequence:c.subSequence,containerRef:o,effect:c}))}),Wb=(n(1332),Object(m.b)(function(e,t){return{pads:t.subSequence?t.subSequence.pads:t.sequencerEngine.currentSubSequence.pads}},function(e){return{}})(function(e){var t=e.pads,n=e.scrollContainer;return u.a.createElement("div",{className:"pads-container"},t.map(function(e,t){return u.a.createElement(Ub.a,{key:t,scrollContainer:n,pad:e})}))}),n(614)),Vb=function(){function e(t,n){Object(Pe.a)(this,e),this.root={x:0,y:0,w:t,h:n}}return Object(Ne.a)(e,[{key:"fit",value:function(e){var t,n,a;for(t=0;t<e.length;t++)a=e[t],(n=this.findNode(this.root,a.w,a.h))&&(a.fit=this.splitNode(n,a.w,a.h))}},{key:"findNode",value:function(e,t,n){return e.used?this.findNode(e.right,t,n)||this.findNode(e.down,t,n):t<=e.w&&n<=e.h?e:null}},{key:"splitNode",value:function(e,t,n){return e.used=!0,e.down={x:e.x,y:e.y+n,w:e.w,h:e.h-n},e.right={x:e.x+t,y:e.y,w:e.w-t,h:n},e}}]),e}(),Xb=n(1308),Kb=Object(m.b)(function(e,t){return{pulledEffects:e.effects.pulledEffects,currentSubSequence:t.subSequence||t.sequencerEngine.currentSubSequence}},function(e){return{setPulledEffects:function(t){return e(Object(f.Jd)(t))}}})(function(e){var t=e.setHeight,n=e.containerRef,a=e.sizeRef,r=e.setSize,c=e.size,o=e.all,s=e.pulledEffects,l=e.sequencerEngine,f=e.setPulledEffects,m=e.scale,p=e.currentSubSequence,d=(e.playhead,e.noWrapper),h=e.elements,b=e.ordering,v=e.setOrdering,g=Object(i.useRef)(),E=Object(i.useRef)({}),O=Object(i.useCallback)(function(e){f(s.filter(function(t){return t!==e}))},[s]),y=Object(i.useCallback)(function(e){return!!e&&(Object(Xb.a)(e)?o||Object(Xb.a)(e).subSequence===p||Object(Xb.a)(e)===p:!(!e.instrument||!e.instrument.context||e.instrument.context.subSequence!==p)||e.track===p)},[p,o]);Object(i.useEffect)(function(){if(g.current){var e=g.current.getBoundingClientRect().height;t(e)}},[s,t]);var k=s.filter(y),j=k.map(function(e){return u.a.createElement(mh,{key:e.id,isStatic:!d,scale:m,elements:h||E,sizeRef:a,setOrdering:v,ordering:b,containerRef:n,size:c,setSize:r,effects:k,onDelete:function(){return O(e)},sequencerEngine:l,fx:e})});return d?j:u.a.createElement("div",{ref:g,className:"pulled-effects"},j)});function Qb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,a=arguments.length>3?arguments[3]:void 0,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return(e-t)/(n-t)}(e,t,n,a);return a*Math.pow(r,2)}var Yb=function(e,t){return Math.abs(e.y-t.y)},Jb=Object(m.b)(function(e,t){return{playing:t.track.notesTriggered&&Object.keys(t.track.notesTriggered).length>0,notesTriggered:t.track.notesTriggered,disabled:t.track.disabled,volume:t.track.sequencerEngine.playing?t.track.pattern.volume:t.track.volumeParameter.get()}},function(e){return{setParameterSliderDown:function(t){return e(Object(f.ld)(t))}}})(function(e){var t=e.track,n=e.playing,a=e.notesTriggered,r=e.setParameterSliderDown,c=e.toggled,o=e.setSelectedTrack,l=t.disabled,f=Object(i.useState)(!0),m=Object(s.a)(f,2),p=m[0],d=(m[1],Object(i.useRef)(void 0)),h=Object(i.useState)(void 0),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useState)(!1),O=Object(s.a)(E,2),y=O[0],k=O[1],j=Object(i.useState)(!1),C=Object(s.a)(j,2),S=C[0],w=C[1],P=Object(i.useRef)(0),N="grid";n&&(N+=" pressed"),l&&(N+=" disabled");var x={},q=a&&Object.keys(a)[0];q&&(q=parseInt(q),x.filter="hue-rotate("+4*q+"deg)");var T=Object(i.useCallback)(function(e){if(y){e.preventDefault(),e.stopPropagation();var n=e.clientY;e.touches&&(n=e.touches[0].clientY);var a=d.current.getBoundingClientRect(),r=d.current.offsetHeight,c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,a=arguments.length>3?arguments[3]:void 0,r=(e=Math.min(Math.max(0,e),a))/a,c=Math.pow(r,.5);return t+(n-t)*c}(r-(n-a.top),-65,6,r);t.setVolume(c,!1,!1),w({x:e.clientX,y:e.clientY})}},[w,y,t]),M={height:Qb(t.volumeParameter.get(),-65,6,d.current&&d.current.offsetHeight)},R=Object(i.useCallback)(function(e){c?o(t):(r(t.volumeParameter),k(!0),g({x:e.clientX,y:e.clientY}),P.current=(new Date).getTime())},[k,g,c,o,t]),D=Object(i.useCallback)(function(e){var n=(new Date).getTime();S&&Yb(v,S),(!S||Yb(v,S)<=8)&&n-P.current<250&&(t.disabled=!t.disabled),w(void 0),k(!1),r(void 0)},[w,k,S,v]);return Object(i.useEffect)(function(){d.current.addEventListener("touchmove",T,{capture:!0})},[T,w,y,t]),u.a.createElement("div",{ref:d,onMouseMove:T,onMouseDown:R,onTouchStart:R,onMouseUp:D,onMouseLeave:function(){k(!1),w(void 0),r(void 0)},style:x,className:N},p?u.a.createElement(en.a,{onMouseDown:function(e){return e.stopPropagation()},showPresetName:!0,track:t}):"",u.a.createElement("div",{className:y?"volume-indicator":"volume-indicator skinny",style:M}))});n(2449);function Zb(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return $b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function $b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ev=Object(m.b)(function(e,t){return{pulledEffects:e.effects.pulledEffects,pulledSequencers:e.pads.sequencers,numTracks:t.subSequence.tracks&&t.subSequence.tracks.length,collapsed:e.pads.modulesCollapsed[t.subSequence.id]}},function(e){return{setPulledEffects:function(t){return e(Object(f.Jd)(t))},setSelectedPulledElements:function(t){return e(Object(f.ie)(t))},setSize:function(t){return e(Object(f.Qc)(5,t))}}})(function(e){var t=e.setSize,n=e.isExplore,a=e.scale,r=(e.showEffects,e.pulledEffects),c=e.setPulledEffects,o=e.setSelectedPulledElements,l=e.toggled,m=e.setSelectedTrack,p=e.subSequence,h=e.collapsed,b=Object(i.useRef)(void 0),v=Object(i.useRef)({}),g=Object($i.a)({ref:b}),E=g.onContextMenu,O=g.dropdownPos,y=(g.setDropdowPos,Object(Wb.a)({ref:b})),k=y.sizeRef,j=y.ordering,C=y.setOrdering,S=Object(i.useRef)(O),w={width:500,height:500},P=function(e){e.ref;var t=e.elements,n=e.subSequence,a=e.presentationMode;return{arrangeWindows:Object(i.useCallback)(function(){if(t.current){var e=n.sequencerEngine.state.windows.moduleSizes[n.id],r=n.state.windows.selectedElements,c=[];for(var o in r)r[o]&&c.push(o);var s=[],i=[];for(var u in t.current)if(!(c.length>0)||c.includes(u)){var l=t.current[u].current;if(l){var m={element:l,id:u,h:l.offsetHeight+15,w:l.offsetWidth+15};s.push(m),i.push(Object(B.a)({},m,{x:l.offsetLeft,y:l.offsetTop}))}}s.sort(function(e,t){return Math.max(t.w,t.h)-Math.max(e.w,e.h)});var p,h,b=e.width||200,v=e.height||200;c.length>0&&(p=Math.min.apply(Math,Object(d.a)(i.map(function(e){return e.x}))),h=Math.min.apply(Math,Object(d.a)(i.map(function(e){return e.y}))),b=Math.max.apply(Math,Object(d.a)(i.map(function(e){return e.x+e.w})))-p,v=Math.max.apply(Math,Object(d.a)(i.map(function(e){return e.y+e.h})))-h),new Vb(b,2*v).fit(s);for(var g={},E=0,O=s;E<O.length;E++){var y=O[E];y.fit&&(c.length>0?g[y.id]={x:y.fit.x+p,y:y.fit.y+h}:g[y.id]=Object(B.a)({},y.fit))}console.log("BULK ARRANGING"),a?n.dispatch(Object(f.T)(g)):n.dispatch(Object(f.U)(g))}},[t,n,a])}}({ref:b,elements:v,subSequence:p,size:w}).arrangeWindows,N=Object(i.useState)(void 0),x=Object(s.a)(N,2),q=x[0],T=x[1],M=Object(gh.a)({containerRef:b,scale:a}).getXY,R=Object(Eh.a)({elements:v}).getSelection,D=Object(i.useCallback)(function(e){var t=M(e),n=t.x,a=t.y;T({x1:n,y1:a,x2:n,y2:a})},[T,a]),I=Object(i.useCallback)(function(e){var t=M(e),n=t.x,a=t.y;T(Object(B.a)({},q,{x2:n,y2:a}))},[q,T,a]),A=Object(i.useCallback)(function(e){if(q&&q.x2-q.x1>1){var t,n={},a=Zb(R(q));try{for(a.s();!(t=a.n()).done;)n[t.value.id]=!0}catch(r){a.e(r)}finally{a.f()}o(n)}q&&T(void 0)},[q,T]);Object(i.useEffect)(function(){O&&(S.current=O)},[O]);var L=[0,1,2],F=p.tracks,z=void 0===F?[]:F;z=z.filter(function(e){return n||void 0===e.pad});var _=Object(i.useCallback)(function(e){var t=Object(cr.c)(e,p),n=S.current,a=n.x,o=n.y;t.x=a,t.y=o,p.midiEffects.addEffect(t),c([].concat(Object(d.a)(r),[t]))},[p,r]),H=Object(i.useCallback)(function(e){p.sequencerEngine.switchToSubSequence(p.id)},[p]),U=Object(i.useCallback)(function(){var e=p.createSequencer(),t=S.current,n=t.x,a=t.y;e.x=n,e.y=a},[p]),G=Object(i.useCallback)(function(){var e=p.createPad(),t=S.current,n=t.x,a=t.y;e.x=n,e.y=a},[p]);if(!p||!p.tracks)return[];var W=u.a.createElement("div",null,!n&&u.a.createElement(Oh.a,{selection:q,scale:a,elements:v,containerRef:b}),u.a.createElement(Zi.a,{className:"midi-context",dropdownPos:O?{x:O.x/a,y:O.y/a}:void 0},u.a.createElement(eu.a,{onMouseDown:U},"New Sequencer"),u.a.createElement(eu.a,{onMouseDown:G},"New Pad"),u.a.createElement(eu.a,{onMouseDown:P},"Arrange Windows"),u.a.createElement("div",{className:"context-divider"}),cr.e.map(function(e){var t=e.label,n=e.value;return u.a.createElement(eu.a,{onMouseDown:function(){return _(n)}},t)})),n&&u.a.createElement("div",{className:"grid-rows"},[0,1,2,3,4].map(function(e){return u.a.createElement("div",{key:e,className:"grid-row"},L.map(function(t){return z[3*e+t]?u.a.createElement(Jb,{scale:a,toggled:l,setSelectedTrack:m,key:3*e+t,track:z[3*e+t],row:e,col:t}):""}))})),u.a.createElement(Kb,{scale:a,sizeRef:k,setSize:t,size:w,ordering:j,setOrdering:C,playhead:!0,elements:v,containerRef:b,noWrapper:!0,sequencerEngine:p.sequencerEngine,subSequence:p}),!n&&p.pads.map(function(e){return u.a.createElement(Gb,{key:e.id,scale:a,size:w,ordering:j,setOrdering:C,setSize:t,sizeRef:k,elements:v,scrollContainer:b,pad:e})}),!n&&u.a.createElement(kh.a,{containerRef:b,scale:a,subSequence:p}),!n&&p.tracks.map(function(e){return u.a.createElement(ph,{scale:a,ordering:j,setOrdering:C,size:w,setSize:t,sizeRef:k,elements:v,containerRef:b,track:e})}),!n&&p.pads.filter(function(e){return e.effectRack}).map(function(e){return u.a.createElement(yh,{scale:a,ordering:j,setOrdering:C,size:w,setSize:t,sizeRef:k,elements:v,containerRef:b,pad:e})}),!n&&p.sequencers.map(function(e){return u.a.createElement(Hb,{ordering:j,setOrdering:C,scrollContainer:b,scale:a,size:w,setSize:t,sizeRef:k,elements:v,sequencer:e})}));return u.a.createElement("div",{onClick:H,onMouseDown:D,onMouseMove:I,onMouseUp:A,onContextMenu:E,className:h?"grids collapsed":"grids not-collapsed"},u.a.createElement(vh,{subSequence:p}),u.a.createElement("div",{ref:b,style:{},className:"grids-inner"},h?u.a.createElement(eh.a,{subSequence:p}):W))}),tv=n(760),nv=(n(2450),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.onClickCancel,a=Object(i.useState)(""),r=Object(s.a)(a,2),l=r[0],f=r[1],m=Object(i.useState)(8),p=Object(s.a)(m,2),d=p[0],h=p[1],b=Object(i.useState)(.1),v=Object(s.a)(b,2),g=v[0],E=v[1],O=Object(i.useState)(!1),y=Object(s.a)(O,2),k=y[0],j=y[1],C=Object(i.useState)(!1),w=Object(s.a)(C,2),P=(w[0],w[1]),N=Object(i.useCallback)(Object(o.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.next=3,Object(tv.b)(t,l,d,g*Math.pow(10,18));case 3:P(!0),j(!1);case 5:case"end":return e.stop()}},e)})),[g,l,d,j,P]);return u.a.createElement(x.a,{dialogClassName:"mint-modal preset-modal render-modal",show:!0,onHide:n},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,"Mint NFT")),u.a.createElement(x.a.Body,null,k?u.a.createElement(S.a,{text:"Minting your nft"}):u.a.createElement("div",null,u.a.createElement("input",{placeholder:"Title your work",value:l,type:"text",onChange:function(e){return f(e.target.value)}}),u.a.createElement("div",{className:"editions"},u.a.createElement("div",{className:"value"},"Editions: ",d),u.a.createElement(be.a,{value:d,change:function(e){return h(e.target.value)},step:1,max:1e3,min:1,orientation:"horizontal",reversed:!1})),u.a.createElement("div",{className:"price"},u.a.createElement("div",{className:"value"},"Price: ",g," eth"),u.a.createElement(be.a,{value:g,change:function(e){return E(e.target.value)},step:.001,max:1,min:.001,orientation:"horizontal",reversed:!1})))),u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{variant:"secondary",onClick:N},"Mint!"),u.a.createElement(q.b,{variant:"primary",onClick:n},"Cancel")))}));function av(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return rv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rv(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function rv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var cv=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a,r,o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.a.encryption.getPotentialUsers();case 2:t=e.sent,[],n=[],a=av(t),e.prev=6,a.s();case 8:if((r=a.n()).done){e.next=16;break}return o=r.value,e.next=12,We.a.users.getUserName(o);case 12:(s=e.sent)&&""!==s&&n.push({id:o,userName:s});case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),a.e(e.t0);case 21:return e.prev=21,a.f(),e.finish(21);case 24:return console.log("USERS =",n),e.abrupt("return",n);case 26:case"end":return e.stop()}},e,null,[[6,18,21,24]])}));return function(){return e.apply(this,arguments)}}(),ov=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.onSharedWithChanged,n=(e.guildId,Object(i.useState)("")),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useState)([]),l=Object(s.a)(o,2),f=l[0],m=l[1],p=Object(i.useState)([]),h=Object(s.a)(p,2),b=h[0],v=h[1],g=Object(i.useState)([]),E=Object(s.a)(g,2),O=E[0],y=E[1];Object(i.useEffect)(function(){},[m]),Object(i.useEffect)(function(){t(f)},[f]),Object(i.useEffect)(function(){cv().then(function(e){return v(e)})},[v]);var k=Object(i.useCallback)(function(e){m([].concat(Object(d.a)(f),[e])),c(""),y([])},[f,m,y]),j=Object(i.useCallback)(function(e){"Enter"===e.key&&k(r)},[m,r,f]);Object(i.useEffect)(function(){if(""===r.trim())y([]);else{var e=b.filter(function(e){return e.userName.toLowerCase().includes(r.toLowerCase())});y(e)}},[r,y]);var C=Object(i.useCallback)(function(e){m(f.filter(function(t){return t!==e}))},[m,f]);return u.a.createElement("div",{className:"share-with-people"},u.a.createElement("div",{className:"people-input-container"},f.map(function(e){return u.a.createElement("div",{className:"shared-user"},e,u.a.createElement("div",{onClick:function(){return C(e)},className:"delete-user"},"x"))}),u.a.createElement("input",{placeholder:"Type collaborators to share this with",className:"people-input",value:r,type:"text",onKeyDown:j,onChange:function(e){return c(e.target.value)}})),u.a.createElement("div",{className:"auto-completion-users"},O.map(function(e){return u.a.createElement("div",{onClick:function(){return k(e.userName)},className:"auto-completed-user"},e.userName)})))});function sv(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return iv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iv(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function iv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var uv=function(e){return new Promise(function(){var t=Object(o.a)(c.a.mark(function t(n){var a,r,o,s,i,u,l,f,m,p,h;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=We.a.users,r=We.a.guilds,o=void 0,s=Object(d.a)(e),t.t0=e,t.next=6,a.getUserName();case 6:t.t1=t.sent,t.t0.push.call(t.t0,t.t1),i=sv(e),t.prev=9,i.s();case 11:if((u=i.n()).done){t.next=23;break}return l=u.value,t.next=15,a.getUserId(l);case 15:return f=t.sent,t.next=18,r.getGuildsForUser(f);case 18:m=t.sent,m=new Set(m.map(function(e){return e.guildId})),o=void 0===o?m:lv(o,m);case 21:t.next=11;break;case 23:t.next=28;break;case 25:t.prev=25,t.t2=t.catch(9),i.e(t.t2);case 28:return t.prev=28,i.f(),t.finish(28);case 31:if(o=Array.from(o),p=void 0,0!==o.length){t.next=40;break}return t.delegateYield(c.a.mark(function t(){var o,i,u,l,f,m,d;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.join(","),t.next=3,r.newGuild(o);case 3:i=t.sent;case 4:return t.next=7,r.getGuildsForUser();case 7:if(u=t.sent,console.log("GUILDS found =",u),!(p=u.find(function(e){return e.name===o}))){t.next=13;break}return p=p.guildId,t.abrupt("break",17);case 13:return t.next=15,Object(Ve.a)(2e3);case 15:t.next=4;break;case 17:r.saveGuildKey(p,i),n(p),l=sv(s),t.prev=20,l.s();case 22:if((f=l.n()).done){t.next=31;break}return m=f.value,t.next=26,a.getUserId(m);case 26:return d=t.sent,t.next=29,r.requestToAddMember(p,d);case 29:t.next=22;break;case 31:t.next=36;break;case 33:t.prev=33,t.t0=t.catch(20),l.e(t.t0);case 36:return t.prev=36,l.f(),t.finish(36);case 39:return t.abrupt("return",{v:void 0});case 40:case"end":return t.stop()}},t,null,[[20,33,36,39]])})(),"t3",35);case 35:if("object"!==typeof(h=t.t3)){t.next=38;break}return t.abrupt("return",h.v);case 38:t.next=41;break;case 40:p=o[0];case 41:n(p);case 42:case"end":return t.stop()}},t,null,[[9,25,28,31]])}));return function(e){return t.apply(this,arguments)}}())},lv=function(e,t){var n,a=[],r=sv(e);try{for(r.s();!(n=r.n()).done;){var c=n.value;t.has(c)&&a.push(c)}}catch(u){r.e(u)}finally{r.f()}var o,s=sv(t);try{for(s.s();!(o=s.n()).done;){var i=o.value;e.has(i)&&a.push(i)}}catch(u){s.e(u)}finally{s.f()}return new Set(a)},fv=Object(m.b)(function(e,t){t.sequencerEngine,t.id,t.renderLength;return{currentTime:e.freeze.offlineEngine&&e.freeze.offlineEngine.context&&Math.floor(e.freeze.offlineEngine.context._context.currentTime),currentExportInfo:e.freeze.currentExportInfo}},null)(function(e){var t=e.currentTime,n=void 0===t?0:t,a=e.renderLength,r=e.width,c=void 0===r?380:r,o=e.currentExportInfo,s=n/(a*(new ke.a.Time("1n").toMilliseconds()/1e3)),i={width:c*s},l=o;return u.a.createElement("div",{className:"progress-bar"},u.a.createElement("div",{className:"inner-progress-bar"},u.a.createElement("div",{className:"progress",style:i}),u.a.createElement("div",{className:"loading-text"},l?"Exporting "+l.name+" "+(l.index+1)+"/"+l.total+" ":"Exporting Project ","(",Math.round(100*s),"%)...")))}),mv=n(303);function pv(e){var t=e.sequencerEngine,n=(e.selectedGuild,t.getAllRecordingsToSave().length);return 0===n?u.a.createElement("div",null):u.a.createElement("div",{className:"save-recordings"},"You have ",n," new sounds to",u.a.createElement("span",{onClick:function(){return t.saveAnyNewRecordings(0)},className:"save-recordings-button"},"save"),".")}function dv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var hv=function(e){Object(xe.a)(n,e);var t=dv(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={sequenceHash:void 0,creatingLink:!1},a}return Object(Ne.a)(n,[{key:"getLink",value:function(){return window.explore?"https://zequencer.io/explore/"+this.state.sequenceHash:"https://zequencer.io/v3/"+this.state.sequenceHash}},{key:"copyLink",value:function(){var e=this,t=this.linkInput;t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),this.setState({copied:!0}),setTimeout(function(){return e.setState({copied:!1})},1e3)}},{key:"createLink",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({creatingLink:!0}),e.next=3,this.props.sequencerEngine.save(void 0,_n.c,!1);case 3:t=e.sent,this.setState({sequenceHash:t,creatingLink:!1});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"exportToWAV",value:function(){Object(mv.a)(this.props.sequencerEngine)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"link-creator"},u.a.createElement(He.a,{condition:void 0===this.state.sequenceHash},u.a.createElement("div",{onClick:function(){return e.createLink()},className:"link-button"},"Create Public Link")),u.a.createElement(He.a,{condition:void 0!==this.state.sequenceHash},u.a.createElement("div",null,"Link: ",u.a.createElement("input",{type:"text",value:this.getLink(),id:"linkInput",ref:function(t){e.linkInput=t}})),u.a.createElement("div",{onClick:function(){return e.copyLink()},className:"small-button pink-button"},"Copy Link"),u.a.createElement("div",{className:"clear-fix"}),u.a.createElement(He.a,{condition:this.state.copied},u.a.createElement("div",{className:"copied-info"},"Copied to clipboard!"))),u.a.createElement("div",{onClick:function(){return e.props.onClickExport()},className:"link-button export-to-wav-btn"},"Export to WAV"))}}]),n}(i.Component),bv=n(1250);function vv(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var gv=function(e){Object(xe.a)(n,e);var t=vv(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={nameValue:"",numTokens:1,saveOption:_n.b,metamaskInstalled:!0,showBuying:!1,sequenceHash:void 0,copied:!1,selectedGuild:void 0,guildOptions:[],renderLength:64,mintNFT:!1,renderOption:bv.b,shareWith:[],formingGuild:!1},a.input=void 0,a.onClickDone=a.onClickDone.bind(Object(Cn.a)(a)),a.onClickCancel=a.onClickCancel.bind(Object(Cn.a)(a)),a.onClickExport=a.onClickExport.bind(Object(Cn.a)(a)),We.a.tokenizedSequences.callback=function(){return a.onBalanceUpdated()},a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.show&&e.show!==this.props.show&&this.getGuilds(),e.show||e.show===this.props.show||(this.state.sequenceHash=void 0,this.state.copied=!1),!0}},{key:"getGuilds",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.a.guilds.getGuildsForUser();case 2:t=e.sent,void 0!==this.props.selectedGuild&&this.setState({saveOption:_n.a}),this.setState({selectedGuild:this.props.selectedGuild||t[0],guildOptions:t.filter(function(e){return e.name.split(",").length<2})});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.show!=e.show){this.input&&this.input.focus();var n=this.props.sequencerEngine.sequenceId;0===n&&-1===n&&void 0===n||We.a.guildSequences.getGuildSequence(n).then(function(e){e?(console.log("GUILD SEQUENCE =",e),t.setState({sequenceGuildId:e.guildId})):t.setState({sequenceGuildId:void 0})})}return!0}},{key:"onClickDone",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({showExportMode:!1}),!this.state.showBuying){e.next=6;break}We.a.tokenizedSequences.buyTokens(parseInt(this.state.numTokens)),this.setState({onPurchased:!0,showBuying:!1}),e.next=18;break;case 6:if(t=this.state.shareWith,n=void 0,!(this.state.saveOption===_n.b&&t.length>0)){e.next=17;break}return this.setState({formingGuild:!0}),e.next=12,uv(t);case 12:n=e.sent,this.setState({formingGuild:!1}),this.props.onSave(this.state.nameValue,_n.a,{guildId:n}),e.next=18;break;case 17:this.props.onSave(this.state.nameValue,this.state.saveOption,this.state.selectedGuild);case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickCancel",value:function(){if(this.state.showBuying)this.setState({showBuying:!1});else{this.setState({showExportMode:!1,mintNFT:!1}),this.props.onHide();var e=this.props.sequencerEngine.state.freeze.offlineEngine;console.log("OFFLINE ENGINE =",e),e&&(console.log("SUSPENDING"),e.stop(),e.context._context.suspend(e.context._context.currentTime+.5).then(function(){console.log("DISPOSING"),e.dispose()}))}}},{key:"onInputType",value:function(e){this.setState({nameValue:e})}},{key:"handleCheckboxChange",value:function(e){this.setState({saveOption:e.target.name})}},{key:"onTokenType",value:function(e){""===e&&this.setState({numTokens:0}),Object(nn.a)(e)&&this.setState({numTokens:e})}},{key:"onSelectGuild",value:function(e){this.setState({selectedGuild:e})}},{key:"showExportMode",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({showExportMode:e})}},{key:"onClickExport",value:function(){var e=this;this.setState({bouncing:!0}),setTimeout(Object(o.a)(c.a.mark(function t(){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(mv.a)(e.props.sequencerEngine,e.state.renderLength,e.state.renderOption);case 2:e.setState({bouncing:!1}),e.onClickCancel(),e.onClickCancel();case 5:case"end":return t.stop()}},t)})),80)}},{key:"onChangeRenderLength",value:function(e){try{var t=parseInt(e);this.setState({renderLength:t})}catch(n){}}},{key:"login",value:function(){this.props.setShowLogin(!0)}},{key:"render",value:function(){var e=this;return this.state.mintNFT?u.a.createElement(nv,{onClickCancel:function(){return e.onClickCancel()},sequencerEngine:this.props.sequencerEngine}):this.state.showExportMode?u.a.createElement(x.a,{dialogClassName:"preset-modal render-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,"Export Project")),u.a.createElement(x.a.Body,null,u.a.createElement("div",{className:"render-options"},u.a.createElement("div",{className:"render-label"},"Rendered Track"),u.a.createElement("div",{onClick:function(){return e.setState({renderOption:bv.b})},className:this.state.renderOption===bv.b?"selected render-option":"render-option"},"Master"),u.a.createElement("div",{onClick:function(){return e.setState({renderOption:bv.a})},className:this.state.renderOption===bv.a?"selected render-option":"render-option"},"Groups")),u.a.createElement("div",{className:"render-length"},u.a.createElement("div",{className:"render-label"},"Render Length"),u.a.createElement("input",{onChange:function(t){return e.onChangeRenderLength(t.target.value)},className:"render-length-input",value:this.state.renderLength})),this.state.bouncing?u.a.createElement(fv,{renderLength:this.state.renderLength}):""),u.a.createElement(x.a.Footer,null,this.state.bouncing?"":u.a.createElement(q.b,{variant:"secondary",onClick:this.onClickExport},"Export"),this.state.bouncing?"":u.a.createElement(q.b,{variant:"primary",onClick:this.onClickCancel},"Cancel"))):this.props.userToken?u.a.createElement(x.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,"Save Project")),u.a.createElement(x.a.Body,null,u.a.createElement("input",{value:this.state.nameValue,onChange:function(t){return e.onInputType(t.target.value)},ref:function(t){e.input=t},placeholder:"Type name of project",className:"tag-input"}),u.a.createElement("form",null,u.a.createElement("input",{name:_n.c,type:"checkbox",checked:this.state.saveOption===_n.c,onChange:function(t){return e.handleCheckboxChange(t)}}),u.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(bn.N)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Public"),u.a.createElement("input",{name:_n.b,value:_n.b,type:"checkbox",checked:this.state.saveOption===_n.b,onChange:function(t){return e.handleCheckboxChange(t)}}),u.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(bn.L)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Private"),u.a.createElement("input",{name:_n.a,value:_n.a,type:"checkbox",checked:this.state.saveOption===_n.a,onChange:function(t){return e.handleCheckboxChange(t)}}),u.a.createElement("label",{onMouseOver:function(){return e.props.setContextualHelp(bn.L)},onMouseLeave:function(){return e.props.setContextualHelp(void 0)}},"Guild")),u.a.createElement(pv,{selectedGuild:this.state.selectedGuild,sequencerEngine:this.props.sequencerEngine}),u.a.createElement(He.a,{condition:this.state.saveOption===_n.b},u.a.createElement(ov,{guildId:this.state.sequenceGuildId,onSharedWithChanged:function(t){return e.setState({shareWith:t})}}),this.state.formingGuild?u.a.createElement(S.a,{text:"Creating encrypted group"}):""),u.a.createElement(He.a,{condition:this.state.saveOption===_n.a},u.a.createElement(In,{onSelectGuild:function(t){return e.onSelectGuild(t)},selectedGuild:this.state.selectedGuild,guildOptions:this.state.guildOptions})),u.a.createElement(hv,{onClickMint:function(){return e.setState({mintNFT:!0})},onClickExport:function(){return e.showExportMode(!0)},sequencerEngine:this.props.sequencerEngine})),this.state.formingGuild?"":u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{variant:"secondary",onClick:this.onClickDone},"Save"),u.a.createElement(q.b,{variant:"primary",onClick:this.onClickCancel},"Cancel"))):u.a.createElement(x.a,{dialogClassName:"preset-modal save-modal",show:this.props.show,onHide:this.onClickCancel},u.a.createElement(x.a.Header,{closeButton:!0},u.a.createElement(x.a.Title,null,"Save Sequence")),u.a.createElement(x.a.Body,null,u.a.createElement("div",{className:"no-metamask"},u.a.createElement("span",{onClick:function(){return e.login()},className:"login-btn"},"Login")," to save your song to your account."),u.a.createElement(hv,{onClickMint:function(){return e.setState({mintNFT:!0})},onClickExport:function(){return e.showExportMode(!0)},sequencerEngine:this.props.sequencerEngine})),u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{variant:"secondary",onClick:this.onClickCancel},"Done")))}}]),n}(i.Component);var Ev=Object(m.b)(function(e){return{selectedGuild:e.guilds.selectedGuild,userToken:e.sequencer.userToken}},function(e){return{setShowLogin:function(t){return e(Object(f.Ge)(t))},setContextualHelp:function(t){return e(Object(f.hb)(t))}}})(gv),Ov=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=Object(i.useState)(!1),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useCallback)(function(e,n,a){t.save(e,n,!0,a),c(!1)},[c,t]);return u.a.createElement("div",null,u.a.createElement(Ev,{sequencerEngine:t,onSave:o,onHide:function(){return c(!1)},show:r}),u.a.createElement("div",{onClick:function(){return c(!0)},className:"work-save-button"}))}),yv=Object(m.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{setWorksLoaded:function(t){return e(Object(f.mg)(t))}}})(function(e){var t=e.setWorksLoaded,n=e.multiSequencerEngine,a=e.sequencerEngine,r=e.worksLoaded,c=Object(i.useCallback)(function(){var e=Object.values(n.idToSequencerEngine).filter(function(e){return e!==a});e.forEach(function(e){return a.subSequences=[].concat(Object(d.a)(a.subSequences),Object(d.a)(e.subSequences))}),e.forEach(function(e){return n.unloadTrack(e.getSequenceId(),!1)});var c=r.filter(function(e){return e.newSequence===a.getSequenceId()});t(c)},[r,a]);return r&&r.length>1?u.a.createElement("div",{onClick:c,className:"combine-works-button"},"Combine Projects"):""}),kv=new h.a,jv=Object(m.b)(function(e,t){var n=t.sequencerEngine.idToSequencerEngine[t.work.newSequence];return n?{worksLoaded:e.explore.worksLoaded,numSubSequences:n&&n.subSequences.length,pulledEffects:e.effects.pulledEffects}:{}},function(e){return{}})(function(e){var t=e.work,n=e.sequencerEngine,a=Object(i.useState)(!1),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(void 0),f=Object(s.a)(l,2),m=f[0],p=f[1],d=n.idToSequencerEngine[t.newSequence];return d?(Object(i.useEffect)(function(){c||p(void 0)},[c,p]),u.a.createElement("div",{className:"explore-work"},c&&m?u.a.createElement(ar.a,{color:kv.getColorForTrack(m),track:m}):d.subSequences.map(function(e){return u.a.createElement(ev,{isExplore:!0,setSelectedTrack:p,toggled:c,subSequence:e,sequencerEngine:d})}),u.a.createElement(rr,{setToggled:o,toggled:c}),u.a.createElement(yv,{multiSequencerEngine:n,sequencerEngine:d}),u.a.createElement(Ov,{sequencerEngine:d}))):""}),Cv=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.pendingComments,n=Object(i.useState)(""),a=Object(s.a)(n,2),r=a[0],c=a[1];Object(i.useEffect)(function(){_e.a.getUserName().then(c)},[c]);var o=Object(d.a)(t);return o.reverse(),o.map(function(e){return u.a.createElement("div",null,u.a.createElement("div",{className:"annotation"},u.a.createElement("div",{className:"author"},r,":"),u.a.createElement("div",{className:"content"},e)))})}),Sv=new h.a,wv={},Pv=function(e){var t=e.annotation,n=e.style,a=Object(i.useState)(""),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(""),f=Object(s.a)(l,2),m=f[0],d=f[1],h=Object(i.useState)([]),b=Object(s.a)(h,2),v=b[0],g=b[1];return Object(i.useEffect)(function(){var e=W.a.utils.fromAscii(t.annotationData),n=Object(et.a)(e);wv[n]?o(wv[n]):p.a.getJson(n).then(function(e){wv[n]=e,o(e)}),We.a.users.getUserName(t.address).then(function(e){return d(e)})},[t,o,d]),Object(i.useEffect)(function(){We.a.xanadu.getContentReferences(t.annotationData).then(g)},[t,g]),u.a.createElement("div",{style:n,className:"annotation"},u.a.createElement("div",{className:"author"},m,":"),u.a.createElement("div",{className:"content"},c),u.a.createElement("div",{className:"references"},v.map(function(e){return u.a.createElement("div",{style:{backgroundColor:Sv.getColorForHash(e)},className:"dot content-reference"})})))},Nv=function(e){var t=e.works,n=e.linkType,a=void 0===n?"SEQUENCE_ANNOTATION":n,r=Object(i.useState)([]),c=Object(s.a)(r,2),o=c[0],u=c[1];return Object(i.useEffect)(function(){var e;(e=We.a.xanadu).getFlattenedAnnotations.apply(e,[a].concat(Object(d.a)(t.map(function(e){return e.newSequence})))).then(function(e){u(Object(d.a)(e))})},[t,u]),{comments:o}},xv=(new h.a,Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.works,n=e.linkType,a=Nv({works:t,linkType:void 0===n?"SEQUENCE_ANNOTATION":n}).comments,r={};return a.reverse(),u.a.createElement("div",null,a.map(function(e){return u.a.createElement(Pv,{style:r,key:e.annotationData,annotation:e})}))})),qv=(new h.a,Object(m.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{}})(function(e){var t=e.worksLoaded,n=e.linkType,a=void 0===n?"SEQUENCE_ANNOTATION":n,r=Object(i.useState)(""),c=Object(s.a)(r,2),o=c[0],l=c[1],f=Object(i.useState)([]),m=Object(s.a)(f,2),p=m[0],h=m[1];Object(i.useEffect)(function(){h([])},[t]);var b=Object(i.useCallback)(function(){t.map(function(e){var t=e.newSequence;return We.a.xanadu.newAnnotationContent(a,t,o)}),l(""),h([].concat(Object(d.a)(p),[o]))},[t,o,l,p,h]);return 0===t.length?[]:u.a.createElement("div",{className:"comments-pane"},u.a.createElement("div",{className:"work-comments"},u.a.createElement(xv,{works:t}),u.a.createElement(Cv,{pendingComments:p})),u.a.createElement(q.g,{type:"textarea",value:o,className:"comment-text",placeholder:"Write a comment here",onChange:function(e){return l(e.target.value)}}),u.a.createElement("div",{onClick:b,className:""===o?"submit-comment-btn disabled":"submit-comment-btn"},"Send"))}));function Tv(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Mv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mv(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Mv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Rv=(new(n(1085).a)).contractAddress,Dv=W.a.utils.padLeft("0x0",64),Iv=function(){return new Je.a(Rv)},Av=function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ye.a(tt.e,"deleteList",[Object(et.c)(t)]).execute();case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Lv=function(){var e=Object(o.a)(c.a.mark(function e(t,n,a,r){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ye.a(tt.e,"bulkEdit",[t.map(function(e){return Object(et.c)(e)}),n.map(function(e){return e?Object(et.c)(e):Dv}),a.map(function(e){return W.a.utils.fromAscii(e)}),r]).execute();case 2:case"end":return e.stop()}},e)}));return function(t,n,a,r){return e.apply(this,arguments)}}(),Fv=function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Iv().from($e.g).select("newContent").select("previousContent").select("title"),e.t0=zv,e.t1=Bv,e.next=5,t.executeQuery();case 5:return e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.next=9,(0,e.t0)(e.t3);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),zv=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.map(function(e){return e.newContent}),n=Iv().from($e.f).select("contentHash"),e.t0=Set,e.next=5,n.executeQuery();case 5:return e.t1=e.sent.map(function(e){return e.contentHash}),a=new e.t0(e.t1),e.abrupt("return",t.filter(function(e){return!a.has(e.newContent)}));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Bv=function(e){var t,n={},a=Tv(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;r.previousContent&&r.previousContent!==r.newContent&&(n[r.newContent]=r.previousContent)}}catch(m){a.e(m)}finally{a.f()}var c,o={},s=Tv(e);try{for(s.s();!(c=s.n()).done;){var i=c.value,u=_v(i.newContent,n);u in o||(o[u]=[]),o[u].push(i)}}catch(m){s.e(m)}finally{s.f()}var l=[];for(var f in o)o[f].sort(function(e,t){return t.blockNumber-e.blockNumber}),l.push(o[f][0]);return l},_v=function e(t,n){var a=n[t];return void 0===a?t:e(a,n)};function Hv(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Uv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uv(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Uv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Gv=Object(m.b)(function(e,t){return{unpublished:e.explore.unpublished}},function(e){return{setExploreUnpublished:function(t){return e(Object(f.Sb)(t))}}})(function(e){var t=e.setExploreUnpublished,n=e.unpublished;Object(i.useEffect)(function(){var e=l.a.getItem("unsavedLists");e&&t(JSON.parse(e))},[]);var a=Object(i.useCallback)(Object(o.a)(c.a.mark(function e(){var a,r,o,s,i,u,f,m,d;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=[],r=[],o=[],s=[],i=Hv(n),e.prev=5,i.s();case 7:if((u=i.n()).done){e.next=21;break}return f=u.value,e.next=11,p.a.addJson(f);case 11:m=e.sent,d=f.hash,f.hash=m,f.newContent=m,a.push(m),r.push(d),o.push(f.name),s.push(0);case 19:e.next=7;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(5),i.e(e.t0);case 26:return e.prev=26,i.f(),e.finish(26);case 29:l.a.setItem("publishingLists",JSON.stringify(n)),l.a.removeItem("unsavedLists"),Lv(a,r,o,s),t(void 0);case 33:case"end":return e.stop()}},e,null,[[5,23,26,29]])})),[n]);return n&&0!==n.length?u.a.createElement("div",{onClick:a,className:"save-unpublished-btn"},"Publish Changes ",u.a.createElement("span",{className:"unpublished-count"},n.length)):u.a.createElement("div",null)}),Wv=Object(m.b)(function(e,t){return{projectDragging:e.explore.projectDragging}},function(e){return{setProjectDragging:function(t){return e(Object(f.Hd)(t))},setExploreUnpublished:function(t){return e(Object(f.Sb)(t))}}})(function(e){var t=e.hide,n=e.projectDragging,a=e.setProjectDragging,r=e.list,f=e.setExploreUnpublished,m=e.onDelete,p=Object(i.useState)(""),h=Object(s.a)(p,2),b=h[0],v=h[1],g=Object(i.useState)([]),E=Object(s.a)(g,2),O=E[0],y=E[1],k=Object(i.useState)(void 0),j=Object(s.a)(k,2),C=j[0],S=j[1],P=Object(i.useState)(void 0),N=Object(s.a)(P,2),x=N[0],q=N[1];Object(i.useEffect)(function(){r&&(y(r.projects),v(r.name),S(r.image))},[r]);var T=Object(i.useCallback)(function(e){n&&(y([].concat(Object(d.a)(O),[n])),a(void 0))},[n,O,y]),M=Object(i.useCallback)(function(e){if(x){var t=O.indexOf(x),n=Object(d.a)(O);n.splice(t,1);var a=n.indexOf(e);n=[].concat(Object(d.a)(n.slice(0,a)),[x],Object(d.a)(n.slice(a))),q(void 0),y(n)}},[x,y,O,q]),R=Object(i.useCallback)(function(e){var t=O.indexOf(e),n=Object(d.a)(O);n.splice(t,1),y(n)},[O,y]),D=Object(i.useCallback)(Object(o.a)(c.a.mark(function e(){var n,a,o,s,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={name:b,title:b,projects:O,image:C,id:Object(xc.uuid)()},r&&(n.hash=r.newContent,n.newContent=r.newContent),a=(a=l.a.getItem("unsavedLists"))?JSON.parse(a):[],!(r&&a.length>0)){e.next=16;break}e.t0=c.a.keys(a);case 6:if((e.t1=e.t0()).done){e.next=14;break}if(o=e.t1.value,!((s=a[o]).name===r.name||r.hash&&s.hash===r.hash)){e.next=12;break}return a[o]=n,e.abrupt("break",14);case 12:e.next=6;break;case 14:e.next=17;break;case 16:a.push(n);case 17:i=JSON.stringify(a),l.a.setItem("unsavedLists",i),f(a),t(n);case 21:case"end":return e.stop()}},e)})),[b,O,C,t,r]);return u.a.createElement("div",{className:"new-list"},u.a.createElement("div",{onDrop:T,onDragOver:function(e){return e.preventDefault()},className:"inner"},u.a.createElement("input",{placeholder:"Type name for list",value:b,onChange:function(e){return v(e.target.value)},type:"text"}),u.a.createElement("div",{className:"projects"},O.map(function(e){return u.a.createElement("div",{key:e.newSequence,onDrop:function(){return M(e)},onDragOver:function(e){return e.preventDefault()},onDragStart:function(){return q(e)},draggable:!0,className:"project"},u.a.createElement("div",{className:"project-name"},e.title),u.a.createElement("div",{onClick:function(){return R(e)},className:"delete-btn"},"x"))})),u.a.createElement("div",{className:"drop-here"},u.a.createElement("span",null,"Drop projects here")),u.a.createElement("div",{className:"btns"},u.a.createElement("div",{onClick:D,className:"done-btn"},"Done"),u.a.createElement("div",{onClick:function(){return t()},className:"cancel-btn"},"Cancel"))),u.a.createElement("div",{className:"inner"},u.a.createElement(w.a,{imageHash:C,setImageHash:S}),r?u.a.createElement("div",{onClick:function(){window.confirm("Confirm delete")&&m()},className:"delete-list-btn"},"Delete List"):""))}),Vv=Object(m.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{}})(function(e){var t=e.loadWork,n=Object(i.useState)(!1),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useState)(!1),l=Object(s.a)(o,2),f=l[0],m=l[1],d=Object(i.useState)(Object(B.a)({},e.list)),h=Object(s.a)(d,2),b=h[0],v=h[1],g={backgroundImage:"url("+p.a.getHashUrl(b.image)+")"};Object(i.useEffect)(function(){_e.a.getAccount().then(function(e){e&&(b.user?c(e.toLowerCase()===b.user.toLowerCase()):c(!0))})},[c]);var E=Object(i.useCallback)(function(t){t&&(v(t),e.onListChanged(t)),m(!1)},[v,m]),O=Object(i.useCallback)(function(t){var n="project";return e.worksLoaded.some(function(e){return e.newSequence===t.newSequence})&&(n+=" loaded"),n},[e.worksLoaded]);return Object(i.useEffect)(function(){e.list.projects[0]&&0===e.worksLoaded.length&&t(b.projects[0])},[]),f?u.a.createElement(Wv,{onDelete:e.onDelete,list:b,hide:E}):u.a.createElement("div",{style:g,className:"list"},r?u.a.createElement("div",{onClick:function(){return m(!0)},className:"edit-button"},"Edit"):"",u.a.createElement("div",{className:"projects"},b.projects.map(function(e){return u.a.createElement("div",{onClick:function(){return t(e)},className:O(e)},e.title)})),u.a.createElement("div",{className:"list-title"},b.name),u.a.createElement("div",{onClick:e.removeList,className:"delete-btn"},"x"))}),Xv=(n(2451),Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.creatingNewList,n=e.lists,a=(e.hide,e.loadWork),r=e.removeList,c=e.onListChanged;return u.a.createElement("div",{className:"lists-container"},n.map(function(e,t){return u.a.createElement(Vv,{onListChanged:c,onDelete:function(){c(e,!0),r(e)},removeList:function(){return r(e)},key:e.name,loadWork:a,list:e})}),t?u.a.createElement(Wv,{hide:c}):"",u.a.createElement(Gv,null))})),Kv=Object(m.b)(function(e,t){return{personSelected:e.explore.personSelected}},function(e){return{setPersonSelected:function(t){return e(Object(f.Qb)(t))}}})(function(e){var t=e.onNewList,n=e.personSelected,a=e.setPersonSelected,r=e.children,c=Object(i.useState)(void 0),o=Object(s.a)(c,2),l=o[0],f=o[1],m=Object(i.useState)(!1),p=Object(s.a)(m,2),d=p[0],h=p[1];return Object(i.useEffect)(function(){n?We.a.users.getUserName(n).then(f):f(void 0)},[n,f]),u.a.createElement("div",{className:"explore-toolbar"},u.a.createElement("div",{className:"toolbar-btn"},u.a.createElement(q.c,{className:"view-dropdown",show:d?"true":"false",isOpen:d,toggle:function(){return h(!d)}},u.a.createElement(q.f,{size:"sm",caret:!0,color:"primary"},u.a.createElement("img",{className:"explore-commands-icon",src:"/automation-icon-disabled.png"})),u.a.createElement(q.e,null,u.a.createElement(q.d,{onClick:t,key:"",size:"sm"},"New List")))),l?u.a.createElement("div",{onClick:function(){return a(void 0)},className:"user-selected"},l):"",r)}),Qv=function(e){var t=e.work,n=(e.numPending,Object(i.useState)([])),a=Object(s.a)(n,2),r=a[0],c=a[1];return Object(i.useEffect)(function(){t&&We.a.xanadu.getAnnotations("SEQUENCE_TAG",t.newSequence).then(function(e){return c(Array.from(new Set(e.map(function(e){return e.annotationData}))))})},[c,t]),{newTag:Object(i.useCallback)(function(e){""!==e.trim()&&(We.a.xanadu.newAnnotation("SEQUENCE_TAG",t.newSequence,e),c([].concat(Object(d.a)(r),[e])))},[t,r,c]),tags:r,setTags:c}},Yv=Object(m.b)(null,null)(function(e){var t=e.work,n=Object(i.useState)(""),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useRef)(void 0),l=Qv({work:t}),f=l.newTag,m=l.setTags,p=l.tags,d=Object(i.useCallback)(function(e){c(e.target.value)},[c]);Object(i.useEffect)(function(){o.current&&o.current.focus()},[]);var h=Object(i.useCallback)(function(){f(r),c("")},[c,r,p,t,m]);return u.a.createElement("div",{className:"tags-editor"},u.a.createElement("div",{className:"input-container"},u.a.createElement("input",{ref:o,placeholder:"Type tag here",className:"tags-input",type:"text",onChange:d,value:r}),u.a.createElement("div",{onClick:h,className:"tag-button"},"Tag")),u.a.createElement("div",{className:"work-tags"},p.map(function(e){return u.a.createElement("div",{className:"work-tag"},e)})))}),Jv=function(e){var t=e.edit,n=Object(i.useState)(""),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useState)(""),l=Object(s.a)(o,2),f=l[0],m=l[1];return Object(i.useEffect)(function(){We.a.users.getUserName(t.user).then(function(e){return c(e)})},[t,c]),Object(i.useEffect)(function(){We.a.getBlockDate(t.blockNumber).then(function(e){return m(e.toISOString().substring(0,10))})},[m,t]),u.a.createElement("div",{className:"sequence-edit"},u.a.createElement("div",{className:"title"},t.title," -"),u.a.createElement("div",{className:"author"},r),u.a.createElement("div",{className:"date"},f))},Zv=Object(m.b)(function(e,t){return{allSequences:e.explore.allSequences}},null)(function(e){var t=e.work,n=e.allSequences,a=Object(i.useState)([]),r=Object(s.a)(a,2),c=r[0],o=r[1];Object(i.useEffect)(function(){var e=We.a.getEditsForSequence(t.newSequence,n);console.log("edits = ",e),o(e)},[o,t,n]);return u.a.createElement("div",null,u.a.createElement("div",{className:"sequence-edits"},c.map(function(e){return u.a.createElement(Jv,{edit:e})})),u.a.createElement("div",{onClick:function(){window.open("/create/"+t.newSequence)},className:"new-edit-button"},"Create New Edit"))}),$v={},eg=function(e){var t=e.annotation,n=e.style,a=Object(i.useState)(""),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(""),f=Object(s.a)(l,2),m=f[0],d=f[1];return Object(i.useEffect)(function(){var e=W.a.utils.fromAscii(t.annotationData),n=Object(et.a)(e);$v[n]?o($v[n]):p.a.getJson(n).then(function(e){$v[n]=e,o(e)}),We.a.users.getUserName(t.address).then(function(e){return d(e)})},[t,o,d]),u.a.createElement("div",{style:n,className:"annotation"},u.a.createElement("div",{className:"author"},m,":"),u.a.createElement("div",{className:"content"},c))},tg=Object(m.b)(function(e,t){return{numPending:e.transactions.pendingTransactions.length}},null)(function(e){var t=e.work,n=e.contentId,a=void 0===n?t&&t.newSequence:n,r=e.numPending,c=e.linkType,o=void 0===c?"SEQUENCE_ANNOTATION":c,l=e.color,f=Object(i.useState)(""),m=Object(s.a)(f,2),p=m[0],d=m[1],h=Object(i.useState)(!1),b=Object(s.a)(h,2),v=(b[0],b[1]),g=Object(i.useState)([]),E=Object(s.a)(g,2),O=E[0],y=E[1],k=Object(i.useCallback)(function(e){d(e.target.value)},[d]),j=Object(i.useCallback)(function(){We.a.xanadu.newAnnotationContent(o,a,p).then(function(e){return v(!0)}),d(""),v(!0)},[a,p,d,v]);Object(i.useEffect)(function(){a&&We.a.xanadu.getAnnotations(o,a).then(function(e){y(e)})},[a,y,r]);var C={};return l&&(C.backgroundColor=l),u.a.createElement("div",null,u.a.createElement(q.g,{style:C,className:"annotation-text",onChange:k,type:"textarea",value:p}),u.a.createElement("div",{style:C,onClick:j,className:"submit-button"},"Annotate"),u.a.createElement("div",{style:C,className:"annotations"},u.a.createElement(Fn.a,{sizeUnit:"px",size:10,color:"#42f4f1",loading:r>0}),O.map(function(e){return u.a.createElement(eg,{style:C,key:e.annotationData,annotation:e})})))}),ng=(n(2452),function(e){var t=e.annotationsView;if(!t)return u.a.createElement("div",null);var n=["ANNOTATION","TAGS","EDITS"];return u.a.createElement("div",null,u.a.createElement(ag,{annotationsView:t,linkType:n[0],linkNumber:0},u.a.createElement(tg,{work:t})),u.a.createElement(ag,{annotationsView:t,linkType:n[1],linkNumber:1},u.a.createElement(Yv,{work:t})),u.a.createElement(ag,{annotationsView:t,linkType:n[2],linkNumber:2},u.a.createElement(Zv,{work:t})))}),ag=function(e){var t=e.annotationsView,n=e.linkNumber,a=e.linkType,r=e.children,c={left:130+220*n},o=[210+250*t.workNumber,0,130+220*n,80,330+220*n,80];return console.log("points = ",o,t),u.a.createElement("div",null,u.a.createElement("svg",{className:"annotations-svg "+a,height:"80",width:"1000"},u.a.createElement("polygon",{points:o})),u.a.createElement("div",{style:c,className:"annotations-view "+a},r))},rg=0,cg=function(e){var t=e.hideText,n=e.searchOptions,a=e.option,r=e.onClickOption,c=e.baseClass,o=void 0===c?"search-option":c,s=e.selectedClass,i=void 0===s?"selected":s;return u.a.createElement("div",{onClick:function(){return r(a)},className:n.indexOf(a)>-1?o+" "+i:o},t?"":"Starred"===a?u.a.createElement("span",null,"\u2606"):a)},og=function(e){e.searchTerm;var t=e.setSearchTerm,n=e.setSearchOptions,a=e.searchOptions,r=e.setSearchTag,c=e.searchTag,o=Object(i.useState)(""),l=Object(s.a)(o,2),f=l[0],m=l[1],p=Object(i.useCallback)(function(e){var r=++rg,c=e.target.value;setTimeout(function(){rg===r&&(t(c),(a.includes("Starred")||a.includes("Favorited"))&&n(a.filter(function(e){return"Starred"!==e&&"Favorited"!==e})))},750),m(e.target.value)},[m,t,a,n]),h=Object(i.useCallback)(function(e){if(-1==a.indexOf(e))n("Lists"===e||"Projects"===e?[e]:[e].concat(Object(d.a)(a)));else{var t=a.filter(function(t){return t!==e});console.log("setting search options = ",t),n(t)}},[a,n]);return u.a.createElement("div",{className:"explore-search-container"},c?u.a.createElement("div",{onClick:function(){return r(void 0)},className:"search-tag"},c):"",u.a.createElement("div",{className:"heart-and-soul"},u.a.createElement(cg,{hideText:!0,baseClass:"heart",selectedClass:"favorited",onClickOption:h,searchOptions:a,option:"Favorited"}),u.a.createElement("div",null),u.a.createElement(cg,{baseClass:"star",selectedClass:"starred",onClickOption:h,searchOptions:a,option:"Starred"})),u.a.createElement(cg,{onClickOption:h,searchOptions:a,option:"Lists"}),u.a.createElement(cg,{onClickOption:h,searchOptions:a,option:"Projects"}),u.a.createElement("input",{type:"text",value:f,onChange:p,className:"explore-search",placeholder:"Type to search"}),u.a.createElement("div",{onClick:function(){t(""),m(""),r(void 0)},className:"search-clear-btn"},"x"))},sg=n(76),ig=function(e){return{type:3,work:e}},ug=function(e,t){return{type:8,sequenceId:e,color:t}},lg=n(570);function fg(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}function mg(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}n(1283);var pg=n(1375),dg=n(886);function hg(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var bg=function(e){Object(xe.a)(n,e);var t=hg(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return n}(function(e){return function(e){Object(xe.a)(n,e);var t=mg(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"saveMix",value:function(){var e=Object(o.a)(c.a.mark(function e(t,n){var a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,_e.a.getAccount();case 3:return e.t1=e.sent,e.t2=this.events,e.t3=this.worksLoaded,e.t4=this.initialState,a={title:e.t0,user:e.t1,events:e.t2,works:e.t3,initialState:e.t4},n=void 0===n?W.a.utils.padLeft("0x0",64):Object(et.c)(n),e.next=11,p.a.addJson(a);case 11:return r=e.sent,o=this.worksLoaded.map(function(e){return Object(et.c)(e.newSequence)}),new Ye.a(tt.o,"newMix",[Object(et.c)(r),n,t,o,0]).execute(),e.abrupt("return",a);case 15:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadMix",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("LOAD MIX CALLED!"),this.unloadAll(),this.events=t.events,this.initialState=t.initialState||{worksLoaded:t.works},this.store.dispatch(Object(f.Ob)(t)),console.log("mix loaded =",t),n=Array.from(new Set([].concat(Object(d.a)(this.initialState.worksLoaded),Object(d.a)(t.works)))),e.t0=c.a.keys(n);case 8:if((e.t1=e.t0()).done){e.next=15;break}return a=e.t1.value,console.log("loading work =",n[a]),e.next=13,this.loadWork(n[a]);case 13:e.next=8;break;case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"clearMix",value:function(){this.clearScheduledEvents(),this.initialState=void 0,this.events=[],this.store.dispatch(Object(f.Ob)(void 0))}}]),n}(e)}(function(e){Object(xe.a)(n,e);var t=fg(n);function n(){var e;Object(Pe.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).events=[],e.hasEdits=!1,e}return Object(Ne.a)(n,[{key:"isRecordingMix",get:function(){return this.state.explore.isRecordingMix}},{key:"currentTransportTime",get:function(){var e=parseFloat(ke.a.Transport.position.split(":")[2]);return"0:0:"+(e-Math.floor(e)+this.trackStep/2)}},{key:"dispatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.currentTransportTime,a=e.sequenceId&&this.getSequencerEngine(e.sequenceId);switch(e.type){case 1:this.switchToPattern(a,e.subSequenceId,e.patternNumber);break;case 2:this.playWork(e.work);break;case 3:this.loadWork(e.work);break;case 4:this.unloadWork(e.work);break;case 5:this.changeTranspose(a,e.transpose);break;case 6:this.changeVolume(a,e.volume);break;case 8:this.changeColor(a,e.color);break;case 7:this.changeBPM(e.bpm)}!t&&this.isRecordingMix&&(e=Object(B.a)({},e,{time:n}),this.events.push(e),this.hasEdits=!0)}},{key:"playWork",value:function(e){this.play(e),this.isNothingPlaying()&&this.clearScheduledEvents()}},{key:"worksLoaded",get:function(){return this.state.explore.worksLoaded}},{key:"loadWork",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("MultiMix.loadWork =",t),!this.worksLoaded.some(function(e){return e.newSequence===t.newSequence})){e.next=5;break}return n=this.getSequencerEngine(t.newSequence),this.setWorkDefaults(n),e.abrupt("return");case 5:return this.store.dispatch(Object(f.mg)([].concat(Object(d.a)(this.worksLoaded),[t]))),e.next=8,this.loadTrack(t.newSequence);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"unloadWork",value:function(e){if(this.worksLoaded.some(function(t){return t.newSequence===e.newSequence})){var t=Object(d.a)(this.worksLoaded),n=t.indexOf(e);t.splice(n,1),this.store.dispatch(Object(f.mg)(t)),this.unloadTrack(e.newSequence)}}},{key:"switchToPattern",value:function(e,t,n){e&&(e.switchToSubSequence(t),e.switchToPattern(n))}},{key:"changeColor",value:function(e,t){e&&(e.channelMixer.mixEffects.filter=t,this.store.dispatch(Object(f.Lc)(e.sequenceId,t)))}},{key:"changeTranspose",value:function(e,t){e&&(e.transpose=t,this.store.dispatch(Object(f.kg)(e.sequenceId,t)))}},{key:"changeVolume",value:function(e,t){e&&(e.setMasterVolume(t,.05),this.store.dispatch(Object(f.lg)(e.sequenceId,t)))}},{key:"changeBPM",value:function(e){this.updateBpm(e)}},{key:"setInitialValuesForMix",value:function(){if(this.initialState){var e=this.initialState,t=e.workVolumes,n=e.worksLoaded,a=e.workTransposes,r=e.mixColorValues,c=e.bpm;for(var o in c&&this.changeBPM(c),t){var s=this.getSequencerEngine(o);s&&this.changeVolume(s,t[o])}for(var i in a){var u=this.getSequencerEngine(i);u&&this.changeTranspose(u,a[i])}for(var l in n)this.loadWork(n[l]);for(var f in r){var m=this.getSequencerEngine(f);m&&this.changeColor(m,r[f])}}}},{key:"saveInitialValuesForMix",value:function(){var e=this.store.getState();this.initialState={worksLoaded:Object(d.a)(e.explore.worksLoaded),workTransposes:Object(B.a)({},e.explore.workTransposes),workVolumes:Object(B.a)({},e.explore.workVolumes),bpm:e.user.bpm,mixColorValues:Object(B.a)({},e.explore.mixColorValues)}}},{key:"playMix",value:function(e){var t=this;e?(this.isRecordingMix?this.saveInitialValuesForMix():this.setInitialValuesForMix(),this.eventIds=this.events.map(function(e){return ke.a.Transport.schedule(function(n){2===e.type&&(n=0),setTimeout(function(){t.dispatch(e,!0)},n)},e.time)}),this.play()):(this.clearScheduledEvents(),this.stop())}},{key:"clearScheduledEvents",value:function(){this.eventIds&&(this.eventIds.forEach(function(e){return ke.a.Transport.clear(e)}),this.eventIds=[])}},{key:"setWorkDefaults",value:function(e){this.changeTranspose(e,0),this.changeVolume(e,0)}},{key:"hasEdits",set:function(e){this.store.dispatch(Object(f.Nc)(e))}},{key:"unloadAll",value:function(){this.clearMix(),this.stop(),this.hasEdits=!1;var e=Object(d.a)(this.worksLoaded);for(var t in e)this.unloadWork(e[t])}}]),n}(function(){function e(t){Object(Pe.a)(this,e),this.store=t,this.idToSequencerEngine={},this.headSequencerEngine=void 0,this.sequencerEnginesToPlay=[],this.sequenceIdQueue=[],window.sequencerEngine=this,this.initAubio()}return Object(Ne.a)(e,[{key:"getHead",value:function(){return this.idToSequencerEngine[Object.keys(this.idToSequencerEngine)[0]]}},{key:"state",get:function(){return this.store.getState()}},{key:"trackStep",get:function(){for(var e in this.idToSequencerEngine){var t=this.idToSequencerEngine[e].trackStepReal;if(t>0)return t}return 0}},{key:"initAubio",value:function(){var e=this;window.Aubio().then(function(t){e.aubio=t})}},{key:"sampleRate",set:function(e){lg.a.setSampleRate(e)}},{key:"stop",value:function(){for(var e in this.idToSequencerEngine)this.idToSequencerEngine[e].stop();ke.a.Transport.stop()}},{key:"updateBpm",value:function(e){for(var t in this.idToSequencerEngine)this.idToSequencerEngine[t].updateBpm(e)}},{key:"getSequencerEngine",value:function(e){return void 0===e?this.idToSequencerEngine[Object.keys(this.idToSequencerEngine)[0]]:this.idToSequencerEngine[e]}},{key:"stepOneCallback",value:function(e){this.sequencerEnginesToPlay.forEach(function(t){var n=ke.a.Transport.getTicksAtTime(e),a=new ke.a.TransportTime(n,"i");t.play(a)}),this.sequencerEnginesToPlay=[]}},{key:"getSamplerPlaySequence",value:function(){return null}},{key:"isNothingPlaying",value:function(){return 0===this.getSequencesPlaying().length}},{key:"getSequencesPlaying",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.store.getState().sequencer.isPlaying;return Object.keys(this.idToSequencerEngine).filter(function(n){return!1===e&&void 0===t[n]||t[n]===e})}},{key:"unloadTrack",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.idToSequencerEngine[e];n.playing&&n.stop(),delete this.idToSequencerEngine[e];var a=this.sequenceIdQueue.indexOf(e);a>-1&&this.sequenceIdQueue.splice(a,1),this.store.dispatch(Object(f.kc)(e,void 0)),t&&setTimeout(function(){n.dispose()},500)}},{key:"loadTrack",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getSequencesPlaying(!1),this.sequenceIdQueue.length>7&&(n.length>0?this.unloadTrack(n[0]):(a=this.sequenceIdQueue.shift(),this.unloadTrack(a))),this.store.dispatch(Object(f.Bc)(t,!0)),(r=new pg.default(this.store,!0,void 0,this.aubio)).channelMixer.connectMixEffects(),o=new dg.a(r,!0),r.setScripting(o),r.multiSequencerEngine=this,r.loadedSequenceId=t,r.setMasterVolume(1),this.sequenceIdQueue.push(t),this.idToSequencerEngine[t]=r,this.store.dispatch(Object(f.kc)(t,!1)),e.next=15,r.loadSequence(t);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"initSamplerTrack",value:function(){}},{key:"sequenceRolling",value:function(){for(var e in this.idToSequencerEngine){if(this.idToSequencerEngine[e].isSequenceRolling)return!0}return!1}},{key:"play",value:function(e){var t=this,n=this.getSequencerEngine(e&&e.id);if(void 0!==n){n.playing&&this.getSequencesPlaying(!0).length,e&&e.playing&&this.setHeadSequencerEngine(void 0);var a=this.getSequencesPlaying(!0);0==this.getSequencesPlaying(!0).length||n.playing?(this.store.dispatch(Object(f.lc)(!0)),n.playing||0!=a.length||this.setHeadSequencerEngine(n),n.play()):this.sequencerEnginesToPlay.push(n),(a=a.map(function(e){return t.idToSequencerEngine[e]}).filter(function(e){return e!==n})).length>0&&a.every(function(e){return void 0===e.stepOneCallback})&&this.setHeadSequencerEngine(a[0])}}},{key:"setHeadSequencerEngine",value:function(e){var t=this;void 0!==e||void 0===this.headSequencerEngine?(this.headSequencerEngine=e,this.headSequencerEngine.stepOneCallback=function(e){return t.stepOneCallback(e)}):this.headSequencerEngine.stepOneCallback=void 0}}]),e}())));function vg(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var gg=function(e){Object(xe.a)(n,e);var t=vg(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"render",value:function(){return 0===this.props.numPending?u.a.createElement("div",null):u.a.createElement("div",{className:"pending-transactions"},"Syncing ",this.props.numPending," items",u.a.createElement(Fn.a,{sizeUnit:"px",size:8,color:"#6200ff",loading:!0}))}}]),n}(i.Component),Eg=Object(m.b)(function(e,t){return{numPending:e.transactions.pendingTransactions.length}},null)(gg),Og=n(1269);function yg(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var kg=function(e){Object(xe.a)(n,e);var t=yg(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={password:"",incorrectPassword:!1,needsToSetPassword:!1,userName:void 0},a.onClickDone=a.onClickDone.bind(Object(Cn.a)(a)),a.onClickCancel=a.onClickCancel.bind(Object(Cn.a)(a)),a}return Object(Ne.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.show&&e.show!==this.props.show&&(this.getNeedsToSetPassword(),this.getUserName()),!0}},{key:"getUserName",value:function(){var e=Object(o.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,_e.a.getUserName();case 3:e.t1=e.sent,e.t2={userName:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getNeedsToSetPassword",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.a.encryption.getPublicKey();case 2:t=e.sent,console.log("ethereum.getPublicKey() returned = "),console.log(t),void 0===t&&this.setState({needsToSetPassword:!0});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){return e.show!==this.props.show&&(console.log("password input = "),console.log(this.input.passwordInput),this.input.passwordInput.focus()),!0}},{key:"onClickDone",value:function(){var e=Object(o.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.crypto.isCorrectPassword(this.state.password);case 2:if(e.sent){e.next=7;break}return this.setState({incorrectPassword:!0}),e.abrupt("return");case 7:this.setState({incorrectPassword:!1});case 8:this.props.setShowPasswordModal(!1),console.log("passwordModalCallback("+this.state.password+")"),this.props.passwordModalCallback(this.state.password);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickCancel",value:function(){this.props.passwordModalCallback(void 0),this.props.setShowPasswordModal(!1)}},{key:"handleChange",value:function(e){this.setState({password:e.target.value})}},{key:"onKeyDown",value:function(e){"Enter"===e.key&&this.onClickDone()}},{key:"render",value:function(){var e=this;return u.a.createElement(x.a,{dialogClassName:"preset-modal",show:this.props.show,onHide:function(){return e.props.setShowPasswordModal(!1)}},u.a.createElement(x.a.Body,null,u.a.createElement(He.a,{condition:this.state.incorrectPassword},u.a.createElement("div",{className:"incorrect-password"},"Incorrect password")),u.a.createElement(He.a,{condition:void 0!==this.state.userName},"Password required to access",u.a.createElement("div",{className:"password-user-name"},this.state.userName)),u.a.createElement(He.a,{condition:this.state.needsToSetPassword},"Create a password to be used to encrypt your projects. Remember the password you choose."),u.a.createElement("div",{className:"password-container"},u.a.createElement(wn.a,{id:"password",name:"password",placeholder:"Enter password",onKeyDown:function(t){return e.onKeyDown(t)},ref:function(t){return e.input=t},value:this.state.password,onChange:this.handleChange.bind(this)}))),u.a.createElement(x.a.Footer,null,u.a.createElement(q.b,{variant:"secondary",onClick:this.onClickDone},"Done"),u.a.createElement(q.b,{variant:"primary",onClick:this.onClickCancel},"Cancel")))}}]),n}(i.Component),jg=Object(m.b)(function(e){return{show:e.sequencer.showPasswordModal,passwordModalCallback:e.sequencer.passwordModalCallback}},function(e){return{setShowPasswordModal:function(t){return e(Object(f.Ke)(t))}}})(kg);n(2453);function Cg(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Sg=new h.a,wg=function(e){Object(xe.a)(n,e);var t=Cg(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={isAuthorized:!1,toggled:!1,guilds:[]},We.a.store=a.props.store,_e.a.setStore(a.props.store),_e.a.setEthereum(We.a),_e.a.checkLogin(),a.getGuilds(),a.getUserName(),a}return Object(Ne.a)(n,[{key:"componentDidMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.userToken!==e.userToken&&(this.getGuilds(),this.getUserName()),this.state.toggled,t.toggled,!0}},{key:"getUserName",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.getUserName();case 2:t=e.sent,this.setState({userName:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getGuilds",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.a.guilds.getGuildsForUser();case 2:if(t=e.sent,n=l.a.getItem("selectedGuild"))try{(n=JSON.parse(n))&&t.some(function(e){return e.guildId===n.guildId})&&this.props.setSelectedGuild(t.find(function(e){return e.guildId===n.guildId}))}catch(a){}this.setState({guilds:t.filter(function(e){return!e.name.includes(",")})});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onClickLogIn",value:function(){this.props.setSigningUp(!1),this.props.setShowLogin(!0)}},{key:"onClickSignUp",value:function(){this.props.setSigningUp(!0),this.props.setShowLogin(!0)}},{key:"onClickLogout",value:function(){_e.a.logout()}},{key:"onClickGuild",value:function(e){void 0!==e&&We.a.crypto.getPassword(),this.props.setSelectedGuild(e),l.a.setItem("selectedGuild",JSON.stringify(e))}},{key:"toggle",value:function(){this.setState({toggled:!this.state.toggled})}},{key:"getSelectedGuild",value:function(){return this.props.selectedGuild?this.props.selectedGuild.name:this.state.userName}},{key:"onClickConnect",value:function(){var e=this;Object(Og.b)().then(function(t){t||Object(Og.a)(),e.setState({isAuthorized:t})})}},{key:"goToGuildsPage",value:function(){}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"guilds-menu"},u.a.createElement(jg,{crypto:We.a.crypto,show:!0}),u.a.createElement(q.c,{className:"view-dropdown guilds-dropdown",show:this.state.toggled?"true":"false",isOpen:this.state.toggled,toggle:function(){return e.toggle()}},_e.a.isLoggedIn()?u.a.createElement(q.f,{size:"sm",caret:!0,color:"primary"},u.a.createElement("div",{style:this.props.selectedGuild&&{backgroundColor:Sg.getColorForHash(this.getSelectedGuild())},className:"not-recording-dot"}),u.a.createElement("span",{className:"guild-name"},this.getSelectedGuild())):u.a.createElement(q.f,{size:"sm",caret:!0,color:"primary"},u.a.createElement("div",{className:"not-recording-dot logged-out"}),"Log In"),u.a.createElement(q.e,null,u.a.createElement(He.a,{condition:!_e.a.isLoggedIn()},u.a.createElement(q.d,{key:"",onClick:function(){return e.onClickLogIn()},size:"sm"},"Log In"),u.a.createElement(q.d,{key:"public",onClick:function(){return e.onClickSignUp()},size:"sm"},"Sign Up")),u.a.createElement(He.a,{condition:_e.a.isLoggedIn()},u.a.createElement("div",{onClick:function(){return e.props.setIsManagingGuilds(!0)},className:"guilds-mgmt-btn"},"Manage Groups"),u.a.createElement(q.d,{key:"public",className:"connect-wallet-option",size:"sm"},this.state.isAuthorized?u.a.createElement("div",{className:"guild-dropdown-option connected-btn"},Pg(this.state.isAuthorized)):u.a.createElement("div",{onClick:function(){return e.onClickConnect(void 0)},className:"guild-dropdown-option connect-wallet-btn"},u.a.createElement("div",null,"Connect Wallet"))),u.a.createElement(q.d,{key:"public",onClick:function(){return e.onClickGuild(void 0)},size:"sm"},u.a.createElement("div",{className:"guild-dropdown-option"},u.a.createElement("div",null,"Everything"),u.a.createElement(Po.a,{className:"guilds-checkmark",condition:void 0===this.props.selectedGuild}))),u.a.createElement("div",{className:"section-header"},"Groups"),this.state.guilds.map(function(t){return u.a.createElement(q.d,{key:t.name,onClick:function(){return e.onClickGuild(t)},size:"sm"},u.a.createElement("div",{className:"guild-dropdown-option"},u.a.createElement("div",{style:{backgroundColor:Sg.getColorForHash(t.name)},className:"dot"}),u.a.createElement("div",null,t.name),u.a.createElement(Po.a,{className:"guilds-checkmark",condition:e.props.selectedGuild===t})))}),u.a.createElement("div",{className:"user-name-item"},u.a.createElement("div",{className:"not-recording-dot"})," ",u.a.createElement("span",{className:"guild-user-name"},this.state.userName)),u.a.createElement("div",{onClick:function(){return e.onClickLogout()},className:"logout-btn"}," Log out ")))))}}]),n}(i.Component),Pg=function(e){return e.length>12?e.slice(0,12)+"...":e},Ng=Object(m.b)(function(e){return{selectedGuild:e.guilds.selectedGuild,userToken:e.sequencer.userToken}},function(e){return{setSelectedGuild:function(t){return e(Object(f.ae)(t))},setShowLogin:function(t){return e(Object(f.Ge)(t))},setSigningUp:function(t){return e(Object(f.af)(t))},setIsManagingGuilds:function(t){return e(Object(f.jc)(t))}}})(wg),xg=function(e){var t=e.name,n=e.option,a=e.selected,r=e.onClick,c="option";return a&&(c+=" selected"),u.a.createElement("div",{onClick:function(){return r(n)},className:c},t)},qg=Object(m.b)(function(e){return{selectedRecord:e.discover.selectedRecord,selectedGuild:e.guilds.selectedGuild,showLogin:e.sequencer.showLogin,option:e.explore.exploreOption,userToken:e.sequencer.userToken}},function(e){return{setOption:function(t){return e(Object(f.Pb)(t))}}})(function(e){e.setSearchTerm,e.searchTerm;var t=e.store,n=e.showLogin,a=e.option,r=e.setOption,c=(e.searchOptions,e.setSearchOptions,Object(i.useState)(!1)),o=Object(s.a)(c,2),l=o[0],f=o[1],m="navigation";return _e.a.isLoggedIn()||(m+=" logged-off"),u.a.createElement("div",{className:m},u.a.createElement(xg,{name:"Home",option:sg.b,selected:a===sg.b,onClick:r}),u.a.createElement(xg,{name:"Guilds",option:sg.a,selected:a===sg.a,onClick:r}),u.a.createElement(xg,{name:"Messages",option:sg.c,selected:a===sg.c,onClick:r}),u.a.createElement("div",{onClick:function(){return f(!0)},className:"preferences-btn"},"Preferences"),u.a.createElement(Ng,{store:t}),u.a.createElement(Eg,null),u.a.createElement(xn,{show:n}),l?u.a.createElement(mt,{hide:function(){return f(!1)},onlyAppearance:!0}):"")}),Tg=function(e){var t=e.person,n=e.selected,a=e.onClick,r=t.userName,c=t.id,o=n?"person selected":"person";return u.a.createElement("div",{onClick:a,className:o},u.a.createElement("div",{className:"name"},r||c))},Mg=(n(724),function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Rg(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Rg=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,a,r,o,s,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a in n=new Set,t)n.add(t[a].user);n=Array.from(new Set(n)),r=[],e.t0=c.a.keys(n);case 5:if((e.t1=e.t0()).done){e.next=14;break}return o=e.t1.value,s=n[o].trim(),e.next=10,We.a.users.getUserName(s);case 10:i=e.sent,r.push({id:s,userName:i}),e.next=5;break;case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Dg=(Object(m.b)(function(e,t){return{personSelected:e.explore.personSelected,allSequences:e.explore.allSequences}},function(e){return{setPersonSelected:function(t){return e(Object(f.Qb)(t))}}})(function(e){var t=e.personSelected,n=e.setPersonSelected,a=e.allSequences,r=Object(i.useState)([]),c=Object(s.a)(r,2),o=c[0],l=c[1];Object(i.useEffect)(function(){Mg(a).then(function(e){return l(e)})},[l,a]);var f="";return t&&(f=u.a.createElement(Tg,{onClick:function(){return n(void 0)},selected:!0,person:t})),u.a.createElement("div",{className:"people"},f,u.a.createElement("div",{className:"people-to-choose"},o.filter(function(e){return!t||t.id!==e.id}).map(function(e){return u.a.createElement(Tg,{onClick:function(){return n(e)},key:e.id,person:e})})))}),function(){var e=Object(o.a)(c.a.mark(function e(t,n,a,r,o,s){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(dn.a)(a,void 0,t,n,r,!1,o,s);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,n,a,r,c,o){return e.apply(this,arguments)}}()),Ig=n(1080),Ag=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Je.a((new Ig.a).contractAddress).from($e.A).select("mixHash").select("previousHash").select("title").select("user"),e.next=3,t.executeQuery(!1);case 3:return n=e.sent,console.log("mix results =",n),e.abrupt("return",n.map(function(e){return Object(B.a)({},e,{type:"MIX"})}));case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function Lg(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Fg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fg(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function Fg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var zg=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a,r,o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fv();case 2:t=e.sent,n=[],a=Lg(t);try{for(a.s();!(r=a.n()).done;)o=r.value,n.push(Object(B.a)({},o,{hash:o.newContent,tags:[],type:"LIST"}))}catch(c){a.e(c)}finally{a.f()}if(s=l.a.getItem("unsavedLists")){e.next=9;break}return e.abrupt("return",n);case 9:return s=JSON.parse(s),n=n.filter(function(e){return!s.some(function(t){return t.hash===e.hash})}),e.abrupt("return",[].concat(Object(d.a)(n),Object(d.a)(s.map(function(e){return Object(B.a)({},e,{id:void 0!==e.id?e.id:Object(xc.uuid)(),title:e.name,unsaved:!0,tags:[],blockNumber:9999999999,type:"LIST"})}))));case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Bg=(new ra.a,function(){var e=Object(o.a)(c.a.mark(function e(t,n,a,r,o,s,i){var u,l,f,m,p,h;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("person selecred == ",i),u=a.includes("Favorited"),l=a.includes("Starred"),e.next=5,Dg(l,u,r,o,s,i);case 5:return f=e.sent.map(function(e){return Object(B.a)({},e,{type:"SEQUENCE"})}),e.next=8,Ag();case 8:return m=e.sent,e.next=11,zg();case 11:p=e.sent,(h=[].concat(Object(d.a)(p),Object(d.a)(m),Object(d.a)(f))).sort(function(e,t){return t.blockNumber-e.blockNumber}),t(Object(d.a)(h)),n(!1);case 16:case"end":return e.stop()}},e)}));return function(t,n,a,r,c,o,s){return e.apply(this,arguments)}}()),_g=Object(m.b)(function(e,t){return{exists:t.sequencerEngine.events.length>0}},null)(function(e){var t=e.sequencerEngine,n=e.exists,a=e.originalMix,r=Object(i.useState)(void 0),l=Object(s.a)(r,2),f=l[0],m=l[1],p=Object(i.useState)(""),d=Object(s.a)(p,2),h=d[0],b=d[1],v=Object(i.useState)(""),g=Object(s.a)(v,2),E=g[0],O=g[1],y=Object(i.useCallback)(function(){t.clearMix(),m(void 0)},[m]);Object(i.useEffect)(function(){a&&We.a.users.getUserName(a.user).then(function(e){return O(e)})},[a]);var k=Object(i.useCallback)(Object(o.a)(c.a.mark(function e(){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.saveMix(a?a.title:h,a&&a.mixHash);case 2:n=e.sent,m(n);case 4:case"end":return e.stop()}},e)})),[h,m,a]);return n?a?u.a.createElement("div",{className:"recorded-mix"},u.a.createElement("div",{className:"edit-text"},"Edit of ",u.a.createElement("span",{className:"mix-title"},a.title)," by ",u.a.createElement("span",{className:"mix-author"},E)),u.a.createElement("div",{className:"buttons-container"},f?"":u.a.createElement("div",{onClick:k,className:"save-mix-button"},"Save"),u.a.createElement("div",{onClick:y,className:"clear-mix-button"},"Clear"))):u.a.createElement("div",{className:"recorded-mix"},u.a.createElement("div",{className:"mix-title"},void 0===f?u.a.createElement("input",{placeholder:"Enter mix name",className:"mix-input",type:"text",value:h,onChange:function(e){return b(e.target.value)}}):u.a.createElement("div",null,f.title)),u.a.createElement("div",{className:"buttons-container"},f?"":u.a.createElement("div",{onClick:k,className:"save-mix-button"},"Save"),u.a.createElement("div",{onClick:y,className:"clear-mix-button"},"Clear"))):[]}),Hg=Object(m.b)(function(e,t){return{bpm:e.user.bpm}},null)(function(e){var t=e.bpm,n=e.sequencerEngine;return u.a.createElement("div",{className:"bpm-container"},u.a.createElement("div",{className:"bpm-label"},"BPM: ",Math.round(t)),u.a.createElement(be.a,{value:t,change:function(e){return n.dispatch({type:7,bpm:e.target.value})},step:1,className:"bpm-fader",max:250,min:1,orientation:"horizontal",reversed:!1}))}),Ug=Object(m.b)(function(e){return{playingMap:e.sequencer.isPlaying,isRecordingMix:e.mix.isRecordingMix}},function(e){return{setRecordingExploreMix:function(t){return e(Object(f.oc)(t))}}})(function(e){var t=e.sequencerEngine,n=e.isRecordingMix,a=e.playingMap,r=e.setRecordingExploreMix,c=Object.keys(a).filter(function(e){return a[e]}).length>0,o=Object(i.useCallback)(function(){r(!n)},[n,r]),s=Object(i.useCallback)(function(e){t.playMix(!c)},[t,c]);return u.a.createElement("div",{className:"work-mix-buttons"},u.a.createElement(Ah,{isPlaying:c,play:s}),u.a.createElement("div",{onClick:o,className:n?"recording-dot":"not-recording-dot"}))});function Gg(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var Wg=function(e){Object(xe.a)(n,e);var t=Gg(n);function n(e){var a;return Object(Pe.a)(this,n),(a=t.call(this,e)).state={clockDragging:!1,clockStartDragY:void 0,clockDragY:void 0},a}return Object(Ne.a)(n,[{key:"onClockMouseLeave",value:function(e){void 0!=this.seekTimer&&(clearInterval(this.seekTimer),this.seekTimer=void 0)}},{key:"onClockMouseDown",value:function(e){var t=this;void 0!==this.props.sequencerEngine&&(this.state.clockStartDragY=e.clientY,this.seekTimer=setInterval(function(){if(void 0!==t.state.clockDragY){var e=t.state.clockStartDragY-t.state.clockDragY,n=t.props.sequencerEngine.trackStep+5*e;n<0&&(n=0),t.props.sequencerEngine.seekToTrackStep(n)}},50))}},{key:"onClockMouseUp",value:function(e){clearInterval(this.seekTimer),this.seekTimer=void 0}},{key:"onClockMouseMove",value:function(e){this.state.clockDragY=e.clientY}},{key:"onClickMetronome",value:function(){void 0!==this.props.sequencerEngine&&(this.props.sequencerEngine.metronomeOn=!this.props.sequencerEngine.metronomeOn)}},{key:"render",value:function(){var e=this,t=Math.ceil(this.props.currentGlobalStep/32);t=isNaN(t)?1:t;var n=1+Math.floor(this.props.currentGlobalStep/8)%4,a=1+Math.floor(this.props.currentGlobalStep/2)%4,r="clock ";this.props.clockTick&&(r+="percentage-"+this.props.clockTick);var c="metronome";return this.props.metronomeOn&&(this.props.currentGlobalStep/4%4>=2&&(c+=" off-beat"),c+=" on"),u.a.createElement("div",{className:r,onMouseLeave:function(t){return e.onClockMouseLeave(t)},onMouseDown:function(t){return e.onClockMouseDown(t)},onMouseUp:function(t){return e.onClockMouseUp(t)},onMouseMove:function(t){return e.onClockMouseMove(t)}},u.a.createElement("div",{className:"track-time"},t),u.a.createElement("div",{className:"divider"},"."),u.a.createElement("div",{className:"time"},n),u.a.createElement("div",{className:"divider"},"."),u.a.createElement("div",{className:"time"},a),u.a.createElement(vn.a,{element:bn.t,onClick:function(){return e.onClickMetronome()},className:c},u.a.createElement("div",{className:"dot first"}),u.a.createElement("div",{className:"dot second"})))}}]),n}(i.Component),Vg=Object(m.b)(function(e,t){if(void 0===t.sequencerEngine)return{currentStep:0,currentGlobalStep:0,clockTick:0,metronomeOn:!1};var n=t.sequencerEngine.getSequenceId();return{currentStep:e.sequencer.currentStep[n]||0,currentGlobalStep:e.sequencer.currentGlobalStep[n]||0,clockTick:e.clock.clockTick,metronomeOn:t.sequencerEngine.metronomeOn}},null)(Wg),Xg=n(847),Kg=function(e){var t=e.sequencerEngine,n=e.children;return u.a.createElement("div",{className:"mixer-toolbar-container"},u.a.createElement("div",{className:"mixer-toolbar"},u.a.createElement(Hg,{sequencerEngine:t}),u.a.createElement(Ug,{sequencerEngine:t}),u.a.createElement(Vg,{sequencerEngine:t.headSequencerEngine}),u.a.createElement(Xg.a,{sequencerEngine:t})),n)},Qg=(new h.a,Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.work,n=e.showComments,a=e.setSearchTag,r=e.editTags,c=void 0===r||r;t.id=t.newSequence;var o=Object(i.useState)([t]),l=Object(s.a)(o,2),f=l[0],m=(l[1],Nv({works:f}).comments),p=Object(i.useState)(!1),d=Object(s.a)(p,2),h=d[0],b=d[1],v=Qv({work:t}).tags,g=Yt({track:t}),E=g.isStarred,O=g.showStar,y=g.isFavorited,k=g.onStarClicked,j=g.onFavoriteClicked,C=Object(i.useCallback)(function(e,t){e.stopPropagation(),a(t)},[a]),S="work-metadata";return h&&(S+=" showing-tags"),u.a.createElement("div",{className:S},u.a.createElement("div",{className:"metadata-inner"},u.a.createElement("div",{className:"work-tags"},c?"":v.filter(function(e){return e}).map(function(e){return u.a.createElement("div",{onClick:function(t){return C(t,e)},className:"work-tag"},e)})),h?u.a.createElement(Yv,{work:t}):"",u.a.createElement("img",{onClick:function(){return b(!h)},className:h?"show tag-icon":"tag-icon",src:"/tag.svg"}),n&&m.length>0?u.a.createElement("img",{className:"comments-icon",src:"/comments.svg"}):"",u.a.createElement(He.a,{condition:O},u.a.createElement("div",{onClick:k,className:E?"star starred":"star"},u.a.createElement("span",null,"\u2606"))),u.a.createElement("div",{onClick:j,className:y?"heart favorited":"heart"})))})),Yg=(n(1322),["A","B","C","D","E","F","G","H","I","J"]),Jg=Object(m.b)(function(e,t){var n=t.sequencerEngine.engineId;t.sequencerEngine.currentSubSequence.id;return{currentSubSequence:e.sequencer.currentSubSequence[n],subSequences:e.sequencer.subSequences[n]}},null)(function(e){var t=e.sequencerEngine,n=e.currentSubSequence,a=e.subSequences;return u.a.createElement("div",{className:"sub-sequences"},a.map(function(e,a){return u.a.createElement("div",{onClick:function(){return t.switchToSubSequence(e)},className:e===n?"sub-sequence current":"sub-sequence"},Yg[a])}))});function Zg(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(Te.a)(e);if(t){var r=Object(Te.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(qe.a)(this,n)}}var $g=["A","B","C","D","E","F","G","H"],eE=function(e){Object(xe.a)(n,e);var t=Zg(n);function n(){return Object(Pe.a)(this,n),t.apply(this,arguments)}return Object(Ne.a)(n,[{key:"switchPattern",value:function(e){var t,n,a=this.props.sequencerEngine;a.multiSequencerEngine.dispatch((t=a.sequenceId,n=a.currentSubSequence.id,{type:1,sequenceId:t,subSequenceId:n,patternNumber:e}))}},{key:"chooseSubSequence",value:function(e){this.props.sequencerEngine.switchToSubSequence(e)}},{key:"getSubSequencesComponent",value:function(){var e=this,t=this.props.subSequences||[];return u.a.createElement("div",{className:"sub-sequence-buttons"},t.map(function(t,n){return u.a.createElement("div",{key:$g[n],onClick:function(){return e.chooseSubSequence(t)},className:t===e.props.currentSubSequence?"sub-sequence selected":"sub-sequence"},$g[n])}))}},{key:"render",value:function(){var e=this;return void 0===this.props.sequencerEngine.tracks[0]?this.getSubSequencesComponent():u.a.createElement("div",null,u.a.createElement("div",{className:"pattern-buttons"},this.props.sequencerEngine.tracks[0].patterns.map(function(t,n){return u.a.createElement("div",{style:e.props.color&&e.props.currentPattern===n?{backgroundColor:e.props.color}:{},onClick:function(){return e.switchPattern(n)},className:e.props.currentPattern===n?"current pattern-button":"pattern-button"},n+1)})),this.getSubSequencesComponent())}}]),n}(i.Component),tE=Object(m.b)(function(e,t){var n=t.sequencerEngine.engineId,a=t.sequencerEngine.currentSubSequence.id;return{currentPattern:e.sequencer.currentPattern[a]||0,subSequenceId:a,subSequences:e.sequencer.subSequences[n],currentSubSequence:e.sequencer.currentSubSequence[n]}},null)(eE),nE=-70,aE=6;var rE=Object(m.b)(function(e,t){return{masterVolume:e.sequencer.masterVolumes[t.id]}},null)(function(e){var t=e.masterVolume,n=(e.id,e.multiSequencerEngine),a=e.sequencerEngine,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nE,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:aE;return Math.pow((e-t)/(n-t),4)}(t),c=Object(i.useCallback)(function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nE,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:aE,a=Math.pow(e,.25);return t+(n-t)*a}(e.target.value);n.dispatch(function(e,t){return{type:6,sequenceId:e,volume:t}}(a.sequenceId,t))},[a,n]);return u.a.createElement("div",{className:"work-volume-container"},u.a.createElement(be.a,{value:r,change:c,step:.01,className:"work-fader",max:1,min:0,orientation:"vertical",reversed:!0}))}),cE=new h.a,oE=Object(m.b)(function(e,t){return{value:e.explore.workTransposes[t.sequencerEngine.sequenceId]||0}},null)(function(e){var t=e.sequencerEngine,n=e.value,a=e.id,r=Object(i.useCallback)(function(e){(e=Math.round(e))!==n&&t.multiSequencerEngine.dispatch({type:5,sequenceId:t.sequenceId,transpose:e})},[t,n]),c=cE.getColorForHash(a||"what");return u.a.createElement("div",{className:"transpose-container"},u.a.createElement(Cf.Knob,{size:50,angleOffset:220,angleRange:280,value:n,initialValue:n,step:1,min:-24,max:24,onChange:r},u.a.createElement(Cf.Arc,{arcWidth:3,color:c,background:"rgb(56, 63, 72)"}),u.a.createElement(Cf.Pointer,{width:3,height:15,radius:10,type:"rect",color:c}),u.a.createElement(Cf.Value,{className:"transpose-value"})))}),sE=new h.a;var iE=Object(m.b)(function(e,t){return{value:e.explore.mixColorValues[t.id]}},function(e,t){return{setColorValue:function(n){return e(Object(f.Lc)(t.id,n))}}})(function(e){var t=e.value,n=void 0===t?.5:t,a=(e.setColorValue,e.mixEffects,e.sequencerEngine),r=e.id,c=Object(i.useCallback)(function(e){a.multiSequencerEngine.dispatch(ug(r,e))},[]),o=sE.getColorForHash(r||"what");return u.a.createElement("div",{className:"color-container"},u.a.createElement(Cf.Knob,{size:50,angleOffset:220,angleRange:280,value:n,min:0,max:1,onChange:function(e){return c(e)}},u.a.createElement(Cf.Arc,{arcWidth:3,color:o,background:"rgb(56, 63, 72)"}),u.a.createElement(Cf.Pointer,{width:3,height:15,radius:10,type:"rect",color:o})))}),uE=new h.a,lE=Object(m.b)(function(e,t){return{isLoading:e.sequencer.loadingSequence[t.work.newSequence],isPlaying:e.sequencer.isPlaying[t.work.newSequence],isAnnotationShowing:e.explore.exploreWork===t.work,worksLoaded:e.explore.worksLoaded}},function(e){return{setExploreWork:function(t){return e(Object(f.Tb)(t))},setProjectDragging:function(t){return e(Object(f.Hd)(t))}}})(function(e){var t=e.workNumber,n=e.work,a=e.sequencerEngine,r=e.isLoading,c=e.isPlaying,o=e.unloadWork,l=e.setExploreWork,f=e.isAnnotationShowing,m=e.setProjectDragging,p=Object(i.useState)(""),d=Object(s.a)(p,2),h=d[0],b=d[1],v=a.idToSequencerEngine[n.newSequence],g=Object(i.useState)(n.title),E=Object(s.a)(g,2),O=E[0],y=E[1],k=Object(i.useState)(void 0),j=Object(s.a)(k,2),C=j[0],S=j[1];Object(i.useEffect)(function(){n.guildId&&We.a.guildSequences._decryptQueryResult(n).then(function(e){return y(e.title)})},[n,y]),Object(i.useEffect)(function(){v&&v._wallpaper&&ot(v._wallpaper).then(function(e){e&&e[0]&&S(e[0].thumbnail)})},v&&v._wallpaper),Object(i.useEffect)(function(){We.a.users.getUserName(n.user).then(function(e){return b(e)})},[n]);if(r||!v)return u.a.createElement("div",{className:"work-mixer loading"},u.a.createElement(jn.a,{width:200,id:n.newSequence}),u.a.createElement("div",{onClick:o,className:"delete-button"},"x"));var w=uE.getColorForHash(n.newSequence),P={backgroundColor:w};n.workNumber=t;var N={};return C&&(N.backgroundImage="url(/ipfs/"+C+")"),u.a.createElement("div",{className:"work-mixer-container"},u.a.createElement("div",{style:{},className:"work-mixer"},u.a.createElement("div",{style:N,className:"inner"},u.a.createElement(rE,{multiSequencerEngine:a,sequencerEngine:v,id:n.newSequence}),u.a.createElement("div",{className:"work-fields"},u.a.createElement(Jg,{sequencerEngine:v}),u.a.createElement(tE,{color:w,sequencerEngine:v}),u.a.createElement("div",{className:"cassette"},u.a.createElement(oE,{id:n.newSequence,sequencerEngine:v}),u.a.createElement(iE,{mixEffects:v.channelMixer.mixEffects,sequencerEngine:v,id:n.newSequence})))),u.a.createElement("div",{draggable:!0,onDragStart:function(){return m(n)},onDragOver:function(e){return e.preventDefault()},className:"bottom"},u.a.createElement("div",{style:P,className:"play-button"},u.a.createElement(Ah,{color:uE.getColorForHash(n.newSequence),isPlaying:c,play:function(){var e=Object(B.a)({},n,{id:n.newSequence});a.dispatch(function(e){return{type:2,work:e,isTransport:!0}}(e))}})),u.a.createElement("div",{className:"title"},u.a.createElement("div",{className:"work-title"},O),u.a.createElement("div",{className:"author-divider"},"-"),u.a.createElement("div",{className:"work-author"},u.a.createElement("div",{className:"author-label"},"Author"),u.a.createElement("div",{className:"author-name"},h))),u.a.createElement("img",{onClick:function(){return l(f?void 0:n)},src:"/annotations.png",className:f?"annotation-button showing":"annotation-button"}),u.a.createElement("div",{style:P,onClick:function(){l(void 0),o()},className:"delete-button"},"x")),u.a.createElement(Qg,{work:n})))}),fE=function(e){var t=e.recording,n=e.setDeleting,a=e.deleting,r=e.onClickRecord,c="button-option";t&&(c+=" selected");var o="button-option";return a&&(o+=" selected"),u.a.createElement("div",{className:"sample-options"},u.a.createElement("div",{className:"buttons"},u.a.createElement("div",{onClick:r,className:c},"Rec"),u.a.createElement("div",{onMouseDown:function(){return n(!0)},onMouseUp:function(){return n(!1)},className:o},"Del")))},mE=n(571),pE=new h.a,dE=new b.a(32,!1),hE=(new gf.a,function(e){var t=e.track,n=e.setLastClicked,a=e.selected,r=e.recording,c=t.instrument,o=Object(i.useState)(void 0),l=Object(s.a)(o,2),f=l[0],m=l[1],p=Object(i.useState)(0),d=Object(s.a)(p,2),h=d[0],b=d[1],v=Object(i.useState)(0),g=Object(s.a)(v,2),E=g[0],O=g[1],y=h>E,k=c.defaultSampler&&c.defaultSampler.sample,j=Object(i.useCallback)(function(){t.sequencerEngine.state.keyboard.isCommandDown?n(t):(c.defaultSampler.loop&&y?c.triggerRelease():c.triggerAttack(),r&&m(new mE.a(t,0,dE,t.sequencerEngine,!0)),n(t))},[c,t,r,m,y]),C=Object(i.useCallback)(function(){t.gated&&c.triggerRelease(),r&&f&&(f.record(),m(void 0))},[c,t,r,f,m]),S=Object(i.useCallback)(function(e){e.trackNumber===t.trackNumber&&setTimeout(function(){b((new Date).getTime()+e.duration),e.duration>0&&setTimeout(w,1e3*e.duration)},e.time)},[t,b,w]),w=Object(i.useCallback)(function(e){void 0!==e&&e.trackNumber!==t.trackNumber||O((new Date).getTime())},[t,O]),P=function(){window.removeEventListener(Sl.d,S),window.removeEventListener(Sl.c,w)};Object(i.useEffect)(function(){return window.addEventListener(Sl.d,S),window.addEventListener(Sl.c,w),P},[]);var N="sampler-trigger";if(y&&(N+=" triggering"),a&&(N+=" selected"),k&&k.videoId)return u.a.createElement("img",{draggable:!1,onMouseDown:j,onMouseUp:C,onMouseLeave:C,className:N,src:k.getThumbnail()});var x={backgroundColor:pE.getColorForTrack(t)};return u.a.createElement("div",{draggable:!1,onMouseDown:j,onMouseUp:C,onMouseLeave:C,style:x,className:N})}),bE=new h.a,vE=function(e){var t=e.lastClicked,n=e.deleteSample,a=(e.recording,e.onClickRecord,Object(i.useState)(!1)),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(!1),f=Object(s.a)(l,2),m=f[0],p=f[1],d=Object(i.useState)(!1),h=Object(s.a)(d,2),b=(h[0],h[1]),v=Object(i.useState)(1),g=Object(s.a)(v,2),E=g[0],O=g[1],y=Object(i.useCallback)(function(){t.instrument.loopParameter.set(!m),p(!m)},[p,m,t]),k=Object(i.useCallback)(function(){t.gated=!c,o(!c)},[o,c,t]),j=Object(i.useCallback)(function(){var e=2*E;8===e&&(e=1),t.pattern.changeLength(32*e),O(e)},[O,E,t]);if(Object(i.useEffect)(function(){t&&(o(t.gated),p(t.instrument.loop),b(t.isWarped()),O(t.length/32))},[t,o,p,b,O]),void 0===t)return[];var C="button-option",S="button-option",w=bE.saturate(bE.getColorForHash(t.instrument.defaultSampler.sample.getId()),3),P={},N={},x={backgroundColor:w,color:"black"};return m&&(S+=" selected",P.backgroundColor=w,P.color="black"),c&&(C+=" selected",N.backgroundColor=w,N.color="black"),u.a.createElement("div",{className:"sample-options"},u.a.createElement("div",{className:"name"},t.instrument.defaultSampler.sample.name),u.a.createElement("div",{className:"buttons"},u.a.createElement("div",{onClick:k,style:N,className:C},"Gate"),u.a.createElement("div",{onClick:y,style:P,className:S},"Loop"),u.a.createElement("div",{onClick:j,style:x,className:"button-option length-button"},E," Bars"),u.a.createElement("div",{onClick:n,className:"delete-button"},"x")),u.a.createElement("div",{className:"knobs"},u.a.createElement(Ps.a,{min:-40,max:0,color:w,parameter:t.volumeParameter}),u.a.createElement(Ps.a,{color:w,parameter:t.instrument.defaultSampler.transposeParameter})))},gE=function(e){var t=e.sequencerEngine,n=e.samplersLoaded,a=e.deleteSample,r=Object(i.useState)(!1),c=Object(s.a)(r,2),o=c[0],l=c[1],f=Object(i.useState)(!1),m=Object(s.a)(f,2),p=m[0],d=m[1],h=Object(i.useState)(void 0),b=Object(s.a)(h,2),v=b[0],g=b[1];Object(i.useEffect)(function(){n[0]&&(n[0].sequencerEngine.deleting=p)},[p,n]);var E=Object(i.useCallback)(function(){l(!o)},[o,l]);if(0===n.length)return[];var O="";if(v){var y=v.instrument;O=u.a.createElement(Dl,{instrument:y,color:"#ffffff",sampler:y.defaultSampler,soundId:y.defaultSampler.sample.getId(),buffer:y.defaultSampler.sample.audioBuffer,width:150,height:40})}return u.a.createElement("div",{className:"sampler"},u.a.createElement("div",{className:"inner"},u.a.createElement(rE,{multiSequencerEngine:t,sequencerEngine:n[0].sequencerEngine,id:n[0].sequencerEngine.sequenceId}),u.a.createElement("div",{className:"sampler-triggers"},n.map(function(e){return u.a.createElement(hE,{key:e.id,recording:o,selected:v===e,setLastClicked:g,track:e})})),u.a.createElement("div",{className:"right-side"},O,u.a.createElement(vE,{deleteSample:function(){g(void 0),a(v)},lastClicked:v}))),u.a.createElement(fE,{setDeleting:d,deleting:p,recording:o,onClickRecord:E}))},EE=function(e){var t=e.work,n=e.onClick,a=e.mixMode,r=e.sequencerEngine,l=Object(i.useState)(""),f=Object(s.a)(l,2),m=f[0],d=f[1],h=Object(i.useState)({}),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useState)([]),O=Object(s.a)(E,2),y=O[0],k=O[1],j=Object(i.useState)({}),C=Object(s.a)(j,2),S=C[0],w=C[1];Object(i.useEffect)(function(){We.a.users.getUserName(t.user).then(function(e){return d(e)})},[t,d]),Object(i.useEffect)(function(){t&&(t.works?(w(t),k(t.works)):p.a.getJson(t.mixHash).then(function(e){e.mixHash=t.mixHash,k(e.works),w(e)}))},[t,k,w]),Object(i.useEffect)(function(){Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={},e.t0=c.a.keys(y);case 2:if((e.t1=e.t0()).done){e.next=9;break}return n=e.t1.value,e.next=6,We.a.users.getUserName(y[n].user);case 6:t[y[n].user]=e.sent,e.next=2;break;case 9:g(t);case 10:case"end":return e.stop()}},e)}))()},[y,g]);var P="";a&&(P=u.a.createElement("div",{onClick:function(){r.unloadAll()},className:"delete-button"},"x"));var N=t.previousHash&&""!==t.previousHash;return u.a.createElement("div",{onClick:function(){return n(S)},className:"work work-mix"},P,u.a.createElement("div",{className:"mix-info"},y.map(function(e){return[e.title+" - ",u.a.createElement("span",{className:"work-author"},v[e.user])]})),u.a.createElement("div",{className:"name"},u.a.createElement("div",{className:"work-author"},m),u.a.createElement("div",{className:"title"},t.title),u.a.createElement("div",{className:"mix-edit-info"},N?"Edit":"Original"),u.a.createElement("div",{className:"mix-background"},"MIX")))},OE=Object(m.b)(function(e,t){return{headSequencerEngine:t.sequencerEngine&&t.sequencerEngine.headSequencerEngine,mixLoaded:e.explore.mixLoaded,mixHasEdits:e.explore.mixHasEdits}},null)(function(e){var t=e.worksLoaded,n=e.sequencerEngine,a=e.unloadWork,r=e.samplersLoaded,c=e.deleteSample,o=e.mixLoaded,s=e.mixHasEdits,l=e.children,f=e.lists,m=Object(i.useCallback)(function(){n.unloadAll()},[n]);if(void 0===n)return u.a.createElement("div",null);var p="";return o&&(p=u.a.createElement(EE,{mixHasEdits:!0,sequencerEngine:n,mixMode:!0,onClick:m,work:o})),u.a.createElement("div",{className:"mixer no-select"},u.a.createElement("div",{className:"mixer-and-works"},u.a.createElement(Kg,{sequencerEngine:n}),u.a.createElement("div",{className:"works-container"},t.map(function(e,t){return u.a.createElement(lE,{workNumber:t,key:e.newSequence,unloadWork:function(){return a(e)},sequencerEngine:n,work:e})}),u.a.createElement(gE,{sequencerEngine:n,deleteSample:c,samplersLoaded:r}),o?p:"",s?u.a.createElement(_g,{originalMix:o,sequencerEngine:n}):""),f),l)}),yE=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,a,r,o,s,i,u,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.a.eth.getBlockNumber();case 2:t=e.sent,n=null,a=new Date,r=a.getDate(),o=a.getMonth(),t-=6e3*r,s=o,i={},u=0;case 11:if(!(u<12)){e.next=23;break}return e.next=14,W.a.eth.getBlock(t);case 14:n=e.sent,a=new Date(1e3*n.timestamp),l=new Date(a.getFullYear(),a.getMonth(),0).getDate(),i[s--]=t,t-=6600*l;case 20:u++,e.next=11;break;case 23:return e.abrupt("return",i);case 24:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();n(2454);function kE(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return jE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jE(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function jE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var CE={0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"},SE=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t,n=e.currentMonth,a=e.onClickMonth,r=e.months,c=((new Date).getMonth(),(new Date).getFullYear()),o=[],s=Object.keys(r).map(function(e){return parseInt(e)}).sort(function(e,t){return t-e}),i=kE(s=[].concat(Object(d.a)(s),Object(d.a)(s)).slice(0,12));try{for(i.s();!(t=i.n()).done;){var l=t.value;o.push({number:l,month:CE[(12+l)%12],isCurrent:l===n}),l%12===0&&o.push({number:l-1,year:--c})}}catch(f){i.e(f)}finally{i.f()}return u.a.createElement("div",{className:"months"},o.map(function(e){var t=e.month,n=e.number,r=e.isCurrent,c=e.year;return c?u.a.createElement("div",{onClick:function(){return a(n)},className:"month year"},c):u.a.createElement("div",{onClick:function(){return a(n)},className:r?"month current":"month"},t)}))}),wE=Object(m.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.work,n=e.onClick,a=Object(i.useState)(void 0),r=Object(s.a)(a,2),c=r[0],o=r[1],l=Object(i.useState)(""),f=Object(s.a)(l,2),m=f[0],d=f[1],h=Object(i.useState)([]),b=Object(s.a)(h,2),v=b[0],g=b[1],E=Object(i.useState)(""),O=Object(s.a)(E,2),y=O[0],k=O[1];Object(i.useEffect)(function(){t.projects?(console.log("there was work.projects and work.image =",t.image),g(t.projects),k(p.a.getHashUrl(t.image)),o(Object(B.a)({},t))):p.a.getJson(t.newContent).then(function(e){o(Object(B.a)({},t,e)),k(p.a.getHashUrl(e.image)),g(e.projects)})},[t]),Object(i.useEffect)(function(){We.a.users.getUserName(t.user).then(d)},[t,d]);var j={backgroundImage:"url("+y+")"};return u.a.createElement("div",{onClick:function(){return n(c)},style:j,className:"work list"},u.a.createElement("div",{className:"projects"},v.map(function(e){return u.a.createElement("div",{className:"project"},e.title," .")})),u.a.createElement("div",{className:"list-author"},m),u.a.createElement("div",{className:"list-title"},t.title))});new h.a;function PE(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return NE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NE(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw c}}}}function NE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var xE=Object(i.memo)(function(e){var t=e.work,n=e.onClick,a=(e.loadSample,e.onClickMix),r=e.onClickList,l=e.setSearchTag,f=e.setProjectDragging,m=e.setPersonSelected,p=Object(i.useState)(""),d=Object(s.a)(p,2),h=d[0],b=d[1],v=Object(i.useState)(t.title),g=Object(s.a)(v,2),E=g[0],O=g[1],y=Object(i.useState)(!1),k=Object(s.a)(y,2),j=(k[0],k[1],Object(i.useState)([])),C=Object(s.a)(j,2),S=C[0],w=C[1],P=Object(i.useState)(void 0),N=Object(s.a)(P,2),x=N[0],q=N[1],T=Object(i.useState)(void 0),M=Object(s.a)(T,2),R=M[0],D=(M[1],Object(i.useState)([t])),I=Object(s.a)(D,2),A=I[0];I[1];t.id=t.newSequence,Object(i.useEffect)(function(){t.guildId&&We.a.guildSequences._decryptQueryResult(t).then(function(e){return O(e.title)})},[t,O]);Nv({works:A}).comments;if(Object(i.useEffect)(function(){"SEQUENCE"===t.type&&on(t).then(function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.wallpaper,n=t.graphic,t.bpm,b(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},[t]),Object(i.useEffect)(function(){fn(t.blockNumber).then(q)},[t,q]),Object(i.useEffect)(function(){if(t.collaborators){var e,n=[],a=PE(t.collaborators);try{for(a.s();!(e=a.n()).done;){var r=e.value;n.push(We.a.users.getUserName(r))}}catch(c){a.e(c)}finally{a.f()}Promise.all(n).then(w)}},[t,w]),"MIX"===t.type)return u.a.createElement(EE,{work:t,onClick:a}," ");if("LIST"===t.type)return u.a.createElement(wE,{onClick:r,work:t});var L=t.previousSequence&&""!==t.previousSequence,F={};R&&(F.backgroundImage="url(/ipfs/"+R+")");var z=void 0,B=void 0;if(x){var _=(new Date).getTime()-x.getTime();B=Math.ceil(_/1e3/60),z=Math.ceil(B/60)}return u.a.createElement("div",{draggable:!0,onDragStart:function(){return f(t)},onDragOver:function(e){return e.preventDefault()},onClick:function(){return n(t)},className:"work"},u.a.createElement(Qg,{setSearchTag:l,editTags:!1,showComments:!0,work:t}),u.a.createElement("div",{className:"graphic"},h),u.a.createElement("div",{className:"name"},u.a.createElement("div",{className:"work-author"},S.map(function(e,n){return u.a.createElement("div",{onClick:function(e){e.stopPropagation(),m(t.collaborators[n])},className:0===n?"collaborator origin":"collaborator"},e)})),u.a.createElement("div",{style:F,className:"work-thumb"}),u.a.createElement("div",{className:"work-title"},u.a.createElement("span",null,E))),u.a.createElement("div",{className:"work-edit-info"},L?"Edit":"Original"),u.a.createElement("div",{className:"work-date"},x?B<60?B+" min ago":z<48?z+" hours ago":ln(x):""))}),qE=Object(m.b)(null,function(e){return{setProjectDragging:function(t){return e(Object(f.Hd)(t))},setPersonSelected:function(t){return e(Object(f.Qb)(t))}}})(xE),TE=Object(m.b)(function(e,t){return{personSelected:e.explore.personSelected,allSequences:e.explore.allSequences,worksLoaded:e.explore.worksLoaded}},null)(function(e){var t=e.allSequences,n=e.onClickWork,a=e.onClickMix,r=e.onClickList,c=e.loadSample,o=e.searchTerm,l=e.searchOptions,f=e.personSelected,m=e.setSearchTag,p=(e.worksLoaded,Object(i.useState)({numTracks:Math.floor(9*window.innerWidth/1e3),scrollTop:0})),h=Object(s.a)(p,2),b=h[0],v=h[1],g=(b.scrollTop,b.numTracks,function(e){var t=e.allSequences,n=e.personSelected,a=e.searchOptions,r=e.searchTerm,c=e.setState,o=Object(i.useState)(!1),u=Object(s.a)(o,2),l=u[0],f=u[1],m=t.filter(function(e){return!n||e.user===n.id}),p=a.indexOf("Samples")>-1,h=a.indexOf("Projects")>-1,b=a.indexOf("Lists")>-1;m=m.filter(function(e){return b&&"LIST"===e.type||p&&("SAMPLES"===e.type||"MIX"===e.type)||h&&"SEQUENCE"===e.type});var v=Object(d.a)(m);return Object(i.useEffect)(function(){console.log("GOING TO BEGINNING"),c({scrollTo:0,numTracks:9}),document.getElementById("works").scrollTo(0,0)},[r,a,c]),Object(i.useEffect)(function(){c({numTracks:9,scrollTop:0})},[n]),{works:v,userWorks:m,isLoading:l,setIsLoading:f}}({allSequences:t,searchTerm:o,searchOptions:l,setState:v})),E=g.userWorks,O=g.works,y=g.setIsLoading,k=g.isLoading,j=function(e){var t=e.setIsLoading,n=e.userWorks,a=e.setState,r=Object(i.useState)((new Date).getMonth()),c=Object(s.a)(r,2),o=c[0],u=c[1],l=Object(i.useState)({}),f=Object(s.a)(l,2),m=f[0],p=f[1];return Object(i.useEffect)(function(){yE().then(function(e){return p(e)})},[p]),{onClickMonth:Object(i.useCallback)(function(e){t(!0);var r=m[Math.min((new Date).getMonth(),e+1)];if(e==(new Date).getMonth())return a({numTracks:25,scrollTop:0}),u(e),void setTimeout(function(){t(!1)},500);for(var c in n)if(n[c].blockNumber<r){var o=parseInt(c);a({numTracks:o+9,skipTracks:o}),setTimeout(function(){u(e),setTimeout(function(){t(!1)},500)},50);break}},[m,n,a,u,t]),months:m,currentMonth:o,setCurrentMonth:u}}({setIsLoading:y,setState:v,userWorks:E}),C=j.months,S=j.onClickMonth,w=j.setCurrentMonth,P=j.currentMonth,N=function(e){var t=e.setIsLoading,n=e.isLoading,a=e.userWorks,r=e.setCurrentMonth,c=e.months,o=e.state,s=e.setState,u=e.works,l=e.personSelected,f=o.skipTracks,m=o.scrollTop,p=o.numTracks,d=Object(i.useCallback)(function(){if(!(p>=a.length)){var e=document.getElementById("works");if(!n){var o=e.scrollTop+e.offsetHeight,i=e.scrollHeight;if(e.scrollTop<=m-1300&&m>50)setTimeout(function(){s({numTracks:9,scrollTop:0}),e.scrollTo(0,0),r((new Date).getMonth())},200);else if(o>=i){t(!0);var u=p+6;if(!a[u])return void t(!1);var l=a[u].blockNumber;for(var d in c)if(d=parseInt(d),l<c[d]){r(d-1);break}setTimeout(function(){console.log("setting scrollTop=",e.scrollTop),s({skipTracks:f,numTracks:p+6,scrollTop:e.scrollTop}),t(!1)},200)}}}},[p,t,f,n,s,a,r,c,m]);function h(){var e=document.getElementById("works");e&&e.removeEventListener("scroll",d)}Object(i.useEffect)(function(){var e=document.getElementById("works");e&&e.scrollTo(0,0)},[f]),Object(i.useEffect)(function(){var e=document.getElementById("works");s({numTracks:9,scrollTop:0}),e&&e.scrollTo(0,0),r((new Date).getMonth())},[l,r]),Object(i.useEffect)(function(){var e=document.getElementById("works");return e&&e.addEventListener("scroll",d),h},[d,a,o,f]);var b=f;if(void 0===f){var v=Math.max(1,Math.floor((window.innerWidth-110)/420)),g=Math.floor(m/290)*v;9===p&&(g=0),g=Math.max(0,g-50)}var E=u.slice(b,p);return{onScroll:d,scrollWorks:E,toSkip:b=void 0!==f?0:b}}({works:O,setIsLoading:y,isLoading:k,state:b,setState:v,userWorks:E,setCurrentMonth:w,months:C,personSelected:f}),x=(N.onScroll,N.scrollWorks),q=N.toSkip;return u.a.createElement("div",{className:"works-and-months"},u.a.createElement("div",{id:"works"},u.a.createElement("div",{className:"works-grid"},x.map(function(e,t){return u.a.createElement(qE,{setSearchTag:m,loadSample:c,onClick:n,onClickMix:a,onClickList:r,key:t+Math.floor(q)+"-"+e.newSequence+"-"+e.blockNumber,work:e})})),u.a.createElement("div",{className:"loader-container"},u.a.createElement(Fn.a,{sizeUnit:"px",size:20,color:"#42f4f1",loading:k}))),u.a.createElement(SE,{months:C,onClickMonth:S,currentMonth:P}))});n(2455),t.default=Object(m.b)(function(e,t){var n;return n={allSequences:e.explore.allSequences,personSelected:e.explore.personSelected,worksLoaded:e.explore.worksLoaded,exploreOption:e.explore.exploreOption,annotationsView:e.explore.annotationsView,wallpaper:e.sequencer.wallpaper,animateWallpaper:e.sequencer.animateWallpaper,exploreWork:e.explore.exploreWork},Object(a.a)(n,"personSelected",e.explore.personSelected),Object(a.a)(n,"guildId",e.guilds.selectedGuild?e.guilds.selectedGuild.guildId:0),n},function(e){return{setAllSequences:function(t){return e(Object(f.Nb)(t))},setCommandDown:function(t){return e(Object(f.cb)(t))},setWorksLoaded:function(t){return e(Object(f.mg)(t))},setExploreUnpublished:function(t){return e(Object(f.Sb)(t))},setWallpaper:function(t){return e(Object(f.fg)(t))},setAnimateWallpaper:function(t){return e(Object(f.y)(t))},setExploreWork:function(t){return e(Object(f.Tb)(t))}}})(function(e){var t=Object(i.useState)(void 0),n=Object(s.a)(t,2),a=n[0],r=n[1],f=e.personSelected,m=e.worksLoaded,h=(e.setWorksLoaded,e.guildId),b=Object(i.useState)(void 0),v=Object(s.a)(b,2),g=(v[0],v[1]),E=Object(i.useState)([]),O=Object(s.a)(E,2),y=O[0],k=O[1],j=Object(i.useState)(""),C=Object(s.a)(j,2),w=C[0],P=C[1],N=Object(i.useState)(void 0),x=Object(s.a)(N,2),q=x[0],T=x[1],M=Object(i.useState)(["Projects"]),R=Object(s.a)(M,2),D=R[0],I=R[1],A=function(e,t){var n=Object(i.useState)(!1),a=Object(s.a)(n,2),r=a[0],c=a[1],o=Object(i.useState)([]),u=Object(s.a)(o,2),f=u[0],m=u[1],p=Object(i.useCallback)(function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0!==t){var a=l.a.getItem("unsavedLists");if(a&&(a=JSON.parse(a)),void 0===t.hash)if(n){var r=e.allSequences.filter(function(e){return e.id!==t.id});e.setAllSequences(r),a&&(a=a.filter(function(e){return e.name!==t.name}),l.a.setItem("unsavedLists",JSON.stringify(a)),e.setExploreUnpublished(a))}else e.setAllSequences([Object(B.a)({},t,{type:"LIST"})].concat(Object(d.a)(e.allSequences)));else if(n){Av(t.newContent);var o=e.allSequences.filter(function(e){return e.hash!==t.hash});e.setAllSequences(o)}c(!1)}else c(!1)},[c,t,e.allSequences]),h=Object(i.useCallback)(function(e){if(f.indexOf(e)>-1){var t=Object(d.a)(f);t.splice(f.indexOf(e),1),m(t)}else m([].concat(Object(d.a)(f),[e]))},[m,f]);return{lists:f,onListChanged:p,onClickList:h,creatingNewList:r,setCreatingNewList:c}}(e,a),L=A.lists,F=A.onListChanged,z=A.onClickList,_=A.creatingNewList,H=A.setCreatingNewList,U=Object(i.useState)(!0),G=Object(s.a)(U,2),W=G[0],V=G[1];Object(i.useEffect)(function(){var t=function(e){_e.a.setEthereum(We.a),We.a.store=e,We.a.crypto.store=e,We.a.guilds.initGuilds(),_e.a.setStore(e),lg.a.setSampleRate(Ie.d);var t=new bg(e);return window.multiMix=!0,window.sequencerEngine=t,t.ethereum=We.a,t}(e.store);window.explore=!0,r(t),ee(),window.addEventListener("keydown",X),window.addEventListener("keyup",K)},[]),Object(i.useEffect)(function(){e.setAllSequences([]),V(!0),Bg(e.setAllSequences,V,D,w,q,h,f).then(function(e){return V(!1)})},[f,D,V,w,q,h]),Object(i.useEffect)(function(){if(a){var t=e.match&&void 0!=e.match.params.sequenceId?e.match.params.sequenceId:null;t&&We.a.getSequence(t).then(function(n){n||(n={newSequence:t,title:"Unpublished work"}),a.dispatch(ig(n)),e.setExploreWork(n)})}},[a]);var X=Object(i.useCallback)(function(t){"Meta"===t.key&&e.setCommandDown(!0)},[]),K=Object(i.useCallback)(function(t){"Meta"===t.key&&e.setCommandDown(!1)},[]),Q=Object(i.useCallback)(function(e){a.dispatch(function(e){return{type:4,work:e}}(e))},[a]),Y=Object(i.useCallback)(function(e){a.dispatch(ig(e))},[a]),J=Object(i.useCallback)(function(e){a.loadMix(e)},[a]),Z=function(e,t,n){return Object(i.useCallback)(function(){var n=Object(o.a)(c.a.mark(function n(a){var r,o;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.samplerTrack.addSampledInstrumentTrack(),o=new Ct.a(a),n.next=4,o.load();case 4:return n.next=6,r.instrument.newSample(0,o);case 6:r.instrument.monophonic=!0,t(Object(d.a)(e.samplerTrack.tracks));case 8:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),[t,n,e])}(a,k),$=function(e,t,n){return Object(i.useCallback)(function(t){n.samplerTrack.deleteTrack(t.trackNumber),e(Object(d.a)(n.samplerTrack.tracks))},[e,t,n])}(k,y,a),ee=function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.a.getUser();case 2:t=e.sent,g(t);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();Object(i.useEffect)(function(){pa.isMobile&&m&&m.length>0&&e.setExploreWork(m[0])},[m]);var te="explore-2",ne={};return e.wallpaper?ne.backgroundImage="url("+p.a.getHashUrl(e.wallpaper)+")":te+=" no-wallpaper",e.animateWallpaper&&(te+=" animate"),Object(i.useEffect)(function(){var t=l.a.getItem("wallpaper");t?e.setWallpaper(t):e.setWallpaper("QmUh2FeN3bw2VdcRVksDctr1ihjDwHpNhE6o9mkBhF2huB"),void 0!==(t=l.a.getItem("animateWallpaper"))&&e.setAnimateWallpaper("true"===t)},[]),m&&m.length>0&&(te+=" work-loaded"),e.exploreWork&&(te+=" exploring"),u.a.createElement("div",{className:te,style:ne},u.a.createElement(He.a,{condition:e.exploreOption===sg.a},u.a.createElement(la,{store:e.store})),u.a.createElement(He.a,{condition:e.exploreOption===sg.b},u.a.createElement(ng,{annotationsView:e.annotationsView}),u.a.createElement(OE,{unloadWork:Q,sequencerEngine:a,samplersLoaded:y,lists:u.a.createElement(Xv,{loadWork:Y,removeList:z,onListChanged:F,creatingNewList:_,hide:function(){return H(!1)},lists:L}),deleteSample:$,worksLoaded:m},a?u.a.createElement("div",{className:"login-and-comments"},u.a.createElement(qg,{store:a.store,setSearchOptions:I,searchOptions:D,setSearchTerm:P,searchTerm:w}),u.a.createElement(qv,{sequencerEngine:a})):""),u.a.createElement(Kv,{onNewList:function(){return H(!0)}},u.a.createElement(og,{searchTag:q,setSearchTag:T,setSearchOptions:I,searchOptions:D,setSearchTerm:P,searchTerm:w})),W?u.a.createElement(S.a,{className:"world-fetcher",text:"Fetching the world"}):"",e.exploreWork?u.a.createElement(jv,{work:e.exploreWork,sequencerEngine:a}):u.a.createElement(TE,{onClickMix:J,onClickList:z,loadSample:Z,onClickWork:Y,setSearchTag:T,searchOptions:D,searchTerm:w}),u.a.createElement("div",{color:"radial-gradient(75.29% 75.29% at 64.96% 24.36%, #F0DFA7 0.52%, #FDBDAA 18.75%, #FEA186 34.38%, #F09277 49.48%, #D27584 74.48%, #6B7B8A 100%)",className:"coke-machine-glow"})))})},426:function(e,t,n){}}]);