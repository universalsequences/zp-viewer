(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{2242:function(e,t,n){"use strict";n.d(t,"g",function(){return a}),n.d(t,"f",function(){return c}),n.d(t,"e",function(){return o}),n.d(t,"h",function(){return i}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return d});var r=n(2251),a=function(e,t,n){return{type:r.i,sequenceId:e,subSequenceId:t,patternNumber:n}},c=function(e){return{type:r.f,work:e,isTransport:!0}},o=function(e){return{type:r.e,work:e}},i=function(e){return{type:r.j,work:e}},s=function(e,t){return{type:r.c,sequenceId:e,transpose:t}},u=function(e,t){return{type:r.d,sequenceId:e,volume:t}},l=function(e,t){return{type:r.b,sequenceId:e,color:t}},d=function(e){return{type:r.a,bpm:e}}},2251:function(e,t,n){"use strict";n.d(t,"i",function(){return r}),n.d(t,"f",function(){return a}),n.d(t,"e",function(){return c}),n.d(t,"j",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return s}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"h",function(){return d}),n.d(t,"g",function(){return f});var r=1,a=2,c=3,o=4,i=5,s=6,u=7,l=8,d=9,f=10},2259:function(e,t,n){"use strict";var r=n(3),a=n.n(r),c=n(10),o=n(13),i=n(9),s=n(2),u=n(4),l=n(6),d=n(11),f=n(1),m=n(2251),b=n(14),p=n.n(b),v=n(8);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}t.a=function(e){return function(e){Object(l.a)(n,e);var t=h(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).events=[],e.hasEdits=!1,e}return Object(u.a)(n,[{key:"isRecordingMix",get:function(){return this.state.explore.isRecordingMix}},{key:"currentTransportTime",get:function(){var e=parseFloat(p.a.Transport.position.split(":")[2]);return"0:0:"+(e-Math.floor(e)+this.trackStep/2)}},{key:"dispatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.currentTransportTime,r=e.sequenceId&&this.getSequencerEngine(e.sequenceId);switch(e.type){case m.i:this.switchToPattern(r,e.subSequenceId,e.patternNumber);break;case m.f:this.playWork(e.work);break;case m.e:this.loadWork(e.work);break;case m.j:this.unloadWork(e.work);break;case m.c:this.changeTranspose(r,e.transpose);break;case m.d:this.changeVolume(r,e.volume);break;case m.b:this.changeColor(r,e.color);break;case m.a:this.changeBPM(e.bpm)}!t&&this.isRecordingMix&&(e=Object(i.a)({},e,{time:n}),this.events.push(e),this.hasEdits=!0)}},{key:"playWork",value:function(e){this.play(e),this.isNothingPlaying()&&this.clearScheduledEvents()}},{key:"worksLoaded",get:function(){return this.state.explore.worksLoaded}},{key:"loadWork",value:function(){var e=Object(o.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("MultiMix.loadWork =",t),!this.worksLoaded.some(function(e){return e.newSequence===t.newSequence})){e.next=5;break}return n=this.getSequencerEngine(t.newSequence),this.setWorkDefaults(n),e.abrupt("return");case 5:return this.store.dispatch(Object(v.Qh)([].concat(Object(c.a)(this.worksLoaded),[t]))),e.next=8,this.loadTrack(t.newSequence);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"unloadWork",value:function(e){if(this.worksLoaded.some(function(t){return t.newSequence===e.newSequence})){var t=Object(c.a)(this.worksLoaded),n=t.indexOf(e);t.splice(n,1),this.store.dispatch(Object(v.Qh)(t)),this.unloadTrack(e.newSequence)}}},{key:"switchToPattern",value:function(e,t,n){e&&(e.switchToSubSequence(t),e.switchToPattern(n))}},{key:"changeColor",value:function(e,t){e&&(e.channelMixer.mixEffects.filter=t,this.store.dispatch(Object(v.nd)(e.sequenceId,t)))}},{key:"changeTranspose",value:function(e,t){e&&(e.transpose=t,this.store.dispatch(Object(v.Oh)(e.sequenceId,t)))}},{key:"changeVolume",value:function(e,t){e&&(e.setMasterVolume(t,.05),this.store.dispatch(Object(v.Ph)(e.sequenceId,t)))}},{key:"changeBPM",value:function(e){this.updateBpm(e)}},{key:"setInitialValuesForMix",value:function(){if(this.initialState){var e=this.initialState,t=e.workVolumes,n=e.worksLoaded,r=e.workTransposes,a=e.mixColorValues,c=e.bpm;for(var o in c&&this.changeBPM(c),t){var i=this.getSequencerEngine(o);i&&this.changeVolume(i,t[o])}for(var s in r){var u=this.getSequencerEngine(s);u&&this.changeTranspose(u,r[s])}for(var l in n)this.loadWork(n[l]);for(var d in a){var f=this.getSequencerEngine(d);f&&this.changeColor(f,a[d])}}}},{key:"saveInitialValuesForMix",value:function(){var e=this.store.getState();this.initialState={worksLoaded:Object(c.a)(e.explore.worksLoaded),workTransposes:Object(i.a)({},e.explore.workTransposes),workVolumes:Object(i.a)({},e.explore.workVolumes),bpm:e.user.bpm,mixColorValues:Object(i.a)({},e.explore.mixColorValues)}}},{key:"playMix",value:function(e){var t=this;e?(this.isRecordingMix?this.saveInitialValuesForMix():this.setInitialValuesForMix(),this.eventIds=this.events.map(function(e){return p.a.Transport.schedule(function(n){e.type===m.f&&(n=0),setTimeout(function(){t.dispatch(e,!0)},n)},e.time)}),this.play()):(this.clearScheduledEvents(),this.stop())}},{key:"clearScheduledEvents",value:function(){this.eventIds&&(this.eventIds.forEach(function(e){return p.a.Transport.clear(e)}),this.eventIds=[])}},{key:"setWorkDefaults",value:function(e){this.changeTranspose(e,0),this.changeVolume(e,0)}},{key:"hasEdits",set:function(e){this.store.dispatch(Object(v.pd)(e))}},{key:"unloadAll",value:function(){this.clearMix(),this.stop(),this.hasEdits=!1;var e=Object(c.a)(this.worksLoaded);for(var t in e)this.unloadWork(e[t])}}]),n}(e)}},2267:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(12);t.a=Object(c.b)(function(e,t){return{step:t.sequencerEngine.trackStep,isSequenceRolling:t.sequencerEngine.isSequenceRolling}},function(e){return{}})(function(e){var t=e.step,n=void 0===t?0:t,r=e.isSequenceRolling,c=e.sequencerEngine,o=void 0,i=void 0,s="";if(r){var u=c.tracks[0];if(u){var l=u.getFactoredResolution().getNumberOfStepsAtBaseResolution();u.patternRollStepNumber,u.pattern.stepBuckets.length,o=l,i=u.patternRollStepNumber}o=o;var d=i,f={left:4*Math.floor(d/4)%32*96/32+"vw",width:4*Math.floor(o/4)%32*96/32+"vw"};s=a.a.createElement("div",{className:"playhead roll-visualizer",style:f})}var m={left:4*Math.floor(n/4)%32*100/32+"vw"};return[s,a.a.createElement("div",{style:m,className:"playhead"})]})},2268:function(e,t,n){},2269:function(e,t,n){"use strict";var r=n(0),a=n.n(r);n(12);t.a=function(e){var t=e.setToggled,n=e.toggled,r=e.url,c=void 0===r?"/zequencer-logo-hiero.svg":r;return a.a.createElement("img",{onClick:function(){return t(!n)},className:n?"logo-hiero toggled":"logo-hiero",src:c})}},2280:function(e,t,n){"use strict";var r=n(2),a=n(4),c=n(6),o=n(11),i=n(1),s=n(0),u=n.n(s),l=n(12),d=n(2242);function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var m=["A","B","C","D","E","F","G","H"],b=function(e){Object(c.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"switchPattern",value:function(e){var t=this.props.sequencerEngine;t.multiSequencerEngine.dispatch(Object(d.g)(t.sequenceId,t.currentSubSequence.id,e))}},{key:"chooseSubSequence",value:function(e){this.props.sequencerEngine.switchToSubSequence(e)}},{key:"getSubSequencesComponent",value:function(){var e=this,t=this.props.subSequences||[];return u.a.createElement("div",{className:"sub-sequence-buttons"},t.map(function(t,n){return u.a.createElement("div",{key:m[n],onClick:function(){return e.chooseSubSequence(t)},className:t===e.props.currentSubSequence?"sub-sequence selected":"sub-sequence"},m[n])}))}},{key:"render",value:function(){var e=this;return void 0===this.props.sequencerEngine.tracks[0]?this.getSubSequencesComponent():u.a.createElement("div",null,u.a.createElement("div",{className:"pattern-buttons"},this.props.sequencerEngine.tracks[0].patterns.map(function(t,n){return u.a.createElement("div",{style:e.props.color&&e.props.currentPattern===n?{backgroundColor:e.props.color}:{},onClick:function(){return e.switchPattern(n)},className:e.props.currentPattern===n?"current pattern-button":"pattern-button"},n+1)})),this.getSubSequencesComponent())}}]),n}(s.Component);t.a=Object(l.b)(function(e,t){var n=t.sequencerEngine.engineId,r=t.sequencerEngine.currentSubSequence.id;return{currentPattern:e.sequencer.currentPattern[r]||0,subSequenceId:r,subSequences:e.sequencer.subSequences[n],currentSubSequence:e.sequencer.currentSubSequence[n]}},null)(b)},2281:function(e,t,n){"use strict";var r=n(3),a=n.n(r),c=n(13),o=n(2),i=n(4),s=n(8),u=(n(1325),n(2259),n(14)),l=n.n(u),d=n(539),f=n(1001),m=n(604),b=function(){function e(t){Object(o.a)(this,e),this.store=t,this.idToSequencerEngine={},this.headSequencerEngine=void 0,this.sequencerEnginesToPlay=[],this.sequenceIdQueue=[],window.sequencerEngine=this,this.initAubio()}return Object(i.a)(e,[{key:"getHead",value:function(){return this.idToSequencerEngine[Object.keys(this.idToSequencerEngine)[0]]}},{key:"state",get:function(){return this.store.getState()}},{key:"trackStep",get:function(){for(var e in this.idToSequencerEngine){var t=this.idToSequencerEngine[e].trackStepReal;if(t>0)return t}return 0}},{key:"initAubio",value:function(){var e=this;window.Aubio().then(function(t){e.aubio=t})}},{key:"sampleRate",set:function(e){d.a.setSampleRate(e)}},{key:"stop",value:function(){for(var e in this.idToSequencerEngine)this.idToSequencerEngine[e].stop();l.a.Transport.stop()}},{key:"updateBpm",value:function(e){for(var t in this.idToSequencerEngine)this.idToSequencerEngine[t].updateBpm(e)}},{key:"getSequencerEngine",value:function(e){return void 0===e?this.idToSequencerEngine[Object.keys(this.idToSequencerEngine)[0]]:this.idToSequencerEngine[e]}},{key:"stepOneCallback",value:function(e){this.sequencerEnginesToPlay.forEach(function(t){var n=l.a.Transport.getTicksAtTime(e),r=new l.a.TransportTime(n,"i");t.play(r)}),this.sequencerEnginesToPlay=[]}},{key:"getSamplerPlaySequence",value:function(){return null}},{key:"isNothingPlaying",value:function(){return 0===this.getSequencesPlaying().length}},{key:"getSequencesPlaying",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.store.getState().sequencer.isPlaying;return Object.keys(this.idToSequencerEngine).filter(function(n){return!1===e&&void 0===t[n]||t[n]===e})}},{key:"unloadTrack",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.idToSequencerEngine[e];n.playing&&n.stop(),delete this.idToSequencerEngine[e];var r=this.sequenceIdQueue.indexOf(e);r>-1&&this.sequenceIdQueue.splice(r,1),this.store.dispatch(Object(s.Hc)(e,void 0)),t&&setTimeout(function(){n.dispose()},500)}},{key:"loadTrack",value:function(){var e=Object(c.a)(a.a.mark(function e(t){var n,r,c,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getSequencesPlaying(!1),this.sequenceIdQueue.length>7&&(n.length>0?this.unloadTrack(n[0]):(r=this.sequenceIdQueue.shift(),this.unloadTrack(r))),this.store.dispatch(Object(s.cd)(t,!0)),(c=new f.default(this.store,!0,void 0,this.aubio)).channelMixer.connectMixEffects(),o=new m.a(c,!0),c.setScripting(o),c.multiSequencerEngine=this,c.loadedSequenceId=t,c.setMasterVolume(1),this.sequenceIdQueue.push(t),this.idToSequencerEngine[t]=c,this.store.dispatch(Object(s.Hc)(t,!1)),e.next=15,c.loadSequence(t);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"initSamplerTrack",value:function(){}},{key:"sequenceRolling",value:function(){for(var e in this.idToSequencerEngine){if(this.idToSequencerEngine[e].isSequenceRolling)return!0}return!1}},{key:"play",value:function(e){var t=this,n=this.getSequencerEngine(e&&e.id);if(void 0!==n){n.playing&&this.getSequencesPlaying(!0).length,e&&e.playing&&this.setHeadSequencerEngine(void 0);var r=this.getSequencesPlaying(!0);0==this.getSequencesPlaying(!0).length||n.playing?(this.store.dispatch(Object(s.Ic)(!0)),n.playing||0!=r.length||this.setHeadSequencerEngine(n),n.play()):this.sequencerEnginesToPlay.push(n),(r=r.map(function(e){return t.idToSequencerEngine[e]}).filter(function(e){return e!==n})).length>0&&r.every(function(e){return void 0===e.stepOneCallback})&&this.setHeadSequencerEngine(r[0])}}},{key:"setHeadSequencerEngine",value:function(e){var t=this;void 0!==e||void 0===this.headSequencerEngine?(this.headSequencerEngine=e,this.headSequencerEngine.stepOneCallback=function(e){return t.stepOneCallback(e)}):this.headSequencerEngine.stepOneCallback=void 0}}]),e}();t.a=b},2292:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(10),o=n(31),i=n(12),s=n(33);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}new o.a;var d=function(e,t){return(e%t+t)%t},f=Object(i.b)(function(e,t){return{step:t.sequencerEngine&&t.sequencerEngine.trackStep}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=e.row,o=e.part,i=e.step,l=void 0===i?0:i,f=Object(r.useCallback)(function(){var e=new s.a(Math.pow(2,2+Math.floor(o/2)),o%2===1);t.resolution=e,t.sequenceRolling=!0,t.trackRolling=!0},[t,o]),m=Object(r.useCallback)(function(){t.sequenceRolling=!1,t.trackRolling=!1},[t,o]),b=Object(r.useRef)(!1),p=Object(r.useRef)(void 0),v=new Set,h={},g=o===4*Math.floor(l/4)%32/32*8;if(t){var k,E=u(t.subSequences);try{for(E.s();!(k=E.n()).done;){var O,j=u(k.value.tracks);try{for(j.s();!(O=j.n()).done;){var w=O.value,S=w.notesTriggered||{};for(var y in S)y=d(y,12),v.add(y),h[y]||(h[y]=[]),h[y].push(w)}}catch(M){j.e(M)}finally{j.f()}}}catch(M){E.e(M)}finally{E.f()}}var q=2*n,x=2*n+1,N="triangle";if(v.has(q)||v.has(x)){var C=h[q]||[],T=h[x]||[],L=[].concat(Object(c.a)(C),Object(c.a)(T)).map(function(e){return"white"});g&&(b.current=!0,p.current=L[o%L.length],N+=" triggered")}else g&&l%4===0&&(b.current=!1);var I={};return b.current&&(N+=" old-trigger",void 0!==p.current?I.borderBottomColor=p.current:N+=" track-0"),a.a.createElement("div",{onMouseDown:f,onMouseUp:m,style:I,className:N})});t.a=function(e){var t=e.sequencerEngine,n=e.row;return a.a.createElement("div",{className:"row"},[0,1,2,3,4,5,6,7].map(function(e){return a.a.createElement(f,{sequencerEngine:t,row:n,part:e})}))}},2412:function(e,t,n){},2413:function(e,t,n){},2420:function(e,t,n){"use strict";n.r(t);var r=n(23),a=n(3),c=n.n(a),o=n(13),i=n(7),s=n(0),u=n.n(s),l=n(94),d=n(8),f=n(12),m=n(45),b=n(2292),p=(n(598),n(2267)),v=(n(433),n(2268),Object(f.b)(function(e,t){return{wallpaper:e.sequencer.wallpaper}},function(e){return{setIsPlayingMix:function(t){return e(Object(d.Ic)(t))}}})(function(e){var t=e.sequencerEngine;e.wallpaper;return u.a.createElement("div",{className:"exhibit"},t?u.a.createElement(p.a,{sequencerEngine:t}):"",u.a.createElement(b.a,{sequencerEngine:t,row:0}),u.a.createElement(b.a,{sequencerEngine:t,row:1}),u.a.createElement(b.a,{sequencerEngine:t,row:2}),u.a.createElement(b.a,{sequencerEngine:t,row:3}),u.a.createElement(b.a,{sequencerEngine:t,row:4}),u.a.createElement(b.a,{sequencerEngine:t,row:5}))}),n(122)),h=(n(1272),n(31)),g=n(609),k=n(2269),E=n(2334),O=n(2286),j=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.sequencerEngine,n=Object(s.useState)(!1),r=Object(i.a)(n,2),a=r[0],c=r[1],o=Object(s.useCallback)(function(e,n,r){t.save(e,n,!0,r),c(!1)},[c,t]);return u.a.createElement("div",null,u.a.createElement(O.a,{sequencerEngine:t,onSave:o,onHide:function(){return c(!1)},show:a}),u.a.createElement("div",{onClick:function(){return c(!0)},className:"work-save-button"}))}),w=n(10),S=Object(f.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{setWorksLoaded:function(t){return e(Object(d.Qh)(t))}}})(function(e){var t=e.setWorksLoaded,n=e.multiSequencerEngine,r=e.sequencerEngine,a=e.worksLoaded,c=Object(s.useCallback)(function(){var e=Object.values(n.idToSequencerEngine).filter(function(e){return e!==r});e.forEach(function(e){return r.subSequences=[].concat(Object(w.a)(r.subSequences),Object(w.a)(e.subSequences))}),e.forEach(function(e){return n.unloadTrack(e.getSequenceId(),!1)});var c=a.filter(function(e){return e.newSequence===r.getSequenceId()});t(c)},[a,r]);return a&&a.length>1?u.a.createElement("div",{onClick:c,className:"combine-works-button"},"Combine Projects"):""}),y=new h.a,q=Object(f.b)(function(e,t){var n=t.sequencerEngine.idToSequencerEngine[t.work.newSequence];return n?{worksLoaded:e.explore.worksLoaded,numSubSequences:n&&n.subSequences.length,pulledEffects:e.effects.pulledEffects}:{}},function(e){return{}})(function(e){var t=e.work,n=e.sequencerEngine,r=Object(s.useState)(!1),a=Object(i.a)(r,2),c=a[0],o=a[1],l=Object(s.useState)(void 0),d=Object(i.a)(l,2),f=d[0],m=d[1],b=n.idToSequencerEngine[t.newSequence];return b?(Object(s.useEffect)(function(){c||m(void 0)},[c,m]),u.a.createElement("div",{className:"explore-work"},c&&f?u.a.createElement(g.a,{color:y.getColorForTrack(f),track:f}):b.subSequences.map(function(e){return u.a.createElement(E.a,{isExplore:!0,setSelectedTrack:m,toggled:c,subSequence:e,sequencerEngine:b})}),u.a.createElement(k.a,{setToggled:o,toggled:c}),u.a.createElement(S,{multiSequencerEngine:n,sequencerEngine:b}),u.a.createElement(j,{sequencerEngine:b}))):""}),x=n(51),N=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.pendingComments,n=Object(s.useState)(""),r=Object(i.a)(n,2),a=r[0],c=r[1];Object(s.useEffect)(function(){x.a.getUserName().then(c)},[c]);var o=Object(w.a)(t);return o.reverse(),o.map(function(e){return u.a.createElement("div",null,u.a.createElement("div",{className:"annotation"},u.a.createElement("div",{className:"author"},a,":"),u.a.createElement("div",{className:"content"},e)))})}),C=n(2241),T=n(32),L=n(36),I=n(65),M=new h.a,A={},P=function(e){var t=e.annotation,n=e.style,r=Object(s.useState)(""),a=Object(i.a)(r,2),c=a[0],o=a[1],l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],b=d[1],p=Object(s.useState)([]),v=Object(i.a)(p,2),h=v[0],g=v[1];return Object(s.useEffect)(function(){var e=L.a.utils.fromAscii(t.annotationData),n=Object(I.a)(e);A[n]?o(A[n]):m.a.getJson(n).then(function(e){A[n]=e,o(e)}),T.a.users.getUserName(t.address).then(function(e){return b(e)})},[t,o,b]),Object(s.useEffect)(function(){T.a.xanadu.getContentReferences(t.annotationData).then(g)},[t,g]),u.a.createElement("div",{style:n,className:"annotation"},u.a.createElement("div",{className:"author"},f,":"),u.a.createElement("div",{className:"content"},c),u.a.createElement("div",{className:"references"},h.map(function(e){return u.a.createElement("div",{style:{backgroundColor:M.getColorForHash(e)},className:"dot content-reference"})})))},D=function(e){var t=e.works,n=e.linkType,r=void 0===n?C.b:n,a=Object(s.useState)([]),c=Object(i.a)(a,2),o=c[0],u=c[1];return Object(s.useEffect)(function(){var e;(e=T.a.xanadu).getFlattenedAnnotations.apply(e,[r].concat(Object(w.a)(t.map(function(e){return e.newSequence})))).then(function(e){u(Object(w.a)(e))})},[t,u]),{comments:o}},R=n(177),W=n.n(R),H=(new h.a,Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.works,n=e.linkType,r=void 0===n?C.b:n,a=D({works:t,linkType:r}).comments,c={};return a.reverse(),u.a.createElement("div",null,a.map(function(e){return u.a.createElement(P,{style:c,key:e.annotationData,annotation:e})}))})),U=n(75),B=(new h.a,Object(f.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{}})(function(e){var t=e.worksLoaded,n=e.linkType,r=void 0===n?C.b:n,a=Object(s.useState)(""),c=Object(i.a)(a,2),o=c[0],l=c[1],d=Object(s.useState)([]),f=Object(i.a)(d,2),m=f[0],b=f[1];Object(s.useEffect)(function(){b([])},[t]);var p=Object(s.useCallback)(function(){t.map(function(e){var t=e.newSequence;return T.a.xanadu.newAnnotationContent(r,t,o)}),l(""),b([].concat(Object(w.a)(m),[o]))},[t,o,l,m,b]);return 0===t.length?[]:u.a.createElement("div",{className:"comments-pane"},u.a.createElement("div",{className:"work-comments"},u.a.createElement(H,{works:t}),u.a.createElement(N,{pendingComments:m})),u.a.createElement(U.g,{type:"textarea",value:o,className:"comment-text",placeholder:"Write a comment here",onChange:function(e){return l(e.target.value)}}),u.a.createElement("div",{onClick:p,className:""===o?"submit-comment-btn disabled":"submit-comment-btn"},"Send"))})),V=n(203),F=n(9),Q=n(71),J=n(29),G=n(1130),z=n(38),X=n(47);function $(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var K=(new G.a).contractAddress,Y=L.a.utils.padLeft("0x0",64),Z=function(){return new z.a(K)},ee=function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Q.a(X.e,"deleteList",[Object(I.c)(t)]).execute();case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(o.a)(c.a.mark(function e(t,n,r,a){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Q.a(X.e,"bulkEdit",[t.map(function(e){return Object(I.c)(e)}),n.map(function(e){return e?Object(I.c)(e):Y}),r.map(function(e){return L.a.utils.fromAscii(e)}),a]).execute();case 2:case"end":return e.stop()}},e)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),ne=function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Z().from(J.g).select("newContent").select("previousContent").select("title"),e.t0=re,e.t1=ae,e.next=5,t.executeQuery();case 5:return e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.next=9,(0,e.t0)(e.t3);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),re=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.map(function(e){return e.newContent}),n=Z().from(J.f).select("contentHash"),e.t0=Set,e.next=5,n.executeQuery();case 5:return e.t1=e.sent.map(function(e){return e.contentHash}),r=new e.t0(e.t1),e.abrupt("return",t.filter(function(e){return!r.has(e.newContent)}));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ae=function(e){var t,n={},r=$(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.previousContent&&a.previousContent!==a.newContent&&(n[a.newContent]=a.previousContent)}}catch(f){r.e(f)}finally{r.f()}var c,o={},i=$(e);try{for(i.s();!(c=i.n()).done;){var s=c.value,u=ce(s.newContent,n);u in o||(o[u]=[]),o[u].push(s)}}catch(f){i.e(f)}finally{i.f()}var l=[];for(var d in o)o[d].sort(function(e,t){return t.blockNumber-e.blockNumber}),l.push(o[d][0]);return l},ce=function e(t,n){var r=n[t];return void 0===r?t:e(r,n)};function oe(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ie(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var se=Object(f.b)(function(e,t){return{unpublished:e.explore.unpublished}},function(e){return{setExploreUnpublished:function(t){return e(Object(d.lc)(t))}}})(function(e){var t=e.setExploreUnpublished,n=e.unpublished;Object(s.useEffect)(function(){var e=l.a.getItem("unsavedLists");e&&t(JSON.parse(e))},[]);var r=Object(s.useCallback)(Object(o.a)(c.a.mark(function e(){var r,a,o,i,s,u,d,f,b;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=[],o=[],i=[],s=oe(n),e.prev=5,s.s();case 7:if((u=s.n()).done){e.next=21;break}return d=u.value,e.next=11,m.a.addJson(d);case 11:f=e.sent,b=d.hash,d.hash=f,d.newContent=f,r.push(f),a.push(b),o.push(d.name),i.push(0);case 19:e.next=7;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(5),s.e(e.t0);case 26:return e.prev=26,s.f(),e.finish(26);case 29:l.a.setItem("publishingLists",JSON.stringify(n)),l.a.removeItem("unsavedLists"),te(r,a,o,i),t(void 0);case 33:case"end":return e.stop()}},e,null,[[5,23,26,29]])})),[n]);return n&&0!==n.length?u.a.createElement("div",{onClick:r,className:"save-unpublished-btn"},"Publish Changes ",u.a.createElement("span",{className:"unpublished-count"},n.length)):u.a.createElement("div",null)}),ue=n(43),le=n(348),de=Object(f.b)(function(e,t){return{projectDragging:e.explore.projectDragging}},function(e){return{setProjectDragging:function(t){return e(Object(d.we)(t))},setExploreUnpublished:function(t){return e(Object(d.lc)(t))}}})(function(e){var t=e.hide,n=e.projectDragging,r=e.setProjectDragging,a=e.list,d=e.setExploreUnpublished,f=e.onDelete,m=Object(s.useState)(""),b=Object(i.a)(m,2),p=b[0],v=b[1],h=Object(s.useState)([]),g=Object(i.a)(h,2),k=g[0],E=g[1],O=Object(s.useState)(void 0),j=Object(i.a)(O,2),S=j[0],y=j[1],q=Object(s.useState)(void 0),x=Object(i.a)(q,2),N=x[0],C=x[1];Object(s.useEffect)(function(){a&&(E(a.projects),v(a.name),y(a.image))},[a]);var T=Object(s.useCallback)(function(e){n&&(E([].concat(Object(w.a)(k),[n])),r(void 0))},[n,k,E]),L=Object(s.useCallback)(function(e){if(N){var t=k.indexOf(N),n=Object(w.a)(k);n.splice(t,1);var r=n.indexOf(e);n=[].concat(Object(w.a)(n.slice(0,r)),[N],Object(w.a)(n.slice(r))),C(void 0),E(n)}},[N,E,k,C]),I=Object(s.useCallback)(function(e){var t=k.indexOf(e),n=Object(w.a)(k);n.splice(t,1),E(n)},[k,E]),M=Object(s.useCallback)(Object(o.a)(c.a.mark(function e(){var n,r,o,i,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={name:p,title:p,projects:k,image:S,id:Object(ue.uuid)()},a&&(n.hash=a.newContent,n.newContent=a.newContent),r=(r=l.a.getItem("unsavedLists"))?JSON.parse(r):[],!(a&&r.length>0)){e.next=16;break}e.t0=c.a.keys(r);case 6:if((e.t1=e.t0()).done){e.next=14;break}if(o=e.t1.value,!((i=r[o]).name===a.name||a.hash&&i.hash===a.hash)){e.next=12;break}return r[o]=n,e.abrupt("break",14);case 12:e.next=6;break;case 14:e.next=17;break;case 16:r.push(n);case 17:s=JSON.stringify(r),l.a.setItem("unsavedLists",s),d(r),t(n);case 21:case"end":return e.stop()}},e)})),[p,k,S,t,a]);return u.a.createElement("div",{className:"new-list"},u.a.createElement("div",{onDrop:T,onDragOver:function(e){return e.preventDefault()},className:"inner"},u.a.createElement("input",{placeholder:"Type name for list",value:p,onChange:function(e){return v(e.target.value)},type:"text"}),u.a.createElement("div",{className:"projects"},k.map(function(e){return u.a.createElement("div",{key:e.newSequence,onDrop:function(){return L(e)},onDragOver:function(e){return e.preventDefault()},onDragStart:function(){return C(e)},draggable:!0,className:"project"},u.a.createElement("div",{className:"project-name"},e.title),u.a.createElement("div",{onClick:function(){return I(e)},className:"delete-btn"},"x"))})),u.a.createElement("div",{className:"drop-here"},u.a.createElement("span",null,"Drop projects here")),u.a.createElement("div",{className:"btns"},u.a.createElement("div",{onClick:M,className:"done-btn"},"Done"),u.a.createElement("div",{onClick:function(){return t()},className:"cancel-btn"},"Cancel"))),u.a.createElement("div",{className:"inner"},u.a.createElement(le.a,{imageHash:S,setImageHash:y}),a?u.a.createElement("div",{onClick:function(){window.confirm("Confirm delete")&&f()},className:"delete-list-btn"},"Delete List"):""))}),fe=Object(f.b)(function(e,t){return{worksLoaded:e.explore.worksLoaded}},function(e){return{}})(function(e){var t=e.loadWork,n=Object(s.useState)(!1),r=Object(i.a)(n,2),a=r[0],c=r[1],o=Object(s.useState)(!1),l=Object(i.a)(o,2),d=l[0],f=l[1],b=Object(s.useState)(Object(F.a)({},e.list)),p=Object(i.a)(b,2),v=p[0],h=p[1],g={backgroundImage:"url("+m.a.getHashUrl(v.image)+")"};Object(s.useEffect)(function(){x.a.getAccount().then(function(e){e&&(v.user?c(e.toLowerCase()===v.user.toLowerCase()):c(!0))})},[c]);var k=Object(s.useCallback)(function(t){t&&(h(t),e.onListChanged(t)),f(!1)},[h,f]),E=Object(s.useCallback)(function(t){var n="project";return e.worksLoaded.some(function(e){return e.newSequence===t.newSequence})&&(n+=" loaded"),n},[e.worksLoaded]);return Object(s.useEffect)(function(){e.list.projects[0]&&0===e.worksLoaded.length&&t(v.projects[0])},[]),d?u.a.createElement(de,{onDelete:e.onDelete,list:v,hide:k}):u.a.createElement("div",{style:g,className:"list"},a?u.a.createElement("div",{onClick:function(){return f(!0)},className:"edit-button"},"Edit"):"",u.a.createElement("div",{className:"projects"},v.projects.map(function(e){return u.a.createElement("div",{onClick:function(){return t(e)},className:E(e)},e.title)})),u.a.createElement("div",{className:"list-title"},v.name),u.a.createElement("div",{onClick:e.removeList,className:"delete-btn"},"x"))}),me=(n(2412),Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.creatingNewList,n=e.lists,r=(e.hide,e.loadWork),a=e.removeList,c=e.onListChanged;return u.a.createElement("div",{className:"lists-container"},n.map(function(e,t){return u.a.createElement(fe,{onListChanged:c,onDelete:function(){c(e,!0),a(e)},removeList:function(){return a(e)},key:e.name,loadWork:r,list:e})}),t?u.a.createElement(de,{hide:c}):"",u.a.createElement(se,null))})),be=Object(f.b)(function(e,t){return{personSelected:e.explore.personSelected}},function(e){return{setPersonSelected:function(t){return e(Object(d.jc)(t))}}})(function(e){var t=e.onNewList,n=e.personSelected,r=e.setPersonSelected,a=e.children,c=Object(s.useState)(void 0),o=Object(i.a)(c,2),l=o[0],d=o[1],f=Object(s.useState)(!1),m=Object(i.a)(f,2),b=m[0],p=m[1];return Object(s.useEffect)(function(){n?T.a.users.getUserName(n).then(d):d(void 0)},[n,d]),u.a.createElement("div",{className:"explore-toolbar"},u.a.createElement("div",{className:"toolbar-btn"},u.a.createElement(U.c,{className:"view-dropdown",show:b?"true":"false",isOpen:b,toggle:function(){return p(!b)}},u.a.createElement(U.f,{size:"sm",caret:!0,color:"primary"},u.a.createElement("img",{className:"explore-commands-icon",src:"/automation-icon-disabled.png"})),u.a.createElement(U.e,null,u.a.createElement(U.d,{onClick:t,key:"",size:"sm"},"New List")))),l?u.a.createElement("div",{onClick:function(){return r(void 0)},className:"user-selected"},l):"",a)}),pe=function(e){var t=e.work,n=(e.numPending,Object(s.useState)([])),r=Object(i.a)(n,2),a=r[0],c=r[1];return Object(s.useEffect)(function(){t&&T.a.xanadu.getAnnotations(C.c,t.newSequence).then(function(e){return c(Array.from(new Set(e.map(function(e){return e.annotationData}))))})},[c,t]),{newTag:Object(s.useCallback)(function(e){""!==e.trim()&&(T.a.xanadu.newAnnotation(C.c,t.newSequence,e),c([].concat(Object(w.a)(a),[e])))},[t,a,c]),tags:a,setTags:c}},ve=Object(f.b)(null,null)(function(e){var t=e.work,n=Object(s.useState)(""),r=Object(i.a)(n,2),a=r[0],c=r[1],o=Object(s.useRef)(void 0),l=pe({work:t}),d=l.newTag,f=l.setTags,m=l.tags,b=Object(s.useCallback)(function(e){c(e.target.value)},[c]);Object(s.useEffect)(function(){o.current&&o.current.focus()},[]);var p=Object(s.useCallback)(function(){d(a),c("")},[c,a,m,t,f]);return u.a.createElement("div",{className:"tags-editor"},u.a.createElement("div",{className:"input-container"},u.a.createElement("input",{ref:o,placeholder:"Type tag here",className:"tags-input",type:"text",onChange:b,value:a}),u.a.createElement("div",{onClick:p,className:"tag-button"},"Tag")),u.a.createElement("div",{className:"work-tags"},m.map(function(e){return u.a.createElement("div",{className:"work-tag"},e)})))}),he=function(e){var t=e.edit,n=Object(s.useState)(""),r=Object(i.a)(n,2),a=r[0],c=r[1],o=Object(s.useState)(""),l=Object(i.a)(o,2),d=l[0],f=l[1];return Object(s.useEffect)(function(){T.a.users.getUserName(t.user).then(function(e){return c(e)})},[t,c]),Object(s.useEffect)(function(){T.a.getBlockDate(t.blockNumber).then(function(e){return f(e.toISOString().substring(0,10))})},[f,t]),u.a.createElement("div",{className:"sequence-edit"},u.a.createElement("div",{className:"title"},t.title," -"),u.a.createElement("div",{className:"author"},a),u.a.createElement("div",{className:"date"},d))},ge=Object(f.b)(function(e,t){return{allSequences:e.explore.allSequences}},null)(function(e){var t=e.work,n=e.allSequences,r=Object(s.useState)([]),a=Object(i.a)(r,2),c=a[0],o=a[1];Object(s.useEffect)(function(){var e=T.a.getEditsForSequence(t.newSequence,n);console.log("edits = ",e),o(e)},[o,t,n]);return u.a.createElement("div",null,u.a.createElement("div",{className:"sequence-edits"},c.map(function(e){return u.a.createElement(he,{edit:e})})),u.a.createElement("div",{onClick:function(){window.open("/create/"+t.newSequence)},className:"new-edit-button"},"Create New Edit"))}),ke=n(2301),Ee=(n(2413),function(e){var t=e.annotationsView;if(!t)return u.a.createElement("div",null);var n=["ANNOTATION","TAGS","EDITS"];return u.a.createElement("div",null,u.a.createElement(Oe,{annotationsView:t,linkType:n[0],linkNumber:0},u.a.createElement(ke.a,{work:t})),u.a.createElement(Oe,{annotationsView:t,linkType:n[1],linkNumber:1},u.a.createElement(ve,{work:t})),u.a.createElement(Oe,{annotationsView:t,linkType:n[2],linkNumber:2},u.a.createElement(ge,{work:t})))}),Oe=function(e){var t=e.annotationsView,n=e.linkNumber,r=e.linkType,a=e.children,c={left:130+220*n},o=[210+250*t.workNumber,0,130+220*n,80,330+220*n,80];return console.log("points = ",o,t),u.a.createElement("div",null,u.a.createElement("svg",{className:"annotations-svg "+r,height:"80",width:"1000"},u.a.createElement("polygon",{points:o})),u.a.createElement("div",{style:c,className:"annotations-view "+r},a))},je=0,we=function(e){var t=e.hideText,n=e.searchOptions,r=e.option,a=e.onClickOption,c=e.baseClass,o=void 0===c?"search-option":c,i=e.selectedClass,s=void 0===i?"selected":i;return u.a.createElement("div",{onClick:function(){return a(r)},className:n.indexOf(r)>-1?o+" "+s:o},t?"":"Starred"===r?u.a.createElement("span",null,"\u2606"):r)},Se=function(e){e.searchTerm;var t=e.setSearchTerm,n=e.setSearchOptions,r=e.searchOptions,a=e.setSearchTag,c=e.searchTag,o=Object(s.useState)(""),l=Object(i.a)(o,2),d=l[0],f=l[1],m=Object(s.useCallback)(function(e){var a=++je,c=e.target.value;setTimeout(function(){je===a&&(t(c),(r.includes("Starred")||r.includes("Favorited"))&&n(r.filter(function(e){return"Starred"!==e&&"Favorited"!==e})))},750),f(e.target.value)},[f,t,r,n]),b=Object(s.useCallback)(function(e){if(-1==r.indexOf(e))n("Lists"===e||"Projects"===e?[e]:[e].concat(Object(w.a)(r)));else{var t=r.filter(function(t){return t!==e});console.log("setting search options = ",t),n(t)}},[r,n]);return u.a.createElement("div",{className:"explore-search-container"},c?u.a.createElement("div",{onClick:function(){return a(void 0)},className:"search-tag"},c):"",u.a.createElement("div",{className:"heart-and-soul"},u.a.createElement(we,{hideText:!0,baseClass:"heart",selectedClass:"favorited",onClickOption:b,searchOptions:r,option:"Favorited"}),u.a.createElement("div",null),u.a.createElement(we,{baseClass:"star",selectedClass:"starred",onClickOption:b,searchOptions:r,option:"Starred"})),u.a.createElement(we,{onClickOption:b,searchOptions:r,option:"Lists"}),u.a.createElement(we,{onClickOption:b,searchOptions:r,option:"Projects"}),u.a.createElement("input",{type:"text",value:d,onChange:m,className:"explore-search",placeholder:"Type to search"}),u.a.createElement("div",{onClick:function(){t(""),f(""),a(void 0)},className:"search-clear-btn"},"x"))},ye=n(1278),qe=n(1041),xe=n(42),Ne=n(67),Ce=n(2242),Te=n(539),Le=n(331),Ie=n(2),Me=n(6),Ae=n(11),Pe=n(1),De=n(2259),Re=n(4);n(90);function We(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(Pe.a)(e);if(t){var a=Object(Pe.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(Ae.a)(this,n)}}var He=n(2281);function Ue(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(Pe.a)(e);if(t){var a=Object(Pe.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(Ae.a)(this,n)}}var Be=function(e){Object(Me.a)(n,e);var t=Ue(n);function n(){return Object(Ie.a)(this,n),t.apply(this,arguments)}return n}(function(e){Object(Me.a)(n,e);var t=We(n);function n(){return Object(Ie.a)(this,n),t.apply(this,arguments)}return Object(Re.a)(n,[{key:"saveMix",value:function(){var e=Object(o.a)(c.a.mark(function e(t,n){var r,a,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,x.a.getAccount();case 3:return e.t1=e.sent,e.t2=this.events,e.t3=this.worksLoaded,e.t4=this.initialState,r={title:e.t0,user:e.t1,events:e.t2,works:e.t3,initialState:e.t4},n=void 0===n?L.a.utils.padLeft("0x0",64):Object(I.c)(n),e.next=11,m.a.addJson(r);case 11:return a=e.sent,o=this.worksLoaded.map(function(e){return Object(I.c)(e.newSequence)}),new Q.a(X.o,"newMix",[Object(I.c)(a),n,t,o,0]).execute(),e.abrupt("return",r);case 15:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadMix",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("LOAD MIX CALLED!"),this.unloadAll(),this.events=t.events,this.initialState=t.initialState||{worksLoaded:t.works},this.store.dispatch(Object(d.hc)(t)),console.log("mix loaded =",t),n=Array.from(new Set([].concat(Object(w.a)(this.initialState.worksLoaded),Object(w.a)(t.works)))),e.t0=c.a.keys(n);case 8:if((e.t1=e.t0()).done){e.next=15;break}return r=e.t1.value,console.log("loading work =",n[r]),e.next=13,this.loadWork(n[r]);case 13:e.next=8;break;case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"clearMix",value:function(){this.clearScheduledEvents(),this.initialState=void 0,this.events=[],this.store.dispatch(Object(d.hc)(void 0))}}]),n}(Object(De.a)(He.a))),Ve=n(1277),Fe=n(989),Qe=n(2238),Je=n(988),Ge=function(e){var t=e.name,n=e.option,r=e.selected,a=e.onClick,c="option";return r&&(c+=" selected"),u.a.createElement("div",{onClick:function(){return a(n)},className:c},t)},ze=Object(f.b)(function(e){return{selectedRecord:e.discover.selectedRecord,selectedGuild:e.guilds.selectedGuild,showLogin:e.sequencer.showLogin,option:e.explore.exploreOption,userToken:e.sequencer.userToken}},function(e){return{setOption:function(t){return e(Object(d.ic)(t))}}})(function(e){e.setSearchTerm,e.searchTerm;var t=e.store,n=e.showLogin,r=e.option,a=e.setOption,c=(e.searchOptions,e.setSearchOptions,Object(s.useState)(!1)),o=Object(i.a)(c,2),l=o[0],d=o[1],f="navigation";return x.a.isLoggedIn()||(f+=" logged-off"),u.a.createElement("div",{className:f},u.a.createElement(Ge,{name:"Home",option:qe.b,selected:r===qe.b,onClick:a}),u.a.createElement(Ge,{name:"Guilds",option:qe.a,selected:r===qe.a,onClick:a}),u.a.createElement(Ge,{name:"Messages",option:qe.c,selected:r===qe.c,onClick:a}),u.a.createElement("div",{onClick:function(){return d(!0)},className:"preferences-btn"},"Preferences"),u.a.createElement(Je.a,{store:t}),u.a.createElement(Qe.a,null),u.a.createElement(Fe.a,{show:n}),l?u.a.createElement(Ve.a,{hide:function(){return d(!1)},onlyAppearance:!0}):"")}),Xe=function(e){var t=e.person,n=e.selected,r=e.onClick,a=t.userName,c=t.id,o=n?"person selected":"person";return u.a.createElement("div",{onClick:r,className:o},u.a.createElement("div",{className:"name"},a||c))},$e=(n(1002),function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),_e=function(){var e=Object(o.a)(c.a.mark(function e(t){var n,r,a,o,i,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r in n=new Set,t)n.add(t[r].user);n=Array.from(new Set(n)),a=[],e.t0=c.a.keys(n);case 5:if((e.t1=e.t0()).done){e.next=14;break}return o=e.t1.value,i=n[o].trim(),e.next=10,T.a.users.getUserName(i);case 10:s=e.sent,a.push({id:i,userName:s}),e.next=5;break;case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Ke=(Object(f.b)(function(e,t){return{personSelected:e.explore.personSelected,allSequences:e.explore.allSequences}},function(e){return{setPersonSelected:function(t){return e(Object(d.jc)(t))}}})(function(e){var t=e.personSelected,n=e.setPersonSelected,r=e.allSequences,a=Object(s.useState)([]),c=Object(i.a)(a,2),o=c[0],l=c[1];Object(s.useEffect)(function(){$e(r).then(function(e){return l(e)})},[l,r]);var d="";return t&&(d=u.a.createElement(Xe,{onClick:function(){return n(void 0)},selected:!0,person:t})),u.a.createElement("div",{className:"people"},d,u.a.createElement("div",{className:"people-to-choose"},o.filter(function(e){return!t||t.id!==e.id}).map(function(e){return u.a.createElement(Xe,{onClick:function(){return n(e)},key:e.id,person:e})})))}),n(847)),Ye=function(){var e=Object(o.a)(c.a.mark(function e(t,n,r,a,o,i){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ke.a)(r,void 0,t,n,a,!1,o,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,n,r,a,c,o){return e.apply(this,arguments)}}(),Ze=(n(414),n(179)),et=n(1129),tt=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new z.a((new et.a).contractAddress).from(J.A).select("mixHash").select("previousHash").select("title").select("user"),e.next=3,t.executeQuery(!1);case 3:return n=e.sent,console.log("mix results =",n),e.abrupt("return",n.map(function(e){return Object(F.a)({},e,{type:"MIX"})}));case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function nt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var at=function(){var e=Object(o.a)(c.a.mark(function e(){var t,n,r,a,o,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne();case 2:t=e.sent,n=[],r=nt(t);try{for(r.s();!(a=r.n()).done;)o=a.value,n.push(Object(F.a)({},o,{hash:o.newContent,tags:[],type:"LIST"}))}catch(c){r.e(c)}finally{r.f()}if(i=l.a.getItem("unsavedLists")){e.next=9;break}return e.abrupt("return",n);case 9:return i=JSON.parse(i),n=n.filter(function(e){return!i.some(function(t){return t.hash===e.hash})}),e.abrupt("return",[].concat(Object(w.a)(n),Object(w.a)(i.map(function(e){return Object(F.a)({},e,{id:void 0!==e.id?e.id:Object(ue.uuid)(),title:e.name,unsaved:!0,tags:[],blockNumber:9999999999,type:"LIST"})}))));case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),ct=(new Ze.a,function(){var e=Object(o.a)(c.a.mark(function e(t,n,r,a,o,i,s){var u,l,d,f,m,b;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("person selecred == ",s),u=r.includes("Favorited"),l=r.includes("Starred"),e.next=5,Ye(l,u,a,o,i,s);case 5:return d=e.sent.map(function(e){return Object(F.a)({},e,{type:"SEQUENCE"})}),e.next=8,tt();case 8:return f=e.sent,e.next=11,at();case 11:m=e.sent,(b=[].concat(Object(w.a)(m),Object(w.a)(f),Object(w.a)(d))).sort(function(e,t){return t.blockNumber-e.blockNumber}),t(Object(w.a)(b)),n(!1);case 16:case"end":return e.stop()}},e)}));return function(t,n,r,a,c,o,i){return e.apply(this,arguments)}}()),ot=Object(f.b)(function(e,t){return{exists:t.sequencerEngine.events.length>0}},null)(function(e){var t=e.sequencerEngine,n=e.exists,r=e.originalMix,a=Object(s.useState)(void 0),l=Object(i.a)(a,2),d=l[0],f=l[1],m=Object(s.useState)(""),b=Object(i.a)(m,2),p=b[0],v=b[1],h=Object(s.useState)(""),g=Object(i.a)(h,2),k=g[0],E=g[1],O=Object(s.useCallback)(function(){t.clearMix(),f(void 0)},[f]);Object(s.useEffect)(function(){r&&T.a.users.getUserName(r.user).then(function(e){return E(e)})},[r]);var j=Object(s.useCallback)(Object(o.a)(c.a.mark(function e(){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.saveMix(r?r.title:p,r&&r.mixHash);case 2:n=e.sent,f(n);case 4:case"end":return e.stop()}},e)})),[p,f,r]);return n?r?u.a.createElement("div",{className:"recorded-mix"},u.a.createElement("div",{className:"edit-text"},"Edit of ",u.a.createElement("span",{className:"mix-title"},r.title)," by ",u.a.createElement("span",{className:"mix-author"},k)),u.a.createElement("div",{className:"buttons-container"},d?"":u.a.createElement("div",{onClick:j,className:"save-mix-button"},"Save"),u.a.createElement("div",{onClick:O,className:"clear-mix-button"},"Clear"))):u.a.createElement("div",{className:"recorded-mix"},u.a.createElement("div",{className:"mix-title"},void 0===d?u.a.createElement("input",{placeholder:"Enter mix name",className:"mix-input",type:"text",value:p,onChange:function(e){return v(e.target.value)}}):u.a.createElement("div",null,d.title)),u.a.createElement("div",{className:"buttons-container"},d?"":u.a.createElement("div",{onClick:j,className:"save-mix-button"},"Save"),u.a.createElement("div",{onClick:O,className:"clear-mix-button"},"Clear"))):[]}),it=n(103),st=n.n(it),ut=Object(f.b)(function(e,t){return{bpm:e.user.bpm}},null)(function(e){var t=e.bpm,n=e.sequencerEngine;return u.a.createElement("div",{className:"bpm-container"},u.a.createElement("div",{className:"bpm-label"},"BPM: ",Math.round(t)),u.a.createElement(st.a,{value:t,change:function(e){return n.dispatch(Object(Ce.a)(e.target.value))},step:1,className:"bpm-fader",max:250,min:1,orientation:"horizontal",reversed:!1}))}),lt=n(844),dt=Object(f.b)(function(e){return{playingMap:e.sequencer.isPlaying,isRecordingMix:e.mix.isRecordingMix}},function(e){return{setRecordingExploreMix:function(t){return e(Object(d.Mc)(t))}}})(function(e){var t=e.sequencerEngine,n=e.isRecordingMix,r=e.playingMap,a=e.setRecordingExploreMix,c=Object.keys(r).filter(function(e){return r[e]}).length>0,o=Object(s.useCallback)(function(){a(!n)},[n,a]),i=Object(s.useCallback)(function(e){t.playMix(!c)},[t,c]);return u.a.createElement("div",{className:"work-mix-buttons"},u.a.createElement(lt.a,{isPlaying:c,play:i}),u.a.createElement("div",{onClick:o,className:n?"recording-dot":"not-recording-dot"}))}),ft=n(2258),mt=n(1027),bt=function(e){var t=e.sequencerEngine,n=e.children;return u.a.createElement("div",{className:"mixer-toolbar-container"},u.a.createElement("div",{className:"mixer-toolbar"},u.a.createElement(ut,{sequencerEngine:t}),u.a.createElement(dt,{sequencerEngine:t}),u.a.createElement(ft.a,{sequencerEngine:t.headSequencerEngine}),u.a.createElement(mt.a,{sequencerEngine:t})),n)},pt=n(953),vt=n(1263),ht=(new h.a,Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.work,n=e.showComments,r=e.setSearchTag,a=e.editTags,c=void 0===a||a;t.id=t.newSequence;var o=Object(s.useState)([t]),l=Object(i.a)(o,2),d=l[0],f=(l[1],D({works:d}).comments),m=Object(s.useState)(!1),b=Object(i.a)(m,2),p=b[0],v=b[1],h=pe({work:t}).tags,g=Object(vt.a)({track:t}),k=g.isStarred,E=g.showStar,O=g.isFavorited,j=g.onStarClicked,w=g.onFavoriteClicked,S=Object(s.useCallback)(function(e,t){e.stopPropagation(),r(t)},[r]),y="work-metadata";return p&&(y+=" showing-tags"),u.a.createElement("div",{className:y},u.a.createElement("div",{className:"metadata-inner"},u.a.createElement("div",{className:"work-tags"},c?"":h.filter(function(e){return e}).map(function(e){return u.a.createElement("div",{onClick:function(t){return S(t,e)},className:"work-tag"},e)})),p?u.a.createElement(ve,{work:t}):"",u.a.createElement("img",{onClick:function(){return v(!p)},className:p?"show tag-icon":"tag-icon",src:"/tag.svg"}),n&&f.length>0?u.a.createElement("img",{className:"comments-icon",src:"/comments.svg"}):"",u.a.createElement(xe.a,{condition:E},u.a.createElement("div",{onClick:j,className:k?"star starred":"star"},u.a.createElement("span",null,"\u2606"))),u.a.createElement("div",{onClick:w,className:O?"heart favorited":"heart"})))})),gt=(n(1238),n(678)),kt=["A","B","C","D","E","F","G","H","I","J"],Et=Object(f.b)(function(e,t){var n=t.sequencerEngine.engineId;t.sequencerEngine.currentSubSequence.id;return{currentSubSequence:e.sequencer.currentSubSequence[n],subSequences:e.sequencer.subSequences[n]}},null)(function(e){var t=e.sequencerEngine,n=e.currentSubSequence,r=e.subSequences;return u.a.createElement("div",{className:"sub-sequences"},r.map(function(e,r){return u.a.createElement("div",{onClick:function(){return t.switchToSubSequence(e)},className:e===n?"sub-sequence current":"sub-sequence"},kt[r])}))}),Ot=n(2280),jt=-70,wt=6;var St=Object(f.b)(function(e,t){return{masterVolume:e.sequencer.masterVolumes[t.id]}},null)(function(e){var t=e.masterVolume,n=(e.id,e.multiSequencerEngine),r=e.sequencerEngine,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt;return Math.pow((e-t)/(n-t),4)}(t),c=Object(s.useCallback)(function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt,r=Math.pow(e,.25);return t+(n-t)*r}(e.target.value);n.dispatch(Object(Ce.d)(r.sequenceId,t))},[r,n]);return u.a.createElement("div",{className:"work-volume-container"},u.a.createElement(st.a,{value:a,change:c,step:.01,className:"work-fader",max:1,min:0,orientation:"vertical",reversed:!0}))}),yt=n(677),qt=new h.a,xt=Object(f.b)(function(e,t){return{value:e.explore.workTransposes[t.sequencerEngine.sequenceId]||0}},null)(function(e){var t=e.sequencerEngine,n=e.value,r=e.id,a=Object(s.useCallback)(function(e){(e=Math.round(e))!==n&&t.multiSequencerEngine.dispatch(Object(Ce.c)(t.sequenceId,e))},[t,n]),c=qt.getColorForHash(r||"what");return u.a.createElement("div",{className:"transpose-container"},u.a.createElement(yt.Knob,{size:50,angleOffset:220,angleRange:280,value:n,initialValue:n,step:1,min:-24,max:24,onChange:a},u.a.createElement(yt.Arc,{arcWidth:3,color:c,background:"rgb(56, 63, 72)"}),u.a.createElement(yt.Pointer,{width:3,height:15,radius:10,type:"rect",color:c}),u.a.createElement(yt.Value,{className:"transpose-value"})))}),Nt=new h.a;var Ct=Object(f.b)(function(e,t){return{value:e.explore.mixColorValues[t.id]}},function(e,t){return{setColorValue:function(n){return e(Object(d.nd)(t.id,n))}}})(function(e){var t=e.value,n=void 0===t?.5:t,r=(e.setColorValue,e.mixEffects,e.sequencerEngine),a=e.id,c=Object(s.useCallback)(function(e){r.multiSequencerEngine.dispatch(Object(Ce.b)(a,e))},[]),o=Nt.getColorForHash(a||"what");return u.a.createElement("div",{className:"color-container"},u.a.createElement(yt.Knob,{size:50,angleOffset:220,angleRange:280,value:n,min:0,max:1,onChange:function(e){return c(e)}},u.a.createElement(yt.Arc,{arcWidth:3,color:o,background:"rgb(56, 63, 72)"}),u.a.createElement(yt.Pointer,{width:3,height:15,radius:10,type:"rect",color:o})))}),Tt=new h.a,Lt=Object(f.b)(function(e,t){return{isLoading:e.sequencer.loadingSequence[t.work.newSequence],isPlaying:e.sequencer.isPlaying[t.work.newSequence],isAnnotationShowing:e.explore.exploreWork===t.work,worksLoaded:e.explore.worksLoaded}},function(e){return{setExploreWork:function(t){return e(Object(d.mc)(t))},setProjectDragging:function(t){return e(Object(d.we)(t))}}})(function(e){var t=e.workNumber,n=e.work,r=e.sequencerEngine,a=e.isLoading,c=e.isPlaying,o=e.unloadWork,l=e.setExploreWork,d=e.isAnnotationShowing,f=e.setProjectDragging,m=Object(s.useState)(""),b=Object(i.a)(m,2),p=b[0],v=b[1],h=r.idToSequencerEngine[n.newSequence],g=Object(s.useState)(n.title),k=Object(i.a)(g,2),E=k[0],O=k[1],j=Object(s.useState)(void 0),w=Object(i.a)(j,2),S=w[0],y=w[1];Object(s.useEffect)(function(){n.guildId&&T.a.guildSequences._decryptQueryResult(n).then(function(e){return O(e.title)})},[n,O]),Object(s.useEffect)(function(){h&&h._wallpaper&&Object(pt.a)(h._wallpaper).then(function(e){e&&e[0]&&y(e[0].thumbnail)})},h&&h._wallpaper),Object(s.useEffect)(function(){T.a.users.getUserName(n.user).then(function(e){return v(e)})},[n]);if(a||!h)return u.a.createElement("div",{className:"work-mixer loading"},u.a.createElement(gt.a,{width:200,id:n.newSequence}),u.a.createElement("div",{onClick:o,className:"delete-button"},"x"));var q=Tt.getColorForHash(n.newSequence),x={backgroundColor:q};n.workNumber=t;var N={};return S&&(N.backgroundImage="url(/ipfs/"+S+")"),u.a.createElement("div",{className:"work-mixer-container"},u.a.createElement("div",{style:{},className:"work-mixer"},u.a.createElement("div",{style:N,className:"inner"},u.a.createElement(St,{multiSequencerEngine:r,sequencerEngine:h,id:n.newSequence}),u.a.createElement("div",{className:"work-fields"},u.a.createElement(Et,{sequencerEngine:h}),u.a.createElement(Ot.a,{color:q,sequencerEngine:h}),u.a.createElement("div",{className:"cassette"},u.a.createElement(xt,{id:n.newSequence,sequencerEngine:h}),u.a.createElement(Ct,{mixEffects:h.channelMixer.mixEffects,sequencerEngine:h,id:n.newSequence})))),u.a.createElement("div",{draggable:!0,onDragStart:function(){return f(n)},onDragOver:function(e){return e.preventDefault()},className:"bottom"},u.a.createElement("div",{style:x,className:"play-button"},u.a.createElement(lt.a,{color:Tt.getColorForHash(n.newSequence),isPlaying:c,play:function(){var e=Object(F.a)({},n,{id:n.newSequence});r.dispatch(Object(Ce.f)(e))}})),u.a.createElement("div",{className:"title"},u.a.createElement("div",{className:"work-title"},E),u.a.createElement("div",{className:"author-divider"},"-"),u.a.createElement("div",{className:"work-author"},u.a.createElement("div",{className:"author-label"},"Author"),u.a.createElement("div",{className:"author-name"},p))),u.a.createElement("img",{onClick:function(){return l(d?void 0:n)},src:"/annotations.png",className:d?"annotation-button showing":"annotation-button"}),u.a.createElement("div",{style:x,onClick:function(){l(void 0),o()},className:"delete-button"},"x")),u.a.createElement(ht,{work:n})))}),It=function(e){var t=e.recording,n=e.setDeleting,r=e.deleting,a=e.onClickRecord,c="button-option";t&&(c+=" selected");var o="button-option";return r&&(o+=" selected"),u.a.createElement("div",{className:"sample-options"},u.a.createElement("div",{className:"buttons"},u.a.createElement("div",{onClick:a,className:c},"Rec"),u.a.createElement("div",{onMouseDown:function(){return n(!0)},onMouseUp:function(){return n(!1)},className:o},"Del")))},Mt=n(33),At=n(281),Pt=n(58),Dt=n(400),Rt=new h.a,Wt=new Mt.a(32,!1),Ht=(new Pt.a,function(e){var t=e.track,n=e.setLastClicked,r=e.selected,a=e.recording,c=t.instrument,o=Object(s.useState)(void 0),l=Object(i.a)(o,2),d=l[0],f=l[1],m=Object(s.useState)(0),b=Object(i.a)(m,2),p=b[0],v=b[1],h=Object(s.useState)(0),g=Object(i.a)(h,2),k=g[0],E=g[1],O=p>k,j=c.defaultSampler&&c.defaultSampler.sample,w=Object(s.useCallback)(function(){t.sequencerEngine.state.keyboard.isCommandDown?n(t):(c.defaultSampler.loop&&O?c.triggerRelease():c.triggerAttack(),a&&f(new Dt.a(t,0,Wt,t.sequencerEngine,!0)),n(t))},[c,t,a,f,O]),S=Object(s.useCallback)(function(){t.gated&&c.triggerRelease(),a&&d&&(d.record(),f(void 0))},[c,t,a,d,f]),y=Object(s.useCallback)(function(e){e.trackNumber===t.trackNumber&&setTimeout(function(){v((new Date).getTime()+e.duration),e.duration>0&&setTimeout(q,1e3*e.duration)},e.time)},[t,v,q]),q=Object(s.useCallback)(function(e){void 0!==e&&e.trackNumber!==t.trackNumber||E((new Date).getTime())},[t,E]),x=function(){window.removeEventListener(At.d,y),window.removeEventListener(At.c,q)};Object(s.useEffect)(function(){return window.addEventListener(At.d,y),window.addEventListener(At.c,q),x},[]);var N="sampler-trigger";if(O&&(N+=" triggering"),r&&(N+=" selected"),j&&j.videoId)return u.a.createElement("img",{draggable:!1,onMouseDown:w,onMouseUp:S,onMouseLeave:S,className:N,src:j.getThumbnail()});var C={backgroundColor:Rt.getColorForTrack(t)};return u.a.createElement("div",{draggable:!1,onMouseDown:w,onMouseUp:S,onMouseLeave:S,style:C,className:N})}),Ut=n(141),Bt=new h.a,Vt=function(e){var t=e.lastClicked,n=e.deleteSample,r=(e.recording,e.onClickRecord,Object(s.useState)(!1)),a=Object(i.a)(r,2),c=a[0],o=a[1],l=Object(s.useState)(!1),d=Object(i.a)(l,2),f=d[0],m=d[1],b=Object(s.useState)(!1),p=Object(i.a)(b,2),v=(p[0],p[1]),h=Object(s.useState)(1),g=Object(i.a)(h,2),k=g[0],E=g[1],O=Object(s.useCallback)(function(){t.instrument.loopParameter.set(!f),m(!f)},[m,f,t]),j=Object(s.useCallback)(function(){t.gated=!c,o(!c)},[o,c,t]),w=Object(s.useCallback)(function(){var e=2*k;8===e&&(e=1),t.pattern.changeLength(32*e),E(e)},[E,k,t]);if(Object(s.useEffect)(function(){t&&(o(t.gated),m(t.instrument.loop),v(t.isWarped()),E(t.length/32))},[t,o,m,v,E]),void 0===t)return[];var S="button-option",y="button-option",q=Bt.saturate(Bt.getColorForHash(t.instrument.defaultSampler.sample.getId()),3),x={},N={},C={backgroundColor:q,color:"black"};return f&&(y+=" selected",x.backgroundColor=q,x.color="black"),c&&(S+=" selected",N.backgroundColor=q,N.color="black"),u.a.createElement("div",{className:"sample-options"},u.a.createElement("div",{className:"name"},t.instrument.defaultSampler.sample.name),u.a.createElement("div",{className:"buttons"},u.a.createElement("div",{onClick:j,style:N,className:S},"Gate"),u.a.createElement("div",{onClick:O,style:x,className:y},"Loop"),u.a.createElement("div",{onClick:w,style:C,className:"button-option length-button"},k," Bars"),u.a.createElement("div",{onClick:n,className:"delete-button"},"x")),u.a.createElement("div",{className:"knobs"},u.a.createElement(Ut.a,{min:-40,max:0,color:q,parameter:t.volumeParameter}),u.a.createElement(Ut.a,{color:q,parameter:t.instrument.defaultSampler.transposeParameter})))},Ft=n(956),Qt=function(e){var t=e.sequencerEngine,n=e.samplersLoaded,r=e.deleteSample,a=Object(s.useState)(!1),c=Object(i.a)(a,2),o=c[0],l=c[1],d=Object(s.useState)(!1),f=Object(i.a)(d,2),m=f[0],b=f[1],p=Object(s.useState)(void 0),v=Object(i.a)(p,2),h=v[0],g=v[1];Object(s.useEffect)(function(){n[0]&&(n[0].sequencerEngine.deleting=m)},[m,n]);var k=Object(s.useCallback)(function(){l(!o)},[o,l]);if(0===n.length)return[];var E="";if(h){var O=h.instrument;E=u.a.createElement(Ft.a,{instrument:O,color:"#ffffff",sampler:O.defaultSampler,soundId:O.defaultSampler.sample.getId(),buffer:O.defaultSampler.sample.audioBuffer,width:150,height:40})}return u.a.createElement("div",{className:"sampler"},u.a.createElement("div",{className:"inner"},u.a.createElement(St,{multiSequencerEngine:t,sequencerEngine:n[0].sequencerEngine,id:n[0].sequencerEngine.sequenceId}),u.a.createElement("div",{className:"sampler-triggers"},n.map(function(e){return u.a.createElement(Ht,{key:e.id,recording:o,selected:h===e,setLastClicked:g,track:e})})),u.a.createElement("div",{className:"right-side"},E,u.a.createElement(Vt,{deleteSample:function(){g(void 0),r(h)},lastClicked:h}))),u.a.createElement(It,{setDeleting:b,deleting:m,recording:o,onClickRecord:k}))},Jt=function(e){var t=e.work,n=e.onClick,r=e.mixMode,a=e.sequencerEngine,l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],b=d[1],p=Object(s.useState)({}),v=Object(i.a)(p,2),h=v[0],g=v[1],k=Object(s.useState)([]),E=Object(i.a)(k,2),O=E[0],j=E[1],w=Object(s.useState)({}),S=Object(i.a)(w,2),y=S[0],q=S[1];Object(s.useEffect)(function(){T.a.users.getUserName(t.user).then(function(e){return b(e)})},[t,b]),Object(s.useEffect)(function(){t&&(t.works?(q(t),j(t.works)):m.a.getJson(t.mixHash).then(function(e){e.mixHash=t.mixHash,j(e.works),q(e)}))},[t,j,q]),Object(s.useEffect)(function(){Object(o.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={},e.t0=c.a.keys(O);case 2:if((e.t1=e.t0()).done){e.next=9;break}return n=e.t1.value,e.next=6,T.a.users.getUserName(O[n].user);case 6:t[O[n].user]=e.sent,e.next=2;break;case 9:g(t);case 10:case"end":return e.stop()}},e)}))()},[O,g]);var x="";r&&(x=u.a.createElement("div",{onClick:function(){a.unloadAll()},className:"delete-button"},"x"));var N=t.previousHash&&""!==t.previousHash;return u.a.createElement("div",{onClick:function(){return n(y)},className:"work work-mix"},x,u.a.createElement("div",{className:"mix-info"},O.map(function(e){return[e.title+" - ",u.a.createElement("span",{className:"work-author"},h[e.user])]})),u.a.createElement("div",{className:"name"},u.a.createElement("div",{className:"work-author"},f),u.a.createElement("div",{className:"title"},t.title),u.a.createElement("div",{className:"mix-edit-info"},N?"Edit":"Original"),u.a.createElement("div",{className:"mix-background"},"MIX")))},Gt=Object(f.b)(function(e,t){return{headSequencerEngine:t.sequencerEngine&&t.sequencerEngine.headSequencerEngine,mixLoaded:e.explore.mixLoaded,mixHasEdits:e.explore.mixHasEdits}},null)(function(e){var t=e.worksLoaded,n=e.sequencerEngine,r=e.unloadWork,a=e.samplersLoaded,c=e.deleteSample,o=e.mixLoaded,i=e.mixHasEdits,l=e.children,d=e.lists,f=Object(s.useCallback)(function(){n.unloadAll()},[n]);if(void 0===n)return u.a.createElement("div",null);var m="";return o&&(m=u.a.createElement(Jt,{mixHasEdits:!0,sequencerEngine:n,mixMode:!0,onClick:f,work:o})),u.a.createElement("div",{className:"mixer no-select"},u.a.createElement("div",{className:"mixer-and-works"},u.a.createElement(bt,{sequencerEngine:n}),u.a.createElement("div",{className:"works-container"},t.map(function(e,t){return u.a.createElement(Lt,{workNumber:t,key:e.newSequence,unloadWork:function(){return r(e)},sequencerEngine:n,work:e})}),u.a.createElement(Qt,{sequencerEngine:n,deleteSample:c,samplersLoaded:a}),o?m:"",i?u.a.createElement(ot,{originalMix:o,sequencerEngine:n}):""),d),l)}),zt=n(2274),Xt=n(2307),$t=Object(f.b)(function(e,t){return{}},function(e){return{}})(function(e){var t=e.work,n=e.onClick,r=Object(s.useState)(void 0),a=Object(i.a)(r,2),c=a[0],o=a[1],l=Object(s.useState)(""),d=Object(i.a)(l,2),f=d[0],b=d[1],p=Object(s.useState)([]),v=Object(i.a)(p,2),h=v[0],g=v[1],k=Object(s.useState)(""),E=Object(i.a)(k,2),O=E[0],j=E[1];Object(s.useEffect)(function(){t.projects?(console.log("there was work.projects and work.image =",t.image),g(t.projects),j(m.a.getHashUrl(t.image)),o(Object(F.a)({},t))):m.a.getJson(t.newContent).then(function(e){o(Object(F.a)({},t,e)),j(m.a.getHashUrl(e.image)),g(e.projects)})},[t]),Object(s.useEffect)(function(){T.a.users.getUserName(t.user).then(b)},[t,b]);var w={backgroundImage:"url("+O+")"};return u.a.createElement("div",{onClick:function(){return n(c)},style:w,className:"work list"},u.a.createElement("div",{className:"projects"},h.map(function(e){return u.a.createElement("div",{className:"project"},e.title," .")})),u.a.createElement("div",{className:"list-author"},f),u.a.createElement("div",{className:"list-title"},t.title))}),_t=n(992),Kt=(n(432),new h.a,n(1326)),Yt=n(994);function Zt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return en(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return en(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw c}}}}function en(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var tn=Object(s.memo)(function(e){var t=e.work,n=e.onClick,r=(e.loadSample,e.onClickMix),a=e.onClickList,l=e.setSearchTag,d=e.setProjectDragging,f=e.setPersonSelected,m=Object(s.useState)(""),b=Object(i.a)(m,2),p=b[0],v=b[1],h=Object(s.useState)(t.title),g=Object(i.a)(h,2),k=g[0],E=g[1],O=Object(s.useState)(!1),j=Object(i.a)(O,2),w=(j[0],j[1],Object(s.useState)([])),S=Object(i.a)(w,2),y=S[0],q=S[1],x=Object(s.useState)(void 0),N=Object(i.a)(x,2),C=N[0],L=N[1],I=Object(s.useState)(void 0),M=Object(i.a)(I,2),A=M[0],P=(M[1],Object(s.useState)([t])),R=Object(i.a)(P,2),W=R[0];R[1];t.id=t.newSequence,Object(s.useEffect)(function(){t.guildId&&T.a.guildSequences._decryptQueryResult(t).then(function(e){return E(e.title)})},[t,E]);D({works:W}).comments;if(Object(s.useEffect)(function(){"SEQUENCE"===t.type&&Object(Kt.a)(t).then(function(){var e=Object(o.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.wallpaper,n=t.graphic,t.bpm,v(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},[t]),Object(s.useEffect)(function(){Object(_t.a)(t.blockNumber).then(L)},[t,L]),Object(s.useEffect)(function(){if(t.collaborators){var e,n=[],r=Zt(t.collaborators);try{for(r.s();!(e=r.n()).done;){var a=e.value;n.push(T.a.users.getUserName(a))}}catch(c){r.e(c)}finally{r.f()}Promise.all(n).then(q)}},[t,q]),"MIX"===t.type)return u.a.createElement(Jt,{work:t,onClick:r}," ");if("LIST"===t.type)return u.a.createElement($t,{onClick:a,work:t});var H=t.previousSequence&&""!==t.previousSequence,U={};A&&(U.backgroundImage="url(/ipfs/"+A+")");var B=void 0,V=void 0;if(C){var F=(new Date).getTime()-C.getTime();V=Math.ceil(F/1e3/60),B=Math.ceil(V/60)}return u.a.createElement("div",{draggable:!0,onDragStart:function(){return d(t)},onDragOver:function(e){return e.preventDefault()},onClick:function(){return n(t)},className:"work"},u.a.createElement(ht,{setSearchTag:l,editTags:!1,showComments:!0,work:t}),u.a.createElement("div",{className:"graphic"},p),u.a.createElement("div",{className:"name"},u.a.createElement("div",{className:"work-author"},y.map(function(e,n){return u.a.createElement("div",{onClick:function(e){e.stopPropagation(),f(t.collaborators[n])},className:0===n?"collaborator origin":"collaborator"},e)})),u.a.createElement("div",{style:U,className:"work-thumb"}),u.a.createElement("div",{className:"work-title"},u.a.createElement("span",null,k))),u.a.createElement("div",{className:"work-edit-info"},H?"Edit":"Original"),u.a.createElement("div",{className:"work-date"},C?V<60?V+" min ago":B<48?B+" hours ago":Object(Yt.a)(C):""))}),nn=Object(f.b)(null,function(e){return{setProjectDragging:function(t){return e(Object(d.we)(t))},setPersonSelected:function(t){return e(Object(d.jc)(t))}}})(tn),rn=Object(f.b)(function(e,t){return{personSelected:e.explore.personSelected,allSequences:e.explore.allSequences,worksLoaded:e.explore.worksLoaded}},null)(function(e){var t=e.allSequences,n=e.onClickWork,r=e.onClickMix,a=e.onClickList,c=e.loadSample,o=e.searchTerm,l=e.searchOptions,d=e.personSelected,f=e.setSearchTag,m=(e.worksLoaded,Object(s.useState)({numTracks:Math.floor(9*window.innerWidth/1e3),scrollTop:0})),b=Object(i.a)(m,2),p=b[0],v=b[1],h=(p.scrollTop,p.numTracks,function(e){var t=e.allSequences,n=e.personSelected,r=e.searchOptions,a=e.searchTerm,c=e.setState,o=Object(s.useState)(!1),u=Object(i.a)(o,2),l=u[0],d=u[1],f=t.filter(function(e){return!n||e.user===n.id}),m=r.indexOf("Samples")>-1,b=r.indexOf("Projects")>-1,p=r.indexOf("Lists")>-1;f=f.filter(function(e){return p&&"LIST"===e.type||m&&("SAMPLES"===e.type||"MIX"===e.type)||b&&"SEQUENCE"===e.type});var v=Object(w.a)(f);return Object(s.useEffect)(function(){console.log("GOING TO BEGINNING"),c({scrollTo:0,numTracks:9}),document.getElementById("works").scrollTo(0,0)},[a,r,c]),Object(s.useEffect)(function(){c({numTracks:9,scrollTop:0})},[n]),{works:v,userWorks:f,isLoading:l,setIsLoading:d}}({allSequences:t,searchTerm:o,searchOptions:l,setState:v})),g=h.userWorks,k=h.works,E=h.setIsLoading,O=h.isLoading,j=function(e){var t=e.setIsLoading,n=e.userWorks,r=e.setState,a=Object(s.useState)((new Date).getMonth()),c=Object(i.a)(a,2),o=c[0],u=c[1],l=Object(s.useState)({}),d=Object(i.a)(l,2),f=d[0],m=d[1];return Object(s.useEffect)(function(){Object(zt.a)().then(function(e){return m(e)})},[m]),{onClickMonth:Object(s.useCallback)(function(e){t(!0);var a=f[Math.min((new Date).getMonth(),e+1)];if(e==(new Date).getMonth())return r({numTracks:25,scrollTop:0}),u(e),void setTimeout(function(){t(!1)},500);for(var c in n)if(n[c].blockNumber<a){var o=parseInt(c);r({numTracks:o+9,skipTracks:o}),setTimeout(function(){u(e),setTimeout(function(){t(!1)},500)},50);break}},[f,n,r,u,t]),months:f,currentMonth:o,setCurrentMonth:u}}({setIsLoading:E,setState:v,userWorks:g}),S=j.months,y=j.onClickMonth,q=j.setCurrentMonth,x=j.currentMonth,N=function(e){var t=e.setIsLoading,n=e.isLoading,r=e.userWorks,a=e.setCurrentMonth,c=e.months,o=e.state,i=e.setState,u=e.works,l=e.personSelected,d=o.skipTracks,f=o.scrollTop,m=o.numTracks,b=Object(s.useCallback)(function(){if(!(m>=r.length)){var e=document.getElementById("works");if(!n){var o=e.scrollTop+e.offsetHeight,s=e.scrollHeight;if(e.scrollTop<=f-1300&&f>50)setTimeout(function(){i({numTracks:9,scrollTop:0}),e.scrollTo(0,0),a((new Date).getMonth())},200);else if(o>=s){t(!0);var u=m+6;if(!r[u])return void t(!1);var l=r[u].blockNumber;for(var b in c)if(b=parseInt(b),l<c[b]){a(b-1);break}setTimeout(function(){console.log("setting scrollTop=",e.scrollTop),i({skipTracks:d,numTracks:m+6,scrollTop:e.scrollTop}),t(!1)},200)}}}},[m,t,d,n,i,r,a,c,f]);function p(){var e=document.getElementById("works");e&&e.removeEventListener("scroll",b)}Object(s.useEffect)(function(){var e=document.getElementById("works");e&&e.scrollTo(0,0)},[d]),Object(s.useEffect)(function(){var e=document.getElementById("works");i({numTracks:9,scrollTop:0}),e&&e.scrollTo(0,0),a((new Date).getMonth())},[l,a]),Object(s.useEffect)(function(){var e=document.getElementById("works");return e&&e.addEventListener("scroll",b),p},[b,r,o,d]);var v=d;if(void 0===d){var h=Math.max(1,Math.floor((window.innerWidth-110)/420)),g=Math.floor(f/290)*h;9===m&&(g=0),g=Math.max(0,g-50)}var k=u.slice(v,m);return{onScroll:b,scrollWorks:k,toSkip:v=void 0!==d?0:v}}({works:k,setIsLoading:E,isLoading:O,state:p,setState:v,userWorks:g,setCurrentMonth:q,months:S,personSelected:d}),C=(N.onScroll,N.scrollWorks),T=N.toSkip;return u.a.createElement("div",{className:"works-and-months"},u.a.createElement("div",{id:"works"},u.a.createElement("div",{className:"works-grid"},C.map(function(e,t){return u.a.createElement(nn,{setSearchTag:f,loadSample:c,onClick:n,onClickMix:r,onClickList:a,key:t+Math.floor(T)+"-"+e.newSequence+"-"+e.blockNumber,work:e})})),u.a.createElement("div",{className:"loader-container"},u.a.createElement(W.a,{sizeUnit:"px",size:20,color:"#42f4f1",loading:O}))),u.a.createElement(Xt.a,{months:S,onClickMonth:y,currentMonth:x}))});n(1330),t.default=Object(f.b)(function(e,t){var n;return n={allSequences:e.explore.allSequences,personSelected:e.explore.personSelected,worksLoaded:e.explore.worksLoaded,exploreOption:e.explore.exploreOption,annotationsView:e.explore.annotationsView,wallpaper:e.sequencer.wallpaper,animateWallpaper:e.sequencer.animateWallpaper,exploreWork:e.explore.exploreWork},Object(r.a)(n,"personSelected",e.explore.personSelected),Object(r.a)(n,"guildId",e.guilds.selectedGuild?e.guilds.selectedGuild.guildId:0),n},function(e){return{setAllSequences:function(t){return e(Object(d.gc)(t))},setCommandDown:function(t){return e(Object(d.ob)(t))},setWorksLoaded:function(t){return e(Object(d.Qh)(t))},setExploreUnpublished:function(t){return e(Object(d.lc)(t))},setWallpaper:function(t){return e(Object(d.Jh)(t))},setAnimateWallpaper:function(t){return e(Object(d.z)(t))},setExploreWork:function(t){return e(Object(d.mc)(t))}}})(function(e){var t=Object(s.useState)(void 0),n=Object(i.a)(t,2),r=n[0],a=n[1],d=e.personSelected,f=e.worksLoaded,b=(e.setWorksLoaded,e.guildId),p=Object(s.useState)(void 0),h=Object(i.a)(p,2),g=(h[0],h[1]),k=Object(s.useState)([]),E=Object(i.a)(k,2),O=E[0],j=E[1],S=Object(s.useState)(""),y=Object(i.a)(S,2),N=y[0],C=y[1],L=Object(s.useState)(void 0),I=Object(i.a)(L,2),M=I[0],A=I[1],P=Object(s.useState)(["Projects"]),D=Object(i.a)(P,2),R=D[0],W=D[1],H=function(e,t){var n=Object(s.useState)(!1),r=Object(i.a)(n,2),a=r[0],c=r[1],o=Object(s.useState)([]),u=Object(i.a)(o,2),d=u[0],f=u[1],m=Object(s.useCallback)(function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0!==t){var r=l.a.getItem("unsavedLists");if(r&&(r=JSON.parse(r)),void 0===t.hash)if(n){var a=e.allSequences.filter(function(e){return e.id!==t.id});e.setAllSequences(a),r&&(r=r.filter(function(e){return e.name!==t.name}),l.a.setItem("unsavedLists",JSON.stringify(r)),e.setExploreUnpublished(r))}else e.setAllSequences([Object(F.a)({},t,{type:"LIST"})].concat(Object(w.a)(e.allSequences)));else if(n){ee(t.newContent);var o=e.allSequences.filter(function(e){return e.hash!==t.hash});e.setAllSequences(o)}c(!1)}else c(!1)},[c,t,e.allSequences]),b=Object(s.useCallback)(function(e){if(d.indexOf(e)>-1){var t=Object(w.a)(d);t.splice(d.indexOf(e),1),f(t)}else f([].concat(Object(w.a)(d),[e]))},[f,d]);return{lists:d,onListChanged:m,onClickList:b,creatingNewList:a,setCreatingNewList:c}}(e,r),U=H.lists,Q=H.onListChanged,J=H.onClickList,G=H.creatingNewList,z=H.setCreatingNewList,X=Object(s.useState)(!0),$=Object(i.a)(X,2),_=$[0],K=$[1];Object(s.useEffect)(function(){var t=function(e){x.a.setEthereum(T.a),T.a.store=e,T.a.crypto.store=e,T.a.guilds.initGuilds(),x.a.setStore(e),Te.a.setSampleRate(Le.d);var t=new Be(e);return window.multiMix=!0,window.sequencerEngine=t,t.ethereum=T.a,t}(e.store);window.explore=!0,a(t),oe(),window.addEventListener("keydown",Y),window.addEventListener("keyup",Z)},[]),Object(s.useEffect)(function(){e.setAllSequences([]),K(!0),ct(e.setAllSequences,K,R,N,M,b,d).then(function(e){return K(!1)})},[d,R,K,N,M,b]),Object(s.useEffect)(function(){if(r){var t=e.match&&void 0!=e.match.params.sequenceId?e.match.params.sequenceId:null;t&&T.a.getSequence(t).then(function(n){n||(n={newSequence:t,title:"Unpublished work"}),r.dispatch(Object(Ce.e)(n)),e.setExploreWork(n)})}},[r]);var Y=Object(s.useCallback)(function(t){"Meta"===t.key&&e.setCommandDown(!0)},[]),Z=Object(s.useCallback)(function(t){"Meta"===t.key&&e.setCommandDown(!1)},[]),te=Object(s.useCallback)(function(e){r.dispatch(Object(Ce.h)(e))},[r]),ne=Object(s.useCallback)(function(e){r.dispatch(Object(Ce.e)(e))},[r]),re=Object(s.useCallback)(function(e){r.loadMix(e)},[r]),ae=function(e,t,n){return Object(s.useCallback)(function(){var n=Object(o.a)(c.a.mark(function n(r){var a,o;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.samplerTrack.addSampledInstrumentTrack(),o=new Ne.a(r),n.next=4,o.load();case 4:return n.next=6,a.instrument.newSample(0,o);case 6:a.instrument.monophonic=!0,t(Object(w.a)(e.samplerTrack.tracks));case 8:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),[t,n,e])}(r,j),ce=function(e,t,n){return Object(s.useCallback)(function(t){n.samplerTrack.deleteTrack(t.trackNumber),e(Object(w.a)(n.samplerTrack.tracks))},[e,t,n])}(j,O,r),oe=function(){var e=Object(o.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.getUser();case 2:t=e.sent,g(t);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)(function(){v.isMobile&&f&&f.length>0&&e.setExploreWork(f[0])},[f]);var ie="explore-2",se={};return e.wallpaper?se.backgroundImage="url("+m.a.getHashUrl(e.wallpaper)+")":ie+=" no-wallpaper",e.animateWallpaper&&(ie+=" animate"),Object(s.useEffect)(function(){var t=l.a.getItem("wallpaper");t?e.setWallpaper(t):e.setWallpaper("QmUh2FeN3bw2VdcRVksDctr1ihjDwHpNhE6o9mkBhF2huB"),void 0!==(t=l.a.getItem("animateWallpaper"))&&e.setAnimateWallpaper("true"===t)},[]),f&&f.length>0&&(ie+=" work-loaded"),e.exploreWork&&(ie+=" exploring"),u.a.createElement("div",{className:ie,style:se},u.a.createElement(xe.a,{condition:e.exploreOption===qe.a},u.a.createElement(ye.a,{store:e.store})),u.a.createElement(xe.a,{condition:e.exploreOption===qe.b},u.a.createElement(Ee,{annotationsView:e.annotationsView}),u.a.createElement(Gt,{unloadWork:te,sequencerEngine:r,samplersLoaded:O,lists:u.a.createElement(me,{loadWork:ne,removeList:J,onListChanged:Q,creatingNewList:G,hide:function(){return z(!1)},lists:U}),deleteSample:ce,worksLoaded:f},r?u.a.createElement("div",{className:"login-and-comments"},u.a.createElement(ze,{store:r.store,setSearchOptions:W,searchOptions:R,setSearchTerm:C,searchTerm:N}),u.a.createElement(B,{sequencerEngine:r})):""),u.a.createElement(be,{onNewList:function(){return z(!0)}},u.a.createElement(Se,{searchTag:M,setSearchTag:A,setSearchOptions:W,searchOptions:R,setSearchTerm:C,searchTerm:N})),_?u.a.createElement(V.a,{className:"world-fetcher",text:"Fetching the world"}):"",e.exploreWork?u.a.createElement(q,{work:e.exploreWork,sequencerEngine:r}):u.a.createElement(rn,{onClickMix:re,onClickList:J,loadSample:ae,onClickWork:ne,setSearchTag:A,searchOptions:R,searchTerm:N}),u.a.createElement("div",{color:"radial-gradient(75.29% 75.29% at 64.96% 24.36%, #F0DFA7 0.52%, #FDBDAA 18.75%, #FEA186 34.38%, #F09277 49.48%, #D27584 74.48%, #6B7B8A 100%)",className:"coke-machine-glow"})))})}}]);